<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>lvm [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="partitions,administration,systeme"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/lvm?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/lvm?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/lvm"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/lvm"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/lvm"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"lvm","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="lvm">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/lvm?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/lvm?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/lvm?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/lvm?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/lvm?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/lvm?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/lvm?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">lvm</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/lvm?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/lvm?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/lvm?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#introduction","title":"Introduction","level":1},{"link":"#avantages_de_lvm","title":"Avantages de LVM","level":2},{"link":"#inconvenients_de_lvm","title":"Inconv\u00e9nients de LVM","level":2},{"link":"#pre-requis","title":"Pr\u00e9-requis","level":1},{"link":"#installation","title":"Installation","level":1},{"link":"#notions_et_vocabulaire","title":"Notions et vocabulaire","level":1},{"link":"#volume_physique","title":"Volume physique","level":2},{"link":"#groupe_de_volumes","title":"Groupe de volumes","level":2},{"link":"#volume_logique","title":"Volume logique","level":2},{"link":"#synthese_graphique","title":"Synth\u00e8se graphique","level":2},{"link":"#creation","title":"Cr\u00e9ation","level":1},{"link":"#groupe_de_volumes1","title":"Groupe de volumes","level":2},{"link":"#volume_logique1","title":"Volume logique","level":2},{"link":"#systeme_de_fichiers","title":"Syst\u00e8me de fichiers","level":2},{"link":"#suppression","title":"Suppression","level":1},{"link":"#redimensionnement","title":"Redimensionnement","level":1},{"link":"#volume_physique1","title":"Volume physique","level":2},{"link":"#volume_logique2","title":"Volume logique","level":2},{"link":"#snapshot","title":"Snapshot","level":1},{"link":"#creation_d_un_snapshot_lvm","title":"Cr\u00e9ation d'un snapshot LVM","level":2},{"link":"#redimensionnement_du_snapshot","title":"Redimensionnement du snapshot","level":2},{"link":"#fusionner_un_snapshot","title":"Fusionner un snapshot","level":2},{"link":"#changement_d_un_disque_defectueux","title":"Changement d'un disque d\u00e9fectueux","level":1},{"link":"#principe","title":"Principe","level":2},{"link":"#avec_gparted","title":"Avec GParted","level":2},{"link":"#en_ligne_de_commande","title":"En ligne de commande","level":2},{"link":"#finalisation","title":"Finalisation","level":2},{"link":"#mieux_comprendre_ou_aller_plus_loin","title":"Mieux comprendre ou aller plus loin","level":1},{"link":"#notion_d_extent","title":"Notion d'\u00ab extent \u00bb","level":2},{"link":"#glossaire","title":"Glossaire","level":2},{"link":"#lvm_et_raid","title":"LVM et RAID","level":2},{"link":"#lvm_miroir","title":"LVM miroir","level":2},{"link":"#interface_graphique_pour_lvm","title":"Interface graphique pour LVM","level":2},{"link":"#monter_une_partition","title":"Monter une partition","level":2},{"link":"#verifier_une_partition","title":"V\u00e9rifier une partition","level":2},{"link":"#references","title":"R\u00e9f\u00e9rences","level":2}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#introduction">Introduction</a>
<ul class="nav toc">
<li class="level2"><a href="#avantages_de_lvm">Avantages de LVM</a></li>
<li class="level2"><a href="#inconvenients_de_lvm">Inconvénients de LVM</a></li>
</ul>
</li>
<li class="level1"><a href="#pre-requis">Pré-requis</a></li>
<li class="level1"><a href="#installation">Installation</a></li>
<li class="level1"><a href="#notions_et_vocabulaire">Notions et vocabulaire</a>
<ul class="nav toc">
<li class="level2"><a href="#volume_physique">Volume physique</a></li>
<li class="level2"><a href="#groupe_de_volumes">Groupe de volumes</a></li>
<li class="level2"><a href="#volume_logique">Volume logique</a></li>
<li class="level2"><a href="#synthese_graphique">Synthèse graphique</a></li>
</ul>
</li>
<li class="level1"><a href="#creation">Création</a>
<ul class="nav toc">
<li class="level2"><a href="#groupe_de_volumes1">Groupe de volumes</a></li>
<li class="level2"><a href="#volume_logique1">Volume logique</a></li>
<li class="level2"><a href="#systeme_de_fichiers">Système de fichiers</a></li>
</ul>
</li>
<li class="level1"><a href="#suppression">Suppression</a></li>
<li class="level1"><a href="#redimensionnement">Redimensionnement</a>
<ul class="nav toc">
<li class="level2"><a href="#volume_physique1">Volume physique</a></li>
<li class="level2"><a href="#volume_logique2">Volume logique</a></li>
</ul>
</li>
<li class="level1"><a href="#snapshot">Snapshot</a>
<ul class="nav toc">
<li class="level2"><a href="#creation_d_un_snapshot_lvm">Création d&#039;un snapshot LVM</a></li>
<li class="level2"><a href="#redimensionnement_du_snapshot">Redimensionnement du snapshot</a></li>
<li class="level2"><a href="#fusionner_un_snapshot">Fusionner un snapshot</a></li>
</ul>
</li>
<li class="level1"><a href="#changement_d_un_disque_defectueux">Changement d&#039;un disque défectueux</a>
<ul class="nav toc">
<li class="level2"><a href="#principe">Principe</a></li>
<li class="level2"><a href="#avec_gparted">Avec GParted</a></li>
<li class="level2"><a href="#en_ligne_de_commande">En ligne de commande</a></li>
<li class="level2"><a href="#finalisation">Finalisation</a></li>
</ul>
</li>
<li class="level1"><a href="#mieux_comprendre_ou_aller_plus_loin">Mieux comprendre ou aller plus loin</a>
<ul class="nav toc">
<li class="level2"><a href="#notion_d_extent">Notion d&#039;« extent »</a></li>
<li class="level2"><a href="#glossaire">Glossaire</a></li>
<li class="level2"><a href="#lvm_et_raid">LVM et RAID</a></li>
<li class="level2"><a href="#lvm_miroir">LVM miroir</a></li>
<li class="level2"><a href="#interface_graphique_pour_lvm">Interface graphique pour LVM</a></li>
<li class="level2"><a href="#monter_une_partition">Monter une partition</a></li>
<li class="level2"><a href="#verifier_une_partition">Vérifier une partition</a></li>
<li class="level2"><a href="#references">Références</a></li>
</ul></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/partitions" class="wikilink1" title="partitions" rel="tag">partitions</a>,
	<a href="/administration" class="wikilink1" title="administration" rel="tag">administration</a>,
	<a href="/systeme" class="wikilink1" title="systeme" rel="tag">système</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="lvm_une_autre_maniere_de_partitionner">LVM, une autre manière de partitionner</h1>
<div class="level1">

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[LVM, une autre manière de partitionner] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="lvm_une_autre_maniere_de_partitionner" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="51-104" /><button type="submit" title="LVM, une autre manière de partitionner" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="introduction">Introduction</h2>
<div class="level2">

<p>
<strong>LVM</strong> (Logical Volume Manager, ou <em>gestionnaire de volumes logiques</em> en français) permet la création et la gestion de volumes logiques sous Linux. L&#039;utilisation de volumes logiques remplace en quelque sorte le partitionnement des disques. C&#039;est un système beaucoup plus souple, qui permet par exemple de diminuer la taille d&#039;un système de fichier pour pouvoir en agrandir un autre, sans se préoccuper de leur emplacement sur le disque.<br/>

</p>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Introduction] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="introduction" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="105-580" /><button type="submit" title="Introduction" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit3" id="avantages_de_lvm">Avantages de LVM</h3>
<div class="level3">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Il n&#039;y a pas de limitations « étranges » comme avec les partitions (primaire, étendue, etc.).</div>
</li>
<li class="level1"><div class="li"> On ne se préoccupe plus de l&#039;emplacement exact des données.</div>
</li>
<li class="level1"><div class="li"> On peut conserver quelques giga-octets de libres pour pouvoir les ajouter n&#039;importe où et n&#039;importe quand.</div>
</li>
<li class="level1"><div class="li"> Les opérations de redimensionnement deviennent quasiment sans risques, contrairement au redimensionnement des partitions.</div>
</li>
<li class="level1"><div class="li"> On peut créer des snapshots de volume sans perturber le fonctionnement de la machine et sans interruption de services.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Avantages de LVM] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="avantages_de_lvm" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="581-1140" /><button type="submit" title="Avantages de LVM" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit4" id="inconvenients_de_lvm">Inconvénients de LVM</h3>
<div class="level3">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Si un des volumes physiques devient HS, alors c&#039;est l&#039;ensemble des volumes logiques qui utilisent ce volume physique qui sont perdus. Pour éviter ce désastre, il faudra utiliser LVM sur des disques raid par exemple.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Inconvénients de LVM] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="inconvenients_de_lvm" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1141-1396" /><button type="submit" title="Inconvénients de LVM" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit5 page-header" id="pre-requis">Pré-requis</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Un disque ou une partition libre.</div>
</li>
<li class="level1"><div class="li"> Ne pas avoir peur de la ligne de commande.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Pré-requis] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="pre-requis" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1397-1507" /><button type="submit" title="Pré-requis" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit6 page-header" id="installation">Installation</h2>
<div class="level2">

<p>
<a href="/gestionnaire_de_paquets" class="wikilink1" title="gestionnaire_de_paquets">Installez</a> le paquet <a href="apt://lvm2" class="urlextern" title="apt://lvm2" rel="nofollow">lvm2</a>.
Avant d&#039;utiliser LVM, il faut comprendre un peu de vocabulaire. Ne vous inquiétez pas si tout n&#039;est pas encore très clair, ça viendra au fur et à mesure, en passant à la pratique.
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Installation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1508-1788" /><button type="submit" title="Installation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit7 page-header" id="notions_et_vocabulaire">Notions et vocabulaire</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Notions et vocabulaire] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="notions_et_vocabulaire" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1789-1824" /><button type="submit" title="Notions et vocabulaire" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit8" id="volume_physique">Volume physique</h3>
<div class="level3">

<p>
Un volume physique ou « PV » pour « <em>physical volume</em> » est tout simplement un disque ou une partition. Bref, c&#039;est un espace de stockage bien réel (autrement dit un périphérique de la forme <code>/dev/sda2</code> par exemple), que l&#039;on va confier à LVM. Bien évidemment, tout ce qui était présent sur la partition sera effacé.
</p>
<div class="noteimportant">avant de pouvoir définir le volume physique, il est nécessaire qu&#039;une partition existe. Pour cela vous pouvez avoir recours à <a href="/gparted" class="wikilink1" title="gparted">gparted</a> sur un PC desktop et à <a href="http://www.gnu.org/software/parted/manual/parted.html" class="urlextern" title="http://www.gnu.org/software/parted/manual/parted.html" rel="nofollow">parted</a> sur serveur
</div>
</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Volume physique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="volume_physique" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1825-2459" /><button type="submit" title="Volume physique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit9" id="groupe_de_volumes">Groupe de volumes</h3>
<div class="level3">

<p>
Un groupe de volumes ou « VG » pour « <em>volume group</em> » est, comme son nom l&#039;indique, un ensemble de volumes physiques. On a donc un ou plusieurs volumes physiques dans un groupe de volumes, et pour utiliser LVM, il faut obligatoirement au moins un groupe de volumes. Habituellement, sur les gros serveurs, on essaye de regrouper les disques en fonction de leur caractéristiques (capacités, performances, etc.). Pour un particulier, le fait de mettre plusieurs disques dans un même groupe de volume peut permettre « d&#039;étaler » un système de fichiers sur plusieurs disques, et d&#039;avoir donc <code>/home</code> par exemple qui utiliserait 2 disques. Une telle configuration est tout de même assez dangereuse en cas de perte d&#039;un disque… De plus, cela n&#039;apporterait aucun gain de performance contrairement à du RAID-0 par exemple.
:)
</p>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Groupe de volumes] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="groupe_de_volumes" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="2460-3325" /><button type="submit" title="Groupe de volumes" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit10" id="volume_logique">Volume logique</h3>
<div class="level3">

<p>
Un volume logique ou « LV » pour « <em>logical volume</em> » est ce que nous allons utiliser au final. Un volume logique est un espace « quelque part dans un groupe de volume » où l&#039;on peut mettre un système de fichiers. C&#039;est donc ce qui remplace les partitions. On peut donc utiliser un volume logique pour mettre la mémoire virtuelle, un pour <code>/home</code>, &quot;/&quot;, etc.
</p>
<div class="noteimportant">Évitez de mettre &quot;/boot/grub&quot; dans un volume logique car cela peut poser des problèmes pour le démarrage du système. En effet, grub ne sait pas encore (novembre 2015) écrire dans un fichier localisé dans un tel volume. Or grub mémorise le résultat du démarrage courant dans le fichier /boot/grub/grubenv de manière à modifier le démarrage qui suit un démarrage défaillant.

</div>
<p>
On peut y mettre à peu près tout … mais il vaut mieux éviter d&#039;y mettre &quot;/boot&quot;. Techniquement, ça doit fonctionner à peu près correctement depuis Grub 2, mais cela est encore sensible suivant la configuration (et perdre la capacité de démarrer est … gênant), pour le moment il est vivement conseillé d&#039;avoir au moins une partition de l&#039;ancien temps avec &quot;/boot&quot; (ou &quot;/&quot; si le dossier &quot;/boot&quot; n&#039;est pas séparé) pour éviter les ennuis.
</p>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Volume logique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="volume_logique" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="3326-4588" /><button type="submit" title="Volume logique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit11" id="synthese_graphique">Synthèse graphique</h3>
<div class="level3">

<p>
On peut voir les choses ainsi :
</p>

<p>
<a href="/_detail/lvm.jpg?id=lvm" class="media" title="lvm.jpg"><img src="/_media/lvm.jpg" class="media img-responsive" alt="" /></a>
</p>

</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Synthèse graphique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="synthese_graphique" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="4589-4667" /><button type="submit" title="Synthèse graphique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit12 page-header" id="creation">Création</h2>
<div class="level2">

<p>
Bien, passons à la pratique !
</p>

<p>
Puisque nous allons entrer toutes les commandes à venir en tant que <em>root</em>, je vous conseille de passer <em>root</em> « une bonne fois pour toutes » :
</p>
<pre class="code">sudo -i</pre>

<p>
Voilà : le <em>prompt</em> est maintenant en mode root « # », cela nous évitera d&#039;avoir à préfixer chaque commande par <em>sudo</em>.
</p>

<p>
Bonne nouvelle, les commandes LVM sont extrêmement simples à utiliser, et elles intègrent toutes une aide en ligne très bien conçue, claire, courte, mais suffisante. De plus, leurs noms se « devinent » assez facilement :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> toutes les commandes agissant sur les volumes physiques commencent par <em>pv</em> (pour <em>physical volume</em>);</div>
</li>
<li class="level1"><div class="li"> toutes les commandes agissant sur les groupes de volumes commencent par <em>vg</em> (pour <em>volumes group</em>);</div>
</li>
<li class="level1"><div class="li"> toutes les commandes agissant sur les volumes logiques commencent par <em>lv</em> (pour <em>logical volume</em>).</div>
</li>
</ul>

<p>
La première chose à faire est de créer <strong>un volume physique</strong>, en attribuant une partition à LVM.
</p>

<p>
Essayez la commande suivante pour connaître la liste des commandes disponibles pour les volumes physiques :
</p>
<pre class="code">man -k pv</pre>

<p>
Parmi toutes les commandes renvoyées, on remarque une « pvcreate », ça doit être celle-là… <img src="/lib/images/smileys/icon_wink.gif" class="icon" alt=";-)" /> Cette astuce fonctionne avec toutes les commandes LVM et permet de les retrouver facilement.
</p>
<pre class="code">pvchange (8)         - change attributes of a physical volume
pvck (8)             - check physical volume metadata
pvcreate (8)         - initialize a disk or partition for use by LVM
pvdisplay (8)        - display attributes of a physical volume
pvmove (8)           - move physical extents
pvremove (8)         - remove a physical volume
pvresize (8)         - resize a disk or partition in use by LVM2
pvs (8)              - report information about physical volumes
pvscan (8)           - scan all disks for physical volumes</pre>

<p>
Il faudra donc créer (plutôt initier) notre volume physique par la commande :
</p>
<pre class="code">pvcreate /dev/sdc1</pre>

<p>
Cela nous permettra de l&#039;utiliser dans notre groupe de volume
</p>

<p>
<em>Noter que la création d&#039;un volume physique avec un disque complet comme <code>/dev/sdc</code> n&#039;est pas recommandé : <a href="https://tldp.org/HOWTO/LVM-HOWTO/initdisks.html" class="urlextern" title="https://tldp.org/HOWTO/LVM-HOWTO/initdisks.html" rel="nofollow">https://tldp.org/HOWTO/LVM-HOWTO/initdisks.html</a></em>
</p>

</div>
<div class='secedit editbutton_section editbutton_12'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Création] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="creation" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="4668-6886" /><button type="submit" title="Création" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit13" id="groupe_de_volumes1">Groupe de volumes</h3>
<div class="level3">

<p>
Il existe de nombreuses options lors de la création d&#039;un groupe de volumes… Mais continuons de faire au plus simple. Le seul paramètre indispensable sera de lui donner un nom, nous utiliserons les valeurs par défaut pour tout le reste. Pour une raison que j&#039;expliquerai par la suite, donnons-lui un nom très court (2 ou 3 caractères). Par exemple : « mvg » pour « mon vg ».
</p>

<p>
Pour connaitre la syntaxe de la commande <em>vgcreate</em> (comme pour toutes les autres commandes LVM), tapez simplement son nom :
</p>
<pre class="code">vgcreate</pre>

<p>
La syntaxe est donc :
</p>
<pre class="code">vgcreate VolumeGroupName PhysicalVolume [optionnellement d&#039;autres PhysicalVolume]</pre>

<p>
Allons-y :
</p>
<pre class="code">vgcreate mvg /dev/sdc1</pre>

<p>
Si tout se passe bien, vous avez maintenant un groupe de volumes, contenant un disque physique. Vous pouvez obtenir d&#039;autres informations sur ce groupe de volumes en tapant <em>vgdisplay</em>:
</p>
<pre class="code">vgdisplay
--- Volume group ---
VG Name               mvg
System ID             
Format                lvm2
Metadata Areas        1
Metadata Sequence No  3
VG Access             read/write
VG Status             resizable
MAX LV                0
Cur LV                2
Open LV               0
Max PV                0
Cur PV                1
Act PV                1
VG Size               186,31 GiB
PE Size               4,00 MiB
Total PE              47695
Alloc PE / Size       15360 / 60,00 GiB
Free  PE / Size       32335 / 126,31 GiB
VG UUID               BaTuai-1I8o-3rkY-Ut1r-ybta-mJnl-9X0oNZ</pre>

</div>
<div class='secedit editbutton_section editbutton_13'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Groupe de volumes] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="groupe_de_volumes1" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="6887-8418" /><button type="submit" title="Groupe de volumes" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit14" id="volume_logique1">Volume logique</h3>
<div class="level3">

<p>
Nous y voilà… Cette fois-ci, nous allons vraiment créer deux espaces que l&#039;on pourra ensuite « formater » en <em>ext4</em> par exemple.
</p>

<p>
Comme précédemment, le plus simple est de commencer par jeter un œil sur la syntaxe de la commande :
</p>
<pre class="code">lvcreate</pre>

<p>
Les deux options vraiment importantes sont « -n » pour son nom, et « -L » pour sa taille. Le paramètre principal est « OriginalLogicalVolume ». Il s&#039;agit peut-être d&#039;une erreur dans le manuel (<em>man</em>). En fait, ce qu&#039;il faut indiquer, c&#039;est bien le groupe de volumes dans lequel nous allons créer le volume logique. Pour l&#039;exemple présent, je fais ici deux volumes, 10 Gio et 50 Gio :
</p>
<pre class="code">lvcreate -n Vol1 -L 10g mvg
lvcreate -n Vol2 -L 50g mvg</pre>

<p>
Idem, on peut vérifier avec la commande <em>lvdisplay</em>:
</p>
<pre class="code">~# lvdisplay
--- Logical volume ---
LV Name                /dev/mvg/Vol1
VG Name                mvg
LV UUID                q0D6cQ-mcMP-q8sf-XTlI-DdxX-QHd1-qkaB5J
LV Write Access        read/write
LV Status              available
# open                 0
LV Size                10,00 GiB
Current LE             2560
Segments               1
Allocation             inherit
Read ahead sectors     auto
- currently set to     256
Block device           252:0
 
--- Logical volume ---
LV Name                /dev/mvg/Vol2
VG Name                mvg
LV UUID                JZjMxI-cTAw-cbs6-02BM-4Mev-P2E7-b8JX0x
LV Write Access        read/write
LV Status              available
# open                 0
LV Size                50,00 GiB
Current LE             12800
Segments               1
Allocation             inherit
Read ahead sectors     auto
- currently set to     256
Block device           252:1</pre>

</div>
<div class='secedit editbutton_section editbutton_14'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Volume logique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="volume_logique1" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="8419-10176" /><button type="submit" title="Volume logique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit15" id="systeme_de_fichiers">Système de fichiers</h3>
<div class="level3">

<p>
Avec les partitions, on avait des noms ressemblant à <code>/dev/sda3</code>, etc. Avec LVM, on utilise aussi des périphériques dans <code>/dev</code>, mais le chemin est de la forme <code>/dev/nom_du_vg/nom_du_lv</code>.
Autrement dit, puisqu&#039;on a décidé d&#039;appeler nos volumes logiques &quot;Vol1&quot; et &quot;Vol2&quot;, les noms de ces périphériques de ce volume logique sont &quot;/dev/mvg/Vol1&quot; et &quot;/dev/mvg/Vol2&quot;.
À partir de maintenant, <code>/dev/mvg/Volx</code> peut être utilisé dans toutes les situations et avec toutes les commandes qui attendent quelque chose de la forme <code>/dev/…</code> Par exemple :
</p>
<pre class="code">mkfs -t ext4 /dev/mvg/Vol1
mkfs -t ext4 /dev/mvg/Vol2
mkdir /Essai1
mount /dev/mvg/Vol1 /Essai1
df -h</pre>

<p>
Et normalement, <code>/dev/mvg/Vol1</code> devrait être monté sur <code>/Essai</code>. Regardez bien la ligne correspondante. Si on avait choisi un nom de VG ou de LV plus long, la sortie de <em>df</em> aurait été modifiée, car le nom aurait « touché » les valeurs… On aurait été obligé de passer des lignes et l&#039;affichage aurait été plus difficile à lire. Techniquement, choisir des noms « longs » pour les VG et les LV ne pose aucun problème, mais c&#039;est l&#039;affichage qui sera parfois délicat. Pour cette raison uniquement, je préconise de se limiter à 7 caractères au total (donc par exemple 3 pour le VG et 4 pour le LV, ou 2 et 5, comme vous voulez).
</p>
<blockquote><div class="no">
 Pourquoi est-il écrit <code>/dev/mapper/mvg-Vol1</code> et non <code>/dev/mvg/Vol1</code> ?</div></blockquote>

<p>
Avec LVM en version 1, c&#039;est bien <code>/dev/mvg/Vol1</code> qui aurait été affiché. Depuis la version 2, LVM utilise le périphérique <em>mapper</em>, ce qui permet pas mal de choses (comme chiffrer les volumes logiques, etc.). Pour simplifier, disons que ces deux notations « /dev/mvg/Vol1 » et « /dev/mapper/mvg-Vol1 » sont synonymes. Dans la pratique, il est conseillé quand même d&#039;utiliser plutôt la forme « /dev/mvg/Vol1 », certaines commandes ne passeront pas autrement.
</p>

</div>
<div class='secedit editbutton_section editbutton_15'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Système de fichiers] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="systeme_de_fichiers" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="10177-12097" /><button type="submit" title="Système de fichiers" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit16 page-header" id="suppression">Suppression</h2>
<div class="level2">

<p>
Rien de plus simple :
</p>
<pre class="code">umount /Essai1  # si le volume Vol1 est monté en /Essai1
lvremove /dev/mvg/Vol1</pre>

<p>
<img src="/lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" /> Attention, une fois un volume logique effacé, il est <strong>totalement impossible</strong> de récupérer les données qu&#039;il contenait.
</p>

</div>
<div class='secedit editbutton_section editbutton_16'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Suppression] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="suppression" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="12098-12363" /><button type="submit" title="Suppression" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit17 page-header" id="redimensionnement">Redimensionnement</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_17'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Redimensionnement] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="redimensionnement" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="12364-12396" /><button type="submit" title="Redimensionnement" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit18" id="volume_physique1">Volume physique</h3>
<div class="level3">

</div>

<h4 id="agrandissement">Agrandissement</h4>
<div class="level4">

<p>
Imaginons maintenant que notre groupe de volume (mvg) n&#039;ait plus suffisamment d&#039;espace libre. On souhaite donc lui rajouter un volume physique afin de rajouter de l&#039;espace libre. Ça tombe bien, on dispose d&#039;un volume physique sdc2 que l&#039;on va pouvoir ajouter à mvg :
</p>

<p>
On initialise le volume en vue de son utilisation dans LVM :
</p>
<pre class="code">pvcreate /dev/sdc2</pre>

<p>
On rajoute le volume sdc2 au groupe de volume mvg :
</p>
<pre class="code">vgextend mvg /dev/sdc2</pre>

</div>

<h4 id="retrecissement">Rétrécissement</h4>
<div class="level4">

<p>
Imaginons maintenant que la partition Boot soit devenue trop petite et que tout le reste du disque qui contient cette partition soit défini comme une partition  utilisée en LVM (/dev/sda2 dans l&#039;exemple). Il sera alors nécessaire de diminuer l&#039;espace  physique de ce groupe de volume (mvg).
</p>

<p>
En premier, il est nécessaire de rétrécir le ou les LVM qui sont définis dans ce volume-groupe. Voir ci-après.
</p>

<p>
Puis il faut rétrécir l&#039;enveloppe physique. Normalement c&#039;est sans risque: Les commandes sont refusées si la demande est trop agressive.
</p>

<p>
Commençons par vérifier l&#039;implantation physique des données dans la partition. Le but est de vérifier que la fin de la partition n&#039;est pas utilisée. 
</p>
<pre class="code bash"><span class="kw2">sudo</span> pvs <span class="re5">-v</span> <span class="re5">--segments</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sda2</pre>

<p>
 La dernière ligne de la réponse indique si la fin de la partition est libre  ou non.
Si la fin de la partition n&#039;a pas suffisamment d&#039;espace libre, il est possible de procéder a une réorganisation physique.
</p>
<pre class="code bash"><span class="kw2">sudo</span> pvmove <span class="re5">--alloc</span> anywhere <span class="sy0">/</span>dev<span class="sy0">/</span>sda2:<span class="nu0">88888888</span>-<span class="nu0">9999999999</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sda2:<span class="nu0">0</span>-<span class="nu0">88888887</span></pre>

<p>
 (les valeurs 88888887 et 88888888 sont à adapter en fonction de la réponse précédente notamment la quantité d&#039;espace libre en début de partition. 
Lancer alors l&#039;<a href="/gparted" class="wikilink1" title="gparted">éditeur de partitions</a> . Indiquer alors la nouvelle taille de la partition. Le minima possible est exprimé en MiO et obtenu par la formule 88888888*4
</p>

</div>
<div class='secedit editbutton_section editbutton_18'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Volume physique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="volume_physique1" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="12397-14308" /><button type="submit" title="Volume physique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit19" id="volume_logique2">Volume logique</h3>
<div class="level3">

<p>
Il est très facile d&#039;augmenter ou de diminuer la taille d&#039;un volume logique. Mais attention, la taille d&#039;un LV n&#039;a pas de lien direct avec la taille de ce qu&#039;il contient (<em>swap</em> ou système de fichier). Le LV est une boîte, le système de fichier est le contenu de la boîte. Augmenter la taille de la boîte sans augmenter la taille du contenu ne pose pas de problème, mais l&#039;inverse…
</p>

</div>

<h4 id="agrandissement1">Agrandissement</h4>
<div class="level4">

<p>
Bien qu&#039;il soit évidemment moins risqué d&#039;agrandir ou de diminuer la taille d&#039;un système de fichiers après l&#039;avoir démonté, la plupart des formats (ext3, reisersfs, ext4…) supportent désormais cette modification &quot;à chaud&quot; (avec des données qui restent donc accessibles en lecture/écriture durant toute l&#039;opération).
</p>

<p>
Pour agrandir un volume il est nécessaire de démonter le système de fichier, ici, prenons celui du volume logique Vol2 :
</p>
<pre class="code">umount /Essai2</pre>

<p>
Maintenant nous allons ajouter 5Gio au volume et agrandir son système de fichier :
</p>
<pre class="code">lvresize --resizefs --size +5G /dev/mvg/Vol2</pre>
<div class="noteimportant">Le paramètre <code>–resizefs</code> ne fonctionne pas avec tous les systèmes de fichiers (voir <a href="http://linux.die.net/man/8/fsadm" class="urlextern" title="http://linux.die.net/man/8/fsadm" rel="nofollow">ici</a>).
</div>
<p>
Une fois l&#039;opération terminée, le volume une fois monté a gagné 5Gio.
</p>

<p>
Il est également possible d&#039;augmenter la taille du volume logique à l&#039;ensemble de l&#039;espace libre disponible sur le support en utilisant <strong>lvextend -l +100%FREE</strong>.
</p>
<pre class="code">usr@pc:~$ lvextend -l +100%FREE /dev/mvg/Vol2</pre>

</div>

<h4 id="retrecissement1">Rétrécissement</h4>
<div class="level4">

<p>
Diminuer la taille d&#039;un système de fichier est un peu plus délicat. En effet, il faut dans un premier temps s&#039;assurer de pouvoir réduire d&#039;autant qu&#039;on le souhaite.
</p>
<div class="noteimportant">Tous les systèmes de fichiers ne supportent pas d&#039;être redimensionnés (voir <a href="http://linux.die.net/man/8/fsadm" class="urlextern" title="http://linux.die.net/man/8/fsadm" rel="nofollow">ici</a>)
</div>
<p>
Voyons d&#039;abord l&#039;espace du système de fichier :
</p>
<pre class="code">df -h -BM | grep ca
/dev/mapper/svg-ca    512M  230M  283M  45% /home/ca</pre>

<p>
Les valeurs qui nous intéressent sont la deuxième et la quatrième, à savoir :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> 512Mio d&#039;espace total</div>
</li>
<li class="level1"><div class="li"> 283Mio d&#039;espace libre</div>
</li>
</ul>

<p>
L&#039;espace disque étant de 283Mio, nous pouvons réduire l&#039;espace de 256Mio et c&#039;est ce que nous allons faire.
</p>

<p>
Commençons par démonter le volume :
</p>
<pre class="code">umount /dev/mapper/svg-ca</pre>

<p>
Maintenant, nous allons retirer 256Mio :
</p>
<pre class="code">lvresize --resizefs --size -256M /dev/mapper/svg-ca</pre>
<div class="notetip">Si la partition n&#039;est pas démontée, la commande propose de la démonter et s&#039;occupera de la remonter une fois le redimensionnement terminé.
</div>
<p>
Le volume peut maintenant être monté :
</p>
<pre class="code">mount /dev/mapper/svg-ca /home/ca</pre>

<p>
Et on peut alors afficher sa nouvelle taille :
</p>
<pre class="code">df -h -BM| grep ca
/dev/mapper/svg-ca    256M  230M   27M  90% /home/ca</pre>
<div class="notewarning">Attention: Il est possible que le rétrécissement soit refusé suite à une dé-organisation qui se fait  pendant la vie du LVM car la demande est trop importante. Dans cas, voici la démarche à effectuer:<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li">    Démonter le volume <pre class="code bash"> <span class="kw2">sudo</span> <span class="kw2">umount</span> <span class="sy0">/</span>dev<span class="sy0">/</span>mapper<span class="sy0">/</span>svg-ca </pre>
</div>
</li>
<li class="level1"><div class="li">    Contrôler la qualité du volume <pre class="code bash"> <span class="kw2">sudo</span> e2fsck <span class="re5">-f</span> <span class="sy0">/</span>dev<span class="sy0">/</span>mapper<span class="sy0">/</span>svg-ca </pre>
</div>
</li>
<li class="level1"><div class="li">    Demander l&#039;espace réel minima nécessaire <pre class="code bash"> <span class="kw2">sudo</span> resize2fs <span class="re5">-PM</span> <span class="sy0">/</span>dev<span class="sy0">/</span>mapper<span class="sy0">/</span>svg-ca </pre>
</div>
</li>
<li class="level1"><div class="li">    Rétrécir à la taille minima indiquée. Mettre la valeur retournée par la commande précédente (ou une valeur plus importante) à la place de la valeur 123456789 de cette commande <pre class="code bash"> <span class="kw2">sudo</span> lvresize <span class="re5">--resizefs</span> <span class="re5">--size</span> $<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="nu0">123456789</span><span class="sy0">/</span><span class="nu0">256</span>+<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>M  <span class="sy0">/</span>dev<span class="sy0">/</span>mapper<span class="sy0">/</span>svg-ca </pre>
</div>
</li>
<li class="level1"><div class="li"> Remonter le volume  <pre class="code bash"><span class="kw2">mount</span> <span class="sy0">/</span>dev<span class="sy0">/</span>mapper<span class="sy0">/</span>svg-ca <span class="sy0">/</span>home<span class="sy0">/</span>ca</pre>
</div>
</li>
</ol>



</div>
</div>
<div class='secedit editbutton_section editbutton_19'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Volume logique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="volume_logique2" /><input type="hidden" name="codeblockOffset" value="4" /><input type="hidden" name="range" value="14309-17931" /><button type="submit" title="Volume logique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit20 page-header" id="snapshot">Snapshot</h2>
<div class="level2">

<p>
<em class="u">Comprendre la magie du Snapshot LVM :</em>
</p>

<p>
<em>Pourquoi donner une taille au snapshot ? Tout simplement parce que celui-ci est intelligent, donc il ne va pas copier l&#039;intégralité du LV original. Au contraire, il ne va stocker que les différences. C&#039;est pourquoi il est instantané et commence avec une occupation taille nulle. La commande lvdisplay permet de voir l&#039;évolution de la taille.</em>
</p>

<p>
<strong>Avec LVM 1</strong>, les instantanés sont en lecture seule. Ils fonctionnent par l&#039;utilisation d&#039;une table d&#039;exception qui trace les blocs modifiés : lorsqu&#039;un bloc est modifié sur la source, il est d&#039;abord copié dans l&#039;instantané, marqué comme modifié dans la table d&#039;exceptions et ensuite modifié sur le volume source avec les nouvelles données.
</p>

<p>
<strong>Avec LVM 2</strong>, les instantanés sont par défaut en lecture/écriture. Le fonctionnement est similaire aux instantanés en lecture seule avec la possibilité supplémentaire d&#039;écrire sur l&#039;instantané : le bloc est alors marqué comme utilisé dans la table d&#039;exceptions et ne sera plus récupéré du volume source. Cela ouvre de nouvelles perspectives par rapport au fonctionnement en lecture seule de LVM 1. Par exemple, on peut faire l&#039;instantané d&#039;un volume, le monter et tester un programme expérimental qui modifie les fichiers dessus. Si le résultat n&#039;est pas satisfaisant, on peut le démonter, le supprimer et remonter le système de fichiers originel à la place. C&#039;est aussi utile pour créer des volumes utilisés avec Xen. Vous pouvez créer une image disque et en faire un instantané que vous pourrez modifier avec une instance spécifique de domU. Vous pourrez ensuite créer un autre instantané de l&#039;image originale et le modifier avec une autre instance de domU. Comme les instantanés ne stockent que les blocs modifiés, la majeure partie du volume sera partagée entre les domUs.
</p>

<p>
Voir <a href="http://doc.ubuntu-fr.org/tutoriel/sauvegarder_a_chaud" class="urlextern" title="http://doc.ubuntu-fr.org/tutoriel/sauvegarder_a_chaud" rel="nofollow">ici</a> Pour sauvegarder son système à chaud avec LVM
</p>

</div>
<div class='secedit editbutton_section editbutton_20'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Snapshot] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="snapshot" /><input type="hidden" name="codeblockOffset" value="10" /><input type="hidden" name="range" value="17932-19926" /><button type="submit" title="Snapshot" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit21" id="creation_d_un_snapshot_lvm">Création d&#039;un snapshot LVM</h3>
<div class="level3">
<pre class="code">lvcreate -L 10g -s -n lv_test_20110617 /dev/vg_data/lv_test</pre>

<p>
Va créer un snapshot du LV &quot;<strong>lv_test</strong>&quot; à la taille de <strong>10Go</strong> qui va avoir comme nom &quot;<strong>lv_test_20110617</strong>&quot;.
Attention, la taille d&#039;utilisation du snapshot évolue avec l&#039;utilisation. Si ce snapshot se retrouve rempli à 100%, il devient alors inutilisable (état &quot;INACTIVE&quot;) mais pas d’inquiétude car il n&#039;y a pas d’impact pour le LV d&#039;origine. 
</p>

</div>
<div class='secedit editbutton_section editbutton_21'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Création d&#039;un snapshot LVM] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="creation_d_un_snapshot_lvm" /><input type="hidden" name="codeblockOffset" value="10" /><input type="hidden" name="range" value="19927-20396" /><button type="submit" title="Création d&#039;un snapshot LVM" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit22" id="redimensionnement_du_snapshot">Redimensionnement du snapshot</h3>
<div class="level3">

<p>
La taille du snapshot est trop petite et elle arrive bientôt à 100%, pourtant vous avez encore besoin d&#039;utiliser ce snap ? Il faut donc redimensionner !
Vérifier avec vgdisplay que le VG dispose encore d&#039;assez d&#039;espace libre (Free PE / Size) puis effectuer :
</p>
<pre class="code">lvresize -L +3GB /dev/vg_data/lv_test_20110617</pre>

<p>
Va ajouter <strong>3Go</strong> au snap <strong>lv_test_20110617</strong> qui est présent dans le VG <strong>vg_data</strong>.
</p>

</div>
<div class='secedit editbutton_section editbutton_22'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Redimensionnement du snapshot] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="redimensionnement_du_snapshot" /><input type="hidden" name="codeblockOffset" value="11" /><input type="hidden" name="range" value="20397-20847" /><button type="submit" title="Redimensionnement du snapshot" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit23" id="fusionner_un_snapshot">Fusionner un snapshot</h3>
<div class="level3">

<p>
Le but ici est de fusionner un snapshot modifié vers le LV d&#039;origine. Pour ainsi dire, &quot;faire que les modifications apportées sur le snapshot se retrouvent sur le LV d&#039;origine&quot;.
</p>
<pre class="code">lvconvert --merge /path/to/dev/snap</pre>

<p>
Attention : vous avez besoin d&#039;un kernel (&gt;=2.6.33)
</p>

</div>
<div class='secedit editbutton_section editbutton_23'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Fusionner un snapshot] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="fusionner_un_snapshot" /><input type="hidden" name="codeblockOffset" value="12" /><input type="hidden" name="range" value="20848-21161" /><button type="submit" title="Fusionner un snapshot" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit24 page-header" id="changement_d_un_disque_defectueux">Changement d&#039;un disque défectueux</h2>
<div class="level2">

<p>
Votre disque /dev/sda présente des signes de faiblesse (signalés par SMART, par la présence de nombreux fichiers dans les dossiers &quot;lost + found&quot; de vos partitions). Vous désirez le remplacer par un disque neuf, de taille plus importante (surtout pas plus petite !), que vous avez installé dans la machine (ou sur un port <abbr title="Universal Serial Bus">USB</abbr>) et qui est reconnu par le système comme étant /dev/sdb.
</p>

</div>
<div class='secedit editbutton_section editbutton_24'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Changement d&#039;un disque défectueux] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="changement_d_un_disque_defectueux" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="21162-21599" /><button type="submit" title="Changement d&#039;un disque défectueux" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit25" id="principe">Principe</h3>
<div class="level3">

<p>
Supposons que votre disque initial (/dev/sda) ait été formaté ainsi :
/dev/sda1 est une partition primaire, de type bootable, montée sur /boot.
/dev/sda2 est une partition étendue, contenant la partition logique /dev/sda5 de type lvm2.
</p>

<p>
Vous avez besoin de copier /dev/sda1 sur une partition /dev/sdb1, et /dev/sda5 sur une partition /dev/sdb5.
</p>

<p>
Vous allez utiliser l&#039;outil GParted pour préparer le disque /dev/sdb et copier la partition de boot. Gparted ne gérant pas lvm2, nous utiliserons la ligne de commande pour la copie de /dev/sda5.
</p>

</div>
<div class='secedit editbutton_section editbutton_25'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Principe] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="principe" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="21600-22168" /><button type="submit" title="Principe" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit26" id="avec_gparted">Avec GParted</h3>
<div class="level3">

<p>
Lancez Gparted (Système → Administration → Editeur de partitions GParted). 
Les partitions de votre disque /dev/sda s&#039;affichent. Notez la taille de /dev/sda1, ainsi que son filesystem (ext2/ext3/ext4). 
</p>

<p>
Passez au disque /dev/sdb. Créez-y une nouvelle partition primaire /dev/sdb1, de taille légèrement supérieure à celle de /dev/sda1. &quot;Appliquez&quot; pour que la création soit effective, puis modifiez (par clic droit) les drapeaux de /dev/sdb1 pour rendre cette partition bootable. Créez une partition étendue /dev/sdb2, occupant le reste du disque. Sur cette partition, créez une partition logique /dev/sdb5 non formatée. &quot;Appliquez&quot; pour que vos créations soient effectives.
</p>

<p>
Repassez au disque /dev/sda. Cliquez-droit sur /dev/sda1 et choisissez &quot;Démonter&quot; puis &quot;Copier&quot;. Repassez au disque /dev/sdb. Cliquez-droit sur /dev/sdb1 et choisissez &quot;Coller&quot; (ou &quot;Paste&quot;). &quot;Appliquez&quot; à nouveau. Fermez GParted.
</p>

</div>
<div class='secedit editbutton_section editbutton_26'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Avec GParted] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="avec_gparted" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="22169-23115" /><button type="submit" title="Avec GParted" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit27" id="en_ligne_de_commande">En ligne de commande</h3>
<div class="level3">

<p>
Remontez votre partition de boot : 
</p>
<pre class="code">sudo mount /boot</pre>

<p>
Faites un scan des volumes physiques de LVM :
</p>
<pre class="code">sudo pvscan 
  PV /dev/sda5   VG delphy   lvm2 [148,81 GiB / 4,87 GiB free]
  Total: 1 [148,81 GiB] / in use: 1 [148,81 GiB] / in no VG: 0 [0   ]</pre>

<p>
Cela signifie que le volume physique (PV) /dev/sda5 est inclus dans le groupe de volumes (VG) nommé ici delphy (bien sûr le vôtre porte un autre nom).
</p>

<p>
Déclarez /dev/sdb5 comme volume physique :
</p>
<pre class="code">sudo pvcreate /dev/sdb5
  Physical volume &quot;/dev/sdb5&quot; successfully created</pre>

<p>
Vérifiez qu&#039;il existe bien, mais n&#039;est pas encore attribué à un groupe de volumes :
</p>
<pre class="code">sudo pvscan 
  PV /dev/sda5   VG delphy          lvm2 [148,81 GiB / 4,87 GiB free]
  PV /dev/sdb5                      lvm2 [465,47 GiB]
  Total: 2 [614,28 GiB] / in use: 1 [148,81 GiB] / in no VG: 1 [465,47 GiB]</pre>

<p>
Attribuez /dev/sdb5 à votre groupe de volumes (ici delphy). Ce groupe de volumes est &quot;étendu&quot; à /dev/sdb5 :
</p>
<pre class="code">sudo vgextend delphy /dev/sdb5
  Volume group &quot;delphy&quot; successfully extended</pre>

<p>
Vérification :
</p>
<pre class="code">sudo pvscan 
  PV /dev/sda5   VG delphy   lvm2 [148,81 GiB / 4,87 GiB free]
  PV /dev/sdb5   VG delphy   lvm2 [465,46 GiB / 465,46 GiB free]
  Total: 2 [614,27 GiB] / in use: 2 [614,27 GiB] / in no VG: 0 [0   ]</pre>

<p>
Lancez enfin le déplacement des données, du volume physique /dev/sda5 vers le volume physique /dev/sdb5 :
</p>
<pre class="code">sudo pvmove /dev/sda5 /dev/sdb5
  /dev/sda5: Moved: 0,3%
  /dev/sda5: Moved: 0,7%
  /dev/sda5: Moved: 1,0%
  /dev/sda5: Moved: 1,3%
  ...  
  /dev/sda5: Moved: 99,8%
  /dev/sda5: Moved: 100,0%</pre>

<p>
Attention, l&#039;opération peut prendre du temps (plusieurs heures pour les grosses partitions), suivant la taille des données à transférer, la rapidité des disques, etc.
</p>

<p>
Vérifiez que le contenu de /dev/sda5 a bien été transféré sur /dev/sdb5 :
</p>
<pre class="code">sudo pvscan 
  PV /dev/sda5   VG delphy   lvm2 [148,81 GiB / 148,81 GiB free]
  PV /dev/sdb5   VG delphy   lvm2 [465,46 GiB / 321,53 GiB free]</pre>

<p>
En effet, la totalité de /dev/sda5 est libre, et /dev/sdb5 est occupée par les données transférées.
</p>

<p>
Supprimez /dev/sda5 du groupe de volumes delphy :
</p>
<pre class="code">sudo vgreduce delphy /dev/sda5
  Removed &quot;/dev/sda5&quot; from volume group &quot;delphy&quot;</pre>

<p>
Vérifiez :
</p>
<pre class="code">sudo pvscan 
  PV /dev/sdb5   VG delphy          lvm2 [465,46 GiB / 321,53 GiB free]
  PV /dev/sda5                      lvm2 [148,81 GiB]
  Total: 2 [614,28 GiB] / in use: 1 [465,46 GiB] / in no VG: 1 [148,81 GiB]</pre>

<p>
Enlevez le disque des volumes physiques :
</p>
<pre class="code">sudo pvremove /dev/sda5
  Labels on physical volume &quot;/dev/sda5&quot; successfully wiped</pre>

<p>
<strong>Vous pouvez désormais enlever le disque.</strong>
</p>

</div>
<div class='secedit editbutton_section editbutton_27'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[En ligne de commande] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="en_ligne_de_commande" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="23116-25790" /><button type="submit" title="En ligne de commande" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit28" id="finalisation">Finalisation</h3>
<div class="level3">

<p>
Réinstallez GRUB sur le MBR de votre disque dur :
</p>
<pre class="code">sudo grub-install /dev/sdb</pre>

<p>
Éteignez votre ordinateur, enlevez l&#039;ancien disque et remplacez-le par le nouveau, au niveau des branchements.
</p>

</div>
<div class='secedit editbutton_section editbutton_28'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Finalisation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="finalisation" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="25791-26009" /><button type="submit" title="Finalisation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit29 page-header" id="mieux_comprendre_ou_aller_plus_loin">Mieux comprendre ou aller plus loin</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_29'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Mieux comprendre ou aller plus loin] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="mieux_comprendre_ou_aller_plus_loin" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="26010-26058" /><button type="submit" title="Mieux comprendre ou aller plus loin" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit30" id="notion_d_extent">Notion d&#039;« extent »</h3>
<div class="level3">

<p>
Un <em>extent</em>, ou « <em>physical extent</em> » aussi appelé « PE », est un tout petit morceau d&#039;un groupe de volumes. En fait, au moment de la création d&#039;un groupe de volumes, le ou les disques sont découpés en morceaux de quelques Mio (4 Mio par défaut). Lorsqu&#039;on crée un volume logique, LVM va utiliser autant de PE que nécessaires. La taille d&#039;un volume logique sera donc toujours un multiple de la taille d&#039;un PE.
</p>

</div>
<div class='secedit editbutton_section editbutton_30'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Notion d&#039;« extent »] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="notion_d_extent" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="26059-26520" /><button type="submit" title="Notion d&#039;« extent »" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit31" id="glossaire">Glossaire</h3>
<div class="level3">
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<tr class="row0">
		<td class="col0">abréviation</td><td class="col1">anglais</td><td class="col2">français</td><td class="col3">description</td>
	</tr>
	<tr class="row1">
		<td class="col0">VG</td><td class="col1"><strong>V</strong>olume <strong>G</strong>roup </td><td class="col2"><strong>G</strong>roupe de <strong>V</strong>olumes </td><td class="col3"> </td>
	</tr>
	<tr class="row2">
		<td class="col0">LV</td><td class="col1"><strong>L</strong>ogical <strong>V</strong>olume</td><td class="col2"><strong>V</strong>olume <strong>L</strong>ogique</td><td class="col3"> une &quot;partition&quot; dans un groupe de volumes </td>
	</tr>
	<tr class="row3">
		<td class="col0">PV</td><td class="col1"><strong>P</strong>hysical <strong>V</strong>olume</td><td class="col2"><strong>V</strong>olume <strong>P</strong>hysique</td><td class="col3"> </td>
	</tr>
	<tr class="row4">
		<td class="col0">PE</td><td class="col1"><strong>P</strong>hysical <strong>E</strong>xtent</td><td class="col2"> <strong>E</strong>tendue <strong>P</strong>hysique</td><td class="col3">un tout petit morceau d&#039;un groupe de volumes </td>
	</tr>
</table></div>

</div>
<div class='secedit editbutton_section editbutton_31'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Glossaire] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="glossaire" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="26521-26894" /><button type="submit" title="Glossaire" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit33" id="lvm_et_raid">LVM et RAID</h3>
<div class="level3">

<p>
Il est tout à fait possible d&#039;utiliser LVM sur un volume en RAID logiciel. Une fois que le RAID a été créé (<code>/dev/md0</code> par exemple), il suffit de le donner à LVM, avec la commande habituelle :
</p>
<pre class="code">pvcreate /dev/md0</pre>

<p>
Bien qu&#039;il soit possible de partitionner le raid <code>/dev/md0</code> comme n&#039;importe quel disque ordinaire (ce qui permet d&#039;obtenir des devices de la forme /dev/md0p1, /dev/md0p2 etc), je vous le déconseille vivement. En effet le but est bien d&#039;utiliser LVM pour découper l&#039;espace, et plus l&#039;ancienne notion de partition physique. De plus, l&#039;utilisation de ces partitions nécessiterait des changements dans la configuration de LVM (filter dans /etc/lvm/lvm.conf). Bref, C&#039;est se donner du mal pour pas grand chose.
</p>

<p>
Donc comme le montre la commande plus haut, le mieux est de donner l&#039;intégralité du RAID. Un exemple de création de RAID est donné sur la <a href="/raid_logiciel" class="wikilink1" title="raid_logiciel">page raid logiciel</a>.
</p>

<p>
Vous pouvez aussi aller voir le tutoriel <a href="/tutoriel/installation_raid_lvm" class="wikilink1" title="tutoriel:installation_raid_lvm">installation_raid_lvm</a>
</p>

</div>
<div class='secedit editbutton_section editbutton_33'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[LVM et RAID] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="lvm_et_raid" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="26895-27910" /><button type="submit" title="LVM et RAID" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit34" id="lvm_miroir">LVM miroir</h3>
<div class="level3">

<p>
Convertir un LVM en miroir
</p>
<pre class="code">lvconvert -m 1 Volume_Group/Logical_Volume /dev/sdx1 /dev/sdy1</pre>

<p>
ou /dev/sdx1 est la partition LVM miroir à ajouter et /dev/sdy1 est la partition LVM de journalisation du miroir
</p>

<p>
Voir l&#039;état du miroir
</p>
<pre class="code">lvs -a -o +devices</pre>
<pre class="code">LV                          VG                   Attr  LSize    Origin Snap%  Move Log                   Copy%    Convert Devices                          
Logical_Volume              Volume_Group mwi-a-        465.00g                     Logical_Volume_mlog   1.56             Home_mimage_0(0),Home_mimage_1(0)
[Logical_Volume_mimage_0]   Volume_Group Iwi-ao        465.00g                                                            /dev/sdw1(0)                     
[Logical_Volume_mimage_1]   Volume_Group Iwi-ao        465.00g                                                            /dev/sdx1(0)                     
[Logical_Volume_mlog]       Volume_Group lwi-ao        4.00m                                                              /dev/sdy1(0)</pre>

</div>
<div class='secedit editbutton_section editbutton_34'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[LVM miroir] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="lvm_miroir" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="27911-28954" /><button type="submit" title="LVM miroir" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit35" id="interface_graphique_pour_lvm">Interface graphique pour LVM</h3>
<div class="level3">

<p>
Il existe une interface graphique pour LVM, qui permet de manipuler les volumes logiques : system-config-lvm. (disponible dans les dépôts de la 11.04).  Cette interface n&#039;est pas disponible avec la version<a href="https://launchpad.net/ubuntu/+source/system-config-lvm" class="urlextern" title="https://launchpad.net/ubuntu/+source/system-config-lvm" rel="nofollow"> 18.04</a>
</p>

<p>
Attention néanmoins, celle-ci applique DIRECTEMENT les changements, vérifiez donc bien ce que vous faites, ainsi que le disque sur lequel vous appliquez vos modifications, sans quoi vous risquez de perdre irrémédiablement vos données.
</p>

</div>
<div class='secedit editbutton_section editbutton_35'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Interface graphique pour LVM] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="interface_graphique_pour_lvm" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="28955-29509" /><button type="submit" title="Interface graphique pour LVM" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit36" id="monter_une_partition">Monter une partition</h3>
<div class="level3">

</div>

<h4 id="obtenir_la_liste_des_groupes_logiques">Obtenir la liste des groupes logiques</h4>
<div class="level4">
<pre class="code">lvm vgscan</pre>

</div>

<h4 id="obtenir_la_liste_des_partitions">Obtenir la liste des partitions</h4>
<div class="level4">
<pre class="code">lvm lvs</pre>

</div>

<h4 id="rendre_la_partition_disponible">Rendre la partition disponible</h4>
<div class="level4">
<pre class="code">lvm lvchange -ay /dev/VolGroup01/LogVol00</pre>

</div>

<h4 id="monter_la_partition">Monter la partition</h4>
<div class="level4">
<pre class="code">mount /dev/VolGroup01/LogVol00 /media/user/point_de_montage</pre>

</div>

<h4 id="exemple">Exemple</h4>
<div class="level4">
<pre class="code">user@ubuntu:~$ sudo lvm vgscan
  Reading all physical volumes. This may take a while...
  Found volume group &quot;Groupe_lvm&quot; using metadata type lvm2
user@ubuntu:~$ sudo lvm lvs
  LV      VG                 Attr          LSize          Pool Origin Data% Move Log Copy% Convert
  home Groupe_lvm   -wi-ao---  500.00g
  root   Groupe_lvm   -wi-a----    20.00g
  swap Groupe_lvm   -wi-a----     4.00g

user@ubuntu:~$ sudo lvm lvchange -ay /dev/Groupe_lvm/home
user@ubuntu:~$ sudo mkdir /media/user/montage
user@ubuntu:~$ sudo mount /dev/Groupe_lvm /home /media/user/montage</pre>

</div>
<div class='secedit editbutton_section editbutton_36'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Monter une partition] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="monter_une_partition" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="29510-30478" /><button type="submit" title="Monter une partition" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit37" id="verifier_une_partition">Vérifier une partition</h3>
<div class="level3">

</div>

<h4 id="rendre_la_partition_disponible1">Rendre la partition disponible</h4>
<div class="level4">
<pre class="code">lvm lvchange -ay /dev/VolGroup01/LogVol00</pre>

</div>

<h4 id="lancer_fsck">Lancer fsck</h4>
<div class="level4">
<pre class="code">sudo fsck -f -y /dev/VolGroup01/LogVol00</pre>

</div>
<div class='secedit editbutton_section editbutton_37'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Vérifier une partition] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="verifier_une_partition" /><input type="hidden" name="codeblockOffset" value="18" /><input type="hidden" name="range" value="30479-30684" /><button type="submit" title="Vérifier une partition" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit38" id="references">Références</h3>
<div class="level3">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <a href="http://hoper.dnsalias.net/tdc/index.php?pages/Documentation-LVM" class="urlextern" title="http://hoper.dnsalias.net/tdc/index.php?pages/Documentation-LVM" rel="nofollow">l&#039;origine de cette page </a> par <a href="/utilisateurs/hoper" class="wikilink1" title="utilisateurs:hoper">Hoper</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.lea-linux.org/documentations/index.php/Leapro-pro_sys-lvm" class="urlextern" title="http://www.lea-linux.org/documentations/index.php/Leapro-pro_sys-lvm" rel="nofollow">Article de Léa Linux</a> un peu vieux (LVM 1) mais plus complet que le mien…</div>
</li>
<li class="level1"><div class="li"> <a href="http://linux.developpez.com/lvm/#L4.1.1" class="urlextern" title="http://linux.developpez.com/lvm/#L4.1.1" rel="nofollow">Article de developpez.com</a> excellent aussi (attention, sauf la partie réduction !)</div>
</li>
<li class="level1"><div class="li"> <a href="http://tldp.org/HOWTO/LVM-HOWTO/" class="urlextern" title="http://tldp.org/HOWTO/LVM-HOWTO/" rel="nofollow">LVM HOW TO (en)</a> un how to assez complet en anglais</div>
</li>
<li class="level1"><div class="li"> <a href="http://www.traduc.org/Guides_pratiques/Suivi/LVM-HOWTO/Document" class="urlextern" title="http://www.traduc.org/Guides_pratiques/Suivi/LVM-HOWTO/Document" rel="nofollow"> Guide pratique de LVM (fr)</a> un guide assez complet en français</div>
</li>
<li class="level1"><div class="li"> <a href="http://www.korben.info/comment-chiffrer-une-partition-systeme-linux-ici-ubuntu.html#comment-164907" class="urlextern" title="http://www.korben.info/comment-chiffrer-une-partition-systeme-linux-ici-ubuntu.html#comment-164907" rel="nofollow">Comment chiffrer une partition système Linux</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.it-connect.fr/gestion-des-lvm-sous-linux/" class="urlextern" title="http://www.it-connect.fr/gestion-des-lvm-sous-linux/" rel="nofollow">Gestion des LVM sous Linux</a> sur IT-Connect.fr</div>
</li>
<li class="level1"><div class="li"> <a href="https://doc.ubuntu-fr.org/lvm_tutorial_install" class="urlextern" title="https://doc.ubuntu-fr.org/lvm_tutorial_install" rel="nofollow">Mise en place LVM tout simplement</a> </div>
</li>
</ul>
<hr />

<p>
<em>Contributeurs : Koshie-2.0, <a href="/utilisateurs/claudiux" class="wikilink1" title="utilisateurs:claudiux">claudiux</a> (remplacement disque défectueux), Alexandre LG ; merci à <a href="/utilisateurs/ner0lph" class="wikilink1" title="utilisateurs:ner0lph">Ner0lph</a> et à tous les autres correcteurs :)</em>
</p>

</div>
<div class='secedit editbutton_section editbutton_38'><form class="button btn_secedit form-inline" method="post" action="/lvm"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1632232922" /><input type="hidden" name="summary" value="[Références] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="references" /><input type="hidden" name="codeblockOffset" value="20" /><input type="hidden" name="range" value="30685-" /><button type="submit" title="Références" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="lvm.txt">lvm.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 21/09/2021, 16:02">Le 21/09/2021, 16:02</span></li><li class="text-muted">par 86.215.34.61</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=lvm&amp;1635556900" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
