<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>tutoriel:comment_utiliser_mplayer_en_esclave [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="mplayer,tutoriel"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns=tutoriel"/>
<link rel="edit" title="Modifier cette page" href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/tutoriel/comment_utiliser_mplayer_en_esclave"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/tutoriel/comment_utiliser_mplayer_en_esclave"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/tutoriel/comment_utiliser_mplayer_en_esclave"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='tutoriel';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"tutoriel:comment_utiliser_mplayer_en_esclave","namespace":"tutoriel","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="tutoriel:comment_utiliser_mplayer_en_esclave">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=media&amp;ns=tutoriel"  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">tutoriel:comment_utiliser_mplayer_en_esclave</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/tutoriel/comment_utiliser_mplayer_en_esclave?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#introduction","title":"Introduction","level":1},{"link":"#prerequis","title":"Pr\u00e9requis","level":1},{"link":"#let_s_go","title":"Let's go ?","level":1},{"link":"#trouver_la_commande","title":"Trouver la commande","level":2},{"link":"#utiliser_la_commande","title":"Utiliser la commande","level":2},{"link":"#mise_en_pratique","title":"Mise en pratique","level":1},{"link":"#aller_plus_loin","title":"Aller plus loin","level":1},{"link":"#infos_utiles","title":"Infos utiles","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#introduction">Introduction</a></li>
<li class="level1"><a href="#prerequis">Prérequis</a></li>
<li class="level1"><a href="#let_s_go">Let&#039;s go ?</a>
<ul class="nav toc">
<li class="level2"><a href="#trouver_la_commande">Trouver la commande</a></li>
<li class="level2"><a href="#utiliser_la_commande">Utiliser la commande</a></li>
</ul>
</li>
<li class="level1"><a href="#mise_en_pratique">Mise en pratique</a></li>
<li class="level1"><a href="#aller_plus_loin">Aller plus loin</a></li>
<li class="level1"><a href="#infos_utiles">Infos utiles</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/mplayer" class="wikilink1" title="mplayer" rel="tag">mplayer</a>,
	<a href="/tutoriel" class="wikilink1" title="tutoriel" rel="tag">tutoriel</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="comment_utiliser_mplayer_en_esclave">Comment utiliser Mplayer en esclave ?</h1>
<div class="level1">

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/comment_utiliser_mplayer_en_esclave"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1458756996" /><input type="hidden" name="summary" value="[Comment utiliser Mplayer en esclave ?] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="comment_utiliser_mplayer_en_esclave" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="33-85" /><button type="submit" title="Comment utiliser Mplayer en esclave ?" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="introduction">Introduction</h2>
<div class="level2">

<p>
<a href="/mplayer" class="wikilink1" title="mplayer">Mplayer</a> est un puissant logiciel de lecture de vidéos et de musique. Ce tutoriel explique comment l&#039;utiliser en tant qu&#039;esclave, autant pour la musique que pour la vidéo. Cette technique permet de se passer d&#039;une <a href="https://fr.wikipedia.org/wiki/Environnement_de_bureau" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Environnement_de_bureau">interface graphique</a> et ainsi d&#039;économiser de la mémoire vive et de la place à l&#039;écran. De plus, cette option permet un contrôle du lecteur via de simples <a href="/tutoriel/script_shell" class="wikilink1" title="tutoriel:script_shell">scripts shell</a>.
</p>

<p>
Cette méthode est plutôt déconseillée aux adeptes de solutions «usine à gaz», qui préféreront alors une interface graphique complète, il existe de nombreux <a href="/lecteur_audio" class="wikilink1" title="lecteur_audio">lecteurs de musique</a> et <a href="/lecture_et_encodage_de_fichiers_videos" class="wikilink1" title="lecture_et_encodage_de_fichiers_videos">lecteurs vidéos</a> de qualité.
</p>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/comment_utiliser_mplayer_en_esclave"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1458756996" /><input type="hidden" name="summary" value="[Introduction] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="introduction" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="86-849" /><button type="submit" title="Introduction" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit3 page-header" id="prerequis">Prérequis</h2>
<div class="level2">

<p>
Cette utilisation de mplayer est dite en tant que «backend», c&#039;est-à-dire que mplayer devient contrôlable par n&#039;importe quel programme ou script. C&#039;est cette deuxième solution qui va nous intéresser. Pour suivre ce tutoriel, il faudra donc de rapides connaissance sur les scripts shell. La lecture du man de mplayer permettra une meilleure compréhension de la suite.
</p>
<pre class="code">man mplayer
man bash</pre>

<p>
il faut aussi comprendre les notions de <a href="https://fr.wikipedia.org/wiki/Flux_standard" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Flux_standard">flux</a> et de redirection de flux.
</p>

<p>
Pour continuer le tutoriel, assurez-vous d&#039;avoir <a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installé le paquet</a> mplayer (<a href="apt://mplayer" class="urlextern" title="apt://mplayer" rel="nofollow">apt://mplayer</a>), <a href="https://fr.wikipedia.org/wiki/Tube_nommé" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Tube_nommé">mkfifo</a>. Munissez vous de votre <a href="/terminal" class="wikilink1" title="terminal">terminal</a> favori, d&#039;un peu de patience, et de courage.
</p>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/comment_utiliser_mplayer_en_esclave"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1458756996" /><input type="hidden" name="summary" value="[Prérequis] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="prerequis" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="850-1629" /><button type="submit" title="Prérequis" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit4 page-header" id="let_s_go">Let&#039;s go ?</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/comment_utiliser_mplayer_en_esclave"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1458756996" /><input type="hidden" name="summary" value="[Let&#039;s go ?] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="let_s_go" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="1630-1652" /><button type="submit" title="Let&#039;s go ?" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit5" id="trouver_la_commande">Trouver la commande</h3>
<div class="level3">

<p>
Tout d&#039;abord, il faut trouver la commande adéquate pour lancer mplayer. Le manuel nous informe qu&#039;il faut utiliser l&#039;argument -slave.
</p>
<pre class="code">Cette option enclenche le mode esclave. Ceci est prévu pour l’utilisation de MPlayer en tant que base (backend) pour d’autres programmes. Au lieu d’intercepter les événements clavier, MPlayer va lire ses commandes séparées par un retour chariot (\n) via l’entrée stdin.
NOTE : Voir −input cmdlist pour une liste des commandes esclaves, et DOCS/tech/slave.txt pour leur description.</pre>

<p>
Il faudra, comme indiqué aussi utiliser l&#039;argument -input file=&quot;chemin/vers/mon/fichier/de/controle&quot;. Cette fois-ci, je vous laisse lire le manuel :p. De même, pour plus de clarté, l&#039;argument -quiet sera passé, pour un <a href="https://fr.wikipedia.org/wiki/Flux_standard" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Flux_standard">stdout</a> plus «épuré». Voici ce que vous devriez obtenir après une petite torture mentale :p :
</p>
<pre class="code">mplayer -quiet -slave -input file=/tmp/music-control</pre>

<p>
NB : l&#039;argument -shuffle permet de rendre la playlist aléatoire ,-idle évite à mplayer de quitter si rien n&#039;est joué et -playlist permet de préloader une playlist. 
</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/comment_utiliser_mplayer_en_esclave"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1458756996" /><input type="hidden" name="summary" value="[Trouver la commande] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="trouver_la_commande" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="1653-2809" /><button type="submit" title="Trouver la commande" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit6" id="utiliser_la_commande">Utiliser la commande</h3>
<div class="level3">

<p>
Comme indiqué dans le man, cette commande implique l&#039;utilisation d&#039;un fifofile. C&#039;est à dire un «fichier» qui servira à rediriger ce qui rentre dans son stdin vers celui de mplayer. Ainsi, les commandes passées au fifofile seront transmises à mplayer, qui les exécutera. Pour obtenir une liste des commandes disponibles, c&#039;est :
</p>
<pre class="code">mplayer -input cmdlist</pre>

<p>
Le principe est donc simple, il suffit de passer des commandes à notre fifofile ce qui influencera le comportement de mplayer.
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/comment_utiliser_mplayer_en_esclave"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1458756996" /><input type="hidden" name="summary" value="[Utiliser la commande] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="utiliser_la_commande" /><input type="hidden" name="codeblockOffset" value="3" /><input type="hidden" name="range" value="2810-3340" /><button type="submit" title="Utiliser la commande" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit7 page-header" id="mise_en_pratique">Mise en pratique</h2>
<div class="level2">
<div class="notetip">Les chemins cités ci-dessous ne sont pas obligatoires, ils ne font qu&#039;office d&#039;exemple. Adaptez les en fonction en vos besoins et envies.
</div>
<p>
Nous allons tout d&#039;abord créer notre fichier fifofile. Pour cela, simplement exécuter la commande &quot;mkfifo&quot;.
</p>
<pre class="code">mkfifo /tmp/music-control</pre>

<p>
Ensuite, il faut lancer la commande de mplayer. Avoir un lecteur en background n&#039;a d’intérêt que s&#039;il est en background (tâche de fond, non dépendante d&#039;un terminal). Pour ce faire, ajouter un <a href="/projets/ecole/scripting/initiation_au_shell#presentation_de1" class="wikilink1" title="projets:ecole:scripting:initiation_au_shell">&amp;</a> en fin de ligne. 
</p>

<p>
Cependant, le stdout et le stderr nous intéressent, car ils permettent de récupérer le nom du titre joué, par exemple dans le cas d&#039;une chanson (cf fixme). Nous allons donc les rediriger vers deux fichiers distincts.
</p>
<pre class="code">mplayer -slave -input file=/tmp/music-control -shuffle -playlist ~/Musique/ma-playlist.m3u -idle &amp;&gt; ~/.mplayer/mplayer.log 2&gt; ~/.mplayer/mplayer-err.log</pre>

<p>
Pour contrôler mplayer, il suffit de rediriger le stdout d&#039;un echo vers le stdin du fifofile.
</p>
<pre class="code">echo &#039;macommande&#039; &gt; /tmp/music-control</pre>

<p>
Pour liste toutes les commandes, c&#039;est <code>mplayer -input cmdlist</code>. On notera &quot;seek&quot; pour se déplacer dans la chanson, &quot;volume&quot;, &quot;loadfile&quot; pour ouvrir un fichier, &quot;loadlist&quot; pour ouvrir une playlist. Pour plus d&#039;infos : <a href="http://www.mplayerhq.hu/DOCS/tech/slave.txt" class="urlextern" title="http://www.mplayerhq.hu/DOCS/tech/slave.txt" rel="nofollow">en</a>.
</p>

<p>
On peut récupérer des infos sur le média en cours de lecture en utilisant les commandes <code>get_xxx</code> de mplayer (la liste est donnée plus bas) :
</p>
<pre class="code">echo &#039;get_meta_title&#039; &gt; /tmp/music-control</pre>

<p>
Cela affichera la ligne suivante dans ~/.mplayer/mplayer.log
</p>
<pre class="code">ANS_META_TITLE=&#039;Le titre de la chanson&#039;</pre>

<p>
On peut donc filtrer la sortie de la manière suivante :
</p>
<pre class="code">tac ~/.mplayer/mplayer.log | grep &quot;ANS_META_TITLE=&#039;&quot; | cut -d &quot;&#039;&quot; -f 2 | head -n 1</pre>

<p>
Notez l&#039;utilisation de tac, qui passe le fichier à grep en ordre inverse (dernière ligne en premier), c&#039;est plus rapide que de démarrer au début. Une autre solution consiste à utiliser un fifo comme sortie de mplayer (au lieu du fichier .log), mais il est (très) difficile d&#039;avoir le même script qui contrôle à la fois une fifo d&#039;entrée et de sortie, donc il faudra avoir deux scripts (un qui envoie les commandes, un qui affiche les infos).
</p>

<p>
Une autre solution, moins propre, consiste à rechercher à coup de &quot;grep&quot;, de &quot;tail&quot; et de &quot;cut&quot; les infos sur la dernière chanson : <code>grep &#039;^ Title&#039; ~/.mplayer/mplayer.log | cut -d &quot;:&quot; -f 2 | tail -n 1</code>
</p>

<p>
On peut récupérer la liste des get_xxx avec la commande <code>mplayer -input cmdlist</code> :
</p>
<pre class="code">get_percent_pos      # Position en pourcentage dans le fichier
get_time_pos         # Position en secondes et dixièmes de secondes
get_time_length      # Longueur totale en secondes et dixièmes
get_file_name        # Nom de fichier
get_video_codec      # Codec vidéo utilisé
get_video_bitrate    # Débit vidéo en KiloBits par seconde
get_video_resolution # Résolution de la vidéo en pixels
get_audio_codec      # Codec audio utilisé
get_audio_bitrate    # Débit audio en KiloBits par seconde
get_audio_samples    # Fréquence d&#039;échantillonnage et nombre de cannaux (1 = mono / 2 = stereo)
get_meta_title       # Titre
get_meta_artist      # Artiste
get_meta_album       # Album
get_meta_year        # Année
get_meta_comment     # Commentaire
get_meta_track       # Numéro de piste
get_meta_genre       # Genre</pre>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/comment_utiliser_mplayer_en_esclave"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1458756996" /><input type="hidden" name="summary" value="[Mise en pratique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="mise_en_pratique" /><input type="hidden" name="codeblockOffset" value="4" /><input type="hidden" name="range" value="3341-6827" /><button type="submit" title="Mise en pratique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit8 page-header" id="aller_plus_loin">Aller plus loin</h2>
<div class="level2">

<p>
Cet aspect de mplayer nous permet de le contrôler via des scripts bash. 
Pour ne citer qu&#039;eux, il est possible
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li">de passer à la chanson suivante</div>
</li>
</ul>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="co0"># Aller au fichier suivant</span>
<span class="kw3">echo</span> <span class="st_h">'pt_step 1'</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>music-control
<span class="kw3">exit</span> <span class="nu0">0</span></pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li">de passer à la chanson précédente</div>
</li>
</ul>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="co0"># Aller au fichier précédent</span>
<span class="kw3">echo</span> <span class="st_h">'pt_step -1'</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>music-control
<span class="kw3">exit</span> <span class="nu0">0</span></pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li">de mettre mplayer en pause</div>
</li>
</ul>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="co0"># Mettre la lecture en pause ou la reprendre</span>
<span class="kw3">echo</span> <span class="st_h">'pause'</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>music-control
<span class="kw3">exit</span> <span class="nu0">0</span></pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li">d&#039;arrêter mplayer</div>
</li>
</ul>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="co0"># Quitte mplayer</span>
<span class="kw3">echo</span> <span class="st_h">'quit'</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>music-control
<span class="kw3">exit</span> <span class="nu0">0</span></pre>

<p>
Ces petits scripts, combinés par exemple à <a href="/zenity" class="wikilink1" title="zenity">zenity</a>, permettent un excellent contrôle de mplayer. On notera par exemple la possibilité de créer un petit script qui affichera un navigateur et permettra d&#039;ouvrir un morceau, et de le jouer dans mplayer. Allez je suis gentil, je vous le donne aussi :p
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="co0"># Open a file</span>
<span class="kw3">echo</span> <span class="st0">&quot;loadfile '<span class="es5">`zenity --question --text=&quot;Si vous jouez une autre liste de lecture, la liste de lecture en cours sera effacée \!&quot; &amp;&amp; zenity --file-selection --title &quot;Sélectionnez le fichier à jouer.&quot;`</span>' 0&quot;</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>music-control 
<span class="kw3">exit</span> <span class="nu0">0</span> </pre>

<p>
De même, une méthode pas très conventionnelle permet de récupérer dans le fichier log le titre de la dernière chanson. Exemple (décidément, je vous donne tout !), et pardonnez la mauvaise qualité de ces scripts.
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="co0"># Récupérer les informations de la chanson.</span>
&nbsp;
<span class="kw3">cd</span> ~<span class="sy0">/</span>.mplayer
<span class="re2">title</span>=<span class="sy0">`</span><span class="kw2">grep</span> Title mplayer.log <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-d</span> <span class="st0">&quot;:&quot;</span> <span class="re5">-f</span> <span class="nu0">2</span> <span class="sy0">|</span> <span class="kw2">tail</span> <span class="re5">-n</span> <span class="nu0">1</span><span class="sy0">`</span>
<span class="re2">artist</span>=<span class="sy0">`</span><span class="kw2">grep</span> Artist mplayer.log <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-d</span> <span class="st0">&quot;:&quot;</span> <span class="re5">-f</span> <span class="nu0">2</span> <span class="sy0">|</span> <span class="kw2">tail</span> <span class="re5">-n</span> <span class="nu0">1</span><span class="sy0">`</span>
<span class="re2">album</span>=<span class="sy0">`</span><span class="kw2">grep</span> Album mplayer.log <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-d</span> <span class="st0">&quot;:&quot;</span> <span class="re5">-f</span> <span class="nu0">2</span> <span class="sy0">|</span> <span class="kw2">tail</span> <span class="re5">-n</span> <span class="nu0">1</span><span class="sy0">`</span>
<span class="re2">year</span>=<span class="sy0">`</span><span class="kw2">grep</span> Year mplayer.log <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-d</span> <span class="st0">&quot;:&quot;</span> <span class="re5">-f</span> <span class="nu0">2</span> <span class="sy0">|</span> <span class="kw2">tail</span> <span class="re5">-n</span> <span class="nu0">1</span><span class="sy0">`</span>
<span class="re2">genre</span>=<span class="sy0">`</span><span class="kw2">grep</span> Genre mplayer.log <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-d</span> <span class="st0">&quot;:&quot;</span> <span class="re5">-f</span> <span class="nu0">2</span> <span class="sy0">|</span> <span class="kw2">tail</span> <span class="re5">-n</span> <span class="nu0">1</span><span class="sy0">`</span>
&nbsp;
<span class="co0">#L'afficher dans une fenêtre</span>
zenity <span class="re5">--info</span> <span class="re5">--text</span>=<span class="st0">&quot;<span class="es5">`echo $title&quot;\n&quot;$artist&quot;\n&quot;$album&quot;\n&quot;$year&quot;\n&quot;$genre`</span>&quot;</span> <span class="re5">--title</span>=<span class="st0">&quot;Current song&quot;</span> <span class="re5">--no-wrap</span></pre>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/comment_utiliser_mplayer_en_esclave"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1458756996" /><input type="hidden" name="summary" value="[Aller plus loin] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="aller_plus_loin" /><input type="hidden" name="codeblockOffset" value="11" /><input type="hidden" name="range" value="6828-8853" /><button type="submit" title="Aller plus loin" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit9 page-header" id="infos_utiles">Infos utiles</h2>
<div class="level2">

<p>
A l&#039;aide de <a href="/xbindkeys" class="wikilink1" title="xbindkeys">xbindkeys</a>, on peut facilement arriver à tout contrôler au clavier !
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"><a href="http://www.mplayerhq.hu" class="urlextern" title="http://www.mplayerhq.hu" rel="nofollow">Le site officiel de mplayer</a></div>
</li>
<li class="level1"><div class="li"><a href="http://www.mplayerhq.hu/DOCS/man/fr/mplayer.1.html" class="urlextern" title="http://www.mplayerhq.hu/DOCS/man/fr/mplayer.1.html" rel="nofollow">Des infos sur le mode &quot;slave&quot; et les commandes possibles</a></div>
</li>
<li class="level1"><div class="li"><a href="https://fr.wikipedia.org/wiki/Mplayer" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Mplayer"> La page wikipédia de mplayer</a></div>
</li>
</ul>
<hr />

<p>
<em>Contributeurs: <a href="/utilisateurs/blackbg" class="wikilink1" title="utilisateurs:blackbg">blackbg</a></em>
</p>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/comment_utiliser_mplayer_en_esclave"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1458756996" /><input type="hidden" name="summary" value="[Infos utiles] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="infos_utiles" /><input type="hidden" name="codeblockOffset" value="17" /><input type="hidden" name="range" value="8854-" /><button type="submit" title="Infos utiles" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="tutoriel/comment_utiliser_mplayer_en_esclave.txt">tutoriel/comment_utiliser_mplayer_en_esclave.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 23/03/2016, 19:16">Le 23/03/2016, 19:16</span></li><li class="text-muted">par 90.31.43.160</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=tutoriel%3Acomment_utiliser_mplayer_en_esclave&amp;1635531487" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
