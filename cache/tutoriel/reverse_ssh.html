<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>tutoriel:reverse_ssh [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="securite,ssh,reseau,tutoriel"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/tutoriel/reverse_ssh?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns=tutoriel"/>
<link rel="edit" title="Modifier cette page" href="/tutoriel/reverse_ssh?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/tutoriel/reverse_ssh"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/tutoriel/reverse_ssh"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/tutoriel/reverse_ssh"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='tutoriel';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"tutoriel:reverse_ssh","namespace":"tutoriel","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="tutoriel:reverse_ssh">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/tutoriel/reverse_ssh?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/tutoriel/reverse_ssh?do=media&amp;ns=tutoriel"  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/tutoriel/reverse_ssh?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/tutoriel/reverse_ssh?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/tutoriel/reverse_ssh?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/tutoriel/reverse_ssh?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/tutoriel/reverse_ssh?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">tutoriel:reverse_ssh</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/tutoriel/reverse_ssh?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/tutoriel/reverse_ssh?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/tutoriel/reverse_ssh?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#connexion_directe","title":"Connexion directe","level":1},{"link":"#creation_d_un_utilisateur_dedie_sur_le_poste_local","title":"Cr\u00e9ation d'un utilisateur d\u00e9di\u00e9 sur le poste local","level":2},{"link":"#connexion_au_poste_local_depuis_le_poste_distant","title":"Connexion au poste local depuis le poste distant","level":2},{"link":"#connexion_au_poste_distant_depuis_le_poste_local","title":"Connexion au poste distant depuis le poste local","level":2},{"link":"#connexion_par_un_serveur_tiers","title":"Connexion par un serveur tiers","level":1},{"link":"#creation_d_un_utilisateur_dedie_sur_le_poste_serveur","title":"Cr\u00e9ation d'un utilisateur d\u00e9di\u00e9 sur le poste serveur","level":2},{"link":"#connexion_sur_le_poste_serveur_depuis_le_poste_distant","title":"Connexion sur le poste serveur depuis le poste distant","level":2},{"link":"#connexion_sur_le_poste_serveur_depuis_le_poste_local","title":"Connexion sur le poste serveur depuis le poste local","level":2},{"link":"#acces_a_la_machine_distante_depuis_la_machine_locale","title":"Acc\u00e8s \u00e0 la machine distante depuis la machine locale","level":2}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#connexion_directe">Connexion directe</a>
<ul class="nav toc">
<li class="level2"><a href="#creation_d_un_utilisateur_dedie_sur_le_poste_local">Création d&#039;un utilisateur dédié sur le poste local</a></li>
<li class="level2"><a href="#connexion_au_poste_local_depuis_le_poste_distant">Connexion au poste local depuis le poste distant</a></li>
<li class="level2"><a href="#connexion_au_poste_distant_depuis_le_poste_local">Connexion au poste distant depuis le poste local</a></li>
</ul>
</li>
<li class="level1"><a href="#connexion_par_un_serveur_tiers">Connexion par un serveur tiers</a>
<ul class="nav toc">
<li class="level2"><a href="#creation_d_un_utilisateur_dedie_sur_le_poste_serveur">Création d&#039;un utilisateur dédié sur le poste serveur</a></li>
<li class="level2"><a href="#connexion_sur_le_poste_serveur_depuis_le_poste_distant">Connexion sur le poste serveur depuis le poste distant</a></li>
<li class="level2"><a href="#connexion_sur_le_poste_serveur_depuis_le_poste_local">Connexion sur le poste serveur depuis le poste local</a></li>
<li class="level2"><a href="#acces_a_la_machine_distante_depuis_la_machine_locale">Accès à la machine distante depuis la machine locale</a></li>
</ul></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/securite" class="wikilink1" title="securite" rel="tag">sécurité</a>,
	<a href="/ssh" class="wikilink1" title="ssh" rel="tag">ssh</a>,
	<a href="/reseau" class="wikilink1" title="reseau" rel="tag">réseau</a>,
	<a href="/tutoriel" class="wikilink1" title="tutoriel" rel="tag">tutoriel</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="reverse_ssh">reverse SSH</h1>
<div class="level1">

<p>
Il est simple de configurer un serveur <a href="/ssh" class="wikilink1" title="ssh">SSH</a> et de s&#039;y connecter lorsque le pare-feu/routeur est correctement configuré.<br/>

Cependant certains réseaux ne laissent pas par défaut entrer les connexions ssh, le port par défaut (22) n&#039;étant pas ouvert, comme ce peut notamment être le cas des particuliers derrière une BOX. Les connexions sortantes ne sont toutefois pas bloquées, ce qui va vous permettre de vous connecter quand même.
</p>

<p>
Une parade est donc d&#039;utiliser la fonction REVERSE de SSH. Le principe consiste à initier une connexion depuis la machine derrière le routeur <sup><a href="#fn__1" id="fnt__1" class="fn_top">1)</a></sup> sur une machine tierce <sup><a href="#fn__2" id="fnt__2" class="fn_top">2)</a></sup>, et ainsi permettre une connexion retour depuis la machine tierce qui ne sera pas bloquée.
</p>

<p>
Cette façon de procéder est très utile pour dépanner quelqu&#039;un à distance qui aura juste à initier la connexion sortante en tapant une ligne depuis le <a href="/terminal" class="wikilink1" title="terminal">terminal</a>, sans avoir à configurer le pare-feu/routeur/BOX. Il n&#039;est également pas nécessaire de connaitre l&#039;adresse IP de la machine distante ni d&#039;effectuer un routage de la connexion.
</p>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[reverse SSH] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="reverse_ssh" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="47-1232" /><button type="submit" title="reverse SSH" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="connexion_directe">Connexion directe</h2>
<div class="level2">

<p>
Prenez l&#039;exemple de configuration suivant:
</p>

<p>
<a href="/_detail/tutoriel/ssh/reverse_ssh_dfwil.png?id=tutoriel%3Areverse_ssh" class="media" title="tutoriel:ssh:reverse_ssh_dfwil.png"><img src="/_media/tutoriel/ssh/reverse_ssh_dfwil.png" class="media img-responsive" title="userD@distant est le serveur SSH à joindre mais est inaccessible dû aux paramétrages du routeur/pare-feu..." alt="userD@distant est le serveur SSH à joindre mais est inaccessible dû aux paramétrages du routeur/pare-feu..." /></a>
</p>

<p>
Ici
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>userD@distant</strong> correspond à l&#039;utilisateur <em>userD</em>, sur le poste appelé <strong><em>distant</em></strong> qui a les ports entrants bloqués et donc inaccessible depuis l&#039;extérieur</div>
</li>
<li class="level1"><div class="li"> <strong>userL@local</strong> correspond à l&#039;utilisateur <em>userL</em>, sur le poste appelé <strong><em>local</em></strong> qui dispose également d&#039;un serveur ssh, et qui va permettre d&#039;accéder à la machine <strong><em>distant</em></strong></div>
</li>
</ul>
<div class="notetip">Le principe de connexion à <a href="/ssh" class="wikilink1" title="ssh">Ssh</a> est habituellement basé sur le système du <em>Client <strong>local</strong></em> qui se connecte au <em>Serveur <strong>distant</strong></em>.<br/>

N&#039;oubliez pas qu&#039;ici c&#039;est le <em>Serveur <strong>distant</strong></em> qui se connecte au <em>Client  <strong>local</strong></em>.
</div>
</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[Connexion directe] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="connexion_directe" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1233-2096" /><button type="submit" title="Connexion directe" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit3" id="creation_d_un_utilisateur_dedie_sur_le_poste_local">Création d&#039;un utilisateur dédié sur le poste local</h3>
<div class="level3">

<p>
Créez un nouvel utilisateur spécialement pour cette connexion afin que l&#039;utilisateur <strong>userD</strong> du poste <em><strong>distant</strong></em> ne puisse pas avoir un accès complet au poste <em><strong>local</strong></em>. Ce nouvel utilisateur créé pourra cependant avoir des <a href="/users-admin" class="wikilink1" title="users-admin">droits</a> personnalisés.<br/>

Saisissez dans un <a href="/terminal" class="wikilink1" title="terminal">terminal</a> sur <strong><em>local</em></strong> la <a href="/commande_shell" class="wikilink1" title="commande_shell">commande</a> suivante :
</p>
<pre class="code">sudo adduser --no-create-home userL</pre>

<p>
où :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>–no-create-home</strong> est l&#039;option spécifiée pour ne pas créer de dossier <strong>/home/userL</strong> sur le poste <em><strong>local</strong></em>.</div>
</li>
<li class="level1"><div class="li"> <strong>userL</strong> est à remplacer par le nom de votre choix mais suffisamment explicite pour savoir sur quelle machine vous êtes. Le mot de passe créé servira pour se connecter lors de l&#039;<a href="#connexion_sur_le_poste_local_depuis_le_poste_distant" title="tutoriel:reverse_ssh ↵" class="wikilink1">étape suivante</a>.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[Création d&#039;un utilisateur dédié sur le poste local] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="creation_d_un_utilisateur_dedie_sur_le_poste_local" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="2097-2978" /><button type="submit" title="Création d&#039;un utilisateur dédié sur le poste local" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit4" id="connexion_au_poste_local_depuis_le_poste_distant">Connexion au poste local depuis le poste distant</h3>
<div class="level3">

<p>
Initiez une connexion à <em><strong>local</strong></em> en saisissant sur le poste <em><strong>distant</strong></em>:
</p>
<pre class="code">ssh -NR 12345:localhost:22 userL@local</pre>

<p>
où
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <em>12345</em> est à remplacer par un numéro de port aléatoire (entre 1024 et 65535 qui sont réservés pour des applications utilisateurs) et non utilisé de votre choix</div>
</li>
<li class="level1"><div class="li"> <strong>userL</strong> et le mot de passe de connexion sont ceux <a href="#creation_d_un_utilisateur_dedie_sur_le_poste_local" title="tutoriel:reverse_ssh ↵" class="wikilink1">défini précédemment</a>.</div>
</li>
<li class="level1"><div class="li"> <strong>local</strong> est l&#039;adresse IP publique de la machine locale (au besoin avec une règle <abbr title="Network Address Translation">NAT</abbr> dans la box locale pour être joignable de l&#039;extérieur)</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[Connexion au poste local depuis le poste distant] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="connexion_au_poste_local_depuis_le_poste_distant" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="2979-3639" /><button type="submit" title="Connexion au poste local depuis le poste distant" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit5" id="connexion_au_poste_distant_depuis_le_poste_local">Connexion au poste distant depuis le poste local</h3>
<div class="level3">

<p>
La connexion étant désormais activée depuis <em><strong>distant</strong></em> vers <em><strong>local</strong></em>, le <a href="/pare-feu" class="wikilink1" title="pare-feu">pare-feu</a> va donc laisser rentrer la connexion reverse, à savoir depuis <em><strong>local</strong></em> vers <em><strong>distant</strong></em>.<br/>

Pour cela taper dans un terminal sur <em><strong>local</strong></em>:
</p>
<pre class="code">ssh -p 12345 userD@localhost</pre>

<p>
où
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <em>12345</em> est le port <a href="#connexion_sur_le_poste_local_depuis_le_poste_distant" title="tutoriel:reverse_ssh ↵" class="wikilink1">choisi auparavant</a></div>
</li>
<li class="level1"><div class="li"> <strong>userD</strong> est à remplacer par le nom d&#039;utilisateur permettant de se connecter au serveur ssh sur <em><strong>distant</strong></em></div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[Connexion au poste distant depuis le poste local] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="connexion_au_poste_distant_depuis_le_poste_local" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="3640-4220" /><button type="submit" title="Connexion au poste distant depuis le poste local" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit6 page-header" id="connexion_par_un_serveur_tiers">Connexion par un serveur tiers</h2>
<div class="level2">

<p>
Cette configuration est pratique quand le poste <strong>local</strong> est lui-même derrière un pare-feu et/ou ne dispose pas d&#039;un serveur ssh.
Prenez l&#039;exemple de configuration suivant:
</p>

<p>
<a href="/_detail/tutoriel/ssh/reverse_ssh_dfwisl.png?id=tutoriel%3Areverse_ssh" class="media" title="tutoriel:ssh:reverse_ssh_dfwisl.png"><img src="/_media/tutoriel/ssh/reverse_ssh_dfwisl.png" class="media img-responsive" title="userD@distant et userL@local ne sont pas accessibles depuis l&#039;extérieur" alt="userD@distant et userL@local ne sont pas accessibles depuis l&#039;extérieur" /></a>
</p>

<p>
Ici
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>userD@distant</strong> correspond à l&#039;utilisateur <em>userD</em>, sur le poste appelé <strong><em>distant</em></strong> qui a les ports entrants bloqués et donc inaccessible depuis l&#039;extérieur</div>
</li>
<li class="level1"><div class="li"> <strong>userS@serveur</strong> correspond à l&#039;utilisateur <em>userS</em>, sur le poste appelé <strong><em>serveur</em></strong> qui dispose d&#039;un accès libre à son serveur ssh.</div>
</li>
<li class="level1"><div class="li"> <strong>userL@local</strong> correspond à l&#039;utilisateur <em>userL</em>, sur le poste appelé <strong><em>local</em></strong> qui va accéder à la machine <strong><em>serveur</em></strong> pour atteindre <strong><em>distant</em></strong></div>
</li>
</ul>

<p>
Pour résumé le principe, il s&#039;agira de:
</p>
<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li"> connecter <strong><em>distant</em></strong> sur <strong><em>serveur</em></strong></div>
</li>
<li class="level1"><div class="li"> connecter <strong><em>local</em></strong> sur <strong><em>serveur</em></strong></div>
</li>
<li class="level1"><div class="li"> depuis le <a href="/terminal" class="wikilink1" title="terminal">terminal</a> qui a initié la connexion <strong><em>local</em></strong> sur <strong><em>serveur</em></strong> pour atteindre <strong><em>distant</em></strong></div>
</li>
</ol>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[Connexion par un serveur tiers] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="connexion_par_un_serveur_tiers" /><input type="hidden" name="codeblockOffset" value="3" /><input type="hidden" name="range" value="4221-5315" /><button type="submit" title="Connexion par un serveur tiers" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit7" id="creation_d_un_utilisateur_dedie_sur_le_poste_serveur">Création d&#039;un utilisateur dédié sur le poste serveur</h3>
<div class="level3">
<div class="notetip">Cette partie est facultative si la machine <em><strong>serveur</strong></em> dispose déjà d&#039;un utilisateur public
</div>
<p>
Taper dans un terminal :
</p>
<pre class="code">sudo adduser --no-create-home userS</pre>

<p>
où
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> l&#039;option <strong>–no-create-home</strong> est spécifiée pour ne pas créer de dossier <strong>/home/userS</strong> sur le poste <em><strong>serveur</strong></em>.</div>
</li>
<li class="level1"><div class="li"> <strong>userS</strong> est à remplacer par le nom de votre choix mais suffisament explicite pour savoir sur quelle machine vous êtes. Le mot de passe créé servira pour se connecter lors de l&#039;<a href="#connexion_sur_le_poste_serveur_depuis_le_poste_distant" title="tutoriel:reverse_ssh ↵" class="wikilink1">étape suivante</a>.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[Création d&#039;un utilisateur dédié sur le poste serveur] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="creation_d_un_utilisateur_dedie_sur_le_poste_serveur" /><input type="hidden" name="codeblockOffset" value="3" /><input type="hidden" name="range" value="5316-5965" /><button type="submit" title="Création d&#039;un utilisateur dédié sur le poste serveur" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit8" id="connexion_sur_le_poste_serveur_depuis_le_poste_distant">Connexion sur le poste serveur depuis le poste distant</h3>
<div class="level3">

<p>
Initiez une connexion sur <strong><em>serveur</em></strong> en tapant dans un <a href="/terminal" class="wikilink1" title="terminal">terminal</a> de la machine <strong><em>distant</em></strong> :
</p>
<pre class="code">ssh -R 12345:localhost:22 userS@serveur</pre>

<p>
où
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <em>12345</em> est à remplacer par un numéro de port aléatoire de votre choix,</div>
</li>
<li class="level1"><div class="li"> le port <em>22</em> est le port d&#039;écoute ssh sur la machine <em><strong>distant</strong></em>,</div>
</li>
<li class="level1"><div class="li"> <strong>userS</strong> et le mot de passe de connexion sont ceux <a href="#creation_d_un_utilisateur_dedie_sur_le_poste_serveur" title="tutoriel:reverse_ssh ↵" class="wikilink1">défini précédemment</a></div>
</li>
<li class="level1"><div class="li"> <strong>serveur</strong> est l&#039;adresse ip ou le nom de domaine du serveur tiers</div>
</li>
</ul>
<div class="notetip"> L&#039;option <code>-N</code> peut également être ajoutée pour ne pas faire apparaitre d&#039;invite de terminal sur <em><strong>distant</strong></em>
</div>
</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[Connexion sur le poste serveur depuis le poste distant] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="connexion_sur_le_poste_serveur_depuis_le_poste_distant" /><input type="hidden" name="codeblockOffset" value="4" /><input type="hidden" name="range" value="5966-6701" /><button type="submit" title="Connexion sur le poste serveur depuis le poste distant" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit9" id="connexion_sur_le_poste_serveur_depuis_le_poste_local">Connexion sur le poste serveur depuis le poste local</h3>
<div class="level3">

<p>
Créer un pont entre <strong><em>serveur</em></strong> et <strong><em>local</em></strong> en tapant dans un <a href="/terminal" class="wikilink1" title="terminal">terminal</a> de ce dernier
</p>
<pre class="code">ssh userS@serveur</pre>

<p>
où
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>userS</strong> et le mot de passe de connexion sont ceux <a href="#creation_d_un_utilisateur_dedie_sur_le_poste_serveur" title="tutoriel:reverse_ssh ↵" class="wikilink1">défini précédemment</a></div>
</li>
<li class="level1"><div class="li"> <strong>serveur</strong> est l&#039;adresse ip ou le nom de domaine du serveur tiers</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[Connexion sur le poste serveur depuis le poste local] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="connexion_sur_le_poste_serveur_depuis_le_poste_local" /><input type="hidden" name="codeblockOffset" value="5" /><input type="hidden" name="range" value="6702-7112" /><button type="submit" title="Connexion sur le poste serveur depuis le poste local" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit10" id="acces_a_la_machine_distante_depuis_la_machine_locale">Accès à la machine distante depuis la machine locale</h3>
<div class="level3">

<p>
Vous pouvez désormais atteindre le poste <strong><em>distant</em></strong> en saisissant dans le terminal du poste <strong><em>local</em></strong> <a href="#connexion_sur_le_poste_serveur_depuis_le_poste_local" title="tutoriel:reverse_ssh ↵" class="wikilink1">connecté précédemment</a> sur <strong><em>serveur</em></strong>
</p>
<pre class="code">ssh -p 12345 userD@localhost</pre>
<hr />

<p>
<em>Contributeurs:<a href="/utilisateurs/nesthib" class="wikilink2" title="utilisateurs:nesthib" rel="nofollow">nesthib</a></em>
</p>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/reverse_ssh"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1598308647" /><input type="hidden" name="summary" value="[Accès à la machine distante depuis la machine locale] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="acces_a_la_machine_distante_depuis_la_machine_locale" /><input type="hidden" name="codeblockOffset" value="6" /><input type="hidden" name="range" value="7113-" /><button type="submit" title="Accès à la machine distante depuis la machine locale" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div><hr/><div class="footnotes">
<div class="fn"><sup><a href="#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
<div class="content">donc la machine dont le port entrant est bloqué</div></div>
<div class="fn"><sup><a href="#fnt__2" id="fn__2" class="fn_bot">2)</a></sup> 
<div class="content">celle-ci disposant d&#039;un serveur SSH accessible</div></div>
</div>

</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="tutoriel/reverse_ssh.txt">tutoriel/reverse_ssh.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 25/08/2020, 00:37">Le 25/08/2020, 00:37</span></li><li class="text-muted">par remi_ours</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=tutoriel%3Areverse_ssh&amp;1635532649" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
