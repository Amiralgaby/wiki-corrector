<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>tutoriel:script_shell [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="programmation,script,shell,console,tutoriel"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/tutoriel/script_shell?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns=tutoriel"/>
<link rel="edit" title="Modifier cette page" href="/tutoriel/script_shell?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/tutoriel/script_shell"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/tutoriel/script_shell"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/tutoriel/script_shell"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='tutoriel';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"tutoriel:script_shell","namespace":"tutoriel","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="tutoriel:script_shell">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/tutoriel/script_shell?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/tutoriel/script_shell?do=media&amp;ns=tutoriel"  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/tutoriel/script_shell?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/tutoriel/script_shell?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/tutoriel/script_shell?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/tutoriel/script_shell?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/tutoriel/script_shell?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">tutoriel:script_shell</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/tutoriel/script_shell?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/tutoriel/script_shell?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/tutoriel/script_shell?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#pour_faire_qu_un_script_soit_executable","title":"Pour faire qu'un script soit ex\u00e9cutable","level":1},{"link":"#methode_graphique","title":"M\u00e9thode graphique","level":2},{"link":"#methode_dans_un_terminal","title":"M\u00e9thode dans un terminal","level":2},{"link":"#les_variables","title":"Les variables","level":1},{"link":"#les_arguments_en_ligne_de_commande","title":"Les arguments en ligne de commande","level":2},{"link":"#l_arithmetique","title":"L'arithm\u00e9tique","level":2},{"link":"#vocabulaire","title":"Vocabulaire","level":1},{"link":"#la_commande_test","title":"La commande test","level":2},{"link":"#la_structureif","title":"La structure : `if`","level":2},{"link":"#les_structures_while_et_until","title":"Les structures while et until","level":2},{"link":"#la_structure_case","title":"La structure case","level":2},{"link":"#la_structure_for","title":"La structure for","level":2},{"link":"#les_fonctions","title":"Les fonctions","level":2},{"link":"#extraire_des_sous-chaines","title":"Extraire des sous-cha\u00eenes","level":2},{"link":"#la_couleur","title":"La couleur","level":2},{"link":"#exemples_et_exercices","title":"Exemples et exercices","level":1},{"link":"#l_art_d_ecrire_un_script","title":"L'art d'\u00e9crire un script","level":1},{"link":"#liens","title":"Liens","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#pour_faire_qu_un_script_soit_executable">Pour faire qu&#039;un script soit exécutable</a>
<ul class="nav toc">
<li class="level2"><a href="#methode_graphique">Méthode graphique</a></li>
<li class="level2"><a href="#methode_dans_un_terminal">Méthode dans un terminal</a></li>
</ul>
</li>
<li class="level1"><a href="#les_variables">Les variables</a>
<ul class="nav toc">
<li class="level2"><a href="#les_arguments_en_ligne_de_commande">Les arguments en ligne de commande</a></li>
<li class="level2"><a href="#l_arithmetique">L&#039;arithmétique</a></li>
</ul>
</li>
<li class="level1"><a href="#vocabulaire">Vocabulaire</a>
<ul class="nav toc">
<li class="level2"><a href="#la_commande_test">La commande test</a></li>
<li class="level2"><a href="#la_structureif">La structure : `if`</a></li>
<li class="level2"><a href="#les_structures_while_et_until">Les structures while et until</a></li>
<li class="level2"><a href="#la_structure_case">La structure case</a></li>
<li class="level2"><a href="#la_structure_for">La structure for</a></li>
<li class="level2"><a href="#les_fonctions">Les fonctions</a></li>
<li class="level2"><a href="#extraire_des_sous-chaines">Extraire des sous-chaînes</a></li>
<li class="level2"><a href="#la_couleur">La couleur</a></li>
</ul>
</li>
<li class="level1"><a href="#exemples_et_exercices">Exemples et exercices</a></li>
<li class="level1"><a href="#l_art_d_ecrire_un_script">L&#039;art d&#039;écrire un script</a></li>
<li class="level1"><a href="#liens">Liens</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/programmation" class="wikilink1" title="programmation" rel="tag">programmation</a>,
	<a href="/script" class="wikilink1" title="script" rel="tag">script</a>,
	<a href="/shell" class="wikilink1" title="shell" rel="tag">shell</a>,
	<a href="/console" class="wikilink1" title="console" rel="tag">console</a>,
	<a href="/tutoriel" class="wikilink1" title="tutoriel" rel="tag">tutoriel</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="introduction_aux_scripts_shell">Introduction aux scripts shell</h1>
<div class="level1">

<p>
Un script shell permet d&#039;automatiser une série d&#039;opérations. Il se présente sous la forme d&#039;un fichier contenant une ou plusieurs commandes qui  seront exécutées de manière séquentielle. 
</p>
<pre class="code bash"><span class="co0">#!/bin/bash</span>
<span class="co0"># This script will take an animated GIF and delete every other frame</span>
<span class="co0"># Accepts two parameters: input file and output file</span>
<span class="co0"># Usage: ./&lt;scriptfilename&gt; input.gif output.gif</span>
&nbsp;
<span class="co0"># Make a copy of the file</span>
<span class="kw2">cp</span> <span class="st0">&quot;$1&quot;</span> <span class="st0">&quot;$2&quot;</span>
&nbsp;
<span class="co0"># Get the number of frames</span>
<span class="re2">numframes</span>=$<span class="br0">&#40;</span>gifsicle <span class="re5">--info</span> <span class="st0">&quot;$1&quot;</span> \
              <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">--perl-regexp</span> <span class="re5">--only-matching</span> <span class="st_h">'\d+ images'</span> \
              <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">--perl-regexp</span> <span class="re5">--only-matching</span> <span class="st_h">'\d+'</span><span class="br0">&#41;</span>
&nbsp;
<span class="co0"># Deletion</span>
<span class="kw3">let</span> <span class="re2">i</span>=<span class="nu0">0</span>
<span class="kw1">while</span> <span class="kw3">test</span> <span class="re1">$i</span> <span class="re5">-lt</span> <span class="re1">$numframes</span>
<span class="kw1">do</span>
    <span class="re2">rem</span>=$<span class="br0">&#40;</span><span class="br0">&#40;</span> <span class="re1">$i</span> <span class="sy0">%</span> <span class="nu0">2</span> <span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp;
    <span class="kw1">if</span> <span class="kw3">test</span> <span class="re1">$rem</span> <span class="re5">-eq</span> <span class="nu0">0</span>
    <span class="kw1">then</span>
        gifsicle <span class="st0">&quot;$2&quot;</span> <span class="re5">--delete</span> <span class="st0">&quot;#&quot;</span>$<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re1">$i</span><span class="sy0">/</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="re5">-o</span> <span class="st0">&quot;$2&quot;</span>
    <span class="kw1">fi</span>
&nbsp;
    <span class="kw3">let</span> <span class="re2">i</span>=i+<span class="nu0">1</span> 
<span class="kw1">done</span></pre>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Introduction aux scripts shell] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="introduction_aux_scripts_shell" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="60-918" /><button type="submit" title="Introduction aux scripts shell" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="pour_faire_qu_un_script_soit_executable">Pour faire qu&#039;un script soit exécutable</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Pour faire qu&#039;un script soit exécutable] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="pour_faire_qu_un_script_soit_executable" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="919-970" /><button type="submit" title="Pour faire qu&#039;un script soit exécutable" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit3" id="methode_graphique">Méthode graphique</h3>
<div class="level3">

<p>
Votre script est un simple fichier texte, par défaut il s&#039;ouvre donc avec l&#039;éditeur de texte défini par défaut (ex : <a href="/gedit" class="wikilink1" title="gedit">Gedit</a> dans une session Unity ou Gnome).<br/>

Pour qu&#039;il soit autorisé à se lancer en tant que programme, il faut modifier ses propriétés.<br/>

Pour cela faites un clic droit sur son icône, et dans l&#039;onglet &quot;Permissions&quot; des &quot;Propriétés&quot;, cocher la case <em>&quot;autoriser l&#039;exécution du fichier comme un programme&quot;</em>.
</p>

<p>
Par la suite, un double-clic sur l’icône vous laissera le choix entre afficher le fichier (dans un éditeur de texte) et le lancer (directement ou dans un terminal pour voir d&#039;éventuels messages d&#039;erreurs)
</p>

<p>
Par ailleurs <a href="/nautilus" class="wikilink1" title="nautilus">Nautilus</a> ne propose pas de lancer le script par simple clic avec les réglages de bases. Il faut aller dans <strong>Menu→ Édition → Préférences → Onglet comportement → fichier texte et exécutable</strong> et cocher pour fichiers exécutables <strong>Demander à chaque fois</strong>.
</p>

</div>

<h4 id="probleme_connu">Problème connu</h4>
<div class="level4">

<p>
Sous <a href="/lubuntu" class="wikilink1" title="lubuntu">Lubuntu</a>, si cette méthode ne fonctionne pas, vous devez d&#039;abord effectuer l&#039;opération suivante :<br/>

</p>
<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Dans le menu principal, allez sur <em>Outils système</em> et faites un <em>clic droit → Propriétés</em> sur le raccourci vers le terminal. Notez le contenu du champ <em>Commande</em> et annulez.</div>
</li>
<li class="level1"><div class="li"> Ouvrez votre gestionnaire de fichier <a href="/pcmanfm" class="wikilink1" title="pcmanfm">PCManFM</a> et allez dans le menu supérieur sur <em>éditer → Préférences</em> puis dans la fenêtre qui s&#039;ouvre sélectionnez <em>Avancé</em>.</div>
</li>
<li class="level1"><div class="li"> Remplacez le contenu du champ <em>Terminal emulator</em> par le contenu du champ <em>Commande</em> que vous avez pris soin de noter à la première étape.</div>
</li>
<li class="level1"><div class="li"> Vous pouvez ensuite suivre la méthode graphique indiquée ci-dessus pour exécuter vos scripts shell.</div>
</li>
</ol>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Méthode graphique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="methode_graphique" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="971-2729" /><button type="submit" title="Méthode graphique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit4" id="methode_dans_un_terminal">Méthode dans un terminal</h3>
<div class="level3">

<p>
Il suffit de se placer dans le dossier où est le script, et de lancer : 
</p>
<pre class="code bash"><span class="kw2">bash</span> nom_du_script</pre>

<p>
mais pas toujours bash ( dépend du langage du script )
</p>

<p>
ou si vous voulez l&#039;exécuter par son  nom , il faut le rendre exécutable avec <code>chmod</code>. Pour ceci tapez la commande qui suit : 
</p>
<pre class="code bash"><span class="kw2">chmod</span> +x nom_du_script</pre>

<p>
Puis vous pouvez exécuter le script en faisant : 
</p>
<pre class="code bash">.<span class="sy0">/</span>nom_du_script</pre>

<p>
mais pourquoi le ./ ?
</p>

</div>

<h4 id="le_chemin">Le chemin ./</h4>
<div class="level4">

<p>
Il peut être intéressant d&#039;ajouter un répertoire au &quot;PATH&quot; pour pouvoir exécuter ses scripts sans avoir à se placer dans le bon dossier.
Je m&#039;explique, quand vous tapez une commande (&quot;ls&quot; par exemple), le shell regarde dans le PATH qui lui indique où chercher le code de la commande.
</p>

<p>
Pour voir à quoi ressemble votre PATH, tapez dans votre console:
</p>
<pre class="code">echo $PATH</pre>

<p>
Cette commande chez moi donnait initialement :
</p>
<pre class="code">/usr/local/bin:/usr/bin:/bin:/usr/bin/X11:/usr/games</pre>

<p>
C&#039;est à dire que le shell va aller voir si la définition de la commande tapée (&quot;ls&quot; pour continuer sur le même exemple) se trouve dans <strong>/usr/local/bin</strong> puis dans <strong>/usr/bin</strong>… jusqu&#039;à ce qu&#039;il la trouve.
</p>

<p>
Ajouter un répertoire au PATH peut donc être très pratique. Par convention, ce répertoire s&#039;appelle <strong>bin</strong> et se place dans votre répertoire personnel. Si votre répertoire personnel est /home/toto, ce répertoire sera donc <strong>/home/toto/bin</strong>.
Pour pouvoir utiliser mes scripts en tapant directement leur nom (sans le &quot;./&quot;) depuis n&#039;importe quel répertoire de mon ordinateur, il me suffit d&#039;indiquer au shell de chercher aussi dans ce nouveau dossier en l&#039;ajoutant au PATH.
Pour ceci, il suffit de faire :
</p>
<pre class="code">export PATH=$PATH:$HOME/bin</pre>

<p>
La commande
</p>
<pre class="code">echo $PATH</pre>

<p>
retourne maintenant
</p>
<pre class="code">/usr/local/bin:/usr/bin:/bin:/usr/bin/X11:/usr/games:/home/toto/bin</pre>

<p>
et je peux lancer le script appelé &quot;monScript&quot; situé dans &quot;/home/toto/bin&quot; en tapant directement :  monScript
</p>
<div class="notetip">Cette procédure est pour une modification temporaire du PATH et qui sera donc effacée à la fin de la session. Pour rendre la modification permanente, ajouter la commande dans le fichier texte caché .bashrc se trouvant dans votre dossier personnel ainsi que dans le dossier /root.
</div><div class="noteimportant">Dans les dernières versions de ubuntu (12.04 +) si le dossier $HOME/bin existe il est automatiquement ajouté au PATH. La commande est incluse dans le fichier ~/.profile lancé lors de toutes sessions (graphique ou console).
</div>
</div>

<h4 id="les_differents_types_de_shells">Les différents types de shells</h4>
<div class="level4">

<p>
Comme vous avez sûrement dû l&#039;entendre, il existe différents types de shells ou en bon français, interpréteurs de commandes :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <a href="https://fr.wikipedia.org/wiki/Debian_Almquist_shell" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Debian_Almquist_shell">dash</a> (<em>Debian Almquist shell</em>) : shell plus léger que bash, installé par défaut sur Ubuntu ;</div>
</li>
<li class="level1"><div class="li"> <a href="/bash" class="wikilink1" title="bash">bash</a> (<em>Bourne Again SHell</em>) : conçu par le projet <abbr title="GNU&#039;s Not Unix">GNU</abbr>, shell linux ; le shell par défaut sur Ubuntu ;</div>
</li>
<li class="level1"><div class="li"> rbash : un shell restreint basé sur bash. Il existe de nombreuses variantes de bash ;</div>
</li>
<li class="level1"><div class="li"> csh, tcsh : shells C, créés par Bill Joy de Berkeley ;</div>
</li>
<li class="level1"><div class="li"> zsh, shell C écrit par Paul Falstad ;</div>
</li>
<li class="level1"><div class="li"> ksh (⇔ ksh88 sur Solaris et équivaut à ksh93 sur les autres UNIX/Linux cf.<a href="http://en.wikipedia.org/wiki/Korn_shell#History" class="urlextern" title="http://en.wikipedia.org/wiki/Korn_shell#History" rel="nofollow">Korn shell History</a>): shells korn écrits par David Korn, pdksh (Public Domain Korn Shell ⇔ ksh88) ;</div>
</li>
<li class="level1"><div class="li"> rc : shell C, lui aussi conçu par le projet <abbr title="GNU&#039;s Not Unix">GNU</abbr> ;</div>
</li>
<li class="level1"><div class="li"> tclsh : shell utilisant Tcl ;                        </div>
</li>
<li class="level1"><div class="li"> wish : shell utilisant Tk .      </div>
</li>
</ul>

<p>
Il existe bien entendu beaucoup d&#039;autres types de shells.<br/>
Pour savoir quel type de shell est présent sur une machine, aller dans un terminal et taper la commande <strong>ps</strong>.
</p>

<p>
La commande <strong>sh</strong> est en fait un lien symbolique vers l&#039;interpréteur de commandes par défaut : <strong>/bin/dash</strong>.
</p>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Méthode dans un terminal] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="methode_dans_un_terminal" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="2730-6545" /><button type="submit" title="Méthode dans un terminal" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit5 page-header" id="les_variables">Les variables</h2>
<div class="level2">

<p>
Il faut savoir que en bash les variables sont toutes des chaînes de caractères.<br/>

Cela dépendra de son USAGE, pour une opération arithmétique prochaine voir : let ma_variable sinon pour conserver une valeur : 
il suffit de lui donner un nom et une valeur avec l&#039;affectation égale :
</p>
<pre class="code bash"><span class="re2">ma_variable</span>=unmot</pre>

<p>
Ici  la valeur est affectée à la variable ma_variable .<br/>

Attention: pas d&#039;espace ni avant ni après le signe &quot;=&quot; .<br/>

Autre exemple avec une commande avec arguments :
</p>
<pre class="code bash"><span class="re2">nbre_lignes</span>=$<span class="br0">&#40;</span><span class="kw2">wc</span> <span class="re5">-l</span> <span class="sy0">&lt;</span> fichier.ext<span class="br0">&#41;</span></pre>

<p>
<em>nbre_lignes</em> contiendra le nombre de lignes contenu dans <em>fichier.ext</em> .
</p>

<p>
Pour voir le contenu d&#039;une variable, on utilisera echo (par exemple) :
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="re1">$ma_variable</span></pre>

<p>
renverra : unmot .
</p>

<p>
Pour gérer les espaces et autres caractères spéciaux du shell, on utilisera les guillemets ou bien une notation avec des apostrophes :
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="re1">$ma_variable</span></pre>
<pre class="code bash"><span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$ma_variable</span>&quot;</span></pre>
<pre class="code bash"><span class="kw3">echo</span> <span class="co1">${ma_variable}</span></pre>
<pre class="code bash"><span class="kw3">echo</span> <span class="st0">&quot;<span class="es3">${ma_variable}</span>&quot;</span></pre>

<p>
renverront toutes la même réponse : unmot .
</p>

<p>
Et avec des chemins de répertoires :
</p>
<pre class="code bash"><span class="re2">chemin_de_base</span>=<span class="st0">&quot;/home/username/un repertoire avec espaces&quot;</span>
<span class="re2">chemin_complet</span>=<span class="st0">&quot;<span class="es2">$chemin_de_base</span>/repertoire&quot;</span></pre>
<div class="noteimportant">Comme on le voit ci-dessus si on met une chaîne de caractères avec des espaces entre guillemets, la variable la prend bien mais attention à l&#039;utiliser aussi avec des guillemets… <pre class="code bash">rsync <span class="re5">-av</span> <span class="st0">&quot;<span class="es2">$chemin_complet</span>&quot;</span> …</pre>

<p>
sinon les espaces reprennent leurs rôles de séparateur!
</p>

</div>
<p>
Des variables système permettent d&#039;accélérer la saisie et la compréhension.
Pour voir les variables d&#039;environnement de votre système tapez simplement :
</p>
<pre class="code bash"><span class="kw2">env</span></pre>

<p>
Quelques variables d&#039;environnement à connaître :
HOME, USER, PATH, IFS,…
</p>

<p>
Pour appeler ou voir une variable, par exemple HOME, il suffit de mettre un $ devant, par exemple :
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="re1">$HOME</span></pre>

<p>
Ce petit code va afficher la variable HOME à l&#039;écran.
</p>

<p>
Il existe des variables un peu spéciales :
</p>
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<thead>
	<tr class="row0">
		<th class="col0">Nom</th><th class="col1">fonction</th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0">$*</td><td class="col1"> contient tous les arguments passés à la fonction</td>
	</tr>
	<tr class="row2">
		<td class="col0">$#</td><td class="col1"> contient le nombre d&#039;arguments</td>
	</tr>
	<tr class="row3">
		<td class="col0">$?</td><td class="col1"> contient le code de retour de la dernière opération</td>
	</tr>
	<tr class="row4">
		<td class="col0">$0</td><td class="col1"> contient le nom du script</td>
	</tr>
	<tr class="row5">
		<td class="col0">$n</td><td class="col1"> contient l&#039;argument n, n étant un nombre</td>
	</tr>
	<tr class="row6">
		<td class="col0">$!</td><td class="col1"> contient le PID de la dernière commande lancée</td>
	</tr>
</table></div>

<p>
Exemple : créer le fichier arg.sh avec le contenu qui suit :
</p>
<pre class="code bash"><span class="co0">#!/bin/bash</span>
<span class="kw3">echo</span> <span class="st0">&quot;Nombre d'arguments ... :  &quot;</span><span class="re4">$#</span>
<span class="kw3">echo</span> <span class="st0">&quot;Les arguments sont ... :  &quot;</span><span class="re4">$*</span>
<span class="kw3">echo</span> <span class="st0">&quot;Le second argument est :  &quot;</span><span class="re4">$2</span>
&nbsp;
<span class="kw3">echo</span> <span class="st0">&quot;Et le code de retour du dernier echo est :  &quot;</span><span class="re4">$?</span></pre>

<p>
Lancez ce script avec un ou plusieurs arguments et vous aurez :
</p>
<pre class="code bash">.<span class="sy0">/</span>arg.sh <span class="nu0">1</span> <span class="nu0">2</span> <span class="nu0">3</span>
Nombre d<span class="st_h">'arguments ... :  3
Les arguments sont ... :  1 2 3
Le second argument est :  2
Et le code de retour du dernier echo est :  0</span></pre>

<p>
Exemple: un sleep interactif pour illustrer $! (Cf. <a href="/tutoriel/script_shell#les_fonctions" class="wikilink1 curid" title="tutoriel:script_shell" data-curid="true">les fonctions</a>).<br/>

Pour déclarer un tableau, plusieurs méthodes :<br/>

première méthode (compatible bash, zsh, et ksh93 mais pas ksh88, ni avec dash, qui est lancé par &quot;sh&quot;) :
</p>
<pre class="code bash"><span class="re2">tab</span>=<span class="br0">&#40;</span><span class="st0">&quot;John Smith&quot;</span> <span class="st0">&quot;Jane Doe&quot;</span><span class="br0">&#41;</span></pre>

<p>
ou bien :
</p>
<pre class="code bash">tab<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>=<span class="st_h">'John Smith'</span>
tab<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>=<span class="st_h">'Jane Doe'</span></pre>

<p>
Pour compter le nombre d&#039;éléments du tableau :
</p>
<pre class="code bash"><span class="re2">len</span>=<span class="co1">${#tab[*]}</span> ou <span class="kw3">echo</span> <span class="co1">${#tab[@]}</span></pre>

<p>
Pour afficher un élément :
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="co1">${tab[1]}</span></pre>

<p>
Pour afficher tous les éléments :
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="co1">${tab[@]}</span></pre>

<p>
ou bien (en bash ou en ksh93 mais pas en ksh88) :
</p>
<pre class="code bash"><span class="kw1">for</span> i <span class="kw1">in</span> <span class="co1">${!tab[@]}</span>; <span class="kw1">do</span> <span class="kw3">echo</span> <span class="co1">${tab[i]}</span>; <span class="kw1">done</span></pre>

<p>
ou encore ( C style ) :
</p>
<pre class="code bash"><span class="kw1">for</span> <span class="br0">&#40;</span><span class="br0">&#40;</span> <span class="re2">i</span>=<span class="nu0">0</span>; i <span class="sy0">&lt;</span> <span class="co1">${#tab[@]}</span>; i++ <span class="br0">&#41;</span><span class="br0">&#41;</span>; <span class="kw1">do</span> <span class="kw3">echo</span> <span class="co1">${tab[i]}</span>; <span class="kw1">done</span></pre>

<p>
NB : toutes les variables sont des tableaux. Par défaut, c&#039;est le premier élément qui est appelé :
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="co1">${tab[0]}</span></pre>

<p>
et :
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="co1">${tab}</span></pre>

<p>
renverront la même réponse.
</p>

<p>
NB2 : les tableaux sont séparés par un séparateur défini : l&#039;IFS. 
Par défaut l&#039;IFS est composé des trois caractères : $&#039; \t\n&#039; soit espace, tabulation, saut de ligne. 
Il peut être forcé sur un autre caractère.
</p>
<pre class="code bash"><span class="re2">IFS</span>=<span class="re1">$SEPARATEUR</span></pre>

<p>
$SEPARATEUR pourra être :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> une lettre (pe : n, i,…)</div>
</li>
<li class="level1"><div class="li"> une ponctuation (pe : &#039;,&#039;, &#039;.&#039;, &#039;-&#039;…)</div>
</li>
<li class="level1"><div class="li"> un caractère spécial : ($&#039;\t&#039; : tabulation, $&#039;\n&#039; : saut de ligne,…)</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Les variables] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="les_variables" /><input type="hidden" name="codeblockOffset" value="4" /><input type="hidden" name="range" value="6546-10904" /><button type="submit" title="Les variables" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit7" id="les_arguments_en_ligne_de_commande">Les arguments en ligne de commande</h3>
<div class="level3">

<p>
Pour passer des arguments en ligne de commande c&#039;est encore une fois très simple. Chaque argument est numéroté et ensuite on l&#039;appelle par son numéro :
</p>
<pre class="code"> ./test.sh powa noplay</pre>

<p>
Voici notre test.sh
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="kw3">echo</span> <span class="re4">$3</span>
<span class="kw3">echo</span> <span class="re4">$2</span></pre>

<p>
Notez que $0 est le nom du fichier.
</p>

<p>
<code>shift</code> est une commande très pratique lorsque vous traitez des arguments en ligne de commande. Elle permet de faire &quot;défiler&quot; les arguments ($0, $1, $2, …). C&#039;est à dire que le contenu de $1 passe dans $0, celui de $2 dans $1 et ainsi de suite. Il est tout à fait possible de traiter les arguments avec <code>for i in $*; do</code> mais lorsque vous aurez des options du style <code>–title &quot;mon_titre&quot;</code> il sera très laborieux de récupérer la valeur <code>&quot;mon_titre&quot;</code>.
</p>

<p>
Voici un exemple de script où vous devez vous souvenir de ce que vous avez écrit (un petit jeu de mémoire, quoi) :
 
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="kw2">clear</span> <span class="co0"># Un peu facile si la commande reste au dessus :-)</span>
<span class="kw1">until</span> <span class="br0">&#91;</span> <span class="re4">$#</span> = <span class="nu0">0</span> <span class="br0">&#93;</span>
<span class="kw1">do</span>
  <span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;Taper l'option suivante : &quot;</span>
  <span class="kw2">read</span> Reslt
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$Reslt</span>&quot;</span> = <span class="st0">&quot;$1&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Bien joué !&quot;</span>
  <span class="kw1">else</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Non mais quand même !!! C'ÉTAIT $1 ET NON PAS <span class="es2">$Reslt</span> PETIT FRIPON !!!&quot;</span>
    <span class="kw2">sleep</span> <span class="nu0">3</span> <span class="co0"># Juste pour le fun du script qui rage ;-p</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Donc je te bannis de ubuntu-fr.org ! Et toc !! Tu ne peux rien contre moi !!!&quot;</span>
    <span class="kw3">exit</span> <span class="nu0">1</span>
  <span class="kw1">fi</span>
  <span class="kw3">shift</span> <span class="co0"># On défile</span>
<span class="kw1">done</span>
<span class="kw3">echo</span> <span class="st0">&quot;Vous avez réussi !&quot;</span></pre>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Les arguments en ligne de commande] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="les_arguments_en_ligne_de_commande" /><input type="hidden" name="codeblockOffset" value="27" /><input type="hidden" name="range" value="10905-12343" /><button type="submit" title="Les arguments en ligne de commande" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit8" id="l_arithmetique">L&#039;arithmétique</h3>
<div class="level3">
<pre class="code bash"><span class="br0">&#40;</span><span class="br0">&#40;</span> variable = <span class="nu0">2</span> + <span class="re1">$autre_var</span> <span class="sy0">*</span> <span class="nu0">5</span> <span class="br0">&#41;</span><span class="br0">&#41;</span></pre>

<p>
Exemple: besoin de définir des plages de valeurs (1 à 500 puis 501 à 1000 puis 1001 à 1500…)
</p>
<pre class="code bash">id_per_step = <span class="nu0">500</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="br0">&#40;</span> <span class="re2">i</span>=<span class="nu0">0</span>; i<span class="sy0">&lt;</span><span class="nu0">8</span>; i++ <span class="br0">&#41;</span><span class="br0">&#41;</span>; <span class="kw1">do</span>
	<span class="br0">&#40;</span><span class="br0">&#40;</span> min_step_id = <span class="nu0">1</span> + <span class="re1">$i</span> <span class="sy0">*</span> <span class="re1">$id_per_step</span> <span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="br0">&#40;</span><span class="br0">&#40;</span> max_step_id = <span class="br0">&#40;</span><span class="br0">&#40;</span> <span class="re1">$i</span> + <span class="nu0">1</span> <span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">*</span> <span class="re1">$id_per_step</span> <span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$min_step_id</span> to <span class="es2">$max_step_id</span> &quot;</span>
<span class="kw1">done</span></pre>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[L&#039;arithmétique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="l_arithmetique" /><input type="hidden" name="codeblockOffset" value="29" /><input type="hidden" name="range" value="12344-12724" /><button type="submit" title="L&#039;arithmétique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit9 page-header" id="vocabulaire">Vocabulaire</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Vocabulaire] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="vocabulaire" /><input type="hidden" name="codeblockOffset" value="31" /><input type="hidden" name="range" value="12725-12748" /><button type="submit" title="Vocabulaire" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit10" id="la_commande_test">La commande test</h3>
<div class="level3">

<p>
La commande test existe sous tous les Unix, elle permet de faire un test et de renvoyer 0 si tout s&#039;est bien passé ou 1 en cas d&#039;erreur.
</p>

<p>
En mode console, faites <a href="http://www.bash-linux.com/unix-man-test-francais.html" class="urlextern" title="http://www.bash-linux.com/unix-man-test-francais.html" rel="nofollow"> man test </a> pour connaître tous les opérateurs, en voici quelques-uns :
</p>

</div>

<h4 id="operateurs_de_test_sur_fichiers">Opérateurs de test sur fichiers</h4>
<div class="level4">
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<thead>
	<tr class="row0">
		<th class="col0"> Syntaxe </th><th class="col1"> Fonction réalisée </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> -e fichier      </td><td class="col1 leftalign"> renvoie 0 si fichier existe.                           </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> -d fichier      </td><td class="col1 leftalign"> renvoie 0 si fichier existe et est un répertoire.      </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> -f fichier      </td><td class="col1"> renvoie 0 si fichier existe et est un fichier &#039;normal&#039;.</td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> -w fichier      </td><td class="col1 leftalign"> renvoie 0 si fichier existe et est en écriture.        </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> -x fichier      </td><td class="col1 leftalign"> renvoie 0 si fichier existe et est exécutable.         </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> f1 -nt f2       </td><td class="col1 leftalign"> renvoie 0 si f1 est plus récent que f2.                </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> f1 -ot f2       </td><td class="col1 leftalign"> renvoie 0 si f1 est plus vieux que f2.                 </td>
	</tr>
</table></div>

</div>

<h4 id="operateurs_de_comparaison_numerique">Opérateurs de comparaison numérique</h4>
<div class="level4">
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<thead>
	<tr class="row0">
		<th class="col0"> Syntaxe </th><th class="col1"> Fonction réalisée </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> $A -lt 5         </td><td class="col1"> renvoie 0 si $A est strictement inférieur à 5 </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> $A -le 5         </td><td class="col1"> renvoie 0 si $A est inférieur ou égal à 5 </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> $A -gt 5         </td><td class="col1"> renvoie 0 si $A est strictement supérieur à 5 </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> $A -ge 5         </td><td class="col1"> renvoie 0 si $A est supérieur ou égal à 5 </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> $A -eq 5         </td><td class="col1"> renvoie 0 si $A est égal à 5 </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> $A -ne 5         </td><td class="col1"> renvoie 0 si $A est différent de 5 </td>
	</tr>
</table></div>

</div>

<h4 id="les_crochets">Les crochets</h4>
<div class="level4">

<p>
On peut raccourcir la commande test par des crochets. Exemple :
</p>
<pre class="code bash"><span class="kw3">test</span> <span class="re5">-f</span> <span class="sy0">/</span>etc<span class="sy0">/</span><span class="kw2">passwd</span>
<span class="kw3">echo</span> <span class="re4">$?</span>
<span class="nu0">0</span>
<span class="br0">&#91;</span> <span class="re5">-f</span> <span class="sy0">/</span>etc<span class="sy0">/</span><span class="kw2">passwd</span> <span class="br0">&#93;</span> 
<span class="kw3">echo</span> <span class="re4">$?</span>
<span class="nu0">0</span></pre>

<p>
Affichera la valeur 0 : ce fichier existe, 1 dans le cas où le fichier /etc/passwd n&#039;existe pas. Sous Unix, le code de retour est par convention et en général 0 s&#039;il n&#039;y a aucune erreur et différent de 0 dans les autres cas.
</p>

<p>
La syntaxe la plus appropriée dans de la programmation shell moderne est le double crochet :
</p>
<pre class="code bash"><span class="br0">&#91;</span><span class="br0">&#91;</span> <span class="re5">-f</span> <span class="sy0">/</span>etc<span class="sy0">/</span><span class="kw2">passwd</span> <span class="br0">&#93;</span><span class="br0">&#93;</span></pre>

<p>
Cela gère bien mieux les problèmes d&#039;espaces dans les noms de fichiers, les erreurs etc… C&#039;est une structure <del>propre à</del> bash (ksh, ?) qui est le shell par défaut dans la plupart des distributions Linux, et de Ubuntu en particulier. On garde en général des simples crochets pour les scripts shell qui doivent être à tout prix POSIX ( utilisation sur des Unix sans installation préalable de bash, comme <abbr title="Berkeley Software Distribution">BSD</abbr>, Solaris… ) .
</p>

</div>

<h4 id="les_operateurs_logiques">Les opérateurs logiques</h4>
<div class="level4">

<p>
Il y a en 3 :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> le <strong>et</strong> logique : -a</div>
</li>
<li class="level1"><div class="li"> le <strong>ou</strong> logique : -o</div>
</li>
<li class="level1"><div class="li"> le <strong>non</strong> logique : !</div>
</li>
</ul>

<p>
Exemple :
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="st0">&quot;renverra 0 si les deux expressions sont vraies&quot;</span>
<span class="kw3">test</span> expr1 <span class="re5">-a</span> expr2  
<span class="br0">&#91;</span> expr1 <span class="re5">-a</span> expr2 <span class="br0">&#93;</span></pre>

</div>

<h5 id="table_de_verite_de_-a">Table de vérité de « -a »</h5>
<div class="level5">
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<thead>
	<tr class="row0">
		<th class="col0"> Comparaison </th><th class="col1"> Résultat </th><th class="col2"> Calcul </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> 0 et 0 </td><td class="col1"> 0 </td><td class="col2"> 0 × 0 = 0 </td>
	</tr>
	<tr class="row2">
		<td class="col0"> 0 et 1 </td><td class="col1"> 0 </td><td class="col2"> 0 × 1 = 0 </td>
	</tr>
	<tr class="row3">
		<td class="col0"> 1 et 0 </td><td class="col1"> 0 </td><td class="col2"> 1 × 0 = 0 </td>
	</tr>
	<tr class="row4">
		<td class="col0"> 1 et 1 </td><td class="col1"> 1 </td><td class="col2"> 1 × 1 = 1 </td>
	</tr>
</table></div>

<p>
Les deux assertions doivent être vérifiées pour que la condition le soit aussi.
</p>

</div>

<h5 id="table_de_verite_de_-o">Table de vérité de « -o »</h5>
<div class="level5">
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<thead>
	<tr class="row0">
		<th class="col0"> Comparaison </th><th class="col1"> Résultat </th><th class="col2"> Calcul </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> 0 ou 0 </td><td class="col1"> 0 </td><td class="col2"> 0 + 0 = 0 </td>
	</tr>
	<tr class="row2">
		<td class="col0"> 0 ou 1 </td><td class="col1"> 1 </td><td class="col2"> 0 + 1 = 1 </td>
	</tr>
	<tr class="row3">
		<td class="col0"> 1 ou 0 </td><td class="col1"> 1 </td><td class="col2"> 1 + 0 = 1 </td>
	</tr>
	<tr class="row4">
		<td class="col0"> 1 ou 1 </td><td class="col1"> 1 </td><td class="col2"> 1 + 1 = 1 </td>
	</tr>
</table></div>

<p>
Dès que l&#039;une des deux assertions est vérifiée, la condition globale l&#039;est aussi.
</p>

<p>
Exemple plus complet :
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
&nbsp;
<span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;Entrez un nom de fichier: &quot;</span>
<span class="kw2">read</span> <span class="kw2">file</span>
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re5">-e</span> <span class="st0">&quot;<span class="es2">$file</span>&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
        <span class="kw3">echo</span> <span class="st0">&quot;Le fichier existe!&quot;</span>
<span class="kw1">else</span>
        <span class="kw3">echo</span> <span class="st0">&quot;Le fichier n'existe pas, du moins n'est pas dans le répertoire d'exécution du script&quot;</span>
<span class="kw1">fi</span></pre>

<p>
La seule chose qui prête à confusion est que l&#039;on vérifie seulement si le fichier « file » est dans le répertoire où le script a été exécuté.
</p>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[La commande test] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="la_commande_test" /><input type="hidden" name="codeblockOffset" value="31" /><input type="hidden" name="range" value="12749-16355" /><button type="submit" title="La commande test" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit15" id="la_structureif">La structure : `if`</h3>
<div class="level3">

<p>
Avant de commencer à faire des scripts de 1000 lignes, il serait intéressant
de voir comment se servir des variables, et des instructions <code>if</code>, <code>then</code>, <code>elif</code>, <code>else</code>, <code>fi</code>. Cela permet par exemple de faire réagir le script de manière différente, selon la réponse de l&#039;utilisateur à une question.
</p>

<p>
En bash, les variables ne se déclarent généralement pas avant leur utilisation, on les utilise directement et elles sont créées lors de sa première mise en œuvre.
</p>

<p>
Pour pouvoir voir la valeur d&#039;une variable il faut faire précéder son nom du caractère « $ ».
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;Voulez-vous voir la liste des fichiers Y/N : &quot;</span>
<span class="kw2">read</span> ouinon
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$ouinon</span>&quot;</span> = <span class="st0">&quot;y&quot;</span> <span class="br0">&#93;</span> <span class="sy0">||</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$ouinon</span>&quot;</span> = <span class="st0">&quot;Y&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Liste des fichiers :&quot;</span>
    <span class="kw2">ls</span> <span class="re5">-la</span>
<span class="kw1">elif</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$ouinon</span>&quot;</span> = <span class="st0">&quot;n&quot;</span> <span class="br0">&#93;</span> <span class="sy0">||</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$ouinon</span>&quot;</span> = <span class="st0">&quot;N&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Ok, bye! &quot;</span>
<span class="kw1">else</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Il faut taper Y ou N!! Pas <span class="es2">$ouinon</span>&quot;</span>
<span class="kw1">fi</span></pre>

</div>

<h4 id="explication">Explication</h4>
<div class="level4">

<p>
Ce script peut paraître simple à première vue mais certaines
choses prêtent à confusion et ont besoin d&#039;être expliquées en détail.
</p>

<p>
Tout abord, le <code>`echo -n`</code> permet de laisser le curseur sur la même ligne, ce
qui permet à l&#039;utilisateur de taper la réponse après la question (question
d&#039;esthétique).
</p>

<p>
L&#039;instruction <code>`read`</code> permet d&#039;affecter une valeur ou un caractère à une variable quelconque, en la demandant à l&#039;utilisateur.
</p>
<div class="noteclassic">En bash, la variable est considérée comme une chaîne même si celle-ci contient une valeur numérique, et les majuscules sont considérées différentes des minuscules, $M ≠ $m.
</div>
<p>
Ensuite vient l&#039;instruction conditionnelle `if`. Elle est suivie d&#039;un « [ »
pour délimiter la condition. La condition doit bien être séparée des crochets par un espace ! Attention, la variable est mise entre guillemets
car dans le cas où la variable est vide, le shell ne retourne pas d&#039;erreur, mais en cas contraire, l&#039;erreur produite ressemble à :
</p>
<pre class="code">[: =: unaryoperator expected</pre>

<p>
L&#039;opérateur <code>`||`</code> signifie exécuter la commande suivante si la commande précédente n&#039;a pas renvoyé 0. Il existe aussi l&#039;opérateur <code>&amp;&amp;</code> qui exécute la commande suivante si la commande précédente a renvoyé 0, et enfin <code>;</code> qui exécute l&#039;opération suivante dans tous les cas.
</p>

<p>
Exemple :
créer le répertoire toto s&#039;il n&#039; existe pas
</p>
<pre class="code bash"><span class="br0">&#91;</span> <span class="sy0">!</span> <span class="re5">-d</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>toto <span class="br0">&#93;</span> <span class="sy0">&amp;&amp;</span> <span class="kw2">mkdir</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>toto
<span class="br0">&#91;</span> <span class="re5">-d</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>toto <span class="br0">&#93;</span> <span class="sy0">||</span> <span class="kw2">mkdir</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>toto
<span class="kw3">test</span> <span class="sy0">!</span> <span class="re5">-d</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>toto <span class="sy0">&amp;&amp;</span> <span class="kw2">mkdir</span>  <span class="sy0">/</span>tmp<span class="sy0">/</span>toto
<span class="kw2">rm</span> <span class="re5">-rf</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>toto;<span class="kw2">mkdir</span> <span class="sy0">/</span>tmp<span class="sy0">/</span>toto</pre>

<p>
Les « { » servent à bien délimiter le bloc d&#039;instructions suivant le <code>`then`</code>, est une commande et donc si elle est sur la même ligne que le <code>`if`</code> les deux commandes doivent être séparées par un <code>`;`</code>
</p>

<p>
Ensuite, <code>`elif`</code> sert à exécuter une autre série d&#039;instructions, si la condition décrite par <code>`if`</code> n&#039;est pas respectée, et si celle fournie après ce <code>`elif`</code> l&#039;est.
</p>

<p>
Enfin, <code>`else`</code> sert à exécuter un bloc si les conditions précédentes ne sont pas respectées (ah les jeunes, ils respectent plus rien de nos jours <img src="/lib/images/smileys/icon_smile.gif" class="icon" alt=":-)" />).
</p>

<p>
<code>`fi`</code> indique la fin de notre bloc d&#039;instructions <code>`if`</code>. Cela permet de voir où se termine la portion de code soumise à une condition.
</p>

<p>
Quelques petites commandes pratiques :
</p>
<pre class="code">sh -n nom_du_fichier</pre>

<p>
ou
</p>
<pre class="code">bash -x chemin_du_fichier</pre>

<p>
Cette commande vérifie la syntaxe de toutes les commandes du script, pratique quand on débute et pour les codes volumineux.
</p>
<pre class="code">sh -u nom_du_fichier</pre>

<p>
Celle-ci sert à montrer les variables qui n&#039;ont pas été utilisées pendant l&#039;exécution du programme.
</p>

<p>
Voici le tableau des opérateurs de comparaison, ceux-ci peuvent s&#039;avérer utiles pour diverses raisons, nous verrons un peu plus loin un exemple.
</p>
<pre class="code bash"><span class="re1">$A</span> = <span class="re1">$B</span> <span class="co0"># Vérifie si les deux chaînes sont égales.</span>
&nbsp;
<span class="re1">$A</span> <span class="sy0">!</span>= <span class="re1">$B</span> <span class="co0"># Vérifie si les deux chaînes sont différentes.</span>
&nbsp;
<span class="re5">-z</span> <span class="re1">$A</span> <span class="co0"># Vérifie si A n'existe pas (ne contient pas de chaîne).</span>
&nbsp;
<span class="re5">-n</span> <span class="re1">$A</span> <span class="co0"># Vérifie si A existe (contient une chaîne).</span></pre>

</div>
<div class='secedit editbutton_section editbutton_15'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[La structure : `if`] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="la_structureif" /><input type="hidden" name="codeblockOffset" value="35" /><input type="hidden" name="range" value="16356-20328" /><button type="submit" title="La structure : `if`" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit16" id="les_structures_while_et_until">Les structures while et until</h3>
<div class="level3">

<p>
La commande <code>while</code> exécute ce qu&#039;il y a dans son bloc<em class="u"> tant que</em> la condition
est respectée :
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
&nbsp;
<span class="re2">cmpt</span>=<span class="nu0">1</span>
<span class="re2">cm</span>=<span class="nu0">3</span>
<span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;Mot de passe : &quot;</span>
<span class="kw2">read</span> mdp
&nbsp;
<span class="kw1">while</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$mdp</span>&quot;</span> <span class="sy0">!</span>= <span class="st0">&quot;ubuntu&quot;</span> <span class="br0">&#93;</span> <span class="sy0">&amp;&amp;</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$cmpt</span>&quot;</span> <span class="sy0">!</span>= <span class="nu0">4</span> <span class="br0">&#93;</span>
<span class="kw1">do</span>
     <span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;Mauvais mot de passe, plus que &quot;</span><span class="re1">$cm</span><span class="st0">&quot; chance(s): &quot;</span>
     <span class="kw2">read</span> mdp
     <span class="re2">cmpt</span>=$<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re1">$cmpt</span>+<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
     <span class="re2">cm</span>=$<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re1">$cm</span>-<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">done</span>
<span class="kw3">echo</span> <span class="st0">&quot;Non mais, le brute-force est interdit en France !!&quot;</span></pre>

<p>
On retrouve des choses déjà abordées avec `if`.
Le `&amp;&amp;` sert à symboliser un &quot;et&quot;, cela implique que deux conditions sont
à respecter. Le `do` sert à exécuter ce qui suit si la condition est respectée.
Si elle ne l&#039;est pas, cela saute tout le bloc (jusqu&#039;à `done`).
Vous allez dire :
</p>
<div class="noteclassic">Mais qu&#039;est-ce que c&#039;est ce truc avec cette syntaxe bizarre au milieu ?
</div>
<p>
Cette partie du code sert tout simplement à réaliser
une opération arithmétique. A chaque passage,
&#039;cmpt = cmpt+1&#039; et &#039;cm = cm-1&#039;.
</p>

<p>
`while` permet de faire exécuter la portion de code un nombre indéterminé de fois.
La commande `until` fait la même chose que la commande `while` mais en inversant.
C&#039;est-à-dire qu&#039;elle exécute le bloc jusqu&#039;à ce que la condition soit vraie, donc elle
s&#039;emploie exactement comme la commande `while`.
</p>

<p>
Par exemple, si on a besoin d&#039;attendre le démarrage de notre window manager pour exécuter des commandes dans notre Xsession il sera plus intéressant d&#039;utiliser le `until`:
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="kw1">until</span> <span class="kw2">pidof</span> wmaker 
<span class="kw1">do</span>
  <span class="kw2">sleep</span> <span class="nu0">1</span>
<span class="kw1">done</span>
xmessage <span class="st0">&quot;Session loaded&quot;</span> <span class="re5">-buttons</span> <span class="st0">&quot;Continue&quot;</span>:<span class="nu0">0</span>,<span class="st0">&quot;That all&quot;</span>:<span class="nu0">1</span>;
<span class="br0">&#91;</span> <span class="re4">$?</span> <span class="re5">-eq</span> <span class="nu0">0</span> <span class="br0">&#93;</span> <span class="sy0">&amp;&amp;</span> xmessage <span class="st0">&quot;Load more...&quot;</span></pre>

<p>
Mais on aurait pu aussi faire:
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="kw1">while</span> <span class="br0">&#91;</span> <span class="re5">-z</span> $<span class="br0">&#40;</span><span class="kw2">pidof</span> wmaker<span class="br0">&#41;</span> <span class="br0">&#93;</span>
<span class="kw1">do</span>
 <span class="kw2">sleep</span> <span class="nu0">1</span>
<span class="kw1">done</span> 
<span class="co0">#(...)</span></pre>

</div>
<div class='secedit editbutton_section editbutton_16'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Les structures while et until] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="les_structures_while_et_until" /><input type="hidden" name="codeblockOffset" value="38" /><input type="hidden" name="range" value="20329-22077" /><button type="submit" title="Les structures while et until" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit17" id="la_structure_case">La structure case</h3>
<div class="level3">

<p>
Regardons la syntaxe de cette commande, qui n&#039;est pas une des plus simples :
</p>
<pre class="code bash"><span class="kw1">case</span> variable <span class="kw1">in</span>
    modèle <span class="br0">&#91;</span> <span class="sy0">|</span> modèle<span class="br0">&#93;</span> ...<span class="br0">&#41;</span> instructions<span class="sy0">;;</span>
    modèle <span class="br0">&#91;</span> <span class="sy0">|</span> modèle<span class="br0">&#93;</span> ...<span class="br0">&#41;</span> instructions<span class="sy0">;;</span>
      ...
<span class="kw1">esac</span></pre>

<p>
Cela peut paraître complexe mais on s&#039;y habitue quand on l&#039;utilise.
</p>
<blockquote><div class="no">
Mais à quoi sert cette commande ?</div></blockquote>

<p>
Elle sert à comparer le contenu d&#039;une variable à des modèles différents. Les ;; sont indipensables car il est possible de placer plusieurs instructions entre un modèle et le
suivant. Les ;; servent donc à identifier clairement la fin d&#039;une instruction et
le début du modèle suivant.
</p>

<p>
Exemple :
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
&nbsp;
<span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;Êtes-vous fatigué ? &quot;</span>
<span class="kw2">read</span> on
&nbsp;
<span class="kw1">case</span> <span class="st0">&quot;<span class="es2">$on</span>&quot;</span> <span class="kw1">in</span>
    oui <span class="sy0">|</span> o <span class="sy0">|</span> O <span class="sy0">|</span> Oui <span class="sy0">|</span> OUI <span class="br0">&#41;</span> <span class="kw3">echo</span> <span class="st0">&quot;Allez faire du café !&quot;</span><span class="sy0">;;</span>
    non <span class="sy0">|</span> n <span class="sy0">|</span> N <span class="sy0">|</span> Non <span class="sy0">|</span> NON <span class="br0">&#41;</span> <span class="kw3">echo</span> <span class="st0">&quot;Programmez !&quot;</span><span class="sy0">;;</span>
    <span class="sy0">*</span> <span class="br0">&#41;</span> <span class="kw3">echo</span> <span class="st0">&quot;Ah bon ?&quot;</span><span class="sy0">;;</span>
<span class="kw1">esac</span></pre>

<p>
La seule chose qui mérite vraiment d&#039;être expliquée est sans doute `* )`.
Cela indique tout simplement l&#039;action à exécuter si la réponse donnée n&#039;est aucune de celles données précédemment.
</p>

<p>
Il existe aussi plusieurs structures pour les modèles, telles que :
</p>
<pre class="code bash"><span class="kw1">case</span> <span class="st0">&quot;<span class="es2">$truc</span>.....&quot;</span> <span class="kw1">in</span>
    <span class="br0">&#91;</span>nN<span class="br0">&#93;</span> <span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw3">echo</span> <span class="st0">&quot;Blablabla...&quot;</span><span class="sy0">;;</span>
    n<span class="sy0">*</span> <span class="sy0">|</span> N<span class="sy0">*</span> <span class="br0">&#41;</span> <span class="kw3">echo</span> <span class="st0">&quot;Bla....&quot;</span><span class="sy0">;;</span></pre>

<p>
Et plein d&#039;autres encore…
</p>

</div>

<h4 id="on_melange_tout_ca">On mélange tout ça</h4>
<div class="level4">

<p>
Pour vous donner une idée précise de ce que peuvent réaliser toutes ces instructions,
voici un petit script censé refaire un prompt avec quelques commandes basiques :
</p>
<pre class="code bash"><span class="co0">#!/bin/bash</span>
&nbsp;
<span class="kw2">clear</span>
<span class="kw3">echo</span> 
<span class="kw3">echo</span> <span class="st0">&quot;#################### Script ############################&quot;</span>
<span class="kw3">echo</span> 
<span class="kw3">echo</span> <span class="st0">&quot;#############################&quot;</span>
<span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;LOGIN: &quot;</span>
<span class="kw2">read</span> <span class="kw2">login</span>
<span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;Hôte: &quot;</span>
<span class="kw2">read</span> hote
<span class="kw3">echo</span> <span class="st0">&quot;#############################&quot;</span>
<span class="kw3">echo</span>
<span class="kw3">echo</span> <span class="st0">&quot;### Pour l'aide tapez help ###&quot;</span>
<span class="kw3">echo</span> 
<span class="kw1">while</span> <span class="br0">&#91;</span> <span class="nu0">1</span> <span class="br0">&#93;</span>; <span class="kw1">do</span>                                 <span class="co0"># permet une boucle infinie</span>
<span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;&quot;</span><span class="re1">$login</span><span class="st0">&quot;@&quot;</span><span class="re1">$hote</span><span class="st0">&quot;$ &quot;</span>                    <span class="co0"># qui s'arrête avec break</span>
<span class="kw2">read</span> reps
&nbsp;
<span class="kw1">case</span> <span class="re1">$reps</span> <span class="kw1">in</span>
  <span class="kw3">help</span> <span class="sy0">|</span> hlp <span class="br0">&#41;</span>
     <span class="kw3">echo</span> <span class="st0">&quot;À propos de TS --&gt; about&quot;</span>
     <span class="kw3">echo</span> <span class="st0">&quot;ls --&gt; liste les fichiers&quot;</span>
     <span class="kw3">echo</span> <span class="st0">&quot;rm --&gt; détruit un fichier (guidé)&quot;</span>
     <span class="kw3">echo</span> <span class="st0">&quot;rmd --&gt; efface un dossier (guidé)&quot;</span>
     <span class="kw3">echo</span> <span class="st0">&quot;noyau --&gt; version du noyau Linux&quot;</span>
     <span class="kw3">echo</span> <span class="st0">&quot;connect --&gt; savoir qui s'est connecté dernièrement&quot;</span><span class="sy0">;;</span>
  <span class="kw2">ls</span> <span class="br0">&#41;</span>
     <span class="kw2">ls</span> <span class="re5">-la</span><span class="sy0">;;</span>
  <span class="kw2">rm</span> <span class="br0">&#41;</span>
     <span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;Quel fichier voulez-vous effacer : &quot;</span>
     <span class="kw2">read</span> eff
     <span class="kw2">rm</span> <span class="re5">-f</span> <span class="re1">$eff</span><span class="sy0">;;</span>
  rmd <span class="sy0">|</span> <span class="kw2">rmdir</span> <span class="br0">&#41;</span>
     <span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;Quel répertoire voulez-vous effacer : &quot;</span>
     <span class="kw2">read</span> eff
     <span class="kw2">rm</span> <span class="re5">-r</span> <span class="re1">$eff</span><span class="sy0">;;</span>
  noyau <span class="sy0">|</span> <span class="st0">&quot;uname -r&quot;</span> <span class="br0">&#41;</span>
     <span class="kw2">uname</span> <span class="re5">-r</span><span class="sy0">;;</span>
  connect <span class="br0">&#41;</span>
     <span class="kw2">last</span><span class="sy0">;;</span>
  about <span class="sy0">|</span> <span class="re5">--v</span> <span class="sy0">|</span> vers <span class="br0">&#41;</span>
     <span class="kw3">echo</span> <span class="st0">&quot;Script simple pour l'initiation aux scripts shell&quot;</span><span class="sy0">;;</span>
  quit <span class="sy0">|</span> <span class="st0">&quot;exit&quot;</span> <span class="br0">&#41;</span>
     <span class="kw3">echo</span> Au revoir<span class="sy0">!!</span>
     <span class="kw3">break</span><span class="sy0">;;</span>
  <span class="sy0">*</span> <span class="br0">&#41;</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Commande inconnue&quot;</span><span class="sy0">;;</span>
<span class="kw1">esac</span>
<span class="kw1">done</span></pre>

</div>

<h4 id="remarque">Remarque</h4>
<div class="level4">

<p>
Comme vous l&#039;avez remarqué, l&#039;indentation a une place importante dans
ce programme. En effet, celui-ci est plus lisible et cela évite aussi de faire
des erreurs. C&#039;est pourquoi il est préférable de bien structurer le code que vous
écrivez.
</p>

</div>
<div class='secedit editbutton_section editbutton_17'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[La structure case] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="la_structure_case" /><input type="hidden" name="codeblockOffset" value="41" /><input type="hidden" name="range" value="22078-25077" /><button type="submit" title="La structure case" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit18" id="la_structure_for">La structure for</h3>
<div class="level3">

<p>
L&#039;instruction `for` exécute ce qui est dans son bloc un nombre de fois prédéfini. Sa syntaxe est la suivante :
</p>
<pre class="code bash"><span class="kw1">for</span> variable <span class="kw1">in</span> valeurs; <span class="kw1">do</span>
    instructions
<span class="kw1">done</span></pre>

<p>
ou le classique:
</p>
<pre class="code bash"><span class="kw1">for</span> <span class="br0">&#40;</span><span class="br0">&#40;</span> <span class="re2">i</span>=<span class="re1">$min</span>; i<span class="sy0">&lt;</span>=<span class="re1">$max</span>; i++ <span class="br0">&#41;</span><span class="br0">&#41;</span>; <span class="kw1">do</span>
    instructions_avec_i <span class="co0"># ou pas</span>
<span class="kw1">done</span></pre>

<p>
Comme vous l&#039;aurez sans doute remarqué, on assigne une valeur différente à <em>variable</em> à chaque itération. On peut aussi très facilement utiliser des fichiers comme &quot;valeur&quot;.<br/>

Rien ne vaut un exemple :
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="kw1">for</span> var <span class="kw1">in</span> <span class="sy0">*</span>.txt; <span class="kw1">do</span>
    <span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$var</span>&quot;</span>
<span class="kw1">done</span> </pre>

<p>
On peut voir une syntaxe un peu particulière :
</p>
<pre class="code bash"><span class="co4">$</span><span class="br0">&#40;</span><span class="kw2">sort</span> <span class="sy0">*</span>.txt<span class="br0">&#41;</span></pre>

<p>
Ceci sert à indiquer que ce qui est entre les parenthèses est une commande à exécuter.
</p>

<p>
On peut aussi utiliser cette instruction simplement avec des nombres, cela permet de connaître le nombre d&#039;itérations :
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="kw1">for</span> var <span class="kw1">in</span> <span class="nu0">1</span> <span class="nu0">2</span> <span class="nu0">3</span> <span class="nu0">4</span> <span class="nu0">5</span> <span class="nu0">6</span> <span class="nu0">7</span> <span class="nu0">8</span> <span class="nu0">9</span>; <span class="kw1">do</span>
    <span class="kw3">echo</span> <span class="re1">$var</span>
<span class="kw1">done</span> </pre>

<p>
On peut très bien aussi utiliser d&#039;autres types de variables, comme par exemple des chaînes de caractères :
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
<span class="kw1">for</span> var <span class="kw1">in</span> Ubuntu Breezy <span class="nu0">5.10</span>; <span class="kw1">do</span>
    <span class="kw3">echo</span> <span class="re1">$var</span>
<span class="kw1">done</span> </pre>

<p>
Il faut quand même faire attention au fait que <em>Ubuntu Breezy 5.10</em> est différent de <em>&quot;Ubuntu Breezy 5.10&quot;</em> dans ce cas. En effet, tous les mots placés entre &quot;&quot; sont considérés comme faisant partie de la même chaîne de caractères. Sans les &quot;&quot;, sh considèrera qu&#039;il y a une liste de trois chaînes de caractères.
</p>

</div>
<div class='secedit editbutton_section editbutton_18'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[La structure for] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="la_structure_for" /><input type="hidden" name="codeblockOffset" value="45" /><input type="hidden" name="range" value="25078-26587" /><button type="submit" title="La structure for" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit19" id="les_fonctions">Les fonctions</h3>
<div class="level3">

<p>
Les fonctions sont indispensables pour bien structurer un programme mais aussi pouvoir le simplifier, créer une tâche, la rappeler… Voici la syntaxe générale de &#039;déclaration&#039; d&#039;une fonction :
</p>
<pre class="code bash">nom_fonction<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
  instructions
<span class="br0">&#125;</span></pre>

<p>
Cette partie ne fait rien en elle même, elle dit juste que quand on appellera nom_fonction, elle fera instruction. Pour appeler une fonction (qui ne possède pas d&#039;argument, voir plus loin) rien de plus simple :
</p>
<pre class="code">nom_fonction</pre>

<p>
Rien ne vaut un petit exemple :
</p>
<pre class="code bash"><span class="co0">#!/bin/sh</span>
&nbsp;
<span class="co0">#Definition de ma fonction</span>
mafonction<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
  <span class="kw3">echo</span> <span class="st_h">'La liste des fichiers de ce répertoire'</span>
  <span class="kw2">ls</span> <span class="re5">-l</span>
<span class="br0">&#125;</span>
<span class="co0">#fin de la définition de ma fonction</span>
&nbsp;
<span class="kw3">echo</span> <span class="st_h">'Vous allez voir la liste des fichiers de ce répertoire:'</span>
mafonction       <span class="co0">#appel de ma fonction</span></pre>

<p>
Comme vous l&#039;avez sans doute remarqué, quand on appelle la fonction, on exécute simplement ce qu&#039;on lui a défini au début, dans notre exemple, echo… et ls -l, on peut donc faire exécuter n&#039;importe quoi à une fonction. 
</p>

<p>
Les fonctions peuvent être définies n&#039;importe où dans le code du moment qu&#039;elles sont définies avant d&#039;être utilisées. Même si en bash les variables sont globales, il est possible de les déclarer comme locales au sein d&#039;une fonction en la précédant du mot clé local: local ma_fonction .
</p>

<p>
Exemple: un sleep interactif :
</p>
<pre class="code bash"><span class="co0">#!/bin/bash</span>
info<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
        <span class="kw3">echo</span> <span class="re5">-e</span> <span class="st0">&quot;$1<span class="es1">\n</span>Bye&quot;</span>
        <span class="kw3">exit</span>
<span class="br0">&#125;</span>
<span class="kw3">test</span> <span class="re5">-z</span> <span class="st0">&quot;$1&quot;</span> <span class="sy0">&amp;&amp;</span> info <span class="st0">&quot;requiert 1 argument pour le temps d'attente...&quot;</span> <span class="sy0">||</span> <span class="re2">PRINT</span>=$<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re4">$1</span><span class="sy0">*</span><span class="nu0">500</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw3">test</span> <span class="re5">-z</span> $<span class="br0">&#40;</span><span class="kw3">echo</span> <span class="st0">&quot;$1&quot;</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-e</span> <span class="st0">&quot;^[0-9]*$&quot;</span><span class="br0">&#41;</span> <span class="sy0">&amp;&amp;</span> info <span class="st0">&quot;'$1' est un mauvais argument&quot;</span>
<span class="kw3">test</span> <span class="re4">$1</span> <span class="re5">-gt</span> <span class="nu0">0</span> <span class="sy0">||</span> info <span class="st0">&quot;Je ne prends que les entiers &gt; 0&quot;</span>
print_until_sleep<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
         <span class="kw3">local</span> <span class="re2">COUNT</span>=<span class="nu0">0</span>
         <span class="kw1">while</span> <span class="br0">&#91;</span> <span class="re5">-d</span> <span class="sy0">/</span>proc<span class="sy0">/</span><span class="re4">$1</span> <span class="br0">&#93;</span>; <span class="kw1">do</span>
&nbsp;
                  <span class="kw3">test</span> $<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re1">$COUNT</span><span class="sy0">%</span><span class="re4">$2</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="re5">-eq</span> <span class="nu0">0</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">echo</span> <span class="re5">-n</span> <span class="st0">&quot;*&quot;</span>
                  <span class="re2">COUNT</span>=$<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re1">$COUNT</span>+<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
         <span class="kw1">done</span>
<span class="br0">&#125;</span>
<span class="kw2">sleep</span> <span class="re4">$1</span> <span class="sy0">&amp;</span> print_until_sleep <span class="re4">$!</span> <span class="re1">$PRINT</span>
<span class="kw3">echo</span> <span class="re5">-e</span> <span class="st0">&quot;<span class="es1">\n</span>Bye&quot;</span></pre>

</div>
<div class='secedit editbutton_section editbutton_19'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Les fonctions] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="les_fonctions" /><input type="hidden" name="codeblockOffset" value="51" /><input type="hidden" name="range" value="26588-28525" /><button type="submit" title="Les fonctions" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit20" id="extraire_des_sous-chaines">Extraire des sous-chaînes</h3>
<div class="level3">

<p>
Pour extraire une chaîne d&#039;une chaîne on utilise : <strong>${ <code>chaîne</code> : <code>position</code> : <code>nombre de caractères</code> }</strong> (n&#039;oubliez pas le <strong>:</strong> qui sépare les &quot;paramètres&quot;).
</p>
<div class="noteimportant">Dans la partie <code>chaîne</code> pour faire référence à une variable <strong>on ne met pas de $</strong> ! Tandis que dans les autres options le $ est nécessaire (sauf si vous n&#039;utilisez pas de variable). Il y a de quoi s’emmêler les pinceaux. Si vous n&#039;avez pas compris (ce n&#039;est pas étonnant), les exemples de cette partie vous aideront beaucoup.
</div>
<p>
Par exemple pour savoir ce que l&#039;on aime manger en fonction de sa langue (vous êtes alors vraiment ultra geek <img src="/lib/images/smileys/icon_eek.gif" class="icon" alt="8-O" /> !) :
</p>
<pre class="code bash"><span class="co0">#!/bin/bash</span>
<span class="co0">#favoritefood</span>
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="co1">${LANG:0:2}</span> = <span class="st0">&quot;fr&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Vous aimez les moules frites !&quot;</span>
<span class="kw1">elif</span> <span class="br0">&#91;</span> <span class="co1">${LANG:0:2}</span> = <span class="st0">&quot;en&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;You love the... pudding !&quot;</span>
<span class="kw1">elif</span> <span class="br0">&#91;</span> <span class="co1">${LANG:0:2}</span> = <span class="st0">&quot;es&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Te gusta el jamón !&quot;</span>    
<span class="kw1">else</span>
    <span class="kw3">echo</span> <span class="st0">&quot;:'-(&quot;</span>
<span class="kw1">fi</span>
<span class="co0">#Noter que $LANG n'a pas le préfixe '$'. ${$LANG:0:2} ne fonctionne pas !</span></pre>

<p>
puis :
</p>
<pre class="code bash">$ .<span class="sy0">/</span>favoritefood
Vous aimez les moules frites <span class="sy0">!</span>
$ <span class="kw2">env</span> <span class="re2">LANG</span>=en .<span class="sy0">/</span>favoritefood
You love the... pudding <span class="sy0">!</span>
$ <span class="kw2">env</span> <span class="re2">LANG</span>=es .<span class="sy0">/</span>favoritefood
Te gusta el jamón <span class="sy0">!</span>
$ <span class="kw2">env</span> <span class="re2">LANG</span>=it .<span class="sy0">/</span>favoritefood
:<span class="st_h">'-(</span></pre>

<p>
Ce code illustre un moyen de faire des scripts multilingues .
</p>

<p>
Une variante permet de tronquer uniquement le début de la chaîne. C&#039;est <strong>${ <code>chaîne</code> : <code>nombre de caractères</code>}</strong> .<br/>

Le tout peut s&#039;illustrer par un (vraiment) petit exemple :
</p>
<pre class="code bash"><span class="co0">#!/bin/bash</span>
<span class="co0">#truncbegin &lt;chaîne&gt; &lt;nombre&gt;</span>
<span class="kw3">echo</span> <span class="co1">${1:$2}</span>
<span class="co0">#Noter bien que echo ${1:2} tronquerait les 2 premiers caractères (et non le nombre indiqué par le 2e paramètre).</span></pre>

<p>
puis :
</p>
<pre class="code bash">$ .<span class="sy0">/</span>truncbegin <span class="st0">&quot;Hello world !&quot;</span> <span class="nu0">5</span>
world <span class="sy0">!</span></pre>

</div>
<div class='secedit editbutton_section editbutton_20'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Extraire des sous-chaînes] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="extraire_des_sous-chaines" /><input type="hidden" name="codeblockOffset" value="54" /><input type="hidden" name="range" value="28526-30303" /><button type="submit" title="Extraire des sous-chaînes" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit21" id="la_couleur">La couleur</h3>
<div class="level3">

<p>
Qui n’a jamais voulu faire un script avec des couleurs pour pouvoir différencier les titres des paramètres et les paramètres de leur valeur par exemple…
</p>

</div>

<h4 id="presentation_de_la_syntaxe">Présentation de la syntaxe</h4>
<div class="level4">

<p>
Comme toute commande sous Linux, il faut utiliser une syntaxe par défaut et y passer quelques paramètres. Pour les couleurs au sein de scripts shell, c’est le même principe.
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="re5">-e</span> <span class="st_h">'\033[A;B;Cm toto \033[0m'</span></pre>

<p>
Dans la commande passée ci-dessus, nous pouvons constater qu’il y a 3 paramètres présents: A, B et C.<br/>

A : correspond à un effet affecté au texte affiché
B : correspond à la couleur du texte
C : identifie la couleur du fond du texte affiché
</p>

<p>
Et enfin on termine notre affichage avec « \033[0m », qui spécifie au terminal de revenir aux couleurs définies par défaut.
</p>

</div>

<h4 id="presentation_des_differentes_valeurs_effet">Présentation des différentes valeurs Effet</h4>
<div class="level4">

<p>
Nous allons commencer par les différents effets possibles :
</p>
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<thead>
	<tr class="row0">
		<th class="col0">Code</th><th class="col1">Effet</th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0">0</td><td class="col1">Normal</td>
	</tr>
	<tr class="row2">
		<td class="col0">1</td><td class="col1"><strong>Gras</strong></td>
	</tr>
	<tr class="row3">
		<td class="col0">21</td><td class="col1">Non-gras</td>
	</tr>
	<tr class="row4">
		<td class="col0">2</td><td class="col1">Sombre</td>
	</tr>
	<tr class="row5">
		<td class="col0">22</td><td class="col1">Non-sombre</td>
	</tr>
	<tr class="row6">
		<td class="col0">3</td><td class="col1"><em>Italique</em></td>
	</tr>
	<tr class="row7">
		<td class="col0">23</td><td class="col1">Non-italique</td>
	</tr>
	<tr class="row8">
		<td class="col0">4</td><td class="col1"><em class="u">Souligné</em></td>
	</tr>
	<tr class="row9">
		<td class="col0">24</td><td class="col1">Non-souligné</td>
	</tr>
	<tr class="row10">
		<td class="col0">5</td><td class="col1">Clignotant</td>
	</tr>
	<tr class="row11">
		<td class="col0">25</td><td class="col1">Non-clignotant</td>
	</tr>
	<tr class="row12">
		<td class="col0">7</td><td class="col1">Inversé</td>
	</tr>
	<tr class="row13">
		<td class="col0">27</td><td class="col1">Non-inversé</td>
	</tr>
	<tr class="row14">
		<td class="col0">8</td><td class="col1">Invisible</td>
	</tr>
	<tr class="row15">
		<td class="col0">28</td><td class="col1">Non-invisible</td>
	</tr>
	<tr class="row16">
		<td class="col0">9</td><td class="col1"><del>Barré</del></td>
	</tr>
	<tr class="row17">
		<td class="col0">29</td><td class="col1">Non-barré</td>
	</tr>
</table></div>

</div>

<h4 id="presentation_des_differentes_valeurs_des_couleurs">Présentation des différentes valeurs des couleurs</h4>
<div class="level4">

<p>
Maintenant que nous avons présenté les différents effets possibles d’attribuer à du texte, nous allons nous attaquer aux couleurs.<br/>

Chaque couleur a 2 valeurs, la première utilisée pour la couleur du texte, et la seconde pour la couleur du fond.
</p>
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<thead>
	<tr class="row0">
		<th class="col0">Couleur</th><th class="col1">Couleur texte</th><th class="col2">Couleur fond</th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0">Noir</td><td class="col1">30</td><td class="col2">40</td>
	</tr>
	<tr class="row2">
		<td class="col0">Rouge</td><td class="col1">31</td><td class="col2">41</td>
	</tr>
	<tr class="row3">
		<td class="col0">Vert</td><td class="col1">32</td><td class="col2">42</td>
	</tr>
	<tr class="row4">
		<td class="col0">Jaune</td><td class="col1">33</td><td class="col2">43</td>
	</tr>
	<tr class="row5">
		<td class="col0">Bleu</td><td class="col1">34</td><td class="col2">44</td>
	</tr>
	<tr class="row6">
		<td class="col0">Magenta</td><td class="col1">35</td><td class="col2">45</td>
	</tr>
	<tr class="row7">
		<td class="col0">Cyan</td><td class="col1">36</td><td class="col2">46</td>
	</tr>
	<tr class="row8">
		<td class="col0">Blanc</td><td class="col1">37</td><td class="col2">47</td>
	</tr>
</table></div>

</div>

<h4 id="exemple">Exemple</h4>
<div class="level4">
<pre class="code bash"><span class="kw3">echo</span> <span class="re5">-e</span> <span class="st_h">'\033[1;30;47m toto \033[0;32m est sur \033[1;33m un bateau \033[0m'</span></pre>

</div>
<div class='secedit editbutton_section editbutton_21'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[La couleur] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="la_couleur" /><input type="hidden" name="codeblockOffset" value="58" /><input type="hidden" name="range" value="30304-32123" /><button type="submit" title="La couleur" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit24 page-header" id="exemples_et_exercices">Exemples et exercices</h2>
<div class="level2">

<p>
Comme indiqué dans la <a href="/tutoriel/script_shell#liens" class="wikilink1 curid" title="tutoriel:script_shell" data-curid="true">section liens</a> de cette page, de très bon exemples et exercices illustrent le cours disponible sur cette page :<br/>

<a href="http://abs.traduc.org/abs-5.3-fr/apm.html" class="urlextern" title="http://abs.traduc.org/abs-5.3-fr/apm.html" rel="nofollow">Guide avancé d&#039;écriture des scripts Bash - Une exploration en profondeur de l&#039;art de la programmation shell</a>
</p>

<p>
Aux structures décrites ci-dessus, il est nécessaire, pour réaliser des scripts poussés, de connaître les commandes shell les plus usitées.<br/>
Vous en trouverez une présentation sur cette autre page du wiki : <a href="/projets/ecole/scripting/initiation_au_shell" class="wikilink1" title="projets:ecole:scripting:initiation_au_shell">initiation_au_shell</a> .
</p>

<p>
La programmation de script shell étant ouverte à tous, cela permet de bénéficier de nombreux scripts pour des applications très variées ; cependant, <strong>la plupart sont proposés sans aucune garantie</strong>.<br/>

Vous pourrez trouver une liste de scripts pouvant servir d&#039;exemples sur la page <a href="/scripts_utiles" class="wikilink1" title="scripts_utiles">scripts utiles</a> du wiki.
</p>

<p>
Une fois vos armes faites, proposez vos contributions sur le topic du forum <a href="http://forum.ubuntu-fr.org/viewtopic.php?id=204074" class="urlextern" title="http://forum.ubuntu-fr.org/viewtopic.php?id=204074" rel="nofollow">[VOS SCRIPTS UTILES]</a> et rajoutez un lien dans la page du wiki ci-dessus.
</p>

</div>
<div class='secedit editbutton_section editbutton_24'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Exemples et exercices] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="exemples_et_exercices" /><input type="hidden" name="codeblockOffset" value="60" /><input type="hidden" name="range" value="32124-33282" /><button type="submit" title="Exemples et exercices" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit25 page-header" id="l_art_d_ecrire_un_script">L&#039;art d&#039;écrire un script</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Des vérifications approfondies doivent être effectuées sur TOUTES les commandes utilisées.</div>
</li>
<li class="level1"><div class="li"> Des commentaires détaillés doivent apparaître lors de chaque étape. De même, chaque étape doit être suivie d&#039;un &quot;echo &lt;voici ce que je fais&gt;&quot; (particulièrement utile notamment lors du débogage).</div>
</li>
<li class="level1"><div class="li"> Lors d&#039;une mise à jour, un fil de discussion doit être précisé pour tracer les bugs éventuels.</div>
</li>
<li class="level1"><div class="li"> Avertir les utilisateurs des dégâts que peuvent causer les commandes utilisées. (Ces deux dernières remarques ne concernent bien sûr que les scripts que l&#039;on souhaite diffuser.)</div>
</li>
<li class="level1"><div class="li"> Commencer par : <pre class="code bash"><span class="co0">#!/bin/bash</span>
<span class="co0"># Version du script</span></pre>
</div>
</li>
<li class="level1"><div class="li"> Créer des fonctions pour des actions précises :<pre class="code bash">nom_de_la_fonction<span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
...
&nbsp;
<span class="br0">&#125;</span></pre>
</div>
</li>
<li class="level1"><div class="li"> Utiliser des chemins absolus pour les dossiers et des chemins relatifs pour les noms de fichiers : <pre class="code bash"><span class="co4">$</span>CHEMIN_DU_DOSSIER<span class="sy0">/</span><span class="re1">$NOM_DU_FICHIER</span></pre>
</div>
</li>
<li class="level1"><div class="li"> Utiliser les entrées de commandes pour les fonctions :<pre class="code bash">nom_de_la_fonction <span class="re4">$1</span> <span class="re4">$2</span> <span class="re4">$3</span> ....</pre>
</div>
</li>
<li class="level1"><div class="li"> Si votre script doit s&#039;arrêter à cause d&#039;une erreur, d&#039;une variable qui ne correspond pas à vos attentes utiliser des numéros exit différents : <pre class="code bash"><span class="kw3">exit</span> <span class="nu0">100</span>;
<span class="kw3">exit</span> <span class="nu0">101</span>;
<span class="kw3">exit</span> <span class="nu0">102</span>;
....</pre>

<p>
Ça permettra d&#039;identifier d&#039;où vient l&#039;erreur.
</p>
</div>
</li>
<li class="level1"><div class="li"> Utiliser le tableau ${PIPESTATUS[@]} pour récupérer les états des autres commandes.</div>
</li>
<li class="level1"><div class="li"> On peut écrire une fonction d&#039;erreur du type : <pre class="code bash">erreur<span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="re2">tab</span>=<span class="br0">&#40;</span> <span class="co1">${PIPESTATUS[@]}</span> <span class="br0">&#41;</span>
&nbsp;
    <span class="kw1">for</span> <span class="br0">&#40;</span><span class="br0">&#40;</span> <span class="re2">i</span>=<span class="nu0">0</span>; i <span class="sy0">&lt;</span> <span class="co1">${#tab[@]}</span>; i++ <span class="br0">&#41;</span><span class="br0">&#41;</span>; <span class="kw1">do</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>i+=i<span class="br0">&#41;</span><span class="br0">&#41;</span>; <span class="kw1">done</span>
&nbsp;
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>i <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#41;</span>; <span class="kw1">then</span>
        zenity <span class="re5">--error</span> <span class="re5">--title</span>=<span class="st0">&quot;Une erreur est survenue&quot;</span> <span class="re5">--text</span>=<span class="st0">&quot;Une erreur est survenue &quot;</span>
        <span class="kw3">exit</span> <span class="nu0">100</span>
    <span class="kw1">fi</span>
<span class="br0">&#125;</span></pre>

<p>
 ainsi après chaque commande vous pouvez donner des codes d&#039;exécutions différents.
</p>
</div>
</li>
</ul>
<div class="notetip">Astuce : le plus important dans tout programme est l&#039;algorithme utilisé.
</div>
<p>
Exemple :
supposons que vous ayez une base de données, avec 3 catégories d&#039;enregistrements possibles :
éléphant bleu, éléphant blanc, éléphant rose ayant chacun 30 individus.
Votre script doit compter le nombre d&#039;éléphants bleus et blancs.
Deux possibilités s&#039;offrent à vous :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> calculer le nombre d&#039;éléphants bleus + éléphants blancs</div>
</li>
</ul>

<p>
ou
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> calculer le nombre total d&#039;éléphants - nombre d&#039;éléphants roses</div>
</li>
</ul>

<p>
Quel algorithme choisissez-vous ?
</p>

<p>
Résultat : le premier car dans le deuxième il faut d&#039;abord calculer le nombre total d&#039;éléphants, donc un calcul en plus <img src="/lib/images/smileys/icon_razz.gif" class="icon" alt=":-P" /> .
</p>

</div>
<div class='secedit editbutton_section editbutton_25'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[L&#039;art d&#039;écrire un script] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="l_art_d_ecrire_un_script" /><input type="hidden" name="codeblockOffset" value="60" /><input type="hidden" name="range" value="33283-35784" /><button type="submit" title="L&#039;art d&#039;écrire un script" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit26 page-header" id="liens">Liens</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> (fr) <a href="http://marcg.developpez.com/ksh/" class="urlextern" title="http://marcg.developpez.com/ksh/" rel="nofollow">http://marcg.developpez.com/ksh/</a> : Pour ceux qui souhaitent aller plus loin dans la conception de script shell.</div>
</li>
<li class="level1"><div class="li"> (fr) <a href="http://abs.traduc.org/abs-fr/" class="urlextern" title="http://abs.traduc.org/abs-fr/" rel="nofollow">Guide avancé d&#039;écriture des scripts Bash</a> : Un très bon tutoriel concernant la réalisation du script shell. C&#039;est l&#039;un des plus complets et les mieux détaillés disponibles en français. Il contient également <a href="http://abs.traduc.org/abs-5.3-fr/apa.html" class="urlextern" title="http://abs.traduc.org/abs-5.3-fr/apa.html" rel="nofollow">des exemples de script complets</a>, une <a href="http://abs.traduc.org/abs-5.3-fr/apb.html" class="urlextern" title="http://abs.traduc.org/abs-5.3-fr/apb.html" rel="nofollow">carte de référence</a> (variables, tests…). Ce site est un site qui vaut réellement le détour pour tous ceux qui cherchent à créer des scripts complets en utilisant au mieux les performances du shell.</div>
</li>
<li class="level1"><div class="li"> (fr) <a href="https://openclassrooms.com/courses/reprenez-le-controle-a-l-aide-de-linux" class="urlextern" title="https://openclassrooms.com/courses/reprenez-le-controle-a-l-aide-de-linux" rel="nofollow">https://openclassrooms.com/courses/reprenez-le-controle-a-l-aide-de-linux</a> : Un tutoriel très complet pour linux qui comporte quelques parties sur la réalisation de scripts bash.</div>
</li>
<li class="level1"><div class="li"> (en) <a href="http://www.ibm.com/developerworks/library/l-bash-parameters.html" class="urlextern" title="http://www.ibm.com/developerworks/library/l-bash-parameters.html" rel="nofollow">Bash parameters and parameter expansions</a>. En anglais mais contient de nombreux exemples concernant la gestion et l&#039;analyse des paramètres.</div>
</li>
<li class="level1"><div class="li"> (fr ) <a href="ftp://ftp-developpez.com/eric-sanchis/IntroProgBash.pdf" class="urlextern" title="ftp://ftp-developpez.com/eric-sanchis/IntroProgBash.pdf" rel="nofollow">Introduction à Bash</a></div>
</li>
<li class="level1"><div class="li"> (fr ) <a href="http://www.scotchlinux.tuxfamily.org/" class="urlextern" title="http://www.scotchlinux.tuxfamily.org/" rel="nofollow">http://www.scotchlinux.tuxfamily.org/</a> exemples de scripts bash, quelques trucs utiles ( fonctions, fonctions comme paramètres… ) </div>
</li>
<li class="level1"><div class="li"> (en) <a href="https://www.shellcheck.net/" class="urlextern" title="https://www.shellcheck.net/" rel="nofollow">https://www.shellcheck.net/</a> Permet de corriger la syntaxe du script (parenthèse oubliée, graphie incorrecte d&#039;une commande, un &quot;if&quot; sans son &quot;fi&quot;, un &quot;while sans son &quot;do&quot; ou son &quot;done&quot;, etc…).</div>
</li>
</ul>
<hr />

<p>
<em>Contributeurs: <a href="/utilisateurs/gapz" class="wikilink2" title="utilisateurs:gapz" rel="nofollow">Gapz</a>, <a href="/utilisateurs/gloubiboulga" class="wikilink2" title="utilisateurs:gloubiboulga" rel="nofollow">Gloubiboulga</a> ,<a href="/utilisateurs/sparky" class="wikilink1" title="utilisateurs:sparky">sparky</a> et <a href="/utilisateurs/deax_one" class="wikilink2" title="utilisateurs:deax_one" rel="nofollow">deax_one</a></em>
</p>

</div>
<div class='secedit editbutton_section editbutton_26'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/script_shell"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1634149598" /><input type="hidden" name="summary" value="[Liens] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="liens" /><input type="hidden" name="codeblockOffset" value="66" /><input type="hidden" name="range" value="35785-" /><button type="submit" title="Liens" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="tutoriel/script_shell.txt">tutoriel/script_shell.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 13/10/2021, 20:26">Le 13/10/2021, 20:26</span></li><li class="text-muted">par Amiralgaby</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=tutoriel%3Ascript_shell&amp;1635936998" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
