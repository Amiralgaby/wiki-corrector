<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>tutoriel:serveur_de_synchronisation_avec_rsync [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="tutoriel,sauvegarde,serveur,synchronisation,systeme,securite"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns=tutoriel"/>
<link rel="edit" title="Modifier cette page" href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/tutoriel/serveur_de_synchronisation_avec_rsync"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/tutoriel/serveur_de_synchronisation_avec_rsync"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/tutoriel/serveur_de_synchronisation_avec_rsync"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='tutoriel';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"tutoriel:serveur_de_synchronisation_avec_rsync","namespace":"tutoriel","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="tutoriel:serveur_de_synchronisation_avec_rsync">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=media&amp;ns=tutoriel"  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">tutoriel:serveur_de_synchronisation_avec_rsync</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/tutoriel/serveur_de_synchronisation_avec_rsync?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#introduction","title":"Introduction","level":1},{"link":"#les_particularites_de_rsync","title":"Les particularit\u00e9s de rsync","level":1},{"link":"#etude_de_cas","title":"\u00c9tude de cas","level":2},{"link":"#configuration_du_serveur_de_synchronisation","title":"Configuration du serveur de synchronisation","level":1},{"link":"#configuration_du_client","title":"Configuration du client","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#introduction">Introduction</a></li>
<li class="level1"><a href="#les_particularites_de_rsync">Les particularités de rsync</a>
<ul class="nav toc">
<li class="level2"><a href="#etude_de_cas">Étude de cas</a></li>
</ul>
</li>
<li class="level1"><a href="#configuration_du_serveur_de_synchronisation">Configuration du serveur de synchronisation</a></li>
<li class="level1"><a href="#configuration_du_client">Configuration du client</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/tutoriel" class="wikilink1" title="tutoriel" rel="tag">tutoriel</a>,
	<a href="/sauvegarde" class="wikilink1" title="sauvegarde" rel="tag">sauvegarde</a>,
	<a href="/serveur" class="wikilink1" title="serveur" rel="tag">serveur</a>,
	<a href="/synchronisation" class="wikilink1" title="synchronisation" rel="tag">synchronisation</a>,
	<a href="/systeme" class="wikilink1" title="systeme" rel="tag">système</a>,
	<a href="/securite" class="wikilink1" title="securite" rel="tag">sécurité</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="serveur_de_synchronisation_avec_rsync">Serveur de synchronisation avec rsync</h1>
<div class="level1">

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/serveur_de_synchronisation_avec_rsync"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1478722303" /><input type="hidden" name="summary" value="[Serveur de synchronisation avec rsync] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="serveur_de_synchronisation_avec_rsync" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="80-131" /><button type="submit" title="Serveur de synchronisation avec rsync" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="introduction">Introduction</h2>
<div class="level2">

<p>
Sur <a href="/rsync" class="wikilink1" title="rsync">rsync</a> voir la page principale à ce sujet : <a href="/rsync" class="wikilink1" title="rsync">rsync</a>.
</p>

<p>
<strong>Pourquoi synchroniser ?</strong>
</p>

<p>
D&#039;un point de vue de l&#039;entreprise, un serveur de synchronisation est utile pour centraliser les sauvegardes sur une même machine équipée accessoirement d&#039;un enregistreur de bande.
</p>

<p>
Pour le particulier, il est intéressant (si vous avez plusieurs machines), d&#039;avoir une sauvegarde simple et rapide de son répertoire home.
</p>

<p>
<strong>rsync</strong> est prévu à cet effet. Il peut même faire plus. Il peut être utilisé <a href="/tutoriel/sauvegarder_home_avec_rsync" class="wikilink1" title="tutoriel:sauvegarder_home_avec_rsync">pour la sauvegarde de &quot;/home&quot;</a>, et dispose d&#039;une interface graphique, <a href="/tutoriel/sauvegarder_home_avec_grsync" class="wikilink1" title="tutoriel:sauvegarder_home_avec_grsync">Grsync</a>. Mais nous allons envisager dans ce tutoriel comment faire une synchronisation entre deux serveurs ; un serveur de production et un serveur de centralisation des backups.
</p>
<div class="noteimportant">Attention : si vous utilisez rsync avec les options <strong>--del</strong> ou <strong>--delete</strong>, et si vous effacez vos données par erreur, rsync transmettra cet effacement sur le serveur de sauvegarde ; vous allez donc perdre vos données. L&#039;emploi de rsync avec ces options d&#039;effacement --del ou --delete n&#039;est pas adapté à ce genre d&#039;utilisation. Ou alors, s&#039;il s&#039;agit de données sensibles, et si vous voulez disposer sur la destination d&#039;un contenu identique à celui de la source (ce que permet l&#039;utilisation d&#039;une option d&#039;effacement comme <strong>--delete</strong>), prévoyez de faire une double sauvegarde sur deux répertoires de destination différents. L&#039;une avec utilisation de --delete ; l&#039;autre sans cette option d&#039;effacement. En cas d&#039;effacement malencontreux de données sur la source, et donc sur le premier répertoire de sauvegarde, vous retrouverez ces données sur le second répertoire de sauvegarde. La prudence recommande de placer ces deux répertoires de sauvegardes sur deux disques durs distincts.
</div>
<p>
Pour une synchronisation de plusieurs dossiers, vous pouvez aller voir aussi du coté de <a href="/unison" class="wikilink1" title="unison">unison</a>.
</p>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/serveur_de_synchronisation_avec_rsync"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1478722303" /><input type="hidden" name="summary" value="[Introduction] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="introduction" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="132-2155" /><button type="submit" title="Introduction" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit3 page-header" id="les_particularites_de_rsync">Les particularités de rsync</h2>
<div class="level2">

<p>
<strong>rsync</strong> est un outil simple disponible sans installation particulière sous Ubuntu et existant pour divers systèmes d&#039;exploitation. La grande particularité de rsync est d&#039;optimiser la bande passante disponible en compressant les données à synchroniser et en ne transférant que les octets modifiés.
</p>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/serveur_de_synchronisation_avec_rsync"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1478722303" /><input type="hidden" name="summary" value="[Les particularités de rsync] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="les_particularites_de_rsync" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="2156-2504" /><button type="submit" title="Les particularités de rsync" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit4" id="etude_de_cas">Étude de cas</h3>
<div class="level3">

<p>
Pour vous donner une idée de l&#039;amélioration que rsync peut apporter, voici quelques tests que nous avons effectués en entreprise sur un serveur de production.
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Masse de données : environ 30 Go</div>
</li>
<li class="level1"><div class="li"> Taux de modification des données : 1% par heure (environ 250 fichiers)</div>
</li>
<li class="level1"><div class="li"> Liaison dédiée 100Mbits entre les deux serveurs.</div>
</li>
<li class="level1"><div class="li"> Temps de synchronisation avec parcours de fichiers : 4h30 (du coup, on ne faisait que 3 synchros par jour).</div>
</li>
<li class="level1"><div class="li"> Temps de synchronisation avec rsync : 22min (quand on le fait 3x par jour, maintenant, on fait 1 synchro par heure avec un temps de synchro de 10min).</div>
</li>
</ul>

<p>
C&#039;était pour la petite histoire, passons maintenant à la configuration du serveur rsync.
</p>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/serveur_de_synchronisation_avec_rsync"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1478722303" /><input type="hidden" name="summary" value="[Étude de cas] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="etude_de_cas" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="2505-3224" /><button type="submit" title="Étude de cas" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit5 page-header" id="configuration_du_serveur_de_synchronisation">Configuration du serveur de synchronisation</h2>
<div class="level2">

<p>
Pour autoriser <strong>rsync</strong> à se lancer, il faut éditer le fichier <code>/etc/default/rsync</code> via la commande :
</p>
<pre class="code">sudo vi /etc/default/rsync</pre>

<p>
et modifier la ligne RSYNC à true
</p>
<pre class="code">RSYNC_ENABLE=true</pre>

<p>
Pour configurer <strong>rsync</strong>, on crée le fichier de configuration de rsync en éditant le fichier <code>/etc/rsyncd.conf</code> via la commande :
</p>
<pre class="code">sudo vi /etc/rsyncd.conf</pre>

<p>
En entête de ce fichier, il faut copier les lignes suivantes :
</p>
<pre class="code">uid = rsync
gid = rsync</pre>

<p>
Le démon rsyncd sera lancé en tant qu&#039;utilisateur rsync, et pourra donc écrire dans les répertoires qui lui seront attribués.
</p>

<p>
Dans ce fichier, on introduit les informations concernant les modules. Un module est une sorte de <em>partage</em> rsync. Dans notre cas, on va créer un module nommé <code>share_rsync</code>.
</p>
<pre class="code">[share_rsync]
   path = /srv/intern
   comment = Synchro fichiers internes
   read only = false</pre>

<p>
Vous pouvez bien entendu créer plusieurs modules de synchronisation. Il existe également d&#039;autres mots clés à utiliser dans le fichier <code>/etc/rsyncd.conf</code> qui permettent l&#039;authentification et d&#039;autres choses. Vous trouverez de plus amples détails en tapant :
</p>
<pre class="code">man rsyncd.conf</pre>

<p>
Ajouter un utilisateur et un groupe <strong>rsync
</strong>
</p>
<pre class="code">sudo useradd rsync
sudo passwd rsync
sudo groupadd rsync
sudo gpasswd -a rsync rsync</pre>

<p>
Attribuer le répertoire de sauvegarde à <strong>rsync</strong>
</p>
<pre class="code">sudo chown -R rsync:rsync /srv/intern</pre>

<p>
Attribuer les droits adéquats au répertoire de sauvegarde
</p>
<pre class="code">sudo chmod -R 775 /srv/intern</pre>

<p>
Pour terminer, lancer rsync sans redémarrage avec la commande :
</p>
<pre class="code">sudo /etc/init.d/rsync start</pre>

<p>
Sur Ubuntu 16.04, on peut lancer le deamon rsync à tous les démarrages du PC en utilisant la commande suivante :
</p>
<pre class="code">sudo systemctl enable rsync.service</pre>

<p>
Le serveur est maintenant prêt pour recevoir les requêtes de synchronisation.
</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/serveur_de_synchronisation_avec_rsync"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1478722303" /><input type="hidden" name="summary" value="[Configuration du serveur de synchronisation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_du_serveur_de_synchronisation" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="3225-5226" /><button type="submit" title="Configuration du serveur de synchronisation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit6 page-header" id="configuration_du_client">Configuration du client</h2>
<div class="level2">

<p>
Les synchronisations du (ou des) client(s) peuvent se faire par le biais de la commande <code>rsync</code>. La syntaxe de cette dernière est relativement simple. Voici la commande que j&#039;utilise :
</p>
<pre class="code">rsync -az --stats --delete --force --ignore-errors --exclude-from=/etc/rsync.exclude /srv/intern 192.168.252.201::share_rsync/</pre>

<p>
Avec cette commande, j&#039;indique que je souhaite supprimer les fichiers (option <code>–delete</code>) qui ne sont plus sur la source (la source dans ce cas-ci est <code>/srv/intern</code>), que je souhaite obtenir des statistiques quant à la vitesse de transfert (option <code>–stats</code>) et que je souhaite exclure les fichiers listés dans <strong>/etc/rsync.exclude</strong> (<code>–exclude-from</code>).
</p>

<p>
Dans le fichier <strong>rsync.exclude</strong>, mettre un chemin par ligne (vers un répertoire ou un fichier).
Attention, ne pas oublier les <strong>/</strong> en fin de ligne pour les répertoires ainsi que &quot;- &quot; (moins espace) avant chaque ligne.
</p>

<p>
Les options clés se trouvant juste après la commande sont explicitées ci-dessous :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong><code>a</code></strong> : indique que <code>rsync</code> doit travailler en mode <em>archive</em>, c&#039;est-à-dire qu&#039;une copie fidèle de l&#039;arborescence (et donc des sous répertoires)  est réalisée (les permissions,  les propriétaires et les dates de modification des fichiers sont conservés).</div>
</li>
<li class="level1"><div class="li"> <strong><code>z</code></strong> : indique à <code>rsync</code> qu&#039;il doit utiliser la compression pour le transfert des données.</div>
</li>
</ul>

<p>
La destination de synchronisation (notre serveur) s&#039;indique comme suit :
</p>
<pre class="code">adresse_ip::module/</pre>

<p>
Notez que si vous ne placez pas le <code>/</code> après le module, vous allez obtenir un sous-répertoire <code>intern</code> (dans ce cas-ci) dans le répertoire défini dans le module. Ce qui peut être intéressant dans certains cas mais ce n&#039;est pas le but ici.
</p>

<p>
Donc, en exécutant cette commande, le répertoire <code>/srv/intern</code> est synchronisé avec le module <code>share_rsync</code> sur le serveur <code>192.168.252.201</code>.
</p>

<p>
Sur une station de travail, on peut utiliser cette commande à chaque fois où l&#039;on veut faire un petit backup (c&#039;est ce que je fais à la maison) mais en entreprise, on souhaite que ces synchronisations (ou backup, comme vous voulez) soient faites à des intervalles fixes.
</p>

<p>
Pour ce faire, nous allons configurer <a href="/cron" class="wikilink1" title="cron">Cron</a> pour lancer les synchronisations automatiquement. Ceci est fait en ajoutant une ligne au fichier <code>/etc/crontab</code>. Par exemple, pour une synchronisation par heure de 7h à 22h :
</p>
<pre class="code">05 7-22 * * *   root   rsync -raz --stats --delete /srv/intern 192.168.252.201::share_rsync/</pre>

<p>
N&#039;oubliez pas de forcer le rechargement du <code>crontab</code> via la commande :
</p>
<pre class="code">sudo /etc/init.d/cron reload</pre>

<p>
Pour plus d&#039;informations concernant les configurations de cron, veuillez vous reporter à <a href="/cron" class="wikilink1" title="cron">cette page</a>.
</p>

<p>
Si l&#039;adresse des fichiers à copier contient des espaces, il faut les remplacer par ? ou \ , par exemple, dans le cas de Windows avec cwrsync : 
</p>
<pre class="code">C:\Mes documents\</pre>

<p>
devient : 
</p>
<pre class="code">/cygdrive/c/Mes?documents/</pre>
<hr />

<p>
<em> Contributeur : <a href="/utilisateurs/ostaquet" class="wikilink2" title="utilisateurs:ostaquet" rel="nofollow">ostaquet</a> </em>
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/tutoriel/serveur_de_synchronisation_avec_rsync"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1478722303" /><input type="hidden" name="summary" value="[Configuration du client] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_du_client" /><input type="hidden" name="codeblockOffset" value="11" /><input type="hidden" name="range" value="5227-" /><button type="submit" title="Configuration du client" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="tutoriel/serveur_de_synchronisation_avec_rsync.txt">tutoriel/serveur_de_synchronisation_avec_rsync.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 09/11/2016, 21:11">Le 09/11/2016, 21:11</span></li><li class="text-muted">par 78.192.147.128</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=tutoriel%3Aserveur_de_synchronisation_avec_rsync&amp;1635532748" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
