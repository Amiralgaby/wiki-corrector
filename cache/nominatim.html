<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>nominatim [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="trusty,sig,openstreetmap,brouillon"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/nominatim?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/nominatim?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/nominatim"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/nominatim"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/nominatim"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"nominatim","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="nominatim">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/nominatim?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/nominatim?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/nominatim?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/nominatim?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/nominatim?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/nominatim?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/nominatim?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">nominatim</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/nominatim?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/nominatim?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/nominatim?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#pourquoi_installer_nominatim","title":"Pourquoi installer Nominatim","level":2},{"link":"#installer_nominatim","title":"Installer Nominatim","level":1},{"link":"#installer_les_dependances","title":"Installer les d\u00e9pendances","level":2},{"link":"#installer_depuis_les_sources","title":"Installer depuis les sources","level":2},{"link":"#utilisation_de_nominatim","title":"Utilisation de Nominatim","level":1},{"link":"#geocodage","title":"G\u00e9ocodage","level":2},{"link":"#geocodage_inverse","title":"G\u00e9ocodage invers\u00e9","level":2},{"link":"#consultation_d_adresses","title":"Consultation d'adresses","level":2},{"link":"#mise_a_jours_base_de_donnees_nominatim_avec_osmosis","title":"Mise \u00e0 jours base de donn\u00e9es Nominatim avec Osmosis","level":1},{"link":"#installation_de_la_nouvelle_version_d_osmosis","title":"Installation de la nouvelle version d'Osmosis","level":2},{"link":"#configuration_des_mises_a_jour","title":"Configuration des mises \u00e0 jour","level":2},{"link":"#mise_a_jour_de_nominatim","title":"Mise \u00e0 jour de Nominatim","level":2},{"link":"#en_cas_de_probleme","title":"En cas de probl\u00e8me","level":1},{"link":"#voir_aussi","title":"Voir aussi","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level2"><a href="#pourquoi_installer_nominatim">Pourquoi installer Nominatim</a></li>
<li class="level1"><a href="#installer_nominatim">Installer Nominatim</a></li>
<li class="level2"><a href="#installer_les_dependances">Installer les dépendances</a></li>
<li class="level2"><a href="#installer_depuis_les_sources">Installer depuis les sources</a></li>
<li class="level1"><a href="#utilisation_de_nominatim">Utilisation de Nominatim</a></li>
<li class="level2"><a href="#geocodage">Géocodage</a></li>
<li class="level2"><a href="#geocodage_inverse">Géocodage inversé</a></li>
<li class="level2"><a href="#consultation_d_adresses">Consultation d&#039;adresses</a></li>
<li class="level1"><a href="#mise_a_jours_base_de_donnees_nominatim_avec_osmosis">Mise à jours base de données Nominatim avec Osmosis</a></li>
<li class="level2"><a href="#installation_de_la_nouvelle_version_d_osmosis">Installation de la nouvelle version d&#039;Osmosis</a></li>
<li class="level2"><a href="#configuration_des_mises_a_jour">Configuration des mises à jour</a></li>
<li class="level2"><a href="#mise_a_jour_de_nominatim">Mise à jour de Nominatim</a></li>
<li class="level1"><a href="#en_cas_de_probleme">En cas de problème</a></li>
<li class="level1"><a href="#voir_aussi">Voir aussi</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="notetag">Selon les <a href="/tags">tags</a> présents sur cette page, les informations qu'elle contient  n'ont pas été vérifiées pour les dernières versions LTS depuis <a href="/trusty">Ubuntu 14.04 LTS.</a><br />
Cette page est en cours de rédaction.<br />
<a href="/wiki/participer_wiki">Apportez votre aide…</a>
</div>
<div class="tags"><span>
	<a href="/trusty" class="wikilink1" title="trusty" rel="tag">Trusty</a>,
	<a href="/sig" class="wikilink1" title="sig" rel="tag">SIG</a>,
	<a href="/openstreetmap" class="wikilink1" title="openstreetmap" rel="tag">OpenStreetMap</a>,
	<a href="/brouillon" class="wikilink1" title="brouillon" rel="tag">BROUILLON</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="nominatim">Nominatim</h1>
<div class="level1">

<p>
Nominatim (du Latin, &#039;par le nom&#039;) est un outil permettant de chercher des données géographiques par leur nom et leur adresse et de générer des adresses potentielles à partir de coordonnées géographiques (reverse geocoding). L&#039;outil peut être utilisé en ligne sur cette page : <a href="http://nominatim.openstreetmap.org" class="urlextern" title="http://nominatim.openstreetmap.org" rel="nofollow">http://nominatim.openstreetmap.org</a>. 
</p>

<p>
Nominatim est aussi utilisé par l&#039;outil Search de la page d&#039;accueil d&#039;OpenStreetMap et améliore la qualité de la recherche proposée sur les sites MapQuest Open Initiative, PickPoint et OpenCage Geocoder.
</p>

<p>
La présente page décrit le processus d&#039;installation de Nominatim sur un ordinateur personnel utilisé en qualité de serveur.
</p>
<div class="notetip">Nominatim permet de transformer une adresse en latitude et longitude et vice-versa.

</div>
</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Nominatim] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="nominatim" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="52-842" /><button type="submit" title="Nominatim" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit2" id="pourquoi_installer_nominatim">Pourquoi installer Nominatim</h3>
<div class="level3">

<p>
Pour un usage occasionnel, installer Nominatim sur son ordinateur n&#039;a aucun intérêt. En revanche, pour des usages fréquents et répétés l&#039;installation de Nominatim permet :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> de soulager les serveurs libres et gratuits d&#039;OpenStreetMap </div>
</li>
<li class="level1"><div class="li"> de ne pas être dépendant d&#039;internet</div>
</li>
<li class="level1"><div class="li"> de disposer de ses propres bases de données</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Pourquoi installer Nominatim] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="pourquoi_installer_nominatim" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="843-1216" /><button type="submit" title="Pourquoi installer Nominatim" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit3 page-header" id="installer_nominatim">Installer Nominatim</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Installer Nominatim] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installer_nominatim" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1217-1249" /><button type="submit" title="Installer Nominatim" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit4" id="installer_les_dependances">Installer les dépendances</h3>
<div class="level3">
<pre class="code">sudo apt-get install libgeos-dev libpq-dev libtool automake libproj-dev libboost-dev libboost-system-dev libboost-filesystem-dev libboost-thread-dev gcc proj-bin libgeos-c1 osmosis libgeos++-dev php5 php-pear php5-pgsql php5-json php-db postgresql postgis postgresql-contrib postgresql-9.3-postgis-2.1 postgresql-server-dev-9.3 libprotobuf-c0-dev protobuf-c-compiler</pre>

<p>
Il faut aussi installer les paquets suivants si vous ne les avez pas déjà installés :
</p>
<pre class="code">sudo apt-get install build-essential libxml2-dev libbz2-dev git cmake pkg-config</pre>

</div>

<h4 id="pour_l_installation_depuis_les_sources_git">Pour l&#039;installation depuis les sources git</h4>
<div class="level4">
<pre class="code">sudo apt-get install git autoconf-archive</pre>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Installer les dépendances] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installer_les_dependances" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1250-1963" /><button type="submit" title="Installer les dépendances" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit5" id="installer_depuis_les_sources">Installer depuis les sources</h3>
<div class="level3">

<p>
Installation à partir de la version stable 2.4.0 (à la date du 4 juin 2015).
</p>

</div>

<h4 id="telechargement_du_fichier_d_installation_compresse">Téléchargement du fichier d&#039;installation compressé</h4>
<div class="level4">
<pre class="code">wget http://www.nominatim.org/release/Nominatim-2.4.0.tar.bz2</pre>

</div>

<h4 id="decompactage_du_fichier_d_installation">Décompactage du fichier d&#039;installation</h4>
<div class="level4">
<pre class="code">tar xvf Nominatim-2.4.0.tar.bz2</pre>

</div>

<h4 id="compilation">Compilation</h4>
<div class="level4">

<p>
Se rendre dans le répertoire Nominatim créé après la décompression (appelé Nominatim dans l&#039;exemple ci-dessous)
</p>
<pre class="code">cd Nominatim
./configure
make
sudo checkinstall</pre>
<div class="notetip">Les alertes à propos de l&#039;absence des librairies lua peuvent être ignorées, Nominatim n&#039;utilise pas l&#039;extension lua de osm2PGSql. 

</div>
</div>

<h4 id="personnalisation_de_nomitamim">Personnalisation de Nomitamim</h4>
<div class="level4">

<p>
La création d&#039;un fichier &lt;local.php&gt; situé dans le répertoire settings permet de personnaliser Nominatim. Les paramètres possibles peuvent être consultés dans le fichier &lt;settings/settings.php&gt;.
Pour davantage de détail voir <strong>(en)</strong> <a href="https://wiki.openstreetmap.org/wiki/Nominatim/Installation" class="urlextern" title="https://wiki.openstreetmap.org/wiki/Nominatim/Installation" rel="nofollow">doc</a>
</p>
<div class="notetip"><strong> Personnaliser les titres des pages web</strong>
<p>
Si vous souhaitez personnaliser les titres des pages internet telles qu&#039;elles s&#039;affichent dans votre navigateur, il suffit de modifier le texte figurant entre les balises &lt;title&gt; et &lt;/title&gt; dans les fichiers &lt;lib/template/search-html.php&gt; &lt;lib/template/details-html.php&gt; et &lt;lib/template/details-error-html.php&gt;.
</p>

<p>
ex :
</p>
<pre class="code">&lt;title&gt;Perso - OpenStreetMap Nominatim : Recherche&lt;/title&gt;</pre>

<p>
au lieu de :
</p>
<pre class="code">&lt;title&gt;OpenStreetMap Nominatim: Search&lt;/title&gt;</pre>

</div>
</div>

<h4 id="telechargement_de_donnees_optionnelles">Téléchargement de données optionnelles</h4>
<div class="level4">

</div>

<h5 id="ponderations_wikipedia_wikipedia_rankings">Pondérations Wikipedia (Wikipedia rankings)</h5>
<div class="level5">

<p>
Le fonctionnement de Nominatim peut être amélioré par le recours aux pondérations Wikipédia qui permettent de mesure l&#039;importance des données osm. Nominatim peut fonctionner sans ces données mais la qualité du résultat s&#039;en trouve dégradée.
</p>

<p>
<strong>Téléchargement des données</strong>
</p>
<pre class="code"> wget --output-document=data/wikipedia_article.sql.bin http://www.nominatim.org/data/wikipedia_article.sql.bin
 wget --output-document=data/wikipedia_redirect.sql.bin http://www.nominatim.org/data/wikipedia_redirect.sql.bin</pre>

<p>
La taille cumulée de ces deux fichiers atteint 1,5 GO et ajoute 30 GO à la taille finale de Nominatim sur le disque. La durée d&#039;installation de Nominatim s&#039;en trouve accrue d&#039;une heure environ.
</p>

</div>

<h5 id="codes_postaux_britanniques">Codes postaux britanniques</h5>
<div class="level5">

<p>
Le cas échéant, utile pour les recherches concernant le territoire britannique.
</p>
<pre class="code">wget --output-document=data/gb_postcode_data.sql.gz http://www.nominatim.org/data/gb_postcode_data.sql.gz</pre>

</div>

<h5 id="installation_des_donnees_tiger_housenumber_pour_les_etats-unis_d_amerique">Installation des données Tiger housenumber pour les États-Unis d&#039;Amérique</h5>
<div class="level5">

<p>
Aux États-Unis d&#039;Amérique, l&#039;instance Nominatim d&#039;OSM utilise la base de données d&#039;adresses TIGER pour compléter les données sur les numéros de rues qui restent encore incomplètes dans OpenStreetMap. L&#039;ajout des données TIGER est possible après avoir installé la librairie GDAL pour Python.
<strong>Installation de la librairie GDAL pour Python</strong>
</p>
<pre class="code">sudo apt-get install python-gdal</pre>

<p>
<strong>Téléchargement des données TIGER 2014</strong>
</p>

<p>
Les fichiers à télécharger sont les fichiers EDGES (3 234 fichiers compressés, 11GO au total)
</p>
<pre class="code"> wget -r ftp://ftp2.census.gov/geo/tiger/TIGER2014/EDGES/</pre>

<p>
<strong>Conversion des données en requêtes SQL (sauvegardées dans data/tiger2011) :</strong>
</p>
<pre class="code">./utils/imports.php --parse-tiger-2011 &lt;répetoire des fichiers tiger edge&gt;</pre>
<div class="noteclassic">Si vous utilisez la dernière version de développement, utiliser –parse-tiger.

</div>
<p>
<strong>Importation des données dans la base de données Nominatim de votre station de travail</strong>
</p>
<pre class="code"> ./utils/setup.php --import-tiger-data</pre>
<div class="noteclassic">L&#039;importation peut prendre beaucoup de temps, notamment si vous importez l&#039;ensemble des données du pays. Une semaine entière sur un petit Asus 1015E doté d&#039;un processeur Intel® Celeron® Dual-Core 847 à 1,1GHz et d&#039;un disque ATA Seagate de 320 GO à 5400 tours.

</div>
</div>

<h4 id="creation_des_comptes_postgres">Création des comptes postgres</h4>
<div class="level4">

</div>

<h5 id="compte_de_l_importateur">Compte de l&#039;importateur</h5>
<div class="level5">
<pre class="code">sudo -u postgres createuser -s &lt;votre nom d&#039;utilisateur&gt;</pre>
<div class="notetip">Il est possible que le compte existe déjà, postgres vous le dira alors

</div>
</div>

<h5 id="compte_de_l_utilisateur">Compte de l&#039;utilisateur</h5>
<div class="level5">

<p>
Le nom d&#039;utilisateur correspond au nom du compte qui doit être utilisé pour finaliser l&#039;installation. Vous devez vous assurer (paramétrage généralement par défaut dans la plupart des distributions) que cet utilisateur peut se connecter à la base de donnée sans mot de passe.
</p>

<p>
<strong> Création de l’utilisateur du site web (PostgreSQL) </strong>
</p>
<pre class="code">sudo -u postgres createuser -SDR www-data</pre>

<p>
Utilisateur nécessaire pour l&#039;installation. Si vous souhaitez utiliser le site web avec un autre utilisateur, reportez-vous à la documentation (section Set up the website).
</p>
<div class="notewarning">En aucun cas l&#039;importation ne doit être réalisée sous le compte root ou www-data

</div>
</div>

<h5 id="parametres_postgresql">Paramètres PostgreSQL</h5>
<div class="level5">

<p>
Par défaut la base de données PostgreSQL s&#039;installe dans le répertoire racine, au risque de ne plus laisser de place au système.
Le répertoire de la base de donnée est le suivant sur mon Ubuntu 14.04 : &lt;/var/lib/postgresql/9.3/main&gt; [9.3 pour la version actuelle].
Le répertoire par défaut peut être modifié dans le fichier de configuration &lt;/etc/postgresql/9.3/main/postgresql.conf&gt;.
</p>
<div class="notetip">Si aprés la modification du répertoire par défaut des données dans postgresql.conf le serveur PostgreSQL refuse de redémarrer, une solution facile à défaut d&#039;être élégante consiste à déplacer le répertoire &lt;/var/lib/postgresql/9.3/main&gt; avec tout son contenu, à vérifier le maintien des droits (propriétaire et groupe &quot;postgres&quot;) et à instituer un lien symbolique à partir de &lt;/var/lib/postgresql/9.3/&gt; vers l&#039;emplacement réel du répertoire main.

</div>
<p>
Pour redémarrer le serveur PostgreSQL, deux commandes équivalentes
</p>
<pre class="code">sudo pg_ctlcluster 9.3 main start</pre>

<p>
ou bien
</p>
<pre class="code">sudo service postgres 9.3 main start</pre>

</div>

<h4 id="permissions_de_lecture_nominatim">Permissions de lecture Nominatim</h4>
<div class="level4">

<p>
L&#039;ensemble des fichiers et répertoire doit être accessible en lecture pour le serveur PostgreSQL car certaines fonctions Nominatim Postgres sont intégrées au module C nominatim.so.
</p>

<p>
Ainsi, pour le cas d&#039;un téléchargement et d&#039;une compilation dans le répertoire &lt;src&gt; du répertoire utilisateur, saisir :
</p>
<pre class="code">chmod +x ~/src
chmod +x ~/src/Nominatim
chmod +x ~/src/Nominatim/module</pre>
<div class="notewarning">La gestion des droits est essentielle au bon fonctionnement de Nominatim. Des droits insuffisants conduiront à l&#039;échec de la procédure de téléchargement des données.
</div>
</div>

<h4 id="importation_et_indexation_des_donnees_osm">Importation et indexation des données OSM</h4>
<div class="level4">

<p>
L&#039;importation préalable du fichier mondial (&quot;Planet file&quot;) ou d&#039;une extraction (par exemple du site Geofabrik) est nécessaire. Utiliser le format PBF.
</p>
<div class="notetip">La durée de téléchargement peut être longue, ouvrir une instance de terminal peut vous permettre de faire autre chose pendant ce temps.

</div>
<p>
Une fois le téléchargement terminé, saisir la commande suivante :
</p>
<pre class="code"> ./utils/setup.php --osm-file &lt;your planet file&gt; --all --osm2pgsql-cache 18000 2&gt;&amp;1 | tee setup.log</pre>

<p>
Le paramètre –osm2pgsql-cache est optionnel mais fortement recommandé en cas d&#039;importation de l&#039;ensemble des données planétaires. Ce paramètre fixe la taille du cache des noeuds lors de l&#039;importation osm2pgsql. 24 GO sont recommandés pour une importation des données mondiales mais vous pouvez choisir de fixer une valeur inférieure. À adapter à la taille de votre RAM pour éviter le swap.
</p>
<div class="noteimportant">L&#039;importation peut durer une heure environ pour un petit pays, jusqu&#039;à dix jours pour l&#039;ensemble des données mondiales. Le nombre des messages de log est important, il est recommandé de les examiner avec attention. Il est recommandé également de tester l&#039;importation des données d&#039;un petit pays (par exemple le Luxembourg) avant de lancer l’importation des données mondiales. Sur mon PC, le traitement de la seule région île-de-France a pris plusieurs heures.

</div><div class="noteclassic"><strong>En cas de problème</strong>
<p>
Il se peut que vous rencontriez des problèmes liés au paramétrage de postgresql lors de l&#039;importation des données, fichiers manquants, opérations impossibles, etc.
La procédure ci-dessous a permis de solutionner le problème pour une installation particulière. À tenter sans garantie et en réfléchissant un peu. 
NB : postgresql exige que la version soit précisée, dans l&#039;exemple ci-dessous c&#039;est la 9.3. À adapter selon votre configuration.
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Arrêt postgresql</div>
</li>
</ul>
<pre class="code">sudo pg_ctlcluster 9.3 main stop</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Suppression cluster</div>
</li>
</ul>
<pre class="code">sudo -i -u postgres
pg_dropcluster 9.3 main --stop
exit</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> suppression complète des paquets</div>
</li>
</ul>
<pre class="code">sudo apt-get purge postgresql-9.3 postgresql postgresql-9.3-postgis-scripts postgresql-client-9.3 postgresql-client-common postgresql-common postgresql-contrib postgresql-contrib-9.3 liblwgeom-2.1.4 libgdal-dev libpostgis-java libpostgresql-jdbc-java libpq-dev php5-pgsql postgis postgis-doc osmosis
sudo apt-get autoremove</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Suppression des répertoires</div>
</li>
</ul>

<p>
/var/lib/postgresql
/etc/postgresql
/var/log/postgresql 
/usr/share/postgresql
et votre répertoire de données
</p>
<pre class="code">sudo rm -R /var/lib/postgresql /etc/postgresql/ /var/log/postgresql /usr/share/postgresql
sudo rm -R &lt;votre répertoire&gt;</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Réinstallation complète de tous les paquets</div>
</li>
</ul>
<pre class="code">sudo apt-get install postgresql-9.3 postgresql postgresql-9.3-postgis-scripts postgresql-client-9.3 postgresql-client-common postgresql-common postgresql-contrib postgresql-contrib-9.3 liblwgeom-2.1.4 libgdal-dev libpostgis-java libpostgresql-jdbc-java libpq-dev php5-pgsql postgis postgis-doc osmosis</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Création d&#039;un lien symbolique</div>
</li>
</ul>

<p>
(selon le résultat de la commande &lt;pg_config –libdir&gt;)
</p>
<pre class="code">sudo ln -s /usr/share/postgresql/9.3/contrib/postgis-2.1 /usr/lib</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Création du cluster main</div>
</li>
</ul>
<pre class="code">sudo pg_createcluster -d &lt;votre répertoire&gt; 9.3 main</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Démarrage postgresql</div>
</li>
</ul>
<pre class="code">sudo pg_ctlcluster 9.3 main start</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Création utilisateur</div>
</li>
</ul>
<pre class="code">sudo -u postgres createuser -s &lt;votre nom d’utilisateur&gt;</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Création utilisateur www-data</div>
</li>
</ul>
<pre class="code">sudo -u postgres createuser -SDR www-data</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Retour dans nominatim</div>
</li>
</ul>
<pre class="code">cd &lt;votre répertoire d&#039;installation&gt;
  * Traitement données
&lt;code&gt;
./utils/setup.php --osm-file &lt;votre fichier.osm.pbf&gt; --all --osm2pgsql-cache 18000 2&gt;&amp;1 | tee setup.lo</pre>

</div><div class="noteclassic"><strong>Effacer la base de donnée</strong>
En cas de besoin, il est toujours possible d&#039;effacer la base de données.<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> On commence par vérifier le nom de la base (normalement c&#039;est nominatim)</div>
</li>
</ul>
<pre class="code">psql -l</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Puis on efface (et on perd tout évidemment)</div>
</li>
</ul>
<pre class="code">dropdb nominatim</pre>

</div>
</div>

<h4 id="ajout_des_phrases_speciales">Ajout des phrases spéciales</h4>
<div class="level4">

</div>

<h5 id="ajout_des_codes_et_des_noms_de_pays_a_l_index_de_recherche">Ajout des codes et des noms de pays à l&#039;index de recherche</h5>
<div class="level5">

<p>
Saisir les instructions suivantes dans le terminal :
</p>
<pre class="code">./utils/specialphrases.php --countries &gt; data/specialphrases_countries.sql
psql -d nominatim -f data/specialphrases_countries.sql</pre>

</div>

<h5 id="marqueurs_specifiques">Marqueurs spécifiques</h5>
<div class="level5">

<p>
Si vous souhaitez retrouver des marqueurs particuliers (&quot;amenity&quot;) comme par exemple des cafés parisiens, vous de devez importer les phrases spéciales de ce wiki de la manière suivante :
</p>
<pre class="code">./utils/specialphrases.php --wiki-import &gt; data/specialphrases.sql
psql -d nominatim -f data/specialphrases.sql</pre>

<p>
Ces opération doivent être répétées de temps en temps pour prendre en compte les mises à jours et compléments du wiki. Il est notamment nécessaire d&#039;effectuer la mise à jour après chaque mise à jour de Nomnatim.
</p>

</div>

<h5 id="langues">Langues</h5>
<div class="level5">

<p>
Si vous n&#039;avez pas besoin des phrases pour toutes les langues, éditez utils/specialphrases.php et supprimez en début de fichier les langues non utilisées.
</p>

</div>

<h4 id="initialisation_du_site_web">initialisation du site web</h4>
<div class="level4">

<p>
Les instructions ci-dessous rendront Nominatim disponible à <a href="http://localhost/nominatim" class="urlextern" title="http://localhost/nominatim" rel="nofollow">http://localhost/nominatim</a>.
</p>

</div>

<h5 id="creation_du_repertoire">Création du répertoire</h5>
<div class="level5">

<p>
Créer le répertoire du site et assurez vous que les droits en écriture sont ouverts pour l’utilisateur d&#039;installation et en lecture par Apache.
</p>
<pre class="code">sudo mkdir -m 755 &lt;répertoire racine apache&gt;/nominatim
sudo chown &lt;votre nom d&#039;utilisateur&gt; &lt;répertoire racine apache&gt;/nominatim</pre>
<div class="notetip">Le répertoire racine par défaut d&#039;apache est /var/www/html depuis Ubuntu 14.04, auparavant il s&#039;agissait de /var/www

</div><div class="notewarning">Veiller particulièrement à ce que l&#039;utilisateur www-data possède les droits suffisants pour accéder au répertoire nominatim, sinon le serveur ne fonctionnera pas.
</div>
</div>

<h5 id="parametres_de_const_website_baseurl">Paramètres de CONST_Website_BaseURL</h5>
<div class="level5">

<p>
Vérifier que settings/local.php est configuré avec les valeurs correctes pour CONST_Website_BaseURL : il faut créer un fichier local.php dans le répertoire Nominatim-2.4.0/settings contenant les valeurs suivantes :
</p>
<pre class="code">@define(&#039;CONST_Website_BaseURL&#039;, &#039;&lt;répertoire racine serveur pour le navigateur&gt;/nominatim&#039;);</pre>

<p>
par exemple :
</p>
<pre class="code">@define(&#039;CONST_Website_BaseURL&#039;, &#039;http://localhost/nominatim/&#039;);</pre>
<div class="notetip">Si malgré cette modification lors de l&#039;affichage du site web dans votre navigateur, une erreur apparaît car le fichier &lt;search.php&gt; est introuvable vous pouvez tenter la méthode &quot;sauvage&quot; : dans le fichier &lt;nominatim/settings/settings.php&gt; commenter (ajouter un # devant) la ligne :
<pre class="code">#@define(&#039;CONST_Website_BaseURL&#039;, &#039;http://&#039;.php_uname(&#039;n&#039;).&#039;/&#039;);</pre>

<p>
et la remplacer (donc insérer en dessous) par :
</p>
<pre class="code">@define(&#039;CONST_Website_BaseURL&#039;, &#039;http://localhost/nominatim/&#039;);</pre>

<p>
Ce n&#039;est pas orthodoxe mais ça peut fonctionner en cas de problème d&#039;arborescence.
</p>

</div>
</div>

<h5 id="liens_symboliques">Liens symboliques</h5>
<div class="level5">

<p>
Rendre disponible le répertoire du site web avec les liens symboliques nécessaires :
</p>
<pre class="code"> ./utils/setup.php --create-website &lt;répertoire racine apache&gt;/nominatim</pre>

</div>

<h5 id="configuration_pour_utilisation_avec_apache">Configuration pour utilisation avec Apache</h5>
<div class="level5">

<p>
Vérifier que le fichier de configuration Apache contient les valeurs suivantes pour les répertoires :
</p>
<pre class="code"> &lt;Directory &quot;/var/www/html/nominatim/&quot;&gt;
    Options FollowSymLinks MultiViews
    AddType text/html   .php     
 &lt;/Directory&gt;</pre>

<p>
En d&#039;autres termes il faut insérer ces lignes dans le fichier de configuration &lt;/etc/apache2/apache2.conf&gt; (adapter le nom du répertoire).
</p>

<p>
&lt;/var/www/html/nominatim&gt; doit être remplacé par le nom du répertoire défini lors de la mise en place du site web Nominatim (voir ci-dessus).
</p>

<p>
Relancer Apache après modification de la configuration (sudo service apache2 start | restart)
</p>

<p>
Vous pouvez désormais utiliser Nominatim
</p>
<pre class="code">Saisir http://localhost/nominatim/search.php dans votre navigateur internet
saisir une adresse...ml/</pre>

</div>

<h5 id="configuration_pour_utilisation_avec_nginx">Configuration pour utilisation avec Nginx</h5>
<div class="level5">

<p>
Pas testé. Voir  <strong>(en)</strong> <a href="https://wiki.openstreetmap.org/wiki/Nominatim/Installation" class="urlextern" title="https://wiki.openstreetmap.org/wiki/Nominatim/Installation" rel="nofollow">doc</a>
</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Installer depuis les sources] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installer_depuis_les_sources" /><input type="hidden" name="codeblockOffset" value="3" /><input type="hidden" name="range" value="1964-16958" /><button type="submit" title="Installer depuis les sources" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit6 page-header" id="utilisation_de_nominatim">Utilisation de Nominatim</h2>
<div class="level2">

<p>
La recherche dans Nominatim fonctionne à partir d&#039;objets nommés ou numérotés à partir des données Openstreetmap (OSM) ainsi que d&#039;une liste d&#039;objets &quot;non nommés&quot; comme des commerces, des hôtels, des bâtiments publics, etc.
</p>

<p>
Le serveur Nominatim peut fonctionner de manière interactive dans le navigateur : saisir l&#039;adresse localhost/nominatim/search.php affiche une carte du monde avec une zone à l&#039;intérieur de laquelle il suffit de saisir une adresse physique pour la géocoder.
</p>

<p>
Toutefois Nominatim peut faire nettement plus, c&#039;est ce que nous allons voir ci-dessous.
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Utilisation de Nominatim] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="utilisation_de_nominatim" /><input type="hidden" name="codeblockOffset" value="42" /><input type="hidden" name="range" value="16959-17579" /><button type="submit" title="Utilisation de Nominatim" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit7" id="geocodage">Géocodage</h3>
<div class="level3">

<p>
Le géocodage est l&#039;action consistant à transformer une adresse en coordonnées géographiques.
</p>

</div>

<h4 id="format_des_requetes">Format des requêtes</h4>
<div class="level4">

<p>
Il est conseillé de saisir les requêtes de gauche à droite, en commençant par le plus précis (1, quai de la fraternité, Marseille) puis, en cas de difficulté, de réssayer en ordre inverse, de droite à gauche.
</p>

</div>

<h5 id="format_de_base">Format de base</h5>
<div class="level5">

<p>
Les requêtes sont passées dans le navigateur sous la forme suivante :
</p>
<pre class="code">&quot;http://nominatim.openstreetmap.org/search?&lt;paramètres&gt;&quot;</pre>

<p>
ou 
</p>
<pre class="code"> &quot;http://nominatim.openstreetmap.org/search/&lt;requête&gt;?&lt;paramètres&gt;&quot;</pre>

</div>

<h4 id="adresses">Adresses</h4>
<div class="level4">

<p>
Rue de la République, Marseille
et
Marseille, Rue de la République
sont deux formats valides
</p>

</div>

<h5 id="numeros">Numéros</h5>
<div class="level5">

<p>
La saisie des numéros améliore la précision de la recherche. Dans ce cas le format de gauche à droite est nécessaire :
51, rue de la République, Marseille
</p>

</div>

<h5 id="virgule">Virgule</h5>
<div class="level5">

<p>
La présence de virgules entre les termes de la recherche n&#039;est pas obligatoire mais améliore l’efficacité de la requête.
</p>

</div>

<h4 id="mots_cles_specifiques">Mots clés spécifiques</h4>
<div class="level4">

<p>
L&#039;usage des mots clés spécifiques est possible si les &quot;phrases spéciales&quot; (special phrases) ont été ajoutées à la base de donnée.
</p>

</div>

<h5 id="parametres">Paramètres</h5>
<div class="level5">

<p>
<strong> format=[html|xml|json|jsonv2] </strong>
</p>

<p>
Format de la sortie
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> html</div>
</li>
</ul>

<p>
Format html
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> xml</div>
</li>
</ul>

<p>
Format XML (format structuré)
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> json</div>
</li>
</ul>

<p>
Format json
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> jsonv2</div>
</li>
</ul>

<p>
Format jsonv2
</p>

<p>
<strong>json_callback=&lt;chaîne&gt;</strong>
</p>

<p>
Empaquette le résultat de la requête dans un appel de fonction json, c&#039;est à dire une chaîne commençant par &quot;json&gt;&quot;
</p>

<p>
<strong>accept-language=&lt;langue du navigateur au format chaîne de caractère&gt;</strong>
</p>

<p>
Force la langue de résultat indépendamment des valeur figurant dans l&#039;en-tête (header) http. Accepte toutes les langues au format rfc2616 ou des codes de langue séparés par des virgules.
</p>

</div>

<h4 id="ecriture_de_la_requete">Écriture de la requête</h4>
<div class="level4">

<p>
q=&lt;requête&gt;
&lt;requête&gt; est la chaîne de caractères recherchée. Les valeurs suivantes sont possibles :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li">  street=&lt;numéro&gt; &lt;nom de rue&gt;</div>
</li>
<li class="level1"><div class="li">  city=&lt;ville&gt;</div>
</li>
<li class="level1"><div class="li">  county=&lt;comté&gt;</div>
</li>
<li class="level1"><div class="li">  state=&lt;état&gt;</div>
</li>
<li class="level1"><div class="li">  country=&lt;pays&gt;</div>
</li>
<li class="level1"><div class="li">  postalcode=&lt; code postal&gt;</div>
</li>
</ul>

</div>

<h4 id="requetes_structurees_experimental">Requêtes structurées (experimental)</h4>
<div class="level4">

<p>
Les requêtes structurées sont plus rapides et nécessites moins de ressources serveur.
NE PAS COMBINER AVEC LES PARAMETRES q=&lt;query&gt; PARAMETRES
</p>

</div>

<h5 id="countrycodes_code_pays_code_pays_code_pays">countrycodes=&lt; code pays&gt;[,&lt; code pays&gt;][,&lt; code pays&gt;]...</h5>
<div class="level5">

<p>
Restreint la recherche à un pays (ou une liste de pays). Code au format ISO 3166-1alpha2 (fr pour France)
</p>

</div>

<h5 id="viewbox_gauche_haut_droite_bas_ou_viewboxlbrt_gauche_bas_droite_haut">viewbox=&lt;gauche&gt;,&lt;haut&gt;,&lt;droite&gt;,&lt;bas&gt;  ou viewboxlbrt=&lt;gauche&gt;,&lt;bas&gt;,&lt;droite&gt;,&lt;haut&gt;</h5>
<div class="level5">

<p>
zone préferentielle de recherche des résultats
</p>

</div>

<h5 id="bounded_0_1">bounded=[0|1]</h5>
<div class="level5">

<p>
Restreint la recherche aux seuls objets contenus dans la zone de recherche.
Cette restriction permet la recherche par aménité. Ainsi [pub] échouera alors que [pub] avec bounded=1 affichera une liste d&#039;objets correspondant à l&#039;item à l&#039;intérieur de la zone de recherche.*
</p>

</div>

<h5 id="polygon_0_1">polygon=[0|1]</h5>
<div class="level5">

<p>
Obsolète
</p>

</div>

<h5 id="addressdetails_0_1">addressdetails=[0|1]</h5>
<div class="level5">

<p>
Séparation de l&#039;adresse en différents éléments
</p>

</div>

<h5 id="email_addresse_electronique_de_contact">email=&lt;addresse électronique de contact&gt;</h5>
<div class="level5">

<p>
Peu utile pour un serveur autohébergé. Concerne les usages en ligne en masse 
</p>

</div>

<h5 id="exclude_place_ids_identifiant_de_lieu_identifiant_de_lieu_identifiant_de_lieu">exclude_place_ids=&lt;identifiant de lieu,[identifiant de lieu],[identifiant de lieu]&gt;</h5>
<div class="level5">

<p>
Permet d&#039;exclure de la liste des résultats certains objets à partir de leur identifiant OSM. Cette fonctionnalité est utile lorsqu&#039;une première recherche n&#039;a produt qu&#039;un nombre lmité de résultats. Exclure ces objets permet d&#039;obtenir davantage de réponses.
</p>

</div>

<h5 id="limit_entier">limit=&lt;entier&gt;</h5>
<div class="level5">

<p>
Limite le nombre des résultats au nombre précisé
</p>

</div>

<h5 id="dedupe_0_1">dedupe=[0|1]</h5>
<div class="level5">

<p>
Non documenté
</p>

</div>

<h5 id="debug_0_1">debug=[0|1]</h5>
<div class="level5">

<p>
Non documenté
</p>

</div>

<h5 id="polygon_geojson_1">polygon_geojson=1</h5>
<div class="level5">

<p>
Affiche la géométrie des résultats au format geojson.
</p>

</div>

<h5 id="polygon_kml_1">polygon_kml=1</h5>
<div class="level5">

<p>
Affiche la géométrie des résultats au format kml.
</p>

</div>

<h5 id="polygon_svg_1">polygon_svg=1</h5>
<div class="level5">

<p>
Affiche la géométrie des résultats au format svg.
</p>

</div>

<h5 id="polygon_text_1">polygon_text=1</h5>
<div class="level5">

<p>
Affiche la géométrie des résultats au format WKT.
</p>

</div>

<h4 id="exemples">Exemples</h4>
<div class="level4">

<p>
Pour faciliter le travail des utilisateurs, les liens sont donnés d&#039;abord sur le serveur internet Nominatim d&#039;Openstreetmap puis sur localhost pour les ubuntunautes qui ont poursuivi le travail d&#039;installation du serveur à son terme.
</p>

</div>

<h5 id="quai_du_port_a_marseille">32 quai du port à Marseille</h5>
<div class="level5">

<p>
<a href="http://nominatim.openstreetmap.org/search.php?q=32%2C+quai+du+port+Marseille&amp;viewbox=5.37%2C43.3%2C5.38%2C43.29" class="urlextern" title="http://nominatim.openstreetmap.org/search.php?q=32%2C+quai+du+port+Marseille&amp;viewbox=5.37%2C43.3%2C5.38%2C43.29" rel="nofollow">http://nominatim.openstreetmap.org/search.php?q=32%2C+quai+du+port+Marseille&amp;viewbox=5.37%2C43.3%2C5.38%2C43.29</a>
</p>

<p>
<a href="http://localhost/nominatim/search.php?q=32%2C+quai+du+port+Marseille&amp;viewbox=5.37%2C43.3%2C5.38%2C43.29" class="urlextern" title="http://localhost/nominatim/search.php?q=32%2C+quai+du+port+Marseille&amp;viewbox=5.37%2C43.3%2C5.38%2C43.29" rel="nofollow">http://localhost/nominatim/search.php?q=32%2C+quai+du+port+Marseille&amp;viewbox=5.37%2C43.3%2C5.38%2C43.29</a>
</p>

<p>
<a href="/_detail/nominatim_32_q_du_port_marseille.png?id=nominatim" class="media" title="nominatim_32_q_du_port_marseille.png"><img src="/_media/nominatim_32_q_du_port_marseille.png?w=600&amp;tok=e181c4" class="mediacenter img-responsive" alt="" width="600" /></a>
</p>

</div>

<h5 id="cours_mirabeau_a_aix-en-provence">12 Cours Mirabeau à Aix-en-Provence</h5>
<div class="level5">

<p>
<a href="http://nominatim.openstreetmap.org/search.php?q=12+cours+Mirabeau%2C+Aix+en+Provence&amp;viewbox=5.43%2C43.54%2C5.47%2C43.52" class="urlextern" title="http://nominatim.openstreetmap.org/search.php?q=12+cours+Mirabeau%2C+Aix+en+Provence&amp;viewbox=5.43%2C43.54%2C5.47%2C43.52" rel="nofollow">http://nominatim.openstreetmap.org/search.php?q=12+cours+Mirabeau%2C+Aix+en+Provence&amp;viewbox=5.43%2C43.54%2C5.47%2C43.52</a>
</p>

<p>
<a href="http://localhost/nominatim/search.php?q=12+cours+Mirabeau%2C+Aix+en+Provence&amp;viewbox=5.43%2C43.54%2C5.47%2C43.52" class="urlextern" title="http://localhost/nominatim/search.php?q=12+cours+Mirabeau%2C+Aix+en+Provence&amp;viewbox=5.43%2C43.54%2C5.47%2C43.52" rel="nofollow">http://localhost/nominatim/search.php?q=12+cours+Mirabeau%2C+Aix+en+Provence&amp;viewbox=5.43%2C43.54%2C5.47%2C43.52</a>
</p>

<p>
<a href="/_detail/12_cours_mirabeau_aix.png?id=nominatim" class="media" title="12_cours_mirabeau_aix.png"><img src="/_media/12_cours_mirabeau_aix.png?w=600&amp;tok=590c69" class="mediacenter img-responsive" alt="" width="600" /></a>
</p>

</div>

<h5 id="details20_la_canebiere_a_marseille">Détails : 20, La Canebière à Marseille</h5>
<div class="level5">

<p>
À noter : les place_id sont différents !
</p>

<p>
<a href="http://nominatim.openstreetmap.org/details.php?place_id=20684057" class="urlextern" title="http://nominatim.openstreetmap.org/details.php?place_id=20684057" rel="nofollow">http://nominatim.openstreetmap.org/details.php?place_id=20684057</a>
</p>

<p>
<a href="http://localhost/nominatim/details.php?place_id=147400" class="urlextern" title="http://localhost/nominatim/details.php?place_id=147400" rel="nofollow">http://localhost/nominatim/details.php?place_id=147400</a>
</p>

<p>
<a href="/_detail/detail_20_la_canebiere.png?id=nominatim" class="media" title="detail_20_la_canebiere.png"><img src="/_media/detail_20_la_canebiere.png?w=600&amp;tok=5504d9" class="mediacenter img-responsive" alt="" width="600" /></a>
</p>

<p>
<a href="http://nominatim.openstreetmap.org/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=json" class="urlextern" title="http://nominatim.openstreetmap.org/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=json" rel="nofollow">http://nominatim.openstreetmap.org/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=json</a>
</p>

<p>
<a href="http://localhost/nominatim/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=json" class="urlextern" title="http://localhost/nominatim/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=json" rel="nofollow">http://localhost/nominatim/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=json</a>
</p>

<p>
<a href="/_detail/capture_du_2015-07-08_20_30_03.png?id=nominatim" class="media" title="capture_du_2015-07-08_20_30_03.png"><img src="/_media/capture_du_2015-07-08_20_30_03.png?w=600&amp;tok=1b08c4" class="mediacenter img-responsive" alt="" width="600" /></a>
</p>

<p>
Et une petite dernière pour la route :
</p>

<p>
<a href="http://nominatim.openstreetmap.org/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=xml" class="urlextern" title="http://nominatim.openstreetmap.org/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=xml" rel="nofollow">http://nominatim.openstreetmap.org/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=xml</a>
</p>

<p>
<a href="http://localhost/nominatim/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=xml" class="urlextern" title="http://localhost/nominatim/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=xml" rel="nofollow">http://localhost/nominatim/search.php?q=20+la+Canebi%C3%A8re+Marseille&amp;format=xml</a>
</p>

<p>
<a href="/_detail/capture_du_2015-07-08_20_29_26.png?id=nominatim" class="media" title="capture_du_2015-07-08_20_29_26.png"><img src="/_media/capture_du_2015-07-08_20_29_26.png?w=600&amp;tok=40ebab" class="mediacenter img-responsive" alt="" width="600" /></a>
</p>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Géocodage] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="geocodage" /><input type="hidden" name="codeblockOffset" value="42" /><input type="hidden" name="range" value="17580-23157" /><button type="submit" title="Géocodage" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit8" id="geocodage_inverse">Géocodage inversé</h3>
<div class="level3">

<p>
Le géocodage inversé est l&#039;action qui consiste à déduire une adresse à partir d&#039;une position en latitude et longitude. Le paramètre optopnnel de zoom précise le niveau de détail requis.
</p>

</div>

<h4 id="format_xml_json">format=[xml|json]</h4>
<div class="level4">

<p>
Format de la sortie
</p>

</div>

<h5 id="xml">xml</h5>
<div class="level5">

<p>
Format XML (format structuré)
</p>

</div>

<h5 id="json">json</h5>
<div class="level5">

<p>
Format json
</p>

</div>

<h4 id="json_callback_chaine">json_callback=&lt;chaîne&gt;</h4>
<div class="level4">

<p>
Empaquette le résultat de la requête dans un appel de fonction json, c&#039;est à dire une chaîne commençant par &quot;json&gt;&quot;
</p>

</div>

<h4 id="accept-language_langue_du_navigateur_au_format_chaine_de_caractere">accept-language=&lt;langue du navigateur au format chaîne de caractère&gt;</h4>
<div class="level4">

<p>
Force la langue de résultat indépendamment des valeur figurant dans l&#039;en-tête (header) http. Accepte toutes les langues au format rfc2616 ou des codes de langue séparés par des virgules.
</p>

</div>

<h4 id="osm_type_n_w_r_osm_id_valeur">osm_type=[N|W|R] osm_id=&lt;valeur&gt;</h4>
<div class="level4">

<p>
objet OSM (noeud/route/relation) à géocoder. Lorsque cela est possible, l&#039;usage des identifiants d&#039;objets OSM est préférable. 
</p>

</div>

<h4 id="lat_valeur_lon_valeur">lat=&lt;valeur&gt;  lon=&lt;valeur&gt;</h4>
<div class="level4">

<p>
Coordonnées du point à géocoder.
</p>

</div>

<h4 id="zoom_0-18">zoom=[0-18]</h4>
<div class="level4">

<p>
Niveau de zoom, 1 correspond à un pays, 18 à un immeuble.
</p>

</div>

<h4 id="addressdetails_0_11">addressdetails=[0|1]</h4>
<div class="level4">

<p>
Séparation de l&#039;adresse en différents éléments
</p>

</div>

<h4 id="email_adresse_electronique_de_contact">email=&lt;adresse électronique de contact&gt;</h4>
<div class="level4">

<p>
Peu utile pour un serveur auto hébergé. Concerne les usages en ligne en masse.
</p>

</div>

<h4 id="hierarchie">Hierarchie</h4>
<div class="level4">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Niveau administratif  	entité XML</div>
</li>
<li class="level1"><div class="li"> 2 	&lt;pays&gt;</div>
</li>
<li class="level1"><div class="li"> 4 	&lt;état&gt; (en France, région ?)</div>
</li>
<li class="level1"><div class="li"> 5 	&lt;district d&#039;état&gt; (en France, département ?)</div>
</li>
<li class="level1"><div class="li"> 6 	</div>
</li>
<li class="level1"><div class="li"> 7 	&lt;comté&gt; (en France, canton ?)</div>
</li>
<li class="level1"><div class="li"> 8 	&lt;commune&gt;</div>
</li>
<li class="level1"><div class="li"> 9 	&lt;arrondissement&gt;</div>
</li>
<li class="level1"><div class="li"> 10 	&lt;quartier&gt;</div>
</li>
</ul>

</div>

<h4 id="exemples1">Exemples</h4>
<div class="level4">

</div>

<h5 id="latitude_nord_43_29537_longitude_est_5_37444">Latitude Nord 43,29537 Longitude Est 5,37444</h5>
<div class="level5">

<p>
<a href="http://localhost/nominatim/reverse?format=xml&amp;lat=43.29537&amp;lon=5.37444&amp;zoom=18&amp;addressdetails=1" class="urlextern" title="http://localhost/nominatim/reverse?format=xml&amp;lat=43.29537&amp;lon=5.37444&amp;zoom=18&amp;addressdetails=1" rel="nofollow">http://localhost/nominatim/reverse?format=xml&amp;lat=43.29537&amp;lon=5.37444&amp;zoom=18&amp;addressdetails=1</a>
</p>

<p>
<a href="http://localhost/nominatim/reverse?format=xml&amp;lat=43.29537&amp;lon=5.37444&amp;zoom=18&amp;addressdetails=1" class="urlextern" title="http://localhost/nominatim/reverse?format=xml&amp;lat=43.29537&amp;lon=5.37444&amp;zoom=18&amp;addressdetails=1" rel="nofollow">http://localhost/nominatim/reverse?format=xml&amp;lat=43.29537&amp;lon=5.37444&amp;zoom=18&amp;addressdetails=1</a>
</p>

<p>
Surprise ! C&#039;est : 1, La Canebière, Marseille 1er Arrondissement, Marseille, Bouches-du-Rhône, Provence-Alpes-Côte d&#039;Azur, 13001, France
</p>

</div>

<h5 id="latitude_nord_44_90008_longitude_est_6_4461">Latitude Nord 44,90008 Longitude Est  6,4461</h5>
<div class="level5">

<p>
<a href="http://nominatim.openstreetmap.org/reverse?format=xml&amp;lat=44.88989&amp;lon=6.63344&amp;zoom=18&amp;addressdetails=1" class="urlextern" title="http://nominatim.openstreetmap.org/reverse?format=xml&amp;lat=44.88989&amp;lon=6.63344&amp;zoom=18&amp;addressdetails=1" rel="nofollow">http://nominatim.openstreetmap.org/reverse?format=xml&amp;lat=44.88989&amp;lon=6.63344&amp;zoom=18&amp;addressdetails=1</a>
</p>

<p>
<a href="http://localhost/nominatim/reverse?format=xml&amp;lat=44.88989&amp;lon=6.63344&amp;zoom=18&amp;addressdetails=1" class="urlextern" title="http://localhost/nominatim/reverse?format=xml&amp;lat=44.88989&amp;lon=6.63344&amp;zoom=18&amp;addressdetails=1" rel="nofollow">http://localhost/nominatim/reverse?format=xml&amp;lat=44.88989&amp;lon=6.63344&amp;zoom=18&amp;addressdetails=1</a>
</p>

<p>
Et la capture d&#039;écran :
</p>

<p>
<a href="/_detail/capture_du_2015-07-08_20_53_01.png?id=nominatim" class="media" title="capture_du_2015-07-08_20_53_01.png"><img src="/_media/capture_du_2015-07-08_20_53_01.png?w=600&amp;tok=203abb" class="mediacenter img-responsive" alt="" width="600" /></a>
</p>

<p>
Gare SNCF de Briançon.
</p>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Géocodage inversé] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="geocodage_inverse" /><input type="hidden" name="codeblockOffset" value="44" /><input type="hidden" name="range" value="23158-25485" /><button type="submit" title="Géocodage inversé" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit9" id="consultation_d_adresses">Consultation d&#039;adresses</h3>
<div class="level3">

<p>
Affiche les adresses d&#039;un ou plusiseurs objets OSM : noeuds, routes, relations.
</p>

</div>

<h4 id="format">Format</h4>
<div class="level4">
<pre class="code"> http://nominatim.openstreetmap.org/lookup?&lt;query&gt;</pre>

</div>

<h4 id="parametres1">Paramètres</h4>
<div class="level4">

</div>

<h5 id="format_xml_json1">format=[xml|json]</h5>
<div class="level5">

<p>
Format de la sortie
</p>

<p>
<strong>xml</strong>
Format XML (format structuré)
<strong>json</strong>
Format json
</p>

</div>

<h5 id="json_callback_chaine1">json_callback=&lt;chaîne&gt;</h5>
<div class="level5">

<p>
Empaquette le résultat de la requête dans un appel de fonction json, c&#039;est à dire une chaîne commençant par &quot;json&gt;&quot;
</p>

</div>

<h5 id="accept-language_langue_du_navigateur_au_format_chaine_de_carcteres">accept-language=&lt;langue du navigateur au format chaîne de carctères&gt;</h5>
<div class="level5">

<p>
Force la langue de résultat indépendamment des valeur figurant dans l&#039;en-tête (header) http. Accepte toutes les langues au format rfc2616 ou des codes de langue séparés par des virgules.
</p>

</div>

<h5 id="osm_ids_n_w_r_valeur_n_w_r_valeur">osm_ids=[N|W|R]&lt;valeur&gt;,…,[N|W|R]&lt;valeur&gt;</h5>
<div class="level5">

<p>
liste de 1 à 50 objets dont l&#039;adresse doit être retournée. 
</p>

</div>

<h5 id="addressdetails_0_12">addressdetails=[0|1]</h5>
<div class="level5">

<p>
Séparation de l&#039;adresse en différents éléments
</p>

</div>

<h5 id="email_addresse_electronique_de_contact1">email=&lt;addresse électronique de contact&gt;</h5>
<div class="level5">

<p>
Peu utile pour un serveur autohébergé. Concerne les usages en ligne en masse.
</p>

</div>

<h4 id="exemples2">Exemples</h4>
<div class="level4">

<p>
<a href="http://nominatim.openstreetmap.org/lookup?osm_ids=R76091,W186948207,N2113091575" class="urlextern" title="http://nominatim.openstreetmap.org/lookup?osm_ids=R76091,W186948207,N2113091575" rel="nofollow">http://nominatim.openstreetmap.org/lookup?osm_ids=R76091,W186948207,N2113091575</a>
</p>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Consultation d&#039;adresses] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="consultation_d_adresses" /><input type="hidden" name="codeblockOffset" value="44" /><input type="hidden" name="range" value="25486-26640" /><button type="submit" title="Consultation d&#039;adresses" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit10 page-header" id="mise_a_jours_base_de_donnees_nominatim_avec_osmosis">Mise à jours base de données Nominatim avec Osmosis</h2>
<div class="level2">

<p>
Plusieurs méthodes existent, la documentation OpenStreetMap conseille Osmosis et renvoie à la lecture de &lt;./utils/update.php –help&gt; pour obtenir la liste des autres méthodes.
</p>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Mise à jours base de données Nominatim avec Osmosis] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="mise_a_jours_base_de_donnees_nominatim_avec_osmosis" /><input type="hidden" name="codeblockOffset" value="45" /><input type="hidden" name="range" value="26641-26887" /><button type="submit" title="Mise à jours base de données Nominatim avec Osmosis" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit11" id="installation_de_la_nouvelle_version_d_osmosis">Installation de la nouvelle version d&#039;Osmosis</h3>
<div class="level3">

</div>

<h4 id="telechargement_du_binaire">Téléchargement du binaire</h4>
<div class="level4">

<p>
La version d&#039;Osmosis disponible dans les paquets de la plupart des distributions est trop ancienne pour repérer correctement les différences pour la mise à jour. Il est donc conseillé de télécharger le binaire de la dernière version stable sur le site <a href="https://wiki.openstreetmap.org/wiki/FR:Osmosis" class="urlextern" title="https://wiki.openstreetmap.org/wiki/FR:Osmosis" rel="nofollow">Osmosis</a> puis de le décompresser. Copier alors le binaire dans &lt;/usr/local/bin&gt; :
</p>
<pre class="code">wget http://bretth.dev.openstreetmap.org/osmosis-build/osmosis-latest.zip
unzip osmosis-latest.zip bin/osmosis
mv bin/osmosis /usr/local/bin/osmosis
rmdir bin
rm osmosis-latest.zip</pre>

</div>

<h4 id="definition_de_la_version_a_utiliser">Définition de la version à utiliser</h4>
<div class="level4">

<p>
Indiquer alors à Nominatim d&#039;utiliser cette version d&#039;Osmosis en ajoutant cette cible au fichier settings/local.php:
</p>
<pre class="code">@define(&#039;CONST_Osmosis_Binary&#039;, &#039;/usr/local/bin/osmosis&#039;);</pre>

</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Installation de la nouvelle version d&#039;Osmosis] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation_de_la_nouvelle_version_d_osmosis" /><input type="hidden" name="codeblockOffset" value="45" /><input type="hidden" name="range" value="26888-27808" /><button type="submit" title="Installation de la nouvelle version d&#039;Osmosis" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit12" id="configuration_des_mises_a_jour">Configuration des mises à jour</h3>
<div class="level3">

<p>
Par défaut, Nominatim est configuré pour réaliser des mises à jour des différences globales à la minute (?? global minutely diffs - mon anglais technique est insuffisant pour une traduction optimale). 
</p>

</div>

<h4 id="modification_des_sources_de_mise_a_jour">Modification des sources de mise à jour</h4>
<div class="level4">

<p>
Pour modifier les sources de mise à jour, le paramétrage est à faire dans le fichier &lt;settings/local.php&gt;. Par exemple, pour utiliser les mises à jours quotidiennes en Irlande à partir de Geofabrik, ajouter les lignes suivantes à &lt;settings/local.php&gt; :
</p>
<pre class="code">@define(&#039;CONST_Replication_Url&#039;, &#039;http://download.geofabrik.de/europe/ireland-and-northern-ireland-updates&#039;);
@define(&#039;CONST_Replication_MaxInterval&#039;, &#039;40000&#039;);     // Process each update separately, osmosis cannot merge multiple updates
@define(&#039;CONST_Replication_Update_Interval&#039;, &#039;86400&#039;);  // How often upstream publishes diffs
@define(&#039;CONST_Replication_Recheck_Interval&#039;, &#039;900&#039;);   // How long to sleep if no update found yet</pre>

<p>
Et pour la France :
</p>
<pre class="code">@define(&#039;CONST_Replication_Url&#039;, &#039;http://download.geofabrik.de/europe/france-updates&#039;);</pre>

</div>

<h4 id="remplacement_du_parametrage_anterieur">Remplacement du paramétrage antérieur</h4>
<div class="level4">

<p>
Il est nécessaire de préalablement effacer le fichier &lt;configuration.txt&gt; puis d’exécuter la commande setup.php :
</p>
<pre class="code">rm configuration.txt
./utils/setup.php --osmosis-init</pre>

</div>

<h4 id="activation_des_mises_a_jour_hierarchiques">Activation des mises à jour hiérarchiques</h4>
<div class="level4">

<p>
Lorsqu&#039;un lieu est modifié dans la base de données, l&#039;ensemble des lieux qui contiennent cet endroit doit être également mis à jour. Ces mises à jour hiérarchiques sont désactivées pas défaut car elles ralentissent l&#039;importation initiale. Il convient d&#039;activer ces mises à jour avec la commande suivante :
</p>
<pre class="code"> ./utils/setup.php --create-functions --enable-diff-updates</pre>

</div>
<div class='secedit editbutton_section editbutton_12'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Configuration des mises à jour] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_des_mises_a_jour" /><input type="hidden" name="codeblockOffset" value="47" /><input type="hidden" name="range" value="27809-29620" /><button type="submit" title="Configuration des mises à jour" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit13" id="mise_a_jour_de_nominatim">Mise à jour de Nominatim</h3>
<div class="level3">

<p>
La commande ci-dessous permet de maintenir à jour en permanence la base de donnée :
</p>
<pre class="code"> ./utils/update.php --import-osmosis-all --no-npi</pre>

<p>
Mise à jour des données si la base de données porte sur plusieurs pays : le script ci-dessous devrait faire le job (original <a href="https://github.com/twain47/Nominatim/issues/60" class="urlextern" title="https://github.com/twain47/Nominatim/issues/60" rel="nofollow">ici</a>)
</p>
<pre class="code">#!/bin/bash

### Country list
COUNTRIES=&quot;europe/isle-of-man europe/kosovo&quot;
NOMINATIM=&quot;/var/Nominatim&quot;

### Foreach country check if configuration exists (if not create one) and then import the diff
for COUNTRY in $COUNTRIES;
do
    DIR=&quot;$NOMINATIM/updates/$COUNTRY&quot;
    FILE=&quot;$DIR/configuration.txt&quot;
    if [ ! -f ${FILE} ];
    then
        /bin/mkdir -p ${DIR}
        /usr/bin/osmosis --rrii workingDirectory=${DIR}/.
        /bin/echo baseUrl=http://download.geofabrik.de/${COUNTRY}-updates &gt; ${FILE}
        /bin/echo maxInterval = 0 &gt;&gt; ${FILE}
        cd ${DIR}
        /usr/bin/wget http://download.geofabrik.de/${COUNTRY}-updates/state.txt
    fi
    FILENAME=${COUNTRY//[\/]/_}
    /usr/bin/osmosis --rri workingDirectory=${DIR}/. --wxc ${FILENAME}.osc.gz
done

INDEX=0 # false

### Foreach diff files do the import
cd ${NOMINATIM}/updates
for OSC in *.osc.gz;
do
    ${NOMINATIM}/utils/update.php --import-diff ${NOMINATIM}/updates/${OSC}
    INDEX=1
done

### Re-index if needed
if ((${INDEX}));
then
    ${NOMINATIM}/utils/update.php --index
fi

### Remove all diff files
rm -f ${NOMINATIM}/updates/*.osc.gz</pre>

</div>
<div class='secedit editbutton_section editbutton_13'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Mise à jour de Nominatim] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="mise_a_jour_de_nominatim" /><input type="hidden" name="codeblockOffset" value="51" /><input type="hidden" name="range" value="29621-31128" /><button type="submit" title="Mise à jour de Nominatim" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit14 page-header" id="en_cas_de_probleme">En cas de problème</h2>
<div class="level2">

<p>
Se rendre sur <a href="https://wiki.openstreetmap.org/wiki/Nominatim/Installation/Troubleshooting" class="urlextern" title="https://wiki.openstreetmap.org/wiki/Nominatim/Installation/Troubleshooting" rel="nofollow">https://wiki.openstreetmap.org/wiki/Nominatim/Installation/Troubleshooting</a>
</p>

</div>
<div class='secedit editbutton_section editbutton_14'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[En cas de problème] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="en_cas_de_probleme" /><input type="hidden" name="codeblockOffset" value="53" /><input type="hidden" name="range" value="31129-31254" /><button type="submit" title="En cas de problème" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit15 page-header" id="voir_aussi">Voir aussi</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="https://wiki.openstreetmap.org/wiki/Nominatim?setlang=fr" class="urlextern" title="https://wiki.openstreetmap.org/wiki/Nominatim?setlang=fr" rel="nofollow">Présentation</a> sur OpenStreetMap </div>
</li>
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="http://nominatim.org/release-docs/latest/admin/Installation/" class="urlextern" title="http://nominatim.org/release-docs/latest/admin/Installation/" rel="nofollow">Installation Nominatim</a> sur OpenStreetMap</div>
</li>
<li class="level1"><div class="li"> <a href="/osrm" class="wikilink1" title="osrm">OSRM</a></div>
</li>
</ul>

<p>
—-
<em>Contributeurs principaux : <a href="/zococo" class="wikilink2" title="zococo" rel="nofollow">Zococo</a>.</em>
</p>

<p>
<em>Basé sur <a href="https://wiki.openstreetmap.org/wiki/Nominatim/Installation" class="urlextern" title="https://wiki.openstreetmap.org/wiki/Nominatim/Installation" rel="nofollow">Installation Nominatim</a> par OpenStreetMap.</em>
</p>

</div>
<div class='secedit editbutton_section editbutton_15'><form class="button btn_secedit form-inline" method="post" action="/nominatim"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1596400945" /><input type="hidden" name="summary" value="[Voir aussi] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="voir_aussi" /><input type="hidden" name="codeblockOffset" value="53" /><input type="hidden" name="range" value="31255-" /><button type="submit" title="Voir aussi" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="nominatim.txt">nominatim.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 02/08/2020, 22:42">Le 02/08/2020, 22:42</span></li><li class="text-muted">par spnux</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=nominatim&amp;1635558938" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
