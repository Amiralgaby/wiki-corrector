{{tag>Bionic bureautique Windows}}

----


====== Microsoft Office ======

**Microsoft™ Office®** (MS Office) est une suite bureautique propriétaire et payante. Elle est conçue pour Microsoft Windows et Apple macOS, mais peut toutefois être installée sur un ordinateur fonctionnant avec Ubuntu, mais ceci n'est pas recommandé, et peut être compliqué.
<note important>**RGI**: le [[wpfr>Référentiel_général_d'interopérabilité|Réglement Général d'Interopérabilité]], dans sa version 2, en vigueur depuis 2016, recommande le format [[wpfr>OpenDocument|Open Document]], format par défaut de LibreOffice.\\ N'hésitez pas à divulguer cette information autour de vous. Les administrations françaises l'acceptent très largement, forcément puisque l'état en est à l'origine (http://references.modernisation.gouv.fr/sites/default/files/Referentiel_General_Interoperabilite_V2.pdf)! </note>
===== Avez-vous essayé LibreOffice ? =====

  * **L'installation de la suite Microsoft Office est superflue pour la plupart des utilisateurs**, c'est pourquoi nous vous conseillons d'utiliser la suite [[:LibreOffice]], qui est installée par défaut sur Ubuntu.
  * Pour lancer l'application, faites une recherche dans [[:unity#tableau_de_bord_dash|le tableau de bord Unity]] avec le mot clé **LibreOffice**, ou depuis le panneau des applications de GNOME.

//Vous pouvez aussi consulter les pages du **[[:bureautique|portail Bureautique]]**.//

<note tip>Sous [[:LibreOffice]], si vous avez des problèmes de police avec des documents provenant de MS Office, installez [[:msttcorefonts|les polices de caractères de Microsoft Office]] : **[[apt>ttf-mscorefonts-installer|ici]]** !</note>

===== Deux suites bureautiques gratuites : =====
====WPS Office ====
    
[[:wps_office|WPS Office]] est une suite de bureautique non libre et gratuite pour Linux, en concurrence directe avec Microsoft Office. Son atout ? La prise en charge native des extensions DOCX, PPTX, XLSX, PPSX, PPT, DOC, XLS, PPS et PDF,les formats de fichier Microsoft, ainsi que sa ressemblance avec Microsoft Office (l'utilisateur peut choisir entre une interface à rubans et une interface classique avec menus).

Cette suite est composée de WPS Writer (Microsoft Word), de WPS Presentation (Microsoft PowerPoint) et de WPS Spreadsheets (Microsoft Excel).

Elle est disponible en téléchargement sur le [[http://linux.wps.com|site officiel]]. Si vous voulez en savoir plus sur ce projet, vous pouvez consulter [[https://www.wps.com/linux?lang=fr|cette page]].

Bien que la dernière version de cette suite soit une alpha, elle fonctionne sans trop de bugs et son interface est facile à modifier et à mettre en français. Cependant, le dictionnaire par défaut est "en_US" (anglais des Etats-Unis). Pour corriger ce problème, deux solutions s'offrent à vous :

  * Télécharger le dictionnaire français officiel (mais incomplet) : [[http://wps-community.org/download/dicts/fr_FR.zip|sur ce site]].
  *  Télécharger un dictionnaire français non-officiel (mais plus complet, à l'exception de la grammaire) [[http://www.labathome.net/wp-content/uploads/2014/09/DictionnaireFR.7z|sur ce site]].
<note>Le dictionnaire français officiel est une archive ZIP. Il faut la décompresser et copier son contenu dans le dossier  d'installation du logiciel. Pour ce faire, deux solutions :
  * Graphiquement, ouvrir un explorateur de fichiers en root (non conseillé) et copier-coller le dossier dans /opt/kingsoft/wps-office/office6/dicts/
  * Ou par sécurité, ouvrir un terminal et couper-coller : <code>sudo mv ~/Bureau/fr_FR/ /opt/kingsoft/wps-office/office6/dicts/</code>
 [[http://mikedafunk.over-blog.org/article-wps-office-en-fran-ais-125335471.html|Source]]
Et pour mettre en français l'interface, téléchargez [[https://www.youtube.com/redirect?q=https%3A%2F%2Fwww.linuxtricks.fr%2Fupload%2Fwps-fr.tar.xz&redir_token=A1wzjBQ-DmEU86lMIybVIUKFnyF8MTU2NzQyNzQ2OEAxNTY3MzQxMDY4&v=AwLgOCCfnOc&event=video_description|ce fichier]], et décompréssez le dans un explorateur de fichiers en root dans <code>/opt/kingsoft/wps-office/office6/mui/</code>
</note>
<note warning>Des polices comme Wingdings, Wingdings2, Wingdings3 et MT Extra sont nécessaires pour certaines formules dans WPS Spreadsheets. Ces polices de Microsoft ne sont pas nativement installées sur WPS Office.</note>

<note important>Attention : Symbol.ttf est aussi à copier puis coller dans Fonts d'Ubuntu, avec les 4 autres polices Microsoft citées plus haut. Il faut faire cet ajout pour que disparaisse le message d'erreur au démarrage de WPS Writer. WPS Spreadsheets ne prend pas en charge la langue arabe  (lettres isolées et de gauche à droite au lieu de l'inverse).</note>

Si vous voulez toutes les polices citées plus haut et plein d'autres en un seul pack, c'est [[https://1drv.ms/f/s!Ah4vpmVYCzSxs25JuVD-zuInraKx|ici]].

<note important>Le copyright concernant les polices étant très vague, il est recommandé d'utiliser [[msttcorefonts|TTF MS Corefonts.]] Cependant ce lien renvoie à un dossier contenant toutes les polices de Microsoft et de Linux en un seul dossier.</note>

==== Microsoft Office 365 Online ====

Microsoft Office 365 Online est une version gratuite et en ligne de MS Office développée par Microsoft ; elle possède un peu moins de fonctionnalités mais permet une compatibilité correcte. Elle reste cependant incapable d'afficher les formules mathématiques. Pour y accéder, se rendre sur [[http://www.office.com]], se connecter avec un compte Microsoft, personnel, professionnel ou scolaire, et cliquer sur l'application souhaitée. À l'instar de Google Docs, cette application ne peut pas ouvrir directement les fichiers enregistrés sur votre disque dur : il faut au préalable les téléverser dans OneDrive.
===== Pourquoi Microsoft Office n'est pas la solution la plus adaptée sous Linux=====

  * L'installation de la suite Microsoft Office est rarement pleinement fonctionnelle sous Linux.
  * Si vraiment, pour des questions de compatibilité (école, entreprise...), vous ne pouvez pas utiliser LibreOffice, il existe Word Online (voir [[:microsoft_office#microsoft_office_online | plus haut]]), qui permet de modifier gratuitement les .doc et .docx sans soucis de compatibilité.

Si vous avez encore quelques hésitations, vous pourrez trouver [[https://drive.google.com/open?id=0B71NyqICD074UVJPeVFfSW1tTkU|ici]] une documentation qui décrit bien la problèmatique.\\
Néanmoins, l'utilisation de la suite Microsoft Office peut être recommandée lors d'un travail en commun avec des utilisateurs qui possèdent cette suite. En effet, un même document ouvert sous LibreOffice ou Microsoft Office peut présenter des différences de formatage (marges, tableaux etc.).

===== Installation de Microsoft Teams ====
**Teams** est à ce jour la seule application de la suite Office que Microsoft fournit pour GNU/Linux. C'est une application qui permet de faire de la vidéoconférence, de partager des fichiers et de les modifier avec Word, Excel et PowerPoint en ligne. \\
Elle est disponible si vous avez un abonnements Office 365 (Premium et Essentials). \\
Même si vous utilisez une autre suite bureautique, il peut être utile de l’installer si votre entreprise ou votre école l’utilise. \\
Il existe une version en ligne accessible via votre navigateur, mais depuis [[https://techcommunity.microsoft.com/t5/microsoft-teams-blog/microsoft-teams-is-now-available-on-linux/ba-p/1056267|octobre 2019]] Microsoft fournit son client (propriétaire) officiel au format linux (.deb). Ce client teams ne convient pas aux ordinateurs les plus anciens car le paquet n’est disponible qu’en 64 bit et il utilise beaucoup de ressources.

Pour l’installer, il suffit de télécharger le paquet au format deb sur [[https://teams.microsoft.com/uswe-01/downloads|cette page]] puis de l’installer graphiquement ou en ligne de commande.

Le paquet **teams** en **.deb** installe non seulement le logiciel, mais __aussi__ le dépôt **teams** Microsoft pour linux. Vous bénéficierez donc de toutes les mises à jours de teams à chaque mise à jour de vos logiciels. Par contre, l'installation automatique de dépôt est  considéré comme un risque en matière de sécurité et est plutôt mal vue dans le monde linux. Si vous souhaitez retirer le dépôt sans retirer le logiciel : **sudo rm /etc/apt/sources.list.d/teams.list**.

Il existe aussi une [[https://flathub.org/apps/details/com.microsoft.Teams|version flatpack]].
===== Installation de Microsoft Office avec PlayOnLinux =====

Si vous avez besoin de Microsoft Office, il est possible d'installer certaines versions de MS Office dans Ubuntu en utilisant [[:Wine]] ou [[:PlayOnLinux]] et éventuellement, en dernier recours, la [[:virtualisation]]. 
Si vous rencontrez des difficultés, laissez un message sur [[https://forum.ubuntu-fr.org/viewtopic.php?id=230575|cette page du forum]].
Si vous n'arrivez pas à rentrer la clé de validation (champ non cliquable/inactif), consultez [[http://forum.ubuntu-fr.org/viewtopic.php?pid=4287101#p4287101|ce post]].


Vous pouvez installer toutes les versions de MS Office avec [[:PlayOnLinux]] : 2000 (Outlook2000 ne fonctionne pas), 2003, 2007 et 2010 fonctionnent sans trop de bugs, voire même très bien, mais Microsoft Office 2013 présente beaucoup de bugs et d'instabilités. Quant aux dernières versions (2016.0.4266.1003 et suivantes), inutile d'en parler, elles ne fonctionnent pas du tout. Outlook, Word, excel 2010 ont été testés sous Ubuntu 18.04.

=====Installation de Microsoft Office avec Wine=====

 [[:tutoriel:comment_installer_un_paquet|Installez les paquets]] [[:wine]] et **[[apt>wine-gecko,wine-mono,winbind,cabextract,zenity|wine-gecko wine-mono winbind cabextract zenity]]**.

Les quatre premiers [[:tutoriel:comment_installer_un_paquet|paquets]] sont indispensables au fonctionnement de MS Office dans Wine. Ils sont peut-être déjà installés. Le cinquième  (zenity) affiche le menu pour //winetricks//.
====Versions MS Office et Wine====

MS Office 2016 fonctionne avec Wine 3.0x et MS Office 2013 avec Wine 2.0x.  Référez-vous au tuto de [[:wine]] pour son installation. Il vous faudra vraisemblablement installer winehq-stable via les dépôts de Wine, mais cela dépendra de votre version d'Ubuntu. Sinon, pour MS Office 2010 ou 2007, Wine 1.6 (ou supérieur) fait l'affaire (il s'agit de l'installation Wine par défaut dans Ubuntu LTS 16.04).  Après avoir installé Wine, ouvrez un terminal et tapez  //wine winver// pour savoir de quelle version il s'agit.  

Wine ne peut faire fonctionner MS Office que dans un environnement 32 bits. Il vous faudra donc disposer de la version 32 bits de MS Office. En plus, il vous faudra l'installer dans un profil Wine de 32 bits. Sur une [[:architecture_materielle|architecture]]  32 bits (donc une édition d'Ubuntu en 32 bits) cela ne pose aucun problème : tout fonctionne en 32 bits par défaut. Sur une [[:architecture_materielle|architecture]] 64 bits, il faut forcer Wine à créer un profil 32 bits (par défaut, il créera un profil 64 bits). Si vous souhaitez exécuter des applications 64 bits (par exemple des jeux gourmands) à côté de MS Office, il vous faudra gérer plusieurs profils WINE — au moins un en 32 et un en 64 bits — et donc autant de répertoires différents, ce qui complique un peu la gestion. 

Pour cette raison, la suite du tutoriel est divisée en deux parties. Dans la première, on considère que vous n'avez besoin que d'un seul préfixe Wine 32 bits — en gros vous utilisez wine essentiellement que pour MS Office. La seconde partie est destinée à ceux qui ont besoin de plusieurs environnements Wine. Pour cette situation, on montrera comment gérer deux profils Wine, situés respectivement dans les répertoires ~/.Win32 et ~/.Win64.


====Environnements simple avec un seul prefixe WINE====
Wine créé par défaut dans votre //home// le répertoire //~.wine//. Il s'agit  d'un profil Wine, qu'on appelle aussi préfixe. Si déjà existant, dans un environnement 64 bits celui-ci est vraisemblablement en 64 bits. Le plus simple est de l'effacer pour se prémunir de mauvaises surprises. Dans un terminal tapez :
<code> rm -rf ~/.wine </code>
Cela effacera le répertoire caché .wine et tout ce qu'il contenait. C'est ainsi qu'on efface un profil wine. Difficile de faire plus simple.

Pour le recréer //MAIS EN 32 BITS// taper simplement dans un terminal :
<code> WINEARCH=win32 wine winecfg </code>
Voilà votre .wine créé en 32 bits.  La fenêtre de configuration de Wine qui s'ouvre confirme la bonne installation du profil — vous pouvez la fermer. Vous pouvez vérifier l'existence du répertoire en tapant   <code>    ls -all ~  </code>  dans un terminal. 

===Bibliothèques et polices utiles à la bonne exécution de MS Office===
<note warning>Vérifier que ces informations sont toujours valables avec Microsoft Office 2016.</note>
Certaines bibliothèques Windows reproduites par les codeurs de Wine ne sont pas encore « à point » pour l'utilisation en MS Office. Il est alors nécessaire de recourir aux bibliothèques originales. En outre, il s'avère nécessaire d'ajouter certaines polices de caractères pour le bon fonctionnement de MS Office.

Ces suppléments peuvent être facilement installés via le shell [[:winetricks]]. Or, la version de winetricks installée par défaut avec Wine est obsolète : les liens pour le téléchargement des bibliothèques sont inopérants. Le mieux est alors de (1) désinstaller le script d'origine, (2) télécharger le script winetricks « frais »  à partir du site [[https://wiki.winehq.org/Winetricks]], (3) de le rendre exécutable puis (4) de le déplacer dans /usr/bin/. 

Pour cela, après vérification que [[https://wiki.winehq.org/Winetricks|le lien de téléchargement de winetricks est toujours valable]] (vérifié valide le 29 nov 2020), il faut exécuter la séquence suivante dans un terminal :
<code>
sudo apt-get install cabextract winbd
sudo apt-get purge winetricks      # cela efface la version obsolète de winetricks
wget  https://raw.githubusercontent.com/Winetricks/winetricks/master/src/winetricks    # téléchargement
chmod +x winetricks   # rendre winetricks exécutable 
sudo mv winetricks /usr/local/bin/winetricks     # déplacer winetricks dans /usr/local/bin   </code>   
Vous aurez ainsi actualisé et surtout rendu utilisable winetricks.

Puis  exécutez
<code> sudo apt-get install fonts-crosextra-carlito fonts-crosextra-caladea   # Polices de substition pour Calibri et Cambria </code>
<code> winetricks riched20 riched30 vcrun2008 msxml3 msxml6 gdiplus vb3run vb4run vb5run vb6run wininet corefonts opensymbol   && echo && echo      ! tâche 1 bien terminée </code>
<code> winetricks consolas cambria lucida tahoma   && echo && echo   ! tâche 2 bien terminée </code>  

Riched20, dotnet20, gdiplus et msxml6 sont indispensables, au moins pour l’exécution de MS Office 2010. Les vbxrun servent aux macros VBA ; wininet est nécessaire à OneNote. Alternativement, il est possible de récupérer les DLL système de Windows et Office  [[http://www.telecharger-dll.fr/|ici]] : il suffira alors de les coller à la place des anciens dans //.wine/drive_c/windows/system32//.

Polices : Corefonts contient les polices de base de Windows libres, et les polices suivantes peuvent s'avérer utiles. Or, les polices de la tâche 2 ne sont pas libres. Elles sont alors installées de façon juridiquement « propre » par la Visionneuse PowerPoint gratuite qui apporte ces polices et dont on ne peut interdire l'exploitation. Winetricks télécharge donc PowerPointViewer.exe, qu'il sauvegarde dans /home/toto/.cache/winetricks/Powerpointviewer.
Les propriétaires d'une licence Microsoft Windows XP valide peuvent simplement copier-coller les polices du répertoire c:\Windows\Fonts, pour les placer dans un des répertoires Ubuntu listé dans la section  6.2 (remplacement de Wingdings) — et régénérer le //font cache//.
<code> fc-cache -f -v </code>
Il reste finalement à installer le //.Net Framework//
<code> winetricks dotnet20    && echo && echo  ! tâche 3 bien terminée</code>

A toute fin, ça peut être utile : rebooter wine : <code> wineboot -k </code>


Nota :  si un seul des paquets listés pose problème, winetricks interrompt l’exécution et le reste de la ligne n'est pas installé. Donc, si vous ne voyez pas le texte    //! tâches 1 (ou 2, ou  3) bien terminées !// à la fin dans votre terminal, il faudra étudier l'écrit du terminal pour comprendre ou se situe l'interruption, puis lancer le script en ne mettant que les paquets non encore installés.

L’exécution de winetricks dans un terminal sans commande ultérieure vous ouvre un menu graphique vous permettant l'installation d'autres bibliothèques DLL ou de logiciels. Cliquer sur //select the default wineprefix//  pour accéder à toutes les options. Vous n'avez pas besoin de vous soucier du wineprefix puisque vous travaillez dans le préfixe par défaut  //.wine//.
      

Fermer winetricks et lancez à nouveau //winecfg//, onglet //Applications//.  Pour MS Office 2007/2010, entrer la version « Windows XP », pour les versions supérieures ce sera « Windows 7 ». En version Windows 7 le lancement de MS Office 2010 n'arrivera pas à terme. Puis vérifiez que l'onglet « Bibliothèques » ressemble bien à peu près à l'image ci-dessous. //Remplacements existants// liste les composantes « built-in » de Wine remplacées par celles « natives » de MS Windows. //native, built-in// signale l’exécution prioritaire de l'application native. Cliquer sur OK.

{{ wine:winecfg_native.png }}

===Installation de MS Office===

  * Lancez l'installation par : <code>  wine "/Chemin_vers_votre_OFFICE20xx_SETUP.EXE"</code>                Adaptez le chemin à l'endroit ou se trouve le setup.exe 32 bits de votre MS Office. Puis lancez et suivez les instructions... vous avez installé MS Office.

===Lancement de MS Office===
En exemple le lancement de Word, Excel et Powerpoint 2010 — entrez votre chemin de façon correspondante.

<code> wine "$HOME/.wine/drive_c/Program Files/Microsoft Office/Office14/WINWORD.EXE"
 wine "$HOME/.wine/drive_c/Program Files/Microsoft Office/Office14/EXCEL.EXE"
 wine "$HOME/.wine/drive_c/Program Files/Microsoft Office/Office14/POWERPNT.EXE"
</code> 
Ce sont typiquement les commandes à entrer dans les lanceurs — obligatoirement avec le prefix 'env'


====Environnements avec plusieurs profils de Wine ====
Vous souhaitez exécuter plusieurs [[:wine_profils|profils wine]] — ou, simplement, vous souhaitez installer MS Office ailleurs que dans //.wine//, le répertoire par défaut. Vous trouverez ici comment correctement gérer les différents environnements. 

On prévoit ici deux répertoires : un répertoire (avec profil et préfixe) 64 bits //.wine/// et un répertoire (avec profil et préfixe) //.win32// qui recevra MS Office.

Entrez dans un [[:terminal]]: <code>winecfg
WINEARCH=win32 WINEPREFIX=/$HOME/.win32 winecfg</code> 
La première ligne correspond à (l'éventuelle) création du profil et répertoire par défaut .wine. S'il existait déjà alors, il continue d'exister — vous avez simplement ouvert le fichier de configuration. S'il n'existait pas, alors vous venez de le créer. Si vous avez une architecture 64 bits alors ce profil est en 64 bits — sinon il est en 32 bits. Sur une architecture 64 bits //WINEARCH=win64 WINEPREFIX=/$HOME/.wine winecfg// aurait eu le même effet.
La deuxième ligne force la création du profil et répertoire wine //.win32// en 32 bits. Ces répertoires représentent l'équivalent de deux disques durs virtuels, ou de deux machines virtuelles. Vous avez donc désormais deux « systèmes » ou vous pouvez installer/exécuter des logiciels Wine : .wine pour les logiciels 64 bits et .win32 pour les logiciels 32 bits.
Donc, désormais à chaque exécution d'un logiciel dans .win32 il faudra appeler le préfixe , sinon Wine voudra travailler avec .wine.
 
 *  Exemples :        <code>WINEPREFIX=/$HOME/.win32 winecfg</code> pour ouvrir winecfg de .win32. 
<code>WINEPREFIX=/$HOME/.win32 winetricks </code> pour appliquer winetricks à .win32 et non pas à .wine    
<code>  WINEPREFIX=/$HOME/.win32 wine  "$HOME/.win32/drive_c/Program Files.../excel.exe"    </code> pour lancer Excel, etc.
       
On aura compris qu'il suffit de faire précéder chaque commande wine par la commande préfixe indiquant à wine quel profil choisir  (WINEPREFIX=/$HOME/.win32). Il faudra donc installer les bibliothèques et polices cités plus haut en ajoutant simplement le préfixe à chaque commande.
              


=====Réglages post-installation=====
Cette section concerne potentiellement toutes les déclinaisons de Wine : Wine, PlayOnLinux, Crossover...

====Ouverture de fichier par défaut====
Si le menu contextuel ne vous propose pas les modules MS Office pour ouvrir des fichiers lors du clic droit -> //Ouvrir avec//, ajoutez les lignes suivantes dans le fichier //~/.local/share/applications/mimeaaps.list//. Elles doivent être ajoutées à la fois sous la section ''[Default Applications]'' et sous la section ''[Added Associations]'':
<file>
application/msonenote=wine-extension-onepkg.desktop;wine-extension-one.desktop;
application/msword=wine-extension-wbk.desktop;wine-extension-doc.desktop;
application/msword-template=wine-extension-dot.desktop;
application/pdf=mendeleydesktop.desktop;
application/pics-rules=wine-extension-prf.desktop;
application/rat-file=wine-extension-rat.desktop;
application/rtf=wine-extension-rtf.desktop;
application/vnd.ms-excel=wine-extension-xlw.desktop;wine-extension-xls.desktop;wine-extension-xlk.desktop;wine-extension-xll.desktop;wine-extension-xlm.desktop;wine-extension-xlt.desktop;wine-extension-xla.desktop;
application/vnd.ms-excel.addin.macroEnabled.12=wine-extension-xlam.desktop;
application/vnd.ms-excel.sheet.binary.macroEnabled.12=wine-extension-xlsb.desktop;
application/vnd.ms-excel.sheet.macroEnabled.12=wine-extension-xlsm.desktop;
application/vnd.ms-excel.template.macroEnabled.12=wine-extension-xltm.desktop;
application/vnd.ms-htmlhelp=wine-extension-chm.desktop;
application/vnd.ms-mediapackage=wine-extension-mpf.desktop;
application/vnd.ms-officetheme=wine-extension-thmx.desktop;
application/vnd.ms-powerpoint=wine-extension-ppa.desktop;wine-extension-pps.desktop;wine-extension-pwz.desktop;wine-extension-pot.desktop;wine-extension-ppt.desktop;
application/vnd.ms-powerpoint.addin.macroEnabled.12=wine-extension-ppam.desktop;
application/vnd.ms-powerpoint.presentation.macroEnabled.12=wine-extension-pptm.desktop;
application/vnd.ms-powerpoint.slide.macroEnabled.12=wine-extension-sldm.desktop;
application/vnd.ms-powerpoint.slideshow.macroEnabled.12=wine-extension-ppsm.desktop;
application/vnd.ms-powerpoint.template.macroEnabled.12=wine-extension-potm.desktop;
application/vnd.ms-visio.viewer=wine-extension-vdx.desktop;
application/vnd.ms-word.document.macroEnabled.12=wine-extension-docm.desktop;
application/vnd.ms-word.template.macroEnabled.12=wine-extension-dotm.desktop;
application/vnd.oasis.opendocument.presentation=wine-extension-odp.desktop;
application/vnd.oasis.opendocument.spreadsheet=wine-extension-ods.desktop;
application/vnd.oasis.opendocument.text=wine-extension-odt.desktop;
application/vnd.openxmlformats-officedocument.presentationml.presentation=wine-extension-pptx.desktop;
application/vnd.openxmlformats-officedocument.presentationml.slide=wine-extension-sldx.desktop;
application/vnd.openxmlformats-officedocument.presentationml.slideshow=wine-extension-ppsx.desktop;
application/vnd.openxmlformats-officedocument.presentationml.template=wine-extension-potx.desktop;
application/vnd.openxmlformats-officedocument.spreadsheetml.sheet=wine-extension-xlsx.desktop;
application/vnd.openxmlformats-officedocument.spreadsheetml.template=wine-extension-xltx.desktop;
application/vnd.openxmlformats-officedocument.wordprocessingml.document=wine-extension-docx.desktop;
application/vnd.openxmlformats-officedocument.wordprocessingml.template=wine-extension-dotx.desktop;
application/vnd.visio=wine-extension-vsd.desktop;
application/x-ms-application=wine-extension-application.desktop;
application/x-ms-vsto=wine-extension-vsto.desktop;
application/x-ms-xbap=wine-extension-xbap.desktop;
application/x-mswinurl=wine-extension-url.desktop;
application/x-mswrite=wine-extension-wri.desktop;
application/x-vbscript=wine-extension-vbs.desktop;
application/x-wine-extension-appref-ms=wine-extension-appref-ms.desktop;
application/x-wine-extension-compositefont=wine-extension-compositefont.desktop;
application/x-wine-extension-dic=wine-extension-dic.desktop;
application/x-wine-extension-dochtml=wine-extension-dochtml.desktop;
application/x-wine-extension-dothtml=wine-extension-dothtml.desktop;
application/x-wine-extension-dqy=wine-extension-dqy.desktop;
application/x-wine-extension-exc=wine-extension-exc.desktop;
application/x-wine-extension-fkdm=wine-extension-fkdm.desktop;
application/x-wine-extension-hlp=wine-extension-hlp.desktop;
application/x-wine-extension-msp=wine-extension-msp.desktop;
application/x-wine-extension-onetoc=wine-extension-onetoc.desktop;
application/x-wine-extension-onetoc2=wine-extension-onetoc2.desktop;
application/x-wine-extension-pothtml=wine-extension-pothtml.desktop;
application/x-wine-extension-ppthtml=wine-extension-ppthtml.desktop;
application/x-wine-extension-pptxml=wine-extension-pptxml.desktop;
application/x-wine-extension-rels=wine-extension-rels.desktop;
application/x-wine-extension-xevgenxml=wine-extension-xevgenxml.desktop;
application/x-wine-extension-xlshtml=wine-extension-xlshtml.desktop;
application/x-wine-extension-xlthtml=wine-extension-xlthtml.desktop;
application/xaml+xml=wine-extension-xaml.desktop;
application/xml=wine-extension-xml.desktop;
image/gif=wine-extension-gif.desktop;
image/jpeg=wine-extension-jfif.desktop;wine-extension-jpe.desktop;
image/png=wine-extension-png.desktop;
inode/directory=pcmanfm.desktop;
message/rfc822=wine-extension-mht.desktop;
text/csv=wine-extension-csv.desktop;
</file>

====Remplacement de la police Wingdings « tronquée » installée par défaut====

Ouvrez PowerPoint sous Wine, puis entrez la série des caractères suivante dans une fenêtre de texte (ou un titre) :   <code>     <==        <==>      :)     :(    </code>  Ces séries de deux ou trois caractères consécutifs sont normalement remplacées par des symboles issus de la police wingdings : une jolie flèche pointant vers la gauche, une double-flèche, un smiley souriant, un smiley triste. Or, voilà, vous obtenez bien la flèche gauche — suivie de trois carrés vides. 

Ce problème est lié à la police incomplète de Wingdings installée avec Wine (et/ou Ubuntu). Démonstration : toujours dans PowerPoint dans Wine, affichez la police Wingdings : onglet //insertion//, puis le bouton //Symboles//  (pour PPT2010,  simile autre versions). Puis cherchez dans le menu //Police// jusqu'à afficher Wingdings. Vous verrez l'intégralité des symboles de cette police — qui est bien pauvre. Environ 20 caractères-symboles se courent l'un après l'autre.
Puis, dans un PowerPoint lancé sur un « vrai » Microsoft Windows (donc en dehors d'Ubuntu, ou sur système virtuel), faites de même : ouvrez la police Wingdings. Vous verrez un tableau de caractères bien garni. En particulier, vous verrez qu'il y a  bien la double-flèche et les smileys qui manquent dans la police Wingdings tronquée de Wine.

Le manque de ces quelques caractères peut s'avérer assez pénible : les ppt de vos collègues affichent des carrés au lieu de smileys, les puces (encore piochées dans Wingdings) ne s'affichent pas, il manque la flèche dans les réactions chimiques...

Pour corriger le problème il suffit de copier //wingdings.ttf// (la police TrueType de Wingdings) de votre installation Windows vers Ubuntu. Dans MS Windows, elle est située dans C:\Windows\Fonts. Copiez-collez la dans // /usr/share/fonts// de votre installation Ubuntu (version Xenial Xerus — éventuellement ailleurs dans les versions plus anciennes) — ou dans // /home/<username>/.fonts// (éventuellement  ~/.local/share/fonts). Ainsi, toutes vos applications Linux et Wine profiteront de la police complétée Wingdings....  **...après régénération du font cache**.

Pour cela, tapez dans un terminal :
     
<code>          ~/.local/share/fonts  </code>
 
Vous pouvez aussi copier la police dans le répertoire dédié de votre profil MS Office  (// /home/<username>/.wine/drive_c/windows/Fonts// pour wine, ou  ///home/<username>/.cxoffice/Microsoft_Office_2010/drive_c/windows/Fonts// pour Crossover ou encore  // /home/<username>/.playonlinux/Microsoft_Office_2010/drive_c/windows/Fonts // pour PlayOnLinux...). Il s'agit en fait du répertoire ou MS Windows loge ses fonts. Dans ce cas la police « améliorée » ne sera disponible que pour les applications situés dans les préfixes (ou répertoires ou profils ou bouteilles...) wine ciblés.

Des changements et/ou une « non-unicodification » de la police Wingdings, éventuellement en lien avec une politique Microsoft d'accès libre inconstante envers cette police, semblent être à l'origine de l'émission de la police Wingdings « tronquée », à en croire les posts circulant sur le web.


====Imprimante PDF====

En installant le paquet **[[apt>cups-pdf]]**, on peut avoir une imprimante PDF dans Wine. De cette façon, on peut exporter en PDF mais pas seulement pour MS Office : aussi pour toute application installée dans Wine.


==== Configuration intempestive SETUP.EXE ====
Si la configuration automatique d'Office se lance de façon intempestive à chaque ouverture de fichier alors que la suite a été installée sans problème, il est possible d'initialiser certaines clefs de registre documentées [[https://answers.microsoft.com/en-us/msoffice/forum/msoffice_install-mso_other/constant-setting-up/8536e71a-af0c-4046-8e7d-43805284b612?auth=1|sur le site du support microsoft]] pour contourner le problème.
Par exemple pour Word 2007, en lancant l'éditeur avec <code>wine regedit</code> et en navigant jusqu'à **HKEY_CURRENT_USER\Software\Microsoft\Office\12.0\Word\Options**, on peut créer un **DWORD** nommé **NoReReg** puis changer sa valeur hexa à **1**

Il est possible de le faire simplement en console, tel que :
<code>
wine reg add HKCU\Software\Microsoft\Office\12.0\Word\Options /v NoReReg /t REG_DWORD /d 0x00000001 
</code>

==== Visionneuses Powerpoint, Word et Excel====

On peut bien sûr, à la place d'Office (il faut la licence, tout de même...), installer les visionneuses gratuites. Vous ne pourrez pas éditer les documents, mais au moins les afficher.

Pour PlayOnLinux/Crossover : cherchez dans les menus. Pour Wine : téléchargez les visionneuses pour Microsoft Office sur les liens suivants :
  * [[https://www.commentcamarche.net/download/telecharger-207-word-viewer|Word Viewer (2003)]]
  * [[https://www.commentcamarche.net/download/telecharger-209-excel-viewer|Excel Viewer]]
  * [[https://download.cnet.com/PowerPoint-Viewer-2007/3000-18483_4-10742145.html|PowerPoint Viewer (2007)]]
Exécutez avec [[:Wine]] les fichiers, et vous devriez les retrouver dans le menu dédié à Wine. Pour lire les documents Word enregistrés dans le nouveau format (*.docx), vous devrez également installer le [[https://filehippo.com/download_microsoft_office_compatibility_pack_for_word_excel_and_powerpoint_file_formats/|pack de compatiblité]].

Pour les utilisateurs ayant installé MS Office 2003 : l'installation de la visionneuse Powerpoint 2007 est utile dans la mesure où elle met à disposition légalement et installe correctement les polices Cleartype introduites avec MS Office 2007 : Calibri, Cambria, Candara, Consolas, Constantia, et Corbel.

Par ailleurs, les polices Carlito et Caladea sont des substituts issus du monde libre compatibles avec les polices Calibri et Caladea, très utilisées.

 


=====Configuration=====
Vous pourrez trouver les différents modules de MSOffice en faisant une recherche dans [[:unity#tableau_de_bord_dash|le tableau de bord Unity]].

==== Ouvrir un fichier en cliquant dessus ====

Vous pouvez ouvrir un fichier de la suite Office en cliquant droit dessus et en choisissant simplement le module requis. Vous pouvez aussi le mettre par défaut par un clic droit -> //Propriétés//, choisir le module et cocher la case //Définir par défaut//.
==== Créer un raccourci ====

Pour créer un raccourci, reportez-vous à [[:raccourci-lanceur|la page dédiée]]. Vous trouverez la commande [[:wine#lancer_un_programme_windows|ici]] et les icônes via le chemin **.local/share/application/wine/Programs/Microsoft Office**.
Vous pouvez également, à partir du tableau de bord Unity, glisser directement les icônes dans la barre d'application.

===== Liens =====

  * (en) [[https://help.ubuntu.com/community/Microsoft_Office|Wiki Ubuntu anglais]],
  * forum Ubuntu-fr : [[https://forum.ubuntu-fr.org/viewtopic.php?id=230575|post sur le sujet]],
  * forum Ubuntu-fr : [[https://forum.ubuntu-fr.org/viewtopic.php?id=179700|autre post sur le sujet]],
  * Procédure sur ce [[http://nithinaneeshsct06bt.blogspot.fr/2013/02/install-microsoft-office-2010-in-ubuntu.html|site]] en anglais
----

//Contributeurs principaux : [[:utilisateurs:yannubuntu|YannUbuntu]],  [[utilisateurs:lapinter|lapinter]],[[utilisateurs:augustinbv|augustinbv]] Robert DEDENON (Roberto Melomaniaque) et LSping.//