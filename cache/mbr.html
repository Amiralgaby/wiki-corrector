<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>mbr [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="tutoriel,ebr"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/mbr?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/mbr?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/mbr"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/mbr"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/mbr"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"mbr","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="mbr">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/mbr?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/mbr?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/mbr?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/mbr?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/mbr?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/mbr?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/mbr?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">mbr</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/mbr?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/mbr?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/mbr?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#pre-requis","title":"Pr\u00e9-requis","level":1},{"link":"#qu_est_ce_que_le_mbr_et_comment_y_acceder","title":"Qu'est ce que le mbr et comment y acc\u00e9der","level":1},{"link":"#les_differentes_parties_du_mbr","title":"Les diff\u00e9rentes parties du mbr","level":1},{"link":"#la_partie_executable","title":"La partie ex\u00e9cutable","level":2},{"link":"#l_identifiant_de_disque","title":"L'identifiant de disque","level":2},{"link":"#la_table_des_partitions_primaires","title":"La table des partitions primaires","level":2},{"link":"#le_nombre_magique","title":"Le nombre magique","level":2},{"link":"#exercice_pratique","title":"Exercice pratique","level":1},{"link":"#problemes_connus","title":"Probl\u00e8mes connus","level":1},{"link":"#voir_aussi","title":"Voir aussi","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#pre-requis">Pré-requis</a></li>
<li class="level1"><a href="#qu_est_ce_que_le_mbr_et_comment_y_acceder">Qu&#039;est ce que le mbr et comment y accéder</a></li>
<li class="level1"><a href="#les_differentes_parties_du_mbr">Les différentes parties du mbr</a>
<ul class="nav toc">
<li class="level2"><a href="#la_partie_executable">La partie exécutable</a></li>
<li class="level2"><a href="#l_identifiant_de_disque">L&#039;identifiant de disque</a></li>
<li class="level2"><a href="#la_table_des_partitions_primaires">La table des partitions primaires</a></li>
<li class="level2"><a href="#le_nombre_magique">Le nombre magique</a></li>
</ul>
</li>
<li class="level1"><a href="#exercice_pratique">Exercice pratique</a></li>
<li class="level1"><a href="#problemes_connus">Problèmes connus</a></li>
<li class="level1"><a href="#voir_aussi">Voir aussi</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/tutoriel" class="wikilink1" title="tutoriel" rel="tag">tutoriel</a>,
	<a href="/ebr" class="wikilink1" title="ebr" rel="tag">ebr</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="qu_est_ce_que_le_mbr">Qu&#039;est ce que le mbr ?</h1>
<div class="level1">

<p>
Ce tutoriel explique ce qu&#039;est le <a href="https://fr.wikipedia.org/wiki/Master_boot_record" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Master_boot_record">MBR</a> d&#039;un disque ou d&#039;un média amovible, son organisation et à quoi il sert.<br/>

 
</p>
<div class="notetip"><strong>Voir <a href="/gpt" class="wikilink1" title="gpt">GPT</a> pour les HDD &gt; 2To</strong>
</div>
</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[Qu&#039;est ce que le mbr ?] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="qu_est_ce_que_le_mbr" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="29-263" /><button type="submit" title="Qu&#039;est ce que le mbr ?" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="pre-requis">Pré-requis</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Disposer des <a href="/sudo" class="wikilink1" title="sudo">droits d&#039;administration</a></div>
</li>
<li class="level1"><div class="li"> Connaitre la numération hexadécimale.</div>
</li>
<li class="level1"><div class="li"> Utiliser la calculatrice gcalctool en mode programmation (pour faire facilement des conversions hexadécimal/décimal)</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[Pré-requis] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="pre-requis" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="264-508" /><button type="submit" title="Pré-requis" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit3 page-header" id="qu_est_ce_que_le_mbr_et_comment_y_acceder">Qu&#039;est ce que le mbr et comment y accéder</h2>
<div class="level2">

<p>
Le mbr (Master Boot Record) est le premier secteur d&#039;un disque dur, d&#039;une clé usb ou d&#039;un autre média amovible.<br/>

<br/>

Sa présence est essentielle pour accéder aux systèmes de fichiers présents et en cas de corruption de ce dernier il sera impossible d&#039;accéder aux données ou, dans une moindre mesure, impossible de redimensionner les partitions.
</p>

<p>
Compte tenu du risque encouru, son accès ne peut s&#039;effectuer qu&#039;en mode superutilisateur (sudo). <br/>

<br/>

Pour y accéder nous aurons besoin de la fonction <a href="/dd" class="wikilink1" title="dd">dd</a>. Cette fonction permet d&#039;accéder directement à un contenu présent sur le disque en s&#039;affranchissant de tout système de fichiers.
</p>

<p>
Le disque est considéré comme un espace linéaire constitué de blocs de données, appelés secteurs, de 512 octets chacun, et dont la position est repérée par la LBA (Logical block addressing).
La première adresse commence en zéro (mbr) et la dernière (pas forcément utilisable) peut être calculée en divisant la taille du disque en octets par 512 et en retirant 1.
</p>

<p>
<br/>

Une des syntaxes pour afficher le mbr est par exemple :
<br/>

</p>
<pre class="code">sudo dd if=/dev/sda bs=512 count=1 | hexdump -C</pre>

<p>
<br/>

Ce qui signifie en clair :
<br/>

<br/>

En tant que superutilisateur (sudo) je demande de faire une copie par blocs (dd) avec comme source (if) le matériel /dev/sda (premier disque dur), que le bloc désiré doit faire 512 octets et que je ne copie qu&#039;un bloc.
<br/>

La sortie par défaut est ensuite redirigée (pipe | ) dans la moulinette hexdump qui formate les données sous la forme adresse, valeurs hexadécimale de 16 octets consécutifs et caractères ascii correspondants.
</p>
<div class="noteclassic">Dans le cas où on souhaite afficher le mbr d&#039;un autre disque, d&#039;une clé usb… il conviendra d&#039;adapter le nom du &quot;device&quot; par celui qui va bien (sdb, sdc…)
</div>
</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[Qu&#039;est ce que le mbr et comment y accéder] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="qu_est_ce_que_le_mbr_et_comment_y_acceder" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="509-2381" /><button type="submit" title="Qu&#039;est ce que le mbr et comment y accéder" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit4 page-header" id="les_differentes_parties_du_mbr">Les différentes parties du mbr</h2>
<div class="level2">

<p>
<br/>

</p>

<p>
Voici par exemple ce que donne le mbr de mon disque dur
<br/>

</p>
<pre class="code">00000000  eb 63 90 d0 bc 00 7c 8e  c0 8e d8 be 00 7c bf 00  |.c....|......|..|
00000010  06 b9 00 02 fc f3 a4 50  68 1c 06 cb fb b9 04 00  |.......Ph.......|
00000020  bd be 07 80 7e 00 00 7c  0b 0f 85 10 01 83 c5 10  |....~..|........|
00000030  e2 f1 cd 18 88 56 00 55  c6 46 11 05 c6 46 10 00  |.....V.U.F...F..|
00000040  b4 41 bb aa 55 cd 13 5d  72 0f 81 fb 55 aa 75 09  |.A..U..]r...U.u.|
00000050  f7 c1 01 00 74 03 fe 46  10 66 00 80 01 00 00 00  |....t..F.f......|
00000060  00 00 00 00 ff fa 90 90  f6 c2 80 75 02 b2 80 ea  |...........u....|
00000070  74 7c 00 00 31 c0 8e d8  8e d0 bc 00 20 fb a0 64  |t|..1....... ..d|
00000080  7c 3c ff 74 02 88 c2 52  bb 17 04 80 27 03 74 06  ||&lt;.t...R....&#039;.t.|
00000090  be 88 7d e8 1c 01 be 05  7c f6 c2 80 74 48 b4 41  |..}.....|...tH.A|
000000a0  bb aa 55 cd 13 5a 52 72  3d 81 fb 55 aa 75 37 83  |..U..ZRr=..U.u7.|
000000b0  e1 01 74 32 31 c0 89 44  04 40 88 44 ff 89 44 02  |..t21..D.@.D..D.|
000000c0  c7 04 10 00 66 8b 1e 5c  7c 66 89 5c 08 66 8b 1e  |....f..\|f.\.f..|
000000d0  60 7c 66 89 5c 0c c7 44  06 00 70 b4 42 cd 13 72  |`|f.\..D..p.B..r|
000000e0  05 bb 00 70 eb 76 b4 08  cd 13 73 0d f6 c2 80 0f  |...p.v....s.....|
000000f0  84 d0 00 be 93 7d e9 82  00 66 0f b6 c6 88 64 ff  |.....}...f....d.|
00000100  40 66 89 44 04 0f b6 d1  c1 e2 02 88 e8 88 f4 40  |@f.D...........@|
00000110  89 44 08 0f b6 c2 c0 e8  02 66 89 04 66 a1 60 7c  |.D.......f..f.`||
00000120  66 09 c0 75 4e 66 a1 5c  7c 66 31 d2 66 f7 34 88  |f..uNf.\|f1.f.4.|
00000130  d1 31 d2 66 f7 74 04 3b  44 08 7d 37 fe c1 88 c5  |.1.f.t.;D.}7....|
00000140  30 c0 c1 e8 02 08 c1 88  d0 5a 88 c6 bb 00 70 8e  |0........Z....p.|
00000150  c3 31 db b8 01 02 cd 13  72 1e 8c c3 60 1e b9 00  |.1......r...`...|
00000160  01 8e db 31 f6 bf 00 80  8e c6 fc f3 a5 1f 61 ff  |...1..........a.|
00000170  26 5a 7c be 8e 7d eb 03  be 9d 7d e8 34 00 be a2  |&amp;Z|..}....}.4...|
00000180  7d e8 2e 00 cd 18 eb fe  47 52 55 42 20 00 47 65  |}.......GRUB .Ge|
00000190  6f 6d 00 48 61 72 64 20  44 69 73 6b 00 52 65 61  |om.Hard Disk.Rea|
000001a0  64 00 20 45 72 72 6f 72  0d 0a 00 bb 01 00 b4 0e  |d. Error........|
000001b0  cd 10 ac 3c 00 75 f4 c3  5d 52 5d 52 00 00 80 01  |...&lt;.u..]R]R....|
000001c0  01 00 07 fe ff ff 3f 00  00 00 d6 24 c2 03 00 00  |......?....$....|
000001d0  c1 ff 07 fe ff ff 15 25  c2 03 86 8c e8 04 00 fe  |.......%........|
000001e0  ff ff 83 fe ff ff 9b b1  aa 08 78 b1 d4 01 00 fe  |..........x.....|
000001f0  ff ff 05 fe ff ff 50 63  7f 0a 71 27 22 08 55 aa  |......Pc..q&#039;&quot;.U.|
00000200
1+0 enregistrements lus
1+0 enregistrements écrits
512 octets (512 B) copiés, 0,00119184 s, 430 kB/s</pre>

<p>
<br/>

Au milieu de tout ce charabia <img src="/lib/images/smileys/icon_sad.gif" class="icon" alt=":-(" /> on distingue quelques messages - en fait des messages d&#039;erreurs - qui pourraient être affichés en cas de détection de problèmes. 
<br/>

</p>
<div class="notetip">On remarque que nous sommes dans la situation où l&#039;amorceur Grub est dans le mbr (chaine faisant référence à grub)
</div><div class="noteclassic">Les adresses sont exprimées en hexadécimal et vont de 00000000 à 000001ff (0 à 511) et augmentent de 1 à chaque fois que l&#039;on se déplace vers la droite. L&#039;octet du mbr à la position 188 (9ème valeur de la ligne 00000180) a pour valeur hexa 47, ce qui correspond au caractère ascii &quot;G&quot;.
</div>
<p>
<br/>

</p>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[Les différentes parties du mbr] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="les_differentes_parties_du_mbr" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="2382-5772" /><button type="submit" title="Les différentes parties du mbr" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit5" id="la_partie_executable">La partie exécutable</h3>
<div class="level3">

<p>
<br/>

</p>

<p>
La première partie, adresses comprises entre <strong>000 et 1b7</strong>, correspond à la partie exécutable du mbr. Elle est chargée en mémoire vive (ainsi que le reste du mbr) lorsque le PC démarre (&quot;boote&quot;) sur ce disque. Elle a pour fonction de vérifier la validité de la table des partitions et de rechercher une partition amorçable du disque.
</p>
<div class="noteclassic">Voir par ici une analyse détaillée de <a href="/la_partie_executable_du_mbr" class="wikilink1" title="la_partie_executable_du_mbr">la partie executable du mbr</a>
</div>
<p>
<br/>

</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[La partie exécutable] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="la_partie_executable" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="5773-6271" /><button type="submit" title="La partie exécutable" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit6" id="l_identifiant_de_disque">L&#039;identifiant de disque</h3>
<div class="level3">

<p>
<br/>

Entre <strong>1b8 et 1bb</strong> se trouve l&#039;identifiant du disque, soit les octets <strong>5d 52 5d 52</strong>, que l&#039;on peut avoir par exemple en faisant un
</p>
<pre class="code">sudo fdisk -lu</pre>

<p>
<br/>

</p>
<pre class="code">Identifiant de disque : 0x525d525d</pre>
<div class="notetip">L&#039;ordre des octets est inversé du fait du codage <a href="https://fr.wikipedia.org/wiki/Endianness" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Endianness">little endian</a> (on commence par mettre les octets de &quot;poids faible&quot; avant les octets de &quot;poids fort&quot;).

</div>
<p>
<br/>

</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[L&#039;identifiant de disque] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="l_identifiant_de_disque" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="6272-6717" /><button type="submit" title="L&#039;identifiant de disque" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit7" id="la_table_des_partitions_primaires">La table des partitions primaires</h3>
<div class="level3">

<p>
<br/>

</p>
<div class="noteimportant">La table des partitions du mbr ne concernent que les partitions principales. En cas de présence d&#039;une (unique) partition étendue, cette dernière qui est seulement un contenant à partitions logiques est considérée comme principale.
</div><div class="noteimportant">Cette table commençant à l&#039;adresse <strong>1be</strong> (446) et se terminant en <strong>1fd</strong> (509) contient 64 octets qui correspondent aux quatre entrées de 16 octets des 4 partitions principales - c&#039;est d&#039;ailleurs pour cela que les partitions principales sont limitées à 4 dans les tables de type msdos.
</div><div class="notetip">Dans le cas d&#039;un partitionnement de type GPT, le mbr est un mbr protector qui ne contient qu&#039;une unique partition de type ee commençant à la LBA 1.<br/>

Le code présent dans le mbr n&#039;est pas utilisé en cas de boot en mode UEFI

</div>
<p>
<br/>

Cette table des partitions est donc ici (en affichant à partir de l&#039;adresse 1be pour avoir une ligne par partition puis en séparant par groupes d&#039;octets)
<br/>

</p>
<pre class="code">000001be   80   01 01 00   07   fe ff ff   3f 00 00 00   d6 24 c2 03
000001ce   00   00 c1 ff   07   fe ff ff   15 25 c2 03   86 8c e8 04
000001de   00   fe ff ff   83   fe ff ff   9b b1 aa 08   78 b1 d4 01
000001ee   00   fe ff ff   05   fe ff ff   50 63 7f 0a   71 27 22 08</pre>

<p>
<br/>

La première ligne qui correspond à la première entrée concerne sda1 (qui n&#039;est pas forcément la partition au début du disque).
<br/>

Elle est marquée comme bootable - l&#039;étoile qui apparait lors d&#039;un fdisk - du fait que le premier octet a la valeur hexa <strong>80</strong>. Si la partition n&#039;est pas marquée comme amorçable alors on aura la valeur <strong>00</strong>.
</p>

<p>
<br/>

</p>

<p>
Le groupe des 3 octets qui suivent est une réminiscence des temps anciens <img src="/lib/images/smileys/icon_wink.gif" class="icon" alt=";-)" /> où le bios ne reconnaissait que le système &quot;tête&quot;, &quot;secteur&quot; et &quot;cylindre&quot;. Il indique le début de la partition.
<br/>

La tête est codée sur 8 bits et peut prendre une valeur entre <strong>0 et fe</strong> (entre 0 et 254 en décimal) - ici 1
<br/>

Le secteur est codé sur 6 bits et peut prendre une valeur entre <strong>1 et 3f</strong> (entre 1 et 63, soit 63 secteurs par piste au maximum) - ici 1
<br/>

Le cylindre est codé sur 10 bits (les deux bits de &quot;poids fort&quot; sont les bits 6 et 7 de l&#039;octet précédent), soit entre <strong>0 et 3ff</strong> (0 et 1023) - ici 0
</p>

<p>
<br/>

<br/>

L&#039;octet suivant code le <a href="https://fr.wikipedia.org/wiki/Partition_de_disque_dur" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Partition_de_disque_dur">système de fichier de la partition</a>, ici le <strong>07</strong> signifie ntfs (j&#039;ai un dual boot avec Windows <img src="/lib/images/smileys/icon_confused.gif" class="icon" alt=":-?" />), les autres valeurs couramment rencontrées sont :<br/>

<strong>05, 0f</strong> : étendue<br/>

<strong>0b</strong> : fat32<br/>

<strong>82</strong> : Linux-swap<br/>

<strong>83</strong> : ext2, ext3, ext4 - en bref appellation Linux<br/>

<br/>

</p>

<p>
Le groupe des 3 octets suivants indique la fin de la partition dans le système &quot;tête, secteur, cylindre&quot; - ici les valeurs sont au maximum car la partition est plus grande que ce qu&#039;autorise cet adressage archaïque.
</p>

<p>
<br/>

<br/>

</p>

<p>
Nous arrivons au plus intéressant car c&#039;est ici que sont codés le début et la taille des partitions dans le système LBA (Logical block addressing).
Le premier groupe de 4 octets correspond à l&#039;emplacement du début de la partition (en hexadécimal et en <a href="https://fr.wikipedia.org/wiki/Endianness" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Endianness">little endian</a>) et la taille (même format).
<br/>

</p>

<p>
Ainsi le groupe <strong>3f 00 00 00</strong> correspond à la valeur hexa 0x0000003f, soit <strong>63</strong> en décimal.
</p>

<p>
<br/>

Et pour la taille on a <strong>d6 24 c2 03</strong>, soit la valeur hexa 0x03c224d6, soit <strong>63055062</strong> en décimal.
</p>
<div class="noteclassic">La taille exprimée est en secteurs, pour connaitre la taille en kio (1 kio=1024 octets soit deux secteurs de 512 octets), il suffit de diviser la valeur par deux.
</div><div class="notetip"><strong>Nota</strong> : <em>Lors d&#039;un sudo fdisk, les tailles exprimées en blocs sont parfois suivies d&#039;un +. Ceci signifie un demi kio, soit un secteur. C&#039;est ce qui apparait lorsque le nombre de secteurs est impair.</em>
</div>
<p>
L&#039;espace qui suit la partition est donc donné par :
<br/>

<br/>

<strong><em>début espace suivant = début partition + taille partition</em></strong>
</p>
<div class="notetip">Souvent les partitions principales commencent au début d&#039;un cylindre. Pour une géométrie classique, les pistes font 63 secteurs et le disque possède <em>au maximum</em> 255 têtes, ce qui fait une taille de cylindre de 63x255=16065 secteurs.
La première partition échappe à cette règle et commence au début de la deuxième tête du premier cylindre, soit à l&#039;adresse 63 (décimal)

</div><div class="notetip">Avec l&#039;arrivée des disques de grande taille et des disques plus performants comme les ssd, cette antique géométrie tend à disparaître et la première partition commence souvent à l&#039;adresse 2048. Les autres partitions commencent également à un multiple de 2048 secteurs assurant un alignement de ces dernières au Mio.
</div><div class="noteclassic">Le système des tables des partitions à base de secteurs de 512 octets, limite la taille des disques à 2 Tio. Pour les disques de plus grande taille il faudra abandonner les tables des partitions msdos au profit des tables gpt.
</div>
<p>
<br/>

</p>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[La table des partitions primaires] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="la_table_des_partitions_primaires" /><input type="hidden" name="codeblockOffset" value="4" /><input type="hidden" name="range" value="6718-11649" /><button type="submit" title="La table des partitions primaires" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit8" id="le_nombre_magique">Le nombre magique</h3>
<div class="level3">

<p>
<br/>

C&#039;est la &quot;marque&quot; d&#039;un média amorçable, elle est donnée par la présence des deux derniers octets du mbr (aux adresses 1fe et 1ff, soit 510 et 511 en décimal) qui correspond à la valeur <strong>aa55</strong>.
Vous allez dire que ça ne va pas car c&#039;est <strong>55</strong> et <strong>aa</strong> que vous avez. Mais je rappelle que les valeurs numériques sont codées sous la forme little endian et donc l&#039;octet de poids faible <strong>55</strong> est placé avant l&#039;octet de poids fort <strong>aa</strong>. <img src="/lib/images/smileys/icon_cool.gif" class="icon" alt="8-)" />
</p>

<p>
<br/>

</p>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[Le nombre magique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="le_nombre_magique" /><input type="hidden" name="codeblockOffset" value="5" /><input type="hidden" name="range" value="11650-12138" /><button type="submit" title="Le nombre magique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit9 page-header" id="exercice_pratique">Exercice pratique</h2>
<div class="level2">

<p>
<br/>

A partir du mbr analysé, retrouver le début et la fin des partitions principales <img src="/lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" />
<br/>

</p>

<p>
Pour que vous ne travailliez pas en vain, voici le résultat à obtenir, donné par un
<br/>

</p>
<pre class="code">sudo fdisk -lu</pre>
<div class="notetip">L&#039;option -lu permet d&#039;afficher les résultats en secteurs au lieu de cylindres (option -l qui est moins précise)
</div><pre class="code">Disque /dev/sda: 160.0 Go, 160041885696 octets
255 têtes, 63 secteurs/piste, 19457 cylindres, total 312581808 secteurs
Unités = secteurs de 1 * 512 = 512 octets
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Identifiant de disque : 0x525d525d

Périphérique Amorce  Début        Fin      Blocs     Id  Système
/dev/sda1   *          63    63055124    31527531    7  HPFS/NTFS
/dev/sda2        63055125   145404314    41174595    7  HPFS/NTFS
/dev/sda3       145404315   176120594    15358140   83  Linux
/dev/sda4       176120656   312576704    68228024+   5  Etendue
/dev/sda5       176120658   180426014     2152678+  82  Linux swap / Solaris
/dev/sda6       180426078   312576704    66075313+  83  Linux</pre>

<p>
<br/>

</p>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[Exercice pratique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="exercice_pratique" /><input type="hidden" name="codeblockOffset" value="5" /><input type="hidden" name="range" value="12139-13299" /><button type="submit" title="Exercice pratique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit10 page-header" id="problemes_connus">Problèmes connus</h2>
<div class="level2">

<p>
<br/>

Il arrive parfois que la table des partitions soit corrompue pouvant empêcher tout redimensionnement. Ceci peut être la conséquence d&#039;un virus de mbr, de l&#039;utilisation d&#039;un outil pour partitionner inadapté…
<br/>

Un cas classique est le chevauchement des partitions, on aura par exemple sda1 qui se terminera dans la partition sda2 si ta taille indiquée de sda1 est trop grande.
<br/>

 Ces problèmes peuvent aussi affecter les partitions logiques et générer aussi un blocage.
Il arrive aussi que la taille indiquée d&#039;une partition excède la taille du disque.
</p>
<div class="noteimportant">Dans ces deux cas, gparted ne saura repartitionner le disque qui apparaitra comme non alloué. Il faudra nécessairement faire une analyse détaillée des partitions pour identifier le problème et adapter le traitement convenable. Par exemple en cas de chevauchement de partition (genre télescopage entre sda1 et sda2) il faudra vérifier que sda2 commence bien à l&#039;emplacement spécifié (en analysant la zone amorce) avant de retailler sda1.
</div>
</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[Problèmes connus] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="problemes_connus" /><input type="hidden" name="codeblockOffset" value="7" /><input type="hidden" name="range" value="13300-14367" /><button type="submit" title="Problèmes connus" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit11 page-header" id="voir_aussi">Voir aussi</h2>
<div class="level2">

<p>
<br/>

</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>(fr)</strong> <a href="https://fr.wikipedia.org/wiki/Master_boot_record" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Master_boot_record">Master boot record sur Wikipédia</a></div>
</li>
<li class="level1"><div class="li"> <strong>(fr)</strong><a href="https://fr.wikipedia.org/wiki/Partition_de_disque_dur" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Partition_de_disque_dur">Les partition de disque dur sur Wikipédia</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://forum.ubuntu-fr.org/viewtopic.php?id=390336" class="urlextern" title="http://forum.ubuntu-fr.org/viewtopic.php?id=390336" rel="nofollow">Forum ubuntu-fr</a></div>
</li>
<li class="level1"><div class="li"> <strong>(fr)</strong><a href="https://fr.wikipedia.org/wiki/Logical_block_addressing" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Logical_block_addressing">Adressage logique sur Wikipédia</a></div>
</li>
</ul>
<hr />

<p>
<em>Contributeurs principaux : <a href="/utilisateurs/nasman" class="wikilink2" title="utilisateurs:nasman" rel="nofollow">Nasman</a>.</em>
</p>

</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit form-inline" method="post" action="/mbr"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1501580813" /><input type="hidden" name="summary" value="[Voir aussi] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="voir_aussi" /><input type="hidden" name="codeblockOffset" value="7" /><input type="hidden" name="range" value="14368-" /><button type="submit" title="Voir aussi" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="mbr.txt">mbr.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 01/08/2017, 11:46">Le 01/08/2017, 11:46</span></li><li class="text-muted">par L&#039;Africain</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=mbr&amp;1635557359" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
