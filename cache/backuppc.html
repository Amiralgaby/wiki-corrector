<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>backuppc [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="trusty,xenial,reseau,serveur,securite,sauvegarde"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/backuppc?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/backuppc?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/backuppc"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/backuppc"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/backuppc"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"backuppc","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="backuppc">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/backuppc?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/backuppc?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/backuppc?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/backuppc?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/backuppc?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/backuppc?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/backuppc?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">backuppc</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/backuppc?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/backuppc?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/backuppc?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#politique_de_sauvegarde_par_defaut","title":"Politique de sauvegarde par d\u00e9faut","level":2},{"link":"#installation","title":"Installation","level":1},{"link":"#utilisation","title":"Utilisation","level":1},{"link":"#configuration_generale","title":"Configuration g\u00e9n\u00e9rale","level":1},{"link":"#mettre_l_interface_en_francais","title":"Mettre l'interface en fran\u00e7ais","level":2},{"link":"#ou_sont_sauvegardees_les_donnees","title":"O\u00f9 sont sauvegard\u00e9es les donn\u00e9es ?","level":2},{"link":"#configurer_les_sauvegardes","title":"Configurer les sauvegardes","level":1},{"link":"#sauvegarder_un_repertoire_local_via_tar","title":"Sauvegarder un r\u00e9pertoire local via tar","level":1},{"link":"#sauvegarde_du_poste_local_sur_un_disque_dur_externe_usb","title":"Sauvegarde du poste local sur un disque dur externe USB","level":1},{"link":"#sauvegarder_un_poste_linux_distant_via_rsync_ssh","title":"Sauvegarder un poste Linux distant via rsync (ssh)","level":1},{"link":"#methode_standard","title":"M\u00e9thode standard","level":2},{"link":"#methode_avec_sudo","title":"M\u00e9thode avec sudo","level":2},{"link":"#ajouter_la_machine_a_sauvegarder_a_la_liste","title":"Ajouter la machine \u00e0 sauvegarder \u00e0 la liste.","level":2},{"link":"#sauvegarder_un_poste_mac_os_distant_via_ssh","title":"Sauvegarder un poste Mac OS distant via ssh","level":1},{"link":"#sauvegarder_des_postes_windows_via_rsyncd","title":"Sauvegarder des postes Windows via \u00ab rsyncd \u00bb","level":1},{"link":"#configuration_des_postes_windows","title":"Configuration des postes Windows","level":2},{"link":"#configuration_du_fichier_configpl","title":"Configuration du fichier \u00ab config.pl \u00bb","level":2},{"link":"#sauvegarder_des_postes_windows_via_smb","title":"Sauvegarder des postes Windows via \u00ab smb \u00bb","level":1},{"link":"#sauvegarder_des_pc_eteints","title":"Sauvegarder des PC \u00e9teints","level":1},{"link":"#configuration_du_wol_sur_le_serveur","title":"Configuration du WOL sur le serveur","level":2},{"link":"#script_de_reveil_et_d_arret_des_machines","title":"Script de r\u00e9veil et d'arr\u00eat des machines","level":2},{"link":"#configuration_de_backuppc_pour_utiliser_les_scripts","title":"Configuration de backuppc pour utiliser les scripts","level":2},{"link":"#faire_une_copie_des_sauvegardes_sur_un_support_externe_avec_rsync","title":"Faire une copie des sauvegardes sur un support externe avec RSYNC","level":1},{"link":"#erreurs","title":"Erreurs","level":1},{"link":"#no_files_dumped_for_share","title":"No files dumped for share ...","level":2},{"link":"#erreur_nt_status","title":"Erreur NT_STATUS...","level":2},{"link":"#liens_utiles","title":"Liens utiles","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level2"><a href="#politique_de_sauvegarde_par_defaut">Politique de sauvegarde par défaut</a></li>
<li class="level1"><a href="#installation">Installation</a></li>
<li class="level1"><a href="#utilisation">Utilisation</a></li>
<li class="level1"><a href="#configuration_generale">Configuration générale</a></li>
<li class="level2"><a href="#mettre_l_interface_en_francais">Mettre l&#039;interface en français</a></li>
<li class="level2"><a href="#ou_sont_sauvegardees_les_donnees">Où sont sauvegardées les données ?</a></li>
<li class="level1"><a href="#configurer_les_sauvegardes">Configurer les sauvegardes</a></li>
<li class="level1"><a href="#sauvegarder_un_repertoire_local_via_tar">Sauvegarder un répertoire local via tar</a></li>
<li class="level1"><a href="#sauvegarde_du_poste_local_sur_un_disque_dur_externe_usb">Sauvegarde du poste local sur un disque dur externe USB</a></li>
<li class="level1"><a href="#sauvegarder_un_poste_linux_distant_via_rsync_ssh">Sauvegarder un poste Linux distant via rsync (ssh)</a></li>
<li class="level2"><a href="#methode_standard">Méthode standard</a></li>
<li class="level2"><a href="#methode_avec_sudo">Méthode avec sudo</a></li>
<li class="level2"><a href="#ajouter_la_machine_a_sauvegarder_a_la_liste">Ajouter la machine à sauvegarder à la liste.</a></li>
<li class="level1"><a href="#sauvegarder_un_poste_mac_os_distant_via_ssh">Sauvegarder un poste Mac OS distant via ssh</a></li>
<li class="level1"><a href="#sauvegarder_des_postes_windows_via_rsyncd">Sauvegarder des postes Windows via « rsyncd »</a></li>
<li class="level2"><a href="#configuration_des_postes_windows">Configuration des postes Windows</a></li>
<li class="level2"><a href="#configuration_du_fichier_configpl">Configuration du fichier « config.pl »</a></li>
<li class="level1"><a href="#sauvegarder_des_postes_windows_via_smb">Sauvegarder des postes Windows via « smb »</a></li>
<li class="level1"><a href="#sauvegarder_des_pc_eteints">Sauvegarder des PC éteints</a></li>
<li class="level2"><a href="#configuration_du_wol_sur_le_serveur">Configuration du WOL sur le serveur</a></li>
<li class="level2"><a href="#script_de_reveil_et_d_arret_des_machines">Script de réveil et d&#039;arrêt des machines</a></li>
<li class="level2"><a href="#configuration_de_backuppc_pour_utiliser_les_scripts">Configuration de backuppc pour utiliser les scripts</a></li>
<li class="level1"><a href="#faire_une_copie_des_sauvegardes_sur_un_support_externe_avec_rsync">Faire une copie des sauvegardes sur un support externe avec RSYNC</a></li>
<li class="level1"><a href="#erreurs">Erreurs</a></li>
<li class="level2"><a href="#no_files_dumped_for_share">No files dumped for share ...</a></li>
<li class="level2"><a href="#erreur_nt_status">Erreur NT_STATUS...</a></li>
<li class="level1"><a href="#liens_utiles">Liens utiles</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/trusty" class="wikilink1" title="trusty" rel="tag">Trusty</a>,
	<a href="/xenial" class="wikilink1" title="xenial" rel="tag">Xenial</a>,
	<a href="/reseau" class="wikilink1" title="reseau" rel="tag">réseau</a>,
	<a href="/serveur" class="wikilink1" title="serveur" rel="tag">serveur</a>,
	<a href="/securite" class="wikilink1" title="securite" rel="tag">sécurité</a>,
	<a href="/sauvegarde" class="wikilink1" title="sauvegarde" rel="tag">sauvegarde</a>
</span></div>
<hr />

<p>
<a href="/_detail/image/backuppc-logo.gif?id=backuppc" class="media" title="image:backuppc-logo.gif"><img src="/_media/image/backuppc-logo.gif?w=80&amp;tok=f06966" class="mediaright img-responsive" alt="" width="80" /></a>
</p>

<h1 class="sectionedit1 page-header" id="serveur_de_sauvegarde_automatiquebackuppc">Serveur de sauvegarde automatique : BackupPC</h1>
<div class="level1">

<p>
<strong>BackupPC</strong> est un logiciel libre de <a href="/sauvegarde" class="wikilink1" title="sauvegarde">sauvegardes</a> de données informatiques, publié sous licence <abbr title="GNU General Public License">GPL</abbr>.<br/>

Il permet d&#039;assurer une politique de sauvegardes &quot;versionnées&quot; pour des clients de différents types (Unix, <abbr title="GNU&#039;s Not Unix">GNU</abbr>/Linux, Windows, Mac)
</p>

<p>
<strong>BackupPC</strong> est utilisé pour sauvegarder un ensemble de postes. Il possède une interface Web pour configurer, lancer des sauvegardes ou restaurer des fichiers. Il est également possible de sauvegarder des bases de données.
</p>

<p>
BackupPC permet de sauvegarder automatiquement à des intervalles de temps réguliers des répertoires situés sur des machines du réseau.
</p>

<p>
<a href="http://backuppc.sourceforge.net/faq/BackupPC.html#overview" class="urlextern" title="http://backuppc.sourceforge.net/faq/BackupPC.html#overview" rel="nofollow">Il peut également faire beaucoup plus…</a> même s&#039;il a quelques <a href="http://backuppc.sourceforge.net/faq/limitations.html" class="urlextern" title="http://backuppc.sourceforge.net/faq/limitations.html" rel="nofollow">limites</a>. 
</p>

<p>
BackupPC peut utiliser plusieurs protocoles pour les sauvegardes :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <a href="/samba" class="wikilink1" title="samba">Samba</a> : Utilise le logiciel <em>SmbClient</em> pour le transfert des données. C&#039;est un bon choix pour sauvegarder des machines sous Windows.</div>
</li>
<li class="level1"><div class="li"> <a href="/rsync" class="wikilink1" title="rsync">rSync</a> : Utilise le logiciel <em>RSync</em> pour le transfert des données. C&#039;est un bon choix pour sauvegarder des machines sous Linux, sous Mac ou sous windows.</div>
</li>
<li class="level1"><div class="li"> <a href="http://www.samba.org/ftp/rsync/rsyncd.conf.html" class="urlextern" title="http://www.samba.org/ftp/rsync/rsyncd.conf.html" rel="nofollow">rSyncd</a> : Utilise le <em>daemon</em> « rsyncd » installé sur chaque client. C&#039;est un bon choix pour sauvegarder des machines sous Linux et sous Windows.</div>
</li>
<li class="level1"><div class="li"> <a href="/tar" class="wikilink1" title="tar">Tar</a> : Utilise le logiciel Tar. C&#039;est un bon choix pour sauvegarder des machines sous Linux.</div>
</li>
</ul>

<p>
Sauf pour <a href="/samba" class="wikilink1" title="samba">Samba</a>, Backuppc utilise <a href="/ssh" class="wikilink1" title="ssh">SSH</a> pour faire les transferts.
</p>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Serveur de sauvegarde automatique : BackupPC] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="serveur_de_sauvegarde_automatiquebackuppc" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="101-1743" /><button type="submit" title="Serveur de sauvegarde automatique : BackupPC" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit2" id="politique_de_sauvegarde_par_defaut">Politique de sauvegarde par défaut</h3>
<div class="level3">

</div>

<h4 id="sur_le_serveur">Sur le serveur</h4>
<div class="level4">

<p>
Le logiciel se réveille toutes les heures pour sonder l&#039;ensemble des machines spécifiées dans le fichier <strong>/etc/backuppc/hosts</strong>.<br/>

Puis, pour chaque poste allumé, il fonctionne ainsi :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Interrogation de la période du Blackout: si l&#039;hôte est dans sa période d&#039;exctinction, le serveur passe à la machine suivante. Ce qui peut être bien pratique pour des machines nomades.</div>
</li>
<li class="level1"><div class="li"> Sinon, il étudie la machine hôte.</div>
</li>
</ul>

</div>

<h4 id="pour_chaque_machine_cliente">Pour chaque machine cliente</h4>
<div class="level4">

<p>
BackupPC examine les dates des dernières sauvegardes effectuées:
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Si la date de dernière sauvegarde complète a plus de trente jours, il en fait une nouvelle.</div>
</li>
<li class="level1"><div class="li"> Sinon il regarde la date de la dernière sauvegarde incrémentielle. Si celle-ci a plus d&#039;un jour, il lance une sauvegarde incrémentielle.</div>
</li>
</ul>

<p>
S&#039;il y a plus de dix-neuf sauvegardes incrémentielles, il supprime les plus anciennes de manière à ce qu&#039;il n&#039;en reste que dix-neuf (limitation de l&#039;espace disque consommé).
</p>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Politique de sauvegarde par défaut] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="politique_de_sauvegarde_par_defaut" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1744-2760" /><button type="submit" title="Politique de sauvegarde par défaut" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit3 page-header" id="installation">Installation</h2>
<div class="level2">

<p>
Backuppc est <a href="http://sourceforge.net/apps/mediawiki/backuppc/index.php?title=Supporting_distros" class="urlextern" title="http://sourceforge.net/apps/mediawiki/backuppc/index.php?title=Supporting_distros" rel="nofollow">supporté</a> par un bon nombre de <a href="https://fr.wikipedia.org/wiki/Linux#Distributions" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Linux#Distributions">distributions linux</a>.<br/>

Étant disponible dans les <a href="/depots" class="wikilink1" title="depots">dépôts</a> de chaque <a href="/versions" class="wikilink1" title="versions">versions d&#039;Ubuntu</a>, il suffira d&#039;<a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installer le paquet</a> <strong><a href="apt://backuppc" class="interwiki iw_apt" title="apt://backuppc">backuppc</a></strong> <a href="http://packages.ubuntu.com/search?keywords=backuppc&amp;searchon=names&amp;suite=all&amp;section=all" class="urlextern" title="http://packages.ubuntu.com/search?keywords=backuppc&amp;searchon=names&amp;suite=all&amp;section=all" rel="nofollow">correspondant</a> sur votre serveur de sauvegarde, puis de vous laissez guider.
</p>

</div>

<h4 id="backuppc_sous_ubuntu_utilisera_par_defaut">Backuppc sous Ubuntu utilisera par défaut:</h4>
<div class="level4">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <a href="/postfix" class="wikilink1" title="postfix">postfix</a> pour envoyer des mails.<br/>
Le <a href="/postfix_systeme_satellite" class="wikilink1" title="postfix_systeme_satellite">mode satellite</a> peut vous convenir.</div>
</li>
<li class="level1"><div class="li"> <a href="/apache2" class="wikilink1" title="apache2">Apache2</a> pour fournir l&#039;interface Web.<br/>
L&#039;utilisation de ce dernier permet une configuration automatique.</div>
</li>
</ul>

</div>

<h4 id="une_fenetre_debconf_doit_apparaitre_durant_l_installation">Une fenêtre debconf doit apparaître durant l&#039;installation :</h4>
<div class="level4">

<p>
<a href="/_detail/utilisateurs/capture-debconf-backuppc.png?id=backuppc" class="media" title="utilisateurs:capture-debconf-backuppc.png"><img src="/_media/utilisateurs/capture-debconf-backuppc.png?w=500&amp;tok=7f769a" class="media img-responsive" alt="" width="500" /></a>
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> soit vous notez soigneusement le mot de passe attribué automatiquement à l&#039;utilisateur backupPC</div>
</li>
<li class="level1"><div class="li"> soit vous préférez le modifier à l&#039;aide de cette commande: <pre class="code">sudo htpasswd /etc/backuppc/htpasswd backuppc</pre>
</div>
</li>
</ul>
<div class="noteclassic">Pour générer le mot de passe et le stocker vous pouvez utilisez par exemple <a href="/keepassx" class="wikilink1" title="keepassx">KeepassX</a>.

</div>
</div>

<h4 id="ajout_de_l_utilisateur_dans_le_groupe_backuppc">Ajout de l&#039;utilisateur dans le groupe backuppc :</h4>
<div class="level4">

<p>
Pour démarrer backuppc, il faut ajouter l&#039;utilisateur de la session dans le groupe backuppc. Pour cela, il faut exécuter la ligne de commande suivante : 
</p>
<pre class="code">sudo adduser [MON_USER] backuppc</pre>

</div>

<h4 id="ajout_du_fichier_apacheconf">Ajout du fichier apache.conf</h4>
<div class="level4">

<p>
Comme l&#039;installation ne copie pas le <strong>/etc/backuppc/apache.conf</strong> sur le serveur apache2, il faut le faire soi-même en copiant le fichier dans le répertoire <strong>/etc/apache2/sites-available/</strong> avant de rendre actif le site, pour cela utilisez la commande suivante : 
</p>
<pre class="code">sudo cp /etc/backuppc/apache.conf /etc/apache2/sites-available/backuppc.conf</pre>

<p>
Puis activez le site : 
</p>
<pre class="code">sudo a2ensite backuppc.conf</pre>
<div class="noteclassic">Le fichier de configuration a été renommé en backuppc.conf, ce qui permet de l&#039;identifier plus facilement parmi les autres fichiers.

</div><ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Un redémarrage du serveur web est nécessaire pour prendre en compte les modifications.</div>
</li>
</ul>
<pre class="code">sudo /etc/init.d/apache2 restart</pre>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Installation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="2761-5080" /><button type="submit" title="Installation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit4 page-header" id="utilisation">Utilisation</h2>
<div class="level2">

</div>

<h4 id="connexion_a_l_interface_web">Connexion à l&#039;interface Web</h4>
<div class="level4">

<p>
Les versions récentes (&gt;=3) de BackupPC permettent notamment de modifier la plupart des options de configuration directement depuis l&#039;interface Web. Il suffit à l&#039;aide d&#039;un <a href="/navigateur" class="wikilink1" title="navigateur">navigateur</a> internet d&#039;aller à l&#039;adresse  <strong>http://&lt;serveur&gt;/backuppc/</strong><sup><a href="#fn__1" id="fnt__1" class="fn_top">1)</a></sup>. <br/>

Ensuite, il faut entrer « backuppc » en nom d&#039;utilisateur et le mot de passe correspondant.<br/>

</p>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Utilisation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="utilisation" /><input type="hidden" name="codeblockOffset" value="5" /><input type="hidden" name="range" value="5081-5602" /><button type="submit" title="Utilisation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit5 page-header" id="configuration_generale">Configuration générale</h2>
<div class="level2">

<p>
Backuppc fonctionne avec la notion de <a href="https://fr.wikipedia.org/wiki/Client-serveur" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Client-serveur">Client/Serveur</a>. La machine serveur pouvant bien entendu être aussi un client.<br/>

</p>

<p>
La configuration peut se faire en modifiant les options dans le fichier <strong>/etc/backuppc/config.pl</strong>.<br/>

Néanmoins ici, il sera principalement fait usage de <a href="#connexion_a_l_interface_web" title="backuppc ↵" class="wikilink1">l&#039;interface web</a>
</p>
<div class="noteimportant">Il vous faudra adapter les termes &lt;client&gt; et &lt;serveur&gt; à votre architecture en les remplaçant par les adresses IP, les <a href="https://fr.wikipedia.org/wiki/FQDN" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/FQDN">FQDN</a> ou les noms hosts correspondants.

</div>
</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Configuration générale] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_generale" /><input type="hidden" name="codeblockOffset" value="5" /><input type="hidden" name="range" value="5603-6186" /><button type="submit" title="Configuration générale" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit6" id="mettre_l_interface_en_francais">Mettre l&#039;interface en français</h3>
<div class="level3">

</div>

<h4 id="par_l_interface_web">Par l&#039;interface web</h4>
<div class="level4">

<p>
Depuis le menu <em>Serveur → Modifier la configuration → CGI → Language </em><br/>

Depuis le menu <em>Server → Edit config → CGI → Language </em>
</p>

</div>

<h4 id="en_ligne_de_commandes">En ligne de commandes</h4>
<div class="level4">

<p>
<a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Modifier avec les droits d&#039;administration</a> l&#039;option dans le fichier 
</p>
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=5" title="Télécharger cet extrait" class="mediafile mf_pl">/etc/backuppc/config.pl</a></dt>
<dd><pre class="code file perl"> <span class="re0">$Conf</span><span class="br0">&#123;</span>Language<span class="br0">&#125;</span> <span class="sy0">=</span> <span class="st_h">'en'</span><span class="sy0">;</span> </pre>
</dd></dl>

<p>
pour obtenir
</p>
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=6" title="Télécharger cet extrait" class="mediafile mf_pl">/etc/backuppc/config.pl</a></dt>
<dd><pre class="code file perl"> <span class="re0">$Conf</span><span class="br0">&#123;</span>Language<span class="br0">&#125;</span> <span class="sy0">=</span> <span class="st_h">'fr'</span><span class="sy0">;</span> </pre>
</dd></dl>

</div>

<h4 id="modifier_la_configuration_pour_toutes_vos_machines">Modifier la configuration pour toutes vos machines</h4>
<div class="level4">

<p>
Depuis le menu <em>Serveur → Modifier la configuration </em>
</p>

</div>

<h4 id="puis_affiner_pour_chacune_d_entre_elle">Puis affiner pour chacune d&#039;entre elle</h4>
<div class="level4">

<p>
Depuis <em>Hôtes → </em>
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Mettre l&#039;interface en français] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="mettre_l_interface_en_francais" /><input type="hidden" name="codeblockOffset" value="5" /><input type="hidden" name="range" value="6187-6879" /><button type="submit" title="Mettre l&#039;interface en français" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit7" id="ou_sont_sauvegardees_les_donnees">Où sont sauvegardées les données ?</h3>
<div class="level3">

</div>

<h4 id="par_defaut">Par défaut</h4>
<div class="level4">

<p>
Les données sont sauvegardées dans des sous-répertoires de <strong>/var/lib/backuppc</strong>
</p>

</div>

<h4 id="changer_le_lieu_de_stockage">Changer le lieu de stockage</h4>
<div class="level4">

<p>
Cela n&#039;est bien sûr pas obligatoire, mais cela peut-être pratique de ne pas laisser vos données dans le dossier <strong>/var</strong>.
</p>

</div>

<h5 id="avec_un_lien_symbolique">Avec un lien symbolique</h5>
<div class="level5">
<div class="noteclassic">En utilisant un <a href="https://fr.wikipedia.org/wiki/lien_symbolique" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/lien_symbolique">un lien symbolique</a> vous ne risquerez pas de problème lié à l&#039;écrasement du fichier de configuration lors d&#039;une mise à jour.

</div><ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> stopper le <a href="/services" class="wikilink1" title="services">service</a> backuppc: <pre class="code">sudo service backuppc stop</pre>
</div>
</li>
<li class="level1"><div class="li"> créer votre répertoire de destination au préalable: <pre class="code">sudo mkdir /&lt;le_chemin/repertoire_destination&gt;/backuppc/</pre>
</div>
</li>
<li class="level1"><div class="li"> copiez-y ce qui se trouve dans <strong>/var/lib/backuppc</strong>:<pre class="code">sudo rsync -va /var/lib/backuppc /&lt;le_chemin/repertoire_destination&gt;/</pre>
</div>
</li>
<li class="level1"><div class="li"> assurer vous que les <a href="/droits" class="wikilink1" title="droits">droits</a> sur les fichiers et répertoires sont les mêmes.</div>
</li>
<li class="level1"><div class="li"> supprimer ou déplacer (au cas où) le répertoire <strong>/var/lib/backuppc</strong></div>
</li>
<li class="level1"><div class="li"> créer votre <a href="https://fr.wikipedia.org/wiki/lien_symbolique" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/lien_symbolique">lien symbolique</a>: <pre class="code">sudo ln -s /&lt;le_chemin/repertoire_destination&gt;/backuppc /var/lib/backuppc</pre>
</div>
</li>
<li class="level1"><div class="li"> corriger le propriétaire du lien: <pre class="code">sudo chown -h backuppc:backuppc /var/lib/backuppc</pre>
</div>
</li>
<li class="level1"><div class="li"> Il ne reste plus qu&#039;a relancer backuppc: <pre class="code">sudo service backuppc start</pre>
</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Où sont sauvegardées les données ?] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="ou_sont_sauvegardees_les_donnees" /><input type="hidden" name="codeblockOffset" value="7" /><input type="hidden" name="range" value="6880-8271" /><button type="submit" title="Où sont sauvegardées les données ?" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit8 page-header" id="configurer_les_sauvegardes">Configurer les sauvegardes</h2>
<div class="level2">

<p>
Vous trouverez dans cette section les différents types de sauvegardes testés par les contributeurs. N&#039;hésitez pas à y ajouter votre méthode s&#039;il n&#039;y est pas déjà listé.
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <a href="#sauvegarder_un_repertoire_local_via_tar" title="backuppc ↵" class="wikilink1">Sauvegarder un répertoire local via tar</a></div>
</li>
<li class="level1"><div class="li"> <a href="#sauvegarde_du_poste_local_sur_un_disque_dur_externe_usb" title="backuppc ↵" class="wikilink1">Sauvegarde du poste local sur un disque dur externe USB</a></div>
</li>
<li class="level1"><div class="li"> <a href="#sauvegarder_un_poste_linux_distant_via_rsync_ssh" title="backuppc ↵" class="wikilink1">Sauvegarder un poste Linux distant via rsync (ssh)</a></div>
</li>
<li class="level1"><div class="li"> <a href="#sauvegarder_un_poste_mac_os_distant_via_ssh" title="backuppc ↵" class="wikilink1">Sauvegarder un poste Mac OS distant via ssh</a></div>
</li>
<li class="level1"><div class="li"> <a href="#sauvegarder_des_postes_windows_via_rsyncd" title="backuppc ↵" class="wikilink1">Sauvegarder des postes Windows via « rsyncd »</a></div>
</li>
<li class="level1"><div class="li"> <a href="#sauvegarder_des_pc_eteints" title="backuppc ↵" class="wikilink1">Sauvegarder des PC éteints</a></div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Configurer les sauvegardes] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configurer_les_sauvegardes" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="8272-8810" /><button type="submit" title="Configurer les sauvegardes" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit9 page-header" id="sauvegarder_un_repertoire_local_via_tar">Sauvegarder un répertoire local via tar</h2>
<div class="level2">

<p>
<a href="#connexion_a_l_interface_web" title="backuppc ↵" class="wikilink1">Se connecter à l&#039;interface web</a> et depuis les menus :
</p>
<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <em>Serveur → Modifier la configuration → Machine</em> : vérifier que la machine (host) &quot;localhost&quot; existe bien, avec &quot;backuppc&quot; comme user<sup><a href="#fn__2" id="fnt__2" class="fn_top">2)</a></sup></div>
</li>
<li class="level1"><div class="li"> <em>Hôtes</em> → choisir <em>Localhost</em> dans la liste déroulante</div>
</li>
<li class="level1"><div class="li"> <em>localhost → Modifier la configuration → xfer → XferMethod → choisir &quot;tar&quot;, &quot;TarShareName&quot; </em>: indiquer le chemin à sauvegarder et cliquer sur <em>insérer → Sauvegarder </em>(apparaît en rouge)</div>
</li>
<li class="level1"><div class="li"> <em>localhost → localhost Accueil → Démarrer la sauvegarde complète</em></div>
</li>
<li class="level1"><div class="li"> <em>localhost → Explorer les sauvegardes</em>: vérifiez ici que ça a fonctionné.</div>
</li>
</ol>

<p>
Par défaut cette sauvegarde sera dans <strong>/var/lib/backuppc/pc/localhost</strong>
</p>
<div class="noteimportant">En faisant comme ça, je n&#039;ai obtenu qu&#039;une erreur Tar 512. Je crois qu&#039;elle est due aux droits d&#039;accès. Pour y remédier, j&#039;ai donc ajouté<pre class="code">backuppc ALL=NOPASSWD: /bin/tar</pre>

<p>
 au fichier /etc/sudoers et mis /usr/bin/sudo devant la commande Tar de backuppc (Modifier la configuration → Xfer → TarClientCmd. Ma commande complète est : 
</p>
<pre class="code">/usr/bin/sudo LC_ALL=C $tarPath -c -v -f - -C $shareName+ --totals</pre>

</div>
</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Sauvegarder un répertoire local via tar] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="sauvegarder_un_repertoire_local_via_tar" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="8811-10062" /><button type="submit" title="Sauvegarder un répertoire local via tar" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit10 page-header" id="sauvegarde_du_poste_local_sur_un_disque_dur_externe_usb">Sauvegarde du poste local sur un disque dur externe USB</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Formater le disque dur <abbr title="Universal Serial Bus">USB</abbr>  par exemple en EXT3 ou <a href="/ext4" class="wikilink1" title="ext4">EXT4</a>. <br/>
Vous pouvez effectuer cette manipulation depuis le menu <em>Système → Administration → Éditeur de partitions</em> ou par exemple avec <a href="/gparted" class="wikilink1" title="gparted">Gparted</a>.</div>
</li>
<li class="level1"><div class="li"> Changer le lieu de stockage avec un lien symbolique comme indiqué au paragraphe <a href="/backuppc#ou_sont_sauvegardees_les_donnees" class="wikilink1 curid" title="backuppc" data-curid="true">Où sont sauvegardées les données ?</a>, le répertoire de destination étant sur le disque dur externe (par exemple /media/disk/sauvegardes/backuppc/).</div>
</li>
<li class="level1"><div class="li"> Modifier les horaires de sauvegarde pour éviter qu&#039;il ne sauvegarde automatiquement quand le disque est débranché<br/>
<em>localhost → Modifier la configuration → Horaires</em></div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Sauvegarde du poste local sur un disque dur externe USB] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="sauvegarde_du_poste_local_sur_un_disque_dur_externe_usb" /><input type="hidden" name="codeblockOffset" value="15" /><input type="hidden" name="range" value="10063-10808" /><button type="submit" title="Sauvegarde du poste local sur un disque dur externe USB" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit11 page-header" id="sauvegarder_un_poste_linux_distant_via_rsync_ssh">Sauvegarder un poste Linux distant via rsync (ssh)</h2>
<div class="level2">

<p>
La sauvegarde se faisant au travers de <a href="/ssh" class="wikilink1" title="ssh">ssh</a>, il faut <a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installer le paquet</a> <strong><a href="apt://openssh-server" class="interwiki iw_apt" title="apt://openssh-server">openssh-server</a></strong> sur le poste à sauvegarder.
</p>

<p>
De plus, il est nécessaire que l&#039;utilisateur Backuppc puisse se connecter en SSH sur les postes clients.<br/>

Pour se faire, vous avez le choix entre 2 méthodes:
</p>
<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li"> La <a href="#methode_standard" title="backuppc ↵" class="wikilink1">méthode standard</a> qui utilise le compte <a href="/root" class="wikilink1" title="root">root</a> désactivé par défaut sur Ubuntu.<br/>
</div>
</li>
<li class="level1"><div class="li"> Une <a href="#methode_avec_sudo" title="backuppc ↵" class="wikilink1">méthode alternative</a>, basé sur le compte backup et l&#039;usage de sudo, utilisable avec toute distribution ayant <a href="/sudo" class="wikilink1" title="sudo">sudo</a>.</div>
</li>
</ol>
<div class="noteclassic">Si vous avez plusieurs clients vous pouvez utiliser le très pratique <a href="/cssh" class="wikilink1" title="cssh">cssh</a>

</div>
</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Sauvegarder un poste Linux distant via rsync (ssh)] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="sauvegarder_un_poste_linux_distant_via_rsync_ssh" /><input type="hidden" name="codeblockOffset" value="15" /><input type="hidden" name="range" value="10809-11596" /><button type="submit" title="Sauvegarder un poste Linux distant via rsync (ssh)" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit12" id="methode_standard">Méthode standard</h3>
<div class="level3">

<p>
Plus simple à mettre en place. <sup><a href="#fn__3" id="fnt__3" class="fn_top">3)</a></sup>
</p>

<p>
<img src="/_media/image/backuppc/backuppc-rsync-root.png?w=400&amp;tok=1c3883" class="media img-responsive" alt="" width="400" />
</p>

</div>

<h4 id="manipulations_sur_le_serveur_de_sauvegarde">Manipulations sur le serveur de sauvegarde.</h4>
<div class="level4">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Passer en utilisateur &quot;backuppc&quot; <pre class="code">sudo -i -u backuppc</pre>
</div>
</li>
<li class="level1 node"><div class="li"> Mettez en place un système de <a href="/ssh#authentification_par_un_systeme_de_cles_publiqueprivee" class="wikilink1" title="ssh">clé publique/clé privée</a> à savoir:</div>
<ul class=" fix-media-list-overlap">
<li class="level2"><div class="li"> Générer le couple clef publique et clef privée sans mettre de mot de passe <pre class="code">ssh-keygen -t rsa -b 2048</pre>
</div>
</li>
<li class="level2"><div class="li"> Vérifier que la clé est bien générée <pre class="code">cat ~/.ssh/id_rsa.pub</pre>
</div>
</li>
<li class="level2"><div class="li"> et que ses droits sont corrects <pre class="code">ls -la ~/.ssh/</pre>
<pre class="code">drwxr-xr-x 2 backuppc backuppc 4096 2011-07-17 17:19 .
drwxr-x--- 8 backuppc backuppc 4096 2011-07-21 13:57 ..
-rw------- 1 backuppc backuppc 1671 2011-07-17 17:10 id_rsa
-rw-r--r-- 1 backuppc backuppc  397 2011-07-17 17:10 id_rsa.pub
-rw-r--r-- 1 backuppc backuppc 4862 2011-07-17 19:58 known_hosts</pre>

<p>
 Si les <a href="/droits" class="wikilink1" title="droits">droits</a> ne sont pas corrects, utiliser la commande <strong>chmod</strong> pour <a href="/permissions#en_ligne_de_commande" class="wikilink1" title="permissions">modifier les permissions</a>
</p>
</div>
</li>
</ul>
</li>
</ul>

</div>

<h4 id="manipulations_sur_les_postes_clients">Manipulations sur les postes clients.</h4>
<div class="level4">

</div>

<h5 id="placer_la_clef_publique">Placer la clef publique</h5>
<div class="level5">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Créer le répertoire <strong>/root/.ssh</strong> si il n&#039;existe pas encore.</div>
</li>
</ul>

<p>
  sudo mkdir /root/.ssh
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Editer le fichier</a> <strong>/root/.ssh/authorized_keys</strong> avec les droits d&#039;administration <pre class="code"> sudo vim /root/.ssh/authorized_keys </pre>
</div>
</li>
<li class="level1"><div class="li"> Ajouter dans le fichier, la clef publique de l&#039;utilisateur &quot;backuppc&quot; <a href="#manipulations_sur_le_serveur_de_sauvegarde" title="backuppc ↵" class="wikilink1">précédemment générée</a> <sup><a href="#fn__4" id="fnt__4" class="fn_top">4)</a></sup>. <em>(Vous pouvez par exemple éditer les deux fichiers et  faire un simple copier/coller.)</em></div>
</li>
<li class="level1"><div class="li"> Pour plus de sécurité, rajouter au début du fichier la directive <pre class="file">from=&quot;serveur&quot;</pre>
</div>
</li>
<li class="level1"><div class="li"> Vous devriez désormais avoir: </div>
</li>
<li class="level1"><div class="li"> Sous le compte root</div>
</li>
</ul>
<pre class="code">sudo -i
cat ~/.ssh/authorized_keys
from=&quot;serveur&quot; ssh-rsa AAAAB3N123456789xyz.......== backuppc@serveur</pre>

</div>

<h5 id="configuration_de_sshd">Configuration de sshd</h5>
<div class="level5">

<p>
<a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Modifier avec les droits d&#039;administration</a> le fichier <strong>/etc/ssh/sshd_config</strong>
</p>
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=23" title="Télécharger cet extrait" class="mediafile mf_">**/etc/ssh/sshd_config**</a></dt>
<dd><pre class="code file bash">PermitRootLogin without-password</pre>
</dd></dl>

<p>
Avec cette directive les connexions SSH de <strong>root</strong> ne seront pas possible avec un mot de passe (qui par défaut  n&#039;est pas utilisé sous Ubuntu)
</p>

<p>
Seul les connexions utilisant une authentification par clef seront possible, et uniquement de l&#039;adresse du serveur si la directive <code>from=</code> est utilisée dans le fichier <strong> authorized_keys</strong>.
</p>

<p>
Il sera donc possible de paramétrer indépendamment les possibilités d&#039;authentification via SSH des autres utilisateurs. Il ne faudra cependant pas oublier d&#039;ajouter <strong>root</strong> en cas d&#039;usage des directives <code>AllowUsers</code> ou <code>AllowGroups</code>.
</p>

</div>

<h4 id="test_de_connexion_ssh">Test de connexion SSH</h4>
<div class="level4">

<p>
Depuis le <em class="u">serveur</em> de sauvegarde, tenter une première connexion ssh vers le poste à sauvegarder pour l&#039;utilisateur &quot;backuppc&quot;.
</p>
<pre class="code">sudo -i -u backuppc
ssh root@client</pre>

<p>
Répondre &quot;yes&quot;, ce qui ajoutera votre client à la liste des <em>known hosts</em><sup><a href="#fn__5" id="fnt__5" class="fn_top">5)</a></sup>.
</p>

</div>
<div class='secedit editbutton_section editbutton_12'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Méthode standard] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="methode_standard" /><input type="hidden" name="codeblockOffset" value="15" /><input type="hidden" name="range" value="11597-14918" /><button type="submit" title="Méthode standard" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit13" id="methode_avec_sudo">Méthode avec sudo</h3>
<div class="level3">

<p>
<img src="/_media/image/backuppc_rsync.png?w=400&amp;tok=5d0506" class="media img-responsive" alt="" width="400" />
</p>

</div>

<h4 id="manipulations_sur_le_serveur_de_sauvegarde1">Manipulations sur le serveur de sauvegarde</h4>
<div class="level4">

<p>
Cette partie est commune  à la <a href="#manipulations_sur_le_serveur_de_sauvegarde" title="backuppc ↵" class="wikilink1">méthode standard</a>
</p>

</div>

<h4 id="manipulations_sur_les_postes_clients1">Manipulations sur les postes clients</h4>
<div class="level4">

<p>
Nous allons utiliser le compte &quot;backup&quot;. Ce compte est pré-existant sous Ubuntu selon la norme <a href="https://fr.wikipedia.org/wiki/Filesystem_Hierarchy_Standard" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">FHS </a>. Comme on peut le voir dans <strong> /etc/passwd </strong>, le répertoire personnel de cet &quot;utilisateur&quot; est /var/backups.
</p>

</div>

<h5 id="placer_la_clef_publique1">Placer la clef publique.</h5>
<div class="level5">

<p>
Pour chacun des clients:
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Créer le répertoire <strong>.ssh</strong> dans le Dossier Personnel <pre class="code">sudo mkdir /var/backups/.ssh</pre>
</div>
</li>
<li class="level1"><div class="li"> <a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Editer le fichier</a> <strong>/var/backups/.ssh/authorized_keys</strong> avec les droits d&#039;administration <pre class="code"> sudo vim /var/backups/.ssh/authorized_keys </pre>
</div>
</li>
<li class="level1"><div class="li"> Ajouter dans le fichier, la clef publique de l&#039;utilisateur &quot;backuppc&quot; <a href="#manipulations_sur_le_serveur_de_sauvegarde" title="backuppc ↵" class="wikilink1">précédemment générée</a> <sup><a href="#fn__6" id="fnt__6" class="fn_top">6)</a></sup>. <em>(Vous pouvez par exemple éditer les deux fichiers et  faire un simple copier/coller.)</em></div>
</li>
<li class="level1"><div class="li"> Pour plus de sécurité, rajouter au début du fichier la directive <pre class="file">from=&quot;serveur&quot;</pre>
</div>
</li>
<li class="level1"><div class="li"> Vous devriez désormais avoir: </div>
</li>
<li class="level1"><div class="li"> Sous le compte backup</div>
</li>
</ul>
<pre class="code">sudo -i -u backup 
cat ~/.ssh/authorized_keys
from=&quot;serveur&quot; ssh-rsa AAAAB3N123456789xyz.......== backuppc@&lt;serveur&gt;</pre>

</div>

<h5 id="configuration_de_sshd1">Configuration de sshd.</h5>
<div class="level5">

<p>
<a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Modifier avec les droits d&#039;administration</a> le fichier <strong>/etc/ssh/sshd_config</strong> pour indiquer qu&#039;il n&#039;y pas besoin d&#039;autoriser root, ni des connexions par mot de passe pour vos sauvegardes.
</p>
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=29" title="Télécharger cet extrait" class="mediafile mf_">/etc/ssh/sshd_config</a></dt>
<dd><pre class="code file bash">PermitRootLogin no</pre>
</dd></dl>

</div>

<h5 id="configuration_de_sudo">Configuration de sudo.</h5>
<div class="level5">

<p>
À l&#039;aide de <a href="/sudoers" class="wikilink1" title="sudoers">visudo</a> mettez dans le fichier sudoers :
</p>
<pre class="code file bash">backup <span class="re2">ALL</span>=NOPASSWD: <span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>rsync</pre>

<p>
Ceci donnera à l&#039;utilisateur &quot;backup&quot; le droit <a href="/sudo" class="wikilink1" title="sudo">sudo</a> pour lancer <a href="/rsync" class="wikilink1" title="rsync">rsync</a> sans demande de mot de passe.
</p>

<p>
Pour pouvoir mener à bien cette opération, il faut revenir à un utilisateur qui ait les droits sudo, en fait à l&#039;utilisateur que vous étiez avant de passer à l&#039;utilisateur backup.
Pour cela :
</p>
<pre class="code">exit</pre>

<p>
puis simplement :
</p>
<pre class="code">sudo visudo</pre>

</div>

<h4 id="test_de_connexion_ssh1">Test de connexion SSH</h4>
<div class="level4">

<p>
Depuis le <em class="u">serveur</em> de sauvegarde, tenter une première connexion ssh vers le poste à sauvegarder pour l&#039;utilisateur &quot;backuppc&quot;.
</p>
<pre class="code">sudo -i -u backuppc
ssh backup@&lt;client&gt;</pre>

<p>
Répondre &quot;yes&quot;, ce qui ajoutera votre client à la liste des <em>known hosts</em><sup><a href="#fn__7" id="fnt__7" class="fn_top">7)</a></sup>.
</p>
<div class="noteclassic">En cas d&#039;erreur SSH vous pouvez rendre la commande plus volubile avec l&#039;option -v de <strong>ssh</strong>.
Regarder aussi <strong> /var/log/syslog </strong> sur le poste à sauvegarder.
Dans tous les cas jeter un œil sur la page consacrée à <a href="/ssh" class="wikilink1" title="ssh">ssh</a>.
En cas de blocage suite à la réinstallation du poste à sauvegarder, la partie traitant de la <a href="/ssh#gestion_des_cles" class="wikilink1" title="ssh">gestion des clefs</a> vous sera sûrement d&#039;une grande aide.

</div><div class="noteclassic">Si l&#039;erreur ssh est &quot;This account is currently not available.&quot;, sur le client, éditer /etc/passwd, et pour le compte &quot;backup&quot; remplacer &quot;/usr/sbin/nologin&quot; par &quot;/bin/sh&quot; (rencontré sur ubuntu 14.10)

</div>
</div>

<h4 id="parametrer_l_usage_de_ce_compte_par_backuppc">Paramétrer l&#039;usage de ce compte par backuppc</h4>
<div class="level4">

</div>

<h5 id="par_l_interface_web1">Par l&#039;interface Web</h5>
<div class="level5">

<p>
<em>onglet <strong>Xfert</strong> → pour <strong>rsync</strong> → chapitre <strong>Chemins/Commandes/Args Rsync</strong> </em> indiquer pour:
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong> RsyncClientCmd </strong> <pre class="file">$sshPath -q -x -l backup $hostIP /usr/bin/sudo $rsyncPath $argList+</pre>
</div>
</li>
<li class="level1"><div class="li"> <strong> RsyncClientRestoreCmd </strong> <pre class="file">$sshPath -q -x -l backup $hostIP /usr/bin/sudo $rsyncPath $argList+</pre>
</div>
</li>
</ul>

</div>

<h5 id="depuis_le_fichieretcbackuppcconfigpl">Depuis le fichier « /etc/backuppc/config.pl »</h5>
<div class="level5">

<p>
<a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Modifier avec les droits d&#039;administration</a> le fichier <strong> /etc/backuppc/config.pl/</strong> comme suit :
</p>
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=36" title="Télécharger cet extrait" class="mediafile mf_pl">/etc/backuppc/config.pl</a></dt>
<dd><pre class="code file perl"><span class="co1"># $Conf{RsyncClientCmd} = '$sshPath -q -x -l root $hostIP $rsyncPath $argList+';</span>
<span class="re0">$Conf</span><span class="br0">&#123;</span>RsyncClientCmd<span class="br0">&#125;</span> <span class="sy0">=</span> <span class="st_h">'$sshPath -q -x -l backup $hostIP /usr/bin/sudo $rsyncPath $argList+'</span><span class="sy0">;</span>
<span class="co1"># $Conf{RsyncClientRestoreCmd} = '$sshPath -q -x -l root $hostIP $rsyncPath $argList+';</span>
<span class="re0">$Conf</span><span class="br0">&#123;</span>RsyncClientRestoreCmd<span class="br0">&#125;</span> <span class="sy0">=</span> <span class="st_h">'$sshPath -q -x -l backup $hostIP /usr/bin/sudo $rsyncPath $argList+'</span><span class="sy0">;</span></pre>
</dd></dl>

</div>
<div class='secedit editbutton_section editbutton_13'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Méthode avec sudo] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="methode_avec_sudo" /><input type="hidden" name="codeblockOffset" value="25" /><input type="hidden" name="range" value="14919-19269" /><button type="submit" title="Méthode avec sudo" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit14" id="ajouter_la_machine_a_sauvegarder_a_la_liste">Ajouter la machine à sauvegarder à la liste.</h3>
<div class="level3">

<p>
Il ne reste plus qu&#039;à  ajouter la machine à sauvegarder à la liste.<br/>

</p>
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<tr class="row0">
		<td class="col0">#Connexion à l&#039;interface Web</td>
	</tr>
</table></div>

<p>
  - <em>Serveur → Modifier les machines → Machines</em> : ajouter &lt;client&gt; avec &quot;backuppc&quot; comme user<sup><a href="#fn__8" id="fnt__8" class="fn_top">8)</a></sup>
</p>
<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <em>Hôtes </em> : choisir &lt;client&gt; dans la liste déroulante</div>
</li>
<li class="level1"><div class="li"> <em>Modifier la configuration → xfer → XferMethod</em> : choisir &quot;rsync&quot; → <em>Sauvegarder </em>(apparaît en rouge)</div>
</li>
<li class="level1"><div class="li"> <em>&lt;client&gt; Accueil → Démarrer la sauvegarde complète</em></div>
</li>
<li class="level1"><div class="li"> <em>Explorer les sauvegardes </em>: vérifier ici que ça a bien fonctionné.</div>
</li>
</ol>

</div>
<div class='secedit editbutton_section editbutton_14'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Ajouter la machine à sauvegarder à la liste.] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="ajouter_la_machine_a_sauvegarder_a_la_liste" /><input type="hidden" name="codeblockOffset" value="37" /><input type="hidden" name="range" value="19270-19914" /><button type="submit" title="Ajouter la machine à sauvegarder à la liste." class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit16 page-header" id="sauvegarder_un_poste_mac_os_distant_via_ssh">Sauvegarder un poste Mac OS distant via ssh</h2>
<div class="level2">

<p>
<em>Testé sur Mac <abbr title="Operating System">OS</abbr> 10.6 &amp; 10.7. </em>
</p>
<div class="notetip"><em class="u"><strong>Pré-requis:</strong></em><br/>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> La sauvegarde se faisant au travers de <a href="/ssh" class="wikilink1" title="ssh">ssh</a>, activer le serveur ssh en cochant &quot;session a distance&quot; depuis le menu <em>Preferences → Système → Partage</em>.<br/>
</div>
</li>
<li class="level1"><div class="li"> Afin de sauvegarder un poste <abbr title="GNU&#039;s Not Unix">GNU</abbr>/linux distant, il est nécessaire que l&#039;utilisateur &quot;backuppc&quot; du serveur se connecte au poste distant.</div>
</li>
</ul>

</div>
<p>
La procédure est identique en tout point à la méthode <a href="#sauvegarder_un_poste_linux_distant_via_rsync_ssh" title="backuppc ↵" class="wikilink1">Sauvegarder un poste Linux distant via rsync (ssh)</a> à celà près qu&#039;il vous faudra commencer par vous connecter en tant qu&#039;administrateur avant de continuer.
</p>
<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Se connecter à la machine Mac à sauvegarder en ssh avec un compte administrateur du Mac qui a un mot de passe. <pre class="code">ssh admin@ip du mac</pre>
</div>
</li>
<li class="level1"><div class="li"> Passez en utilisateur root <pre class="code">sudo -su root</pre>
</div>
</li>
<li class="level1"><div class="li"> Suivre la procédure telle qu&#039;expliquée <a href="#manipulations_sur_le_serveur_de_sauvegarde" title="backuppc ↵" class="wikilink1">ici</a></div>
</li>
</ol>

</div>
<div class='secedit editbutton_section editbutton_16'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Sauvegarder un poste Mac OS distant via ssh] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="sauvegarder_un_poste_mac_os_distant_via_ssh" /><input type="hidden" name="codeblockOffset" value="37" /><input type="hidden" name="range" value="19915-20882" /><button type="submit" title="Sauvegarder un poste Mac OS distant via ssh" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit17 page-header" id="sauvegarder_des_postes_windows_via_rsyncd">Sauvegarder des postes Windows via « rsyncd »</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_17'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Sauvegarder des postes Windows via « rsyncd »] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="sauvegarder_des_postes_windows_via_rsyncd" /><input type="hidden" name="codeblockOffset" value="39" /><input type="hidden" name="range" value="20883-20943" /><button type="submit" title="Sauvegarder des postes Windows via « rsyncd »" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit18" id="configuration_des_postes_windows">Configuration des postes Windows</h3>
<div class="level3">

<p>
Sans s&#039;étendre sur la configuration des postes Windows, sachez qu&#039;il existe un paquet tout fait sur le site de BackupPC, qui, en moins de 1 Mio comprend une version de CygWin et le binaire de <em>Rsync</em>.<br/>

Ce paquet s&#039;appelle « cygwin-rsyncd » et est disponible <a href="http://sourceforge.net/project/showfiles.php?group_id=34854" class="urlextern" title="http://sourceforge.net/project/showfiles.php?group_id=34854" rel="nofollow">ici</a>.<br/>

Il suffira ensuite de suivre les instructions du fichier « README.TXT » de ce paquet.
</p>

<p>
Il sera donc considéré pour la suite de cet article que vous avez :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> un module « docs » partagé par <em>rsyncd</em> ;</div>
</li>
<li class="level1"><div class="li"> ce module doit permettre l&#039;accès en écriture à l&#039;utilisateur « UUU » avec le mot de passe « <abbr title="Protocole Point à Point">PPP</abbr> » ;</div>
</li>
<li class="level1"><div class="li"> le service <em>rsyncd</em> lancé sur ce PC.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_18'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Configuration des postes Windows] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_des_postes_windows" /><input type="hidden" name="codeblockOffset" value="39" /><input type="hidden" name="range" value="20944-21689" /><button type="submit" title="Configuration des postes Windows" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit19" id="configuration_du_fichier_configpl">Configuration du fichier « config.pl »</h3>
<div class="level3">

<p>
<a href="/tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">Éditez le fichier</a> <strong> /etc/backuppc/config.pl</strong> avec les <a href="/sudo" class="wikilink1" title="sudo">droits d&#039;administration</a> et modifiez les options de la façon suivante :
</p>
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=39" title="Télécharger cet extrait" class="mediafile mf_pl">/etc/backuppc/config.pl</a></dt>
<dd><pre class="code file perl"><span class="re0">$Conf</span><span class="br0">&#123;</span>XferMethod<span class="br0">&#125;</span> <span class="sy0">=</span> <span class="st_h">'rsyncd'</span><span class="sy0">;</span>
<span class="re0">$Conf</span><span class="br0">&#123;</span>RsyncdUserName<span class="br0">&#125;</span>  <span class="sy0">=</span> <span class="st0">&quot;UUU&quot;</span><span class="sy0">;</span>
<span class="re0">$Conf</span><span class="br0">&#123;</span>RsyncdPasswd<span class="br0">&#125;</span>    <span class="sy0">=</span> <span class="st0">&quot;PPP&quot;</span><span class="sy0">;</span>
<span class="re0">$Conf</span><span class="br0">&#123;</span>RsyncShareName<span class="br0">&#125;</span>  <span class="sy0">=</span> <span class="st0">&quot;docs&quot;</span><span class="sy0">;</span></pre>
</dd></dl>

<p>
Sauvegarder le fichier et recharger la configuration depuis <a href="#connexion_a_l_interface_web" title="backuppc ↵" class="wikilink1">l&#039;interface Web</a>. 
</p>

</div>
<div class='secedit editbutton_section editbutton_19'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Configuration du fichier « config.pl »] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_du_fichier_configpl" /><input type="hidden" name="codeblockOffset" value="39" /><input type="hidden" name="range" value="21690-22205" /><button type="submit" title="Configuration du fichier « config.pl »" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit20 page-header" id="sauvegarder_des_postes_windows_via_smb">Sauvegarder des postes Windows via « smb »</h2>
<div class="level2">

</div>

<h4 id="configuration_des_postes_windows1">Configuration des postes Windows</h4>
<div class="level4">
<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Créez un utilisateur avec un mot de passe.</div>
</li>
<li class="level1"><div class="li"> Créez un partage sur la ressource à sauvegarder avec les droits modifiés en lecture pour l&#039;utilisateur créé précédemment.</div>
</li>
<li class="level1"><div class="li"> Effectuez les changements depuis <a href="#connexion_a_l_interface_web" title="backuppc ↵" class="wikilink1">l&#039;interface Web</a> ou en modifiants les fichiers <strong>config.pl</strong> et <strong>hosts</strong> comme indiqué ci-dessous.</div>
</li>
</ol>

<p>
Pour l&#039;exemple ici:
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> nom d&#039;utilisateur créé sera → <em>backup</em> </div>
</li>
<li class="level1"><div class="li"> mot de pase → <em>mdpbupc</em></div>
</li>
<li class="level1"><div class="li"> dossier de partage → <em>docs$</em></div>
</li>
<li class="level1"><div class="li"> adresse IP de la machine windows → <em>192.168.1.10</em></div>
</li>
</ul>

</div>

<h5 id="configuration_du_fichier_configpl1">Configuration du fichier « config.pl »</h5>
<div class="level5">

<p>
<a href="/tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">Éditez le fichier</a> <strong> /etc/backuppc/config.pl</strong> avec les <a href="/sudo" class="wikilink1" title="sudo">droits d&#039;administration</a> et modifiez les options ainsi :
</p>
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=40" title="Télécharger cet extrait" class="mediafile mf_pl">/etc/backuppc/config.pl</a></dt>
<dd><pre class="code file perl"><span class="re0">$Conf</span><span class="br0">&#123;</span>XferMethod<span class="br0">&#125;</span> <span class="sy0">=</span> <span class="st_h">'smb'</span><span class="sy0">;</span>
<span class="re0">$Conf</span><span class="br0">&#123;</span>SmbShareUserName<span class="br0">&#125;</span> <span class="sy0">=</span> <span class="st_h">'backup'</span><span class="sy0">;</span>
<span class="re0">$Conf</span><span class="br0">&#123;</span>SmbSharePasswd<span class="br0">&#125;</span> <span class="sy0">=</span> <span class="st_h">'mdpbupc'</span><span class="sy0">;</span>
<span class="re0">$Conf</span><span class="br0">&#123;</span>SmbShareName<span class="br0">&#125;</span> <span class="sy0">=</span> <span class="st_h">'docs$'</span><span class="sy0">;</span>
&nbsp;</pre>
</dd></dl>

<p>
Sauvegarder le fichier et recharger la configuration depuis <a href="#connexion_a_l_interface_web" title="backuppc ↵" class="wikilink1">l&#039;interface Web</a>. 
</p>

</div>

<h5 id="configuration_du_fichier_hosts">Configuration du fichier « hosts »</h5>
<div class="level5">

<p>
<a href="/tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">Éditez le fichier</a> <strong>/etc/backuppc/hosts</strong> avec les droits d&#039;administration pour y ajouter cette ligne en fin de fichier 
</p>
<pre class="file"> 192.168.1.10	0	utilisateur	UUU </pre>

<p>
Sauvegarder le fichier et recharger la configuration depuis <a href="#connexion_a_l_interface_web" title="backuppc ↵" class="wikilink1">l&#039;interface Web</a>. 
</p>

</div>
<div class='secedit editbutton_section editbutton_20'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Sauvegarder des postes Windows via « smb »] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="sauvegarder_des_postes_windows_via_smb" /><input type="hidden" name="codeblockOffset" value="40" /><input type="hidden" name="range" value="22206-23716" /><button type="submit" title="Sauvegarder des postes Windows via « smb »" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit21 page-header" id="sauvegarder_des_pc_eteints">Sauvegarder des PC éteints</h2>
<div class="level2">

<p>
Il est intéressant de pouvoir effectuer la sauvegarde des machines lorsqu&#039;elles ne sont pas en production, par exemple la nuit. Par défaut, backuppc ne permet pas de gérer le <a href="/wakeonlan" class="wikilink1" title="wakeonlan">wake on lan</a>, mais avec quelques astuces, c&#039;est possible !
</p>

</div>
<div class='secedit editbutton_section editbutton_21'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Sauvegarder des PC éteints] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="sauvegarder_des_pc_eteints" /><input type="hidden" name="codeblockOffset" value="42" /><input type="hidden" name="range" value="23717-24009" /><button type="submit" title="Sauvegarder des PC éteints" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit22" id="configuration_du_wol_sur_le_serveur">Configuration du WOL sur le serveur</h3>
<div class="level3">

<p>
L&#039;outil <a href="/wakeonlan" class="wikilink1" title="wakeonlan">etherwake</a> est parfait pour démarrer une machine à distance. Pour pouvoir utiliser ce dernier avec le nom de la machine au lieu de son adresse <abbr title="Medium Access Control">MAC</abbr>, il faut compléter le fichier <strong>/etc/ethers</strong> :
</p>
<pre class="file"> adresse:MAC	nom_machine </pre>

<p>
Il va sans dire que le nom de la machine doit être déclaré comme dans le fichier <strong> /etc/backuppc/hosts</strong>.
</p>

<p>
Pour que le fichier ethers soit pris en compte par etherwake modifier le fichier <strong>/etc/nsswitch.conf</strong>, à la ligne ethers :
</p>
<pre class="file"> ethers:         files </pre>

<p>
Par defaut, la commande etherwake n&#039;est exécutable que par root, pour remédier à cela :
</p>
<pre class="file"> ln /usr/sbin/etherwake /usr/bin/
chmod +s /usr/sbin/etherwake </pre>

</div>
<div class='secedit editbutton_section editbutton_22'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Configuration du WOL sur le serveur] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_du_wol_sur_le_serveur" /><input type="hidden" name="codeblockOffset" value="42" /><input type="hidden" name="range" value="24010-24759" /><button type="submit" title="Configuration du WOL sur le serveur" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit23" id="script_de_reveil_et_d_arret_des_machines">Script de réveil et d&#039;arrêt des machines</h3>
<div class="level3">

<p>
Créez dans le dossier <strong>/etc/backuppc/</strong> deux petits scripts qui doivent pouvoir être améliorés :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>wol.sh</strong> pour l&#039;envoi d&#039;un <a href="https://fr.wikipedia.org/wiki/Wake-on-LAN#Paquet_magique" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/Wake-on-LAN#Paquet_magique">paquet magique</a> </div>
</li>
<li class="level1"><div class="li"> <strong>shutdown.sh</strong> pour l&#039;arrêt de la machine.</div>
</li>
</ul>

</div>

<h5 id="le_fichier_wolsh">le fichier **wol.sh**</h5>
<div class="level5">
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=45" title="Télécharger cet extrait" class="mediafile mf_sh">wol.sh</a></dt>
<dd><pre class="code file bash"><span class="co0">#!/bin/bash</span>
&nbsp;
<span class="kw3">declare</span> <span class="re5">-i</span> z
<span class="re2">z</span>=<span class="nu0">0</span>
<span class="re2">i</span>=<span class="nu0">0</span>
<span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>etherwake <span class="re4">$1</span>
<span class="kw2">sleep</span> 1m
<span class="kw1">while</span> <span class="br0">&#91;</span> <span class="re1">$i</span> = <span class="nu0">0</span> <span class="re5">-a</span> <span class="re1">$z</span> <span class="re5">-lt</span> <span class="nu0">15</span> <span class="br0">&#93;</span>
<span class="kw1">do</span>
        <span class="kw1">if</span> smbclient <span class="re5">-L</span> <span class="re4">$1</span> <span class="re5">-U</span> backup<span class="sy0">%</span>mdpbupc<span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null
                <span class="kw1">then</span>
                        <span class="re2">i</span>=<span class="nu0">1</span>
        <span class="kw1">fi</span>
<span class="kw2">sleep</span> 10s
<span class="re2">z</span>=z+<span class="nu0">1</span>
<span class="kw1">done</span> </pre>
</dd></dl>

<p>
<em class="u"><strong>Explication:</strong></em> Une fois la commande etherwake exécutée:
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> il y a une pause d&#039;une minute pour laisser le temps au pc de démarrer.</div>
</li>
<li class="level1"><div class="li"> Puis, la boucle while teste si le partage est actif. </div>
</li>
<li class="level1"><div class="li"> Après 15 essais sans résultat la boucle s&#039;arrête.</div>
</li>
</ul>

</div>

<h5 id="le_fichier_shutdownsh">le fichier **shutdown.sh**</h5>
<div class="level5">
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=46" title="Télécharger cet extrait" class="mediafile mf_sh">shutdown.sh</a></dt>
<dd><pre class="code file bash"> <span class="co0">#!/bin/bash</span>
<span class="kw1">if</span> <span class="br0">&#91;</span> $<span class="br0">&#40;</span><span class="kw2">date</span> +<span class="sy0">%</span>k<span class="br0">&#41;</span> <span class="re5">-lt</span> 07 <span class="re5">-o</span> $<span class="br0">&#40;</span><span class="kw2">date</span> +<span class="sy0">%</span>k <span class="br0">&#41;</span> <span class="re5">-gt</span> <span class="nu0">20</span> <span class="br0">&#93;</span>
<span class="kw1">then</span>
	<span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>net rpc SHUTDOWN <span class="re5">-f</span> <span class="re5">-I</span> <span class="re4">$1</span> <span class="re5">-U</span> administrateur<span class="sy0">%</span>mdpadministrateur <span class="re5">-t</span> <span class="nu0">30</span>
<span class="kw1">else</span>
        <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re4">$2</span> = <span class="nu0">1</span> <span class="br0">&#93;</span>
        <span class="kw1">then</span>
            <span class="kw3">echo</span> sauvegarde terminé avec succès. <span class="sy0">|</span> smbclient <span class="re5">-M</span> <span class="re4">$1</span> <span class="re5">--user</span>=<span class="st0">&quot;backuppc&quot;</span>
        <span class="kw1">fi</span>
<span class="kw1">fi</span> </pre>
</dd></dl>

<p>
<em class="u"><strong>Explication:</strong></em>  entre 20h00 et 07h00 est exécutée la commande d&#039;extinction du pc sauvegardé. En dehors de cette plage horaire, au lieu d&#039;arrêter la machine, un message est envoyé.
</p>
<div class="noteimportant">N&#039;oubliez pas de rendre les scripts <a href="/permissions#execution" class="wikilink1" title="permissions">exécutables</a> pour l&#039;utilisateur backuppc !
</div><div class="noteclassic">Cette commande :<pre class="file">net rpc SHUTDOWN -f -I $1 -U administrateur%mdpadministrateur -t 30</pre>

<p>
peut ne pas fonctionner si le pc sous Windows n&#039;accepte pas l&#039;exécution de la commande d&#039;extinction à distance.<br/>

Pour parer à cela, vous êtes invité à lire le dernier message de <a href="http://forum.ubuntu-fr.org/viewtopic.php?pid=2988204#p2988204" class="urlextern" title="http://forum.ubuntu-fr.org/viewtopic.php?pid=2988204#p2988204" rel="nofollow">cette discussion</a>
</p>

</div>
</div>

<h5 id="autre_exemple_de_fichiers_wolsh_et_shutdownsh_ameliores_qui_conservent_l_etat_precedent">autre exemple de fichiers **wol.sh** et **shutdown.sh** améliorés qui conservent l&#039;état précédent</h5>
<div class="level5">

<p>
Pour utiliser ces scripts, veuillez mettre le paramètre <strong>UserCmdCheckStatus</strong> à <strong>1</strong> dans la configuration, ou ajoutez cette ligne au fichier <strong>/etc/backuppc/config.pl</strong>:
</p>
<pre class="file">$Conf{UserCmdCheckStatus} = &#039;1&#039;;</pre>

<p>
ceci permet de dire à Backuppc de prendre en compte le code d&#039;erreur des scripts de réveil/extinction.
</p>
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=49" title="Télécharger cet extrait" class="mediafile mf_sh">wol.sh</a></dt>
<dd><pre class="code file bash"><span class="co0">#!/bin/bash</span>
&nbsp;
<span class="kw3">declare</span> <span class="re5">-i</span> z
<span class="re2">z</span>=<span class="nu0">0</span>
<span class="re2">i</span>=<span class="nu0">0</span>
<span class="re2">filename</span>=<span class="sy0">/</span>var<span class="sy0">/</span>lib<span class="sy0">/</span>backuppc<span class="sy0">/</span><span class="re4">$1</span>.laststate
<span class="kw3">echo</span> <span class="st0">&quot;Starting wake on lan script&quot;</span>
<span class="kw3">echo</span> <span class="st0">&quot;Filename=<span class="es2">$filename</span>&quot;</span>
<span class="re2">cnt</span>=$<span class="br0">&#40;</span><span class="kw2">ping</span> <span class="re5">-c</span> <span class="nu0">1</span> <span class="re4">$1</span> <span class="sy0">|</span> <span class="kw2">awk</span> -F, <span class="st_h">'/received/{print $2*1}'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw3">echo</span> <span class="st0">&quot;Count ping to host $1 = <span class="es2">$cnt</span>&quot;</span>
&nbsp;
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re1">$cnt</span> <span class="re5">-eq</span> <span class="nu0">0</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="re1">$cnt</span> <span class="sy0">&gt;</span> <span class="re1">$filename</span>
&nbsp;
    <span class="co0"># Time to wait for machine to boot in minutes</span>
    <span class="co0"># Use value given as argument</span>
    <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re5">-n</span> <span class="st0">&quot;$2&quot;</span> <span class="br0">&#93;</span> <span class="sy0">&amp;&amp;</span> <span class="br0">&#91;</span> <span class="st0">&quot;$2&quot;</span> <span class="re5">-eq</span> <span class="st0">&quot;$2&quot;</span> <span class="br0">&#93;</span> <span class="nu0">2</span><span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null; <span class="kw1">then</span>
      <span class="re2">min</span>=<span class="re4">$2</span>
    <span class="kw1">else</span>
      <span class="kw3">echo</span> <span class="st0">&quot;	Second argument given is not a valid number! : $2&quot;</span>
      <span class="kw3">echo</span> <span class="st0">&quot;	Using default value: 2 minutes&quot;</span>
      <span class="re2">min</span>=<span class="nu0">2</span>
    <span class="kw1">fi</span>
    <span class="re2">m</span>=<span class="re1">$min</span><span class="st0">&quot;m&quot;</span>
&nbsp;
    <span class="kw3">echo</span> <span class="st0">&quot;Send WOL to $1 and wait <span class="es2">$min</span> minutes&quot;</span>
    <span class="kw2">sudo</span> <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>etherwake <span class="re5">-i</span> enp5s0 <span class="re4">$1</span>
    <span class="kw2">sleep</span> <span class="re1">$m</span>
    <span class="kw1">while</span> <span class="br0">&#91;</span> <span class="re1">$i</span> = <span class="nu0">0</span> <span class="re5">-a</span> <span class="re1">$z</span> <span class="re5">-lt</span> <span class="nu0">18</span> <span class="br0">&#93;</span>
    <span class="kw1">do</span>
	<span class="re2">count</span>=$<span class="br0">&#40;</span><span class="kw2">ping</span> <span class="re5">-c</span> <span class="nu0">5</span> <span class="re4">$1</span> <span class="sy0">|</span> <span class="kw2">awk</span> -F, <span class="st_h">'/received/{print $2*1}'</span><span class="br0">&#41;</span>
	<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re1">$count</span> <span class="re5">-eq</span> <span class="nu0">0</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    	    <span class="kw3">echo</span> <span class="st0">&quot;$1 is down&quot;</span>
	    <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re1">$z</span> <span class="re5">-eq</span> <span class="nu0">17</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
		<span class="kw3">echo</span> <span class="st0">&quot;$1 not up after <span class="es5">`expr $min + 3`</span> minutes... exiting&quot;</span>
		<span class="kw3">exit</span> <span class="nu0">1</span>
	    <span class="kw1">fi</span>
	<span class="kw1">else</span>
	    <span class="re2">i</span>=<span class="nu0">1</span>
	    <span class="kw3">echo</span> <span class="st0">&quot;$1 is up&quot;</span>
	    <span class="kw3">exit</span> <span class="nu0">0</span>
        <span class="kw1">fi</span>
	<span class="kw2">sleep</span> 10s
	<span class="re2">z</span>=z+<span class="nu0">1</span>
    <span class="kw1">done</span>
<span class="kw1">else</span>
    <span class="kw3">echo</span> <span class="re1">$cnt</span> <span class="sy0">&gt;</span> <span class="re1">$filename</span>
    <span class="kw3">exit</span> <span class="nu0">0</span>
<span class="kw1">fi</span></pre>
</dd></dl>

<p>
<em class="u"><strong>Explication:</strong></em> Ce script prend deux arguments: le nom d&#039;hôte de la machine en premier et un nombre en deuxième (correspondant au nombre de minutes à attendre une fois que la commande etherwake est executée).
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> le script exécute la commande etherwake sur la machine spécifiée</div>
</li>
<li class="level1"><div class="li"> puis, la boucle while teste si la machine répond au ping</div>
</li>
<li class="level1"><div class="li"> après le nombre de minutes spécifiées en second argument, si la machine est en ligne, la sauvegarde est effectuée. Si la machine ne répond pas, le script attend encore 3 minutes supplémentaires</div>
</li>
<li class="level1"><div class="li"> si après les 3 minutes supplémentaires la machine ne répond toujours pas, le script s&#039;arrête et renvoi un code d&#039;erreur, qui est ensuite interprêté par backuppc </div>
</li>
</ul>
<div class="noteclassic">Cette commande :<pre class="file">sudo /usr/sbin/etherwake -i enp5s0 $1</pre>

<p>
peut varier selon les machines. Vous devrez peut-être l&#039;adapter à votre configuration.<br/>

Ici &#039;enp5s0&#039; est l&#039;interface par laquelle est envoyée le paquet magique via ethernet. $1 est la variable du nom d&#039;hôte (ne doit pas être modifiée).
</p>

</div>
<p>
Ainsi pour utiliser ce script il faut ajouter ce paramètre à la configuration:
</p>
<pre class="file">$Conf{DumpPreUserCmd}     = &#039;/etc/backuppc/wol.sh $host 3&#039;;</pre>

<p>
Cette commande envoi le paquet magique et attend ensuite 3 minutes (à adapter selon vos besoins) le réveil de la machine (si rien n&#039;est donné en second argument, le script utilise la valeur de 2 minutes par défaut).
</p>
<dl class="file">
<dt><a href="/_export/code/backuppc?codeblock=52" title="Télécharger cet extrait" class="mediafile mf_sh">shutdown.sh</a></dt>
<dd><pre class="code file bash"><span class="co0">#!/bin/bash</span>
<span class="co0"># Backuppc user script</span>
&nbsp;
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;$#&quot;</span> <span class="sy0">!</span>= <span class="nu0">2</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span>
    <span class="kw3">echo</span> <span class="st0">&quot;The BackupPC user script takes two arguments:&quot;</span>
    <span class="kw3">echo</span> <span class="st0">&quot; First: a host name ( with a corresponding /etc/hosts entry )&quot;</span>
    <span class="kw3">echo</span> <span class="st0">&quot; Second: - either a number corresponding to the output of the backup process (0 = failed / 1 = success)&quot;</span>
    <span class="kw3">echo</span> <span class="st0">&quot;         - OR -f to force shutdown a host&quot;</span>
    <span class="kw3">echo</span>
    <span class="kw3">exit</span> <span class="nu0">1</span>
<span class="kw1">fi</span>
&nbsp;
<span class="co0"># Array of computers, in the form: [hostname]='Username%Password'</span>
<span class="co0"># these must be Administrator's accounts</span>
<span class="co0"># Modify these according to your needs</span>
<span class="kw3">declare</span> <span class="re5">-A</span> names
<span class="re2">names</span>=<span class="br0">&#40;</span>
    <span class="br0">&#91;</span>hostname1<span class="br0">&#93;</span>=<span class="st_h">'adminuser1%password1'</span>
    <span class="br0">&#91;</span>hostname2<span class="br0">&#93;</span>=<span class="st_h">'adminuser2%password2'</span>
    <span class="br0">&#91;</span>hostname3<span class="br0">&#93;</span>=<span class="st_h">'adminuser3%password3'</span>
<span class="br0">&#41;</span>
&nbsp;
<span class="kw1">for</span> i <span class="kw1">in</span> <span class="st0">&quot;<span class="es3">${!names[@]}</span>&quot;</span>
<span class="kw1">do</span>
    <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re1">$i</span> = <span class="re4">$1</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
	    <span class="re2">host_name</span>=<span class="re1">$i</span>
	    <span class="re2">upwd</span>=<span class="co1">${names[$i]}</span>
    <span class="kw1">fi</span>
<span class="kw1">done</span>
&nbsp;
<span class="co0"># Exit if no corresponding host name found</span>
<span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$host_name</span>&quot;</span> = <span class="st0">&quot;&quot;</span> <span class="br0">&#93;</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">echo</span> <span class="st0">&quot;Host unknown!&quot;</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">exit</span> <span class="nu0">1</span>
&nbsp;
<span class="co0"># To stop a pc, if -f argument given ( wol script wasn't used and there is no host file )</span>
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;$2&quot;</span> = <span class="st0">&quot;-f&quot;</span> <span class="br0">&#93;</span>
<span class="kw1">then</span>
    <span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>net rpc SHUTDOWN <span class="re5">-f</span> <span class="re5">-I</span> <span class="re1">$host_name</span> <span class="re5">-U</span> <span class="st0">&quot;<span class="es2">$upwd</span>&quot;</span> <span class="re5">-t</span> <span class="nu0">1</span>
    <span class="kw3">exit</span> <span class="nu0">0</span>
<span class="kw1">fi</span>
&nbsp;
<span class="co0"># File to record the host status</span>
<span class="re2">filename</span>=<span class="sy0">/</span>var<span class="sy0">/</span>lib<span class="sy0">/</span>backuppc<span class="sy0">/</span><span class="re1">$host_name</span>.laststate
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re5">-f</span> <span class="re1">$filename</span> <span class="br0">&#93;</span>
<span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Filename=<span class="es2">$filename</span>&quot;</span>
    <span class="kw3">declare</span> <span class="re5">-i</span> laststate
    <span class="kw2">read</span> laststate <span class="sy0">&lt;</span> <span class="re1">$filename</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Last State Host <span class="es2">$host_name</span> = <span class="es2">$laststate</span>&quot;</span>
<span class="kw1">else</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Missing host file!&quot;</span>
    <span class="kw3">exit</span> <span class="nu0">1</span>
<span class="kw1">fi</span>
&nbsp;
<span class="co0"># Actions after backup</span>
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re4">$2</span> = <span class="nu0">1</span> <span class="br0">&#93;</span> <span class="co0"># Successfull backup</span>
<span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Backup of <span class="es2">$host_name</span> OK&quot;</span>
    <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re1">$laststate</span> = <span class="nu0">0</span> <span class="br0">&#93;</span>
    <span class="kw1">then</span>
	<span class="co0"># Last state off, send shutdown</span>
	<span class="kw3">echo</span> <span class="st0">&quot;Sent SHUTDOWN to host <span class="es2">$host_name</span>&quot;</span>
	<span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>net rpc SHUTDOWN <span class="re5">-f</span> <span class="re5">-I</span> <span class="re1">$host_name</span> <span class="re5">-U</span> <span class="st0">&quot;<span class="es2">$upwd</span>&quot;</span> <span class="re5">-t</span> <span class="nu0">30</span>
    <span class="kw1">else</span>
        <span class="co0"># Last state : up</span>
        <span class="kw3">echo</span> <span class="st0">&quot;SHUTDOWN not sent to <span class="es2">$host_name</span> cause Host already UP before&quot;</span>
    <span class="kw1">fi</span>
<span class="kw1">elif</span> <span class="br0">&#91;</span> <span class="re4">$2</span> = <span class="nu0">0</span> <span class="br0">&#93;</span> <span class="co0"># backup error</span>
<span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Problem during backup of <span class="es2">$host_name</span>&quot;</span>
    <span class="co0"># Only shutdown after unsuccesfull backup during out of office hours</span>
    <span class="co0">#if [ $(date +%k) -lt 07 -o $(date +%k ) -gt 22 ]</span>
    <span class="co0">#then</span>
    <span class="co0">#/usr/bin/net rpc SHUTDOWN -f -I $host_name -U &quot;$upwd&quot; -t 30</span>
    <span class="co0">#fi</span>
<span class="kw1">fi</span>
&nbsp;
<span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re5">-f</span> <span class="re1">$filename</span> <span class="br0">&#93;</span>
<span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Delete <span class="es2">$filename</span>&quot;</span>
    <span class="kw2">unlink</span> <span class="re1">$filename</span>
<span class="kw1">fi</span></pre>
</dd></dl>

<p>
<em class="u"><strong>Explication:</strong></em> Ce script prend deux arguments: le nom d&#039;hôte de la machine en premier et le code de résultat du backup en deuxième (0 = échec / 1 = succès).
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> si le backup est réussi: si la machine était précédemment éteinte, le script exécute la commande d&#039;arrêt avec les paramètres nom d&#039;utilisateur/ mot de passe tels qu&#039;enregistrés dans le script</div>
</li>
<li class="level1"><div class="li"> si la machine était allumée avant, la commande d&#039;arrêt, n&#039;est pas envoyée</div>
</li>
<li class="level1"><div class="li"> si le second argument est &#039;-f&#039; (pour forcer), la machine correspondante est arrêtée quel que soit l&#039;état précédent</div>
</li>
</ul>

<p>
Ainsi pour utiliser ce script il faut ajouter ce paramètre à la configuration:
</p>
<pre class="file">$Conf{DumpPostUserCmd}    = &#039;/etc/backuppc/shutdown.sh $host $xferOK&#039;;</pre>
<div class="noteclassic">Cette commande :<pre class="file">/etc/backuppc/shutdown.sh $host -f</pre>

<p>
peut être utilisé en ligne de commande directement pour éteindre une machine en dehors de backuppc.
</p>

</div>
</div>
<div class='secedit editbutton_section editbutton_23'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Script de réveil et d&#039;arrêt des machines] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="script_de_reveil_et_d_arret_des_machines" /><input type="hidden" name="codeblockOffset" value="45" /><input type="hidden" name="range" value="24760-32708" /><button type="submit" title="Script de réveil et d&#039;arrêt des machines" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit24" id="configuration_de_backuppc_pour_utiliser_les_scripts">Configuration de backuppc pour utiliser les scripts</h3>
<div class="level3">

<p>
Backuppc contrôle la présence du pc sur le réseau avec ping, sans quoi il n&#039;effectue pas de sauvegarde. Pour remédier à cela, dans le fichier <strong>/etc/backuppc/config.pl</strong>, avec les droits d&#039;administration remplacer
</p>
<pre class="file">$Conf{PingPath} = &#039;/bin/ping&#039;;</pre>

<p>
par
</p>
<pre class="file">$Conf{PingPath} = &#039;/bin/echo&#039;;</pre>

<p>
<img src="/lib/images/smileys/fixme.gif" class="icon" alt="FIXME" /> dans ce cas le backup pourrait essayer de se lancer alors que la machine n&#039;est pas accessible.
</p>
<div class="noteclassic"><strong>Pour faire encore mieux</strong>, vous pouvez aussi réaliser un ping a travers le démon ssh en executant simplement la commande <strong>cat</strong> sur le fichier <strong>/dev/null</strong>. Ceci permettra de tester que le démon ssh est bien démarré et donc de tester que le serveur est accessible. Pour faire ceci, remplassez la configuration précédente par la ligne ci-contre: <strong>$Conf{PingPath} = &#039;/usr/bin/ssh $host cat /dev/null&#039;;</strong> 
</div>
<p>
et ajouter les chemins des scripts comme suit :
</p>
<pre class="file">$Conf{DumpPreUserCmd}     = &#039;/etc/backuppc/wol.sh $host&#039;;
$Conf{DumpPostUserCmd}    = &#039;/etc/backuppc/shutdown.sh $host $xferOK&#039;;</pre>

<p>
Sauvegardez le fichier et recharger la configuration via l&#039;interface web. 
</p>

<p>
Il ne vous reste plus qu&#039;à activer le <a href="/wakeonlan" class="wikilink1" title="wakeonlan">wol</a> sur les postes clients…
</p>

</div>
<div class='secedit editbutton_section editbutton_24'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Configuration de backuppc pour utiliser les scripts] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_de_backuppc_pour_utiliser_les_scripts" /><input type="hidden" name="codeblockOffset" value="55" /><input type="hidden" name="range" value="32709-33964" /><button type="submit" title="Configuration de backuppc pour utiliser les scripts" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit25 page-header" id="faire_une_copie_des_sauvegardes_sur_un_support_externe_avec_rsync">Faire une copie des sauvegardes sur un support externe avec RSYNC</h2>
<div class="level2">

<p>
<strong>Backuppc</strong> gère <strong>la déduplication des données</strong>. C&#039;est à dire qu&#039;après la copie des fichiers, si un fichier apparaît plusieurs fois, il n&#039;en gardera qu&#039;un seul exemplaire, en  créant des <strong>liens matériels</strong> (<strong>hardlinks</strong>) vers le fichier d&#039;origine.
</p>

<p>
Lorsqu&#039;on sauvegarde avec un <strong>rsync &quot;traditionnel&quot;</strong> les sauvegardes de <strong>Backuppc</strong>, <strong>rsync</strong> ne gère pas les liens matériels, et recopie le fichier autant de fois qu&#039;il y a de liens matériels. <strong>Ce qui a pour effet de gonfler considérablement le volume des données</strong>.
</p>

<p>
Pour éviter cela, on indique à <strong>rsync</strong> qu&#039;il doit gérer les liens matériels avec l&#039;option <strong>-H</strong>. Ce qui donne  :
</p>
<pre class="file">rsync -rlptDvzH --delete-after /chemin/sauvegardes/backuppc/ /chemin/vers/support/externe/sauvegardes/backuppc</pre>

<p>
<strong>ATTENTION !!! : cette opération entraîne une forte consommation en CPU et en RAM !!!</strong>
</p>

</div>
<div class='secedit editbutton_section editbutton_25'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Faire une copie des sauvegardes sur un support externe avec RSYNC] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="faire_une_copie_des_sauvegardes_sur_un_support_externe_avec_rsync" /><input type="hidden" name="codeblockOffset" value="58" /><input type="hidden" name="range" value="33965-34921" /><button type="submit" title="Faire une copie des sauvegardes sur un support externe avec RSYNC" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit26 page-header" id="erreurs">Erreurs</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_26'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Erreurs] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="erreurs" /><input type="hidden" name="codeblockOffset" value="59" /><input type="hidden" name="range" value="34922-34942" /><button type="submit" title="Erreurs" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit27" id="no_files_dumped_for_share">No files dumped for share ...</h3>
<div class="level3">

<p>
Cliquez sur &quot;Last bad XferLOG&quot;. Si vous obtenez un message ressemblant à :
</p>
<pre class="file">/bin/tar: --totals: Cannot chdir: No such file or directory</pre>

<p>
Sauvez votre configuration backuppc, puis effectuez ces commandes avec la console :
</p>
<pre class="code">sudo mv /etc/backuppc/localhost.pl /etc/backuppc/fileserver.pl
sudo chown backuppc:www-data /etc/backuppc/fileserver.pl</pre>

<p>
Reparamétrez votre configuration dans &quot;xfer&quot;.
</p>

</div>
<div class='secedit editbutton_section editbutton_27'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[No files dumped for share ...] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="no_files_dumped_for_share" /><input type="hidden" name="codeblockOffset" value="59" /><input type="hidden" name="range" value="34943-35398" /><button type="submit" title="No files dumped for share ..." class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit28" id="erreur_nt_status">Erreur NT_STATUS...</h3>
<div class="level3">

<p>
Pour se connecter aux partages SMB, backuppc utilise smbclient et lui passe par défaut l&#039;argument -N qui siginifie &quot;no password&quot;<sup><a href="#fn__9" id="fnt__9" class="fn_top">9)</a></sup>.<br/>

Apparament dans une version antérieure de smbclient, même si -N était spécifié, le mot de passe était quand même demandé. Ainsi même si le partage avait un mot de passe, smbclient pouvait s&#039;y connecter.<br/>

Toutefois, ceci a été corrigé dans la nouvelle version de smbclient mais backuppc utilise toujours le -N. C&#039;est pourquoi, cette option empêche de prendre en compte votre mot de passe et provoquera une erreur.
</p>

<p>
Pour corriger ceci, sur <a href="#connexion_a_l_interface_web" title="backuppc ↵" class="wikilink1">l&#039;interface Web</a> de backuppc, depuis le menu <em>Edit Config du Server →onglet Xfer</em>,  supprimer le -N dans les 3 commandes pour la sauvegarde (smblient… -N …).  
</p>

</div>
<div class='secedit editbutton_section editbutton_28'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Erreur NT_STATUS...] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="erreur_nt_status" /><input type="hidden" name="codeblockOffset" value="61" /><input type="hidden" name="range" value="35399-36238" /><button type="submit" title="Erreur NT_STATUS..." class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit29 page-header" id="liens_utiles">Liens utiles</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li">  <a href="http://backuppc.sourceforge.net/faq/BackupPC.html" class="urlextern" title="http://backuppc.sourceforge.net/faq/BackupPC.html" rel="nofollow">la documentation de BackupPC</a>.</div>
</li>
<li class="level1"><div class="li"> <a href="http://backuppc.sourceforge.net/" class="urlextern" title="http://backuppc.sourceforge.net/" rel="nofollow"> Le site officiel</a> <strong>[en]</strong></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.klipz.fr/tutoriel_backuppc.html" class="urlextern" title="http://www.klipz.fr/tutoriel_backuppc.html" rel="nofollow">http://www.klipz.fr/tutoriel_backuppc.html</a> <strong>[fr]</strong></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.aboutmyip.com/AboutMyXApp/DeltaCopy.jsp" class="urlextern" title="http://www.aboutmyip.com/AboutMyXApp/DeltaCopy.jsp" rel="nofollow">deltacopy</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.generation-linux.fr/index.php?post/2008/08/09/119-backuppc-un-logiciel-de-sauvegarde-automatique" class="urlextern" title="http://www.generation-linux.fr/index.php?post/2008/08/09/119-backuppc-un-logiciel-de-sauvegarde-automatique" rel="nofollow">http://www.generation-linux.fr/index.php?post/2008/08/09/119-backuppc-un-logiciel-de-sauvegarde-automatique</a> <strong>[fr]</strong></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.projet-plume.org/fiche/backuppc" class="urlextern" title="http://www.projet-plume.org/fiche/backuppc" rel="nofollow">la fiche plume</a></div>
</li>
</ul>
<hr />

<p>
<em> Contributeurs : <a href="/utilisateurs/cyprien" class="wikilink2" title="utilisateurs:cyprien" rel="nofollow">Cyprien</a>,wouldsmina, <a href="/utilisateurs/naoli" class="wikilink1" title="utilisateurs:naoli">naoli</a>, snoopysnoopy <a href="/utilisateurs/ool" class="wikilink1" title="utilisateurs:ool">Ool</a>, gg <a href="/utilisateurs/gfontaniere" class="wikilink1" title="utilisateurs:gfontaniere">gfontaniere</a>, mathieuc  </em>
</p>

</div>
<div class='secedit editbutton_section editbutton_29'><form class="button btn_secedit form-inline" method="post" action="/backuppc"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1631434553" /><input type="hidden" name="summary" value="[Liens utiles] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="liens_utiles" /><input type="hidden" name="codeblockOffset" value="61" /><input type="hidden" name="range" value="36239-" /><button type="submit" title="Liens utiles" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div><hr/><div class="footnotes">
<div class="fn"><sup><a href="#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
<div class="content">&lt;serveur&gt; sera à remplacer par l&#039;adresse IP de la machine faisant office de serveur de sauvegarde</div></div>
<div class="fn"><sup><a href="#fnt__2" id="fn__2" class="fn_bot">2)</a></sup> 
, <sup><a href="#fnt__8" id="fn__8" class="fn_bot">8)</a></sup> 
<div class="content">utilisateur</div></div>
<div class="fn"><sup><a href="#fnt__3" id="fn__3" class="fn_bot">3)</a></sup> 
<div class="content"><a href="http://backuppc.sourceforge.net/faq/ssh.html" class="urlextern" title="http://backuppc.sourceforge.net/faq/ssh.html" rel="nofollow">la page ssh de la FAQ backuppc</a></div></div>
<div class="fn"><sup><a href="#fnt__4" id="fn__4" class="fn_bot">4)</a></sup> 
<div class="content">donc visible dans le fichier <strong>id_rsa.pub</strong> du <a href="/fichier_cache" class="wikilink1" title="fichier_cache">répertoire caché</a> <strong>.ssh</strong> dans le <em class="u">Dossier Personnel du <strong>serveur</strong> de backup</em></div></div>
<div class="fn"><sup><a href="#fnt__5" id="fn__5" class="fn_bot">5)</a></sup> 
, <sup><a href="#fnt__7" id="fn__7" class="fn_bot">7)</a></sup> 
<div class="content">hôtes connus</div></div>
<div class="fn"><sup><a href="#fnt__6" id="fn__6" class="fn_bot">6)</a></sup> 
<div class="content">donc visible dans le fichier <strong>id_rsa.pub</strong> du <a href="/fichier_cache" class="wikilink1" title="fichier_cache">répertoire caché</a> <strong>.ssh</strong> dans le <em class="u">Dossier Personnel du <strong>serveur</strong></em></div></div>
<div class="fn"><sup><a href="#fnt__9" id="fn__9" class="fn_bot">9)</a></sup> 
<div class="content">pas de mot de passe</div></div>
</div>

</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="backuppc.txt">backuppc.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 12/09/2021, 10:15">Le 12/09/2021, 10:15</span></li><li class="text-muted">par titigab</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=backuppc&amp;1635545755" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
