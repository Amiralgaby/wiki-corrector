<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>slapd [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="precise,serveur,reseau,brouillon"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/slapd?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/slapd?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/slapd"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/slapd"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/slapd"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"slapd","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="slapd">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/slapd?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/slapd?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/slapd?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/slapd?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/slapd?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/slapd?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/slapd?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">slapd</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/slapd?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/slapd?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/slapd?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#installation","title":"Installation","level":1},{"link":"#remplir_ldap","title":"Remplir LDAP","level":1},{"link":"#convertir_un_csv_en_ldif","title":"Convertir un csv en ldif","level":2},{"link":"#utiliser_votre_serveur_ldap","title":"Utiliser votre serveur LDAP","level":1},{"link":"#replication_des_donnees_ldap","title":"R\u00e9plication des donn\u00e9es LDAP","level":1},{"link":"#liens","title":"Liens","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#installation">Installation</a></li>
<li class="level1"><a href="#remplir_ldap">Remplir LDAP</a>
<ul class="nav toc">
<li class="level2"><a href="#convertir_un_csv_en_ldif">Convertir un csv en ldif</a></li>
</ul>
</li>
<li class="level1"><a href="#utiliser_votre_serveur_ldap">Utiliser votre serveur LDAP</a></li>
<li class="level1"><a href="#replication_des_donnees_ldap">Réplication des données LDAP</a></li>
<li class="level1"><a href="#liens">Liens</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="notetag">Selon les <a href="/tags">tags</a> présents sur cette page, celle-ci n'a pas été vérifiée pour une des <a href="/versions">versions LTS supportées d'Ubuntu</a>.<br />
Cette page est en cours de rédaction.<br />
<a href="/wiki/participer_wiki">Apportez votre aide…</a>
</div>
<div class="tags"><span>
	<a href="/precise" class="wikilink1" title="precise" rel="tag">Precise</a>,
	<a href="/serveur" class="wikilink1" title="serveur" rel="tag">serveur</a>,
	<a href="/reseau" class="wikilink1" title="reseau" rel="tag">réseau</a>,
	<a href="/brouillon" class="wikilink1" title="brouillon" rel="tag">BROUILLON</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="un_serveur_d_annuaire_avec_openldap">Un serveur d&#039;annuaire avec OpenLDAP</h1>
<div class="level1">

<p>
Ce document est la traduction du HowTo présenté à l&#039;adresse <a href="https://wiki.ubuntu.com/OpenLDAPServer" class="urlextern" title="https://wiki.ubuntu.com/OpenLDAPServer" rel="nofollow">https://wiki.ubuntu.com/OpenLDAPServer</a>. 
</p>

<p>
<abbr title="Lightweight Directory Access Protocol">LDAP</abbr> signifie Lightweight Directory Access Protocol, c&#039;est une version simplifiée du protocole X500. Vous pourrez trouver une présentation détaillée sur <a href="https://fr.wikipedia.org/wiki/LDAP" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/LDAP">Wikipédia</a>.
</p>

<p>
Pour expliquer rapidement, toutes les informations sont stockées dans un arbre. Vous devez déterminer l&#039;arborescence des annuaires ou, autrement dit, des informations de l&#039;arbre (Directory Information Tree). 
Nous allons commencer ici avec un exemple simple contenant seulement 2 nœuds en plus de la racine :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Le nœud &quot;People&quot; , où seront stockés vos utilisateurs,</div>
</li>
<li class="level1"><div class="li"> Le nœud &quot;Groups&quot; , où seront enregistrés vos groupes.</div>
</li>
</ul>

<p>
Vous devez commencer par déterminer ce que sera la racine de votre <abbr title="Lightweight Directory Access Protocol">LDAP</abbr>. Par défaut, votre arbre peut être déterminé à partir de votre domaine Internet. Si votre domaine est exemple.com , votre racine sera  dc=exemple,dc=com .
</p>
<div class="noteimportant">Dans le cas où le nom de domaine déclaré sur la machine n&#039;est pas celui que l&#039;on souhaite utiliser, il faut modifier le nom dans les fichiers &quot;/etc/hostname&quot; et &quot;/etc/hosts&quot; et redémarrer le serveur AVANT l&#039;installation des paquets.
Dans le cas contraire, il risque d&#039;y avoir une contradiction entre le nom choisi à l&#039;installation (ou demandé par dpkg-reconfigure) et celui récupéré automatiquement par l&#039;installation du paquet (dc=lenomdedomaine,dc=extension). je n&#039;ai pas réussi à modifier cela dans la base <abbr title="Lightweight Directory Access Protocol">LDAP</abbr>. solutionné par tout désinstaller, renommer puis réinstaller.
</div>
</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/slapd"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1615193810" /><input type="hidden" name="summary" value="[Un serveur d&#039;annuaire avec OpenLDAP] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="un_serveur_d_annuaire_avec_openldap" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="51-1678" /><button type="submit" title="Un serveur d&#039;annuaire avec OpenLDAP" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="installation">Installation</h2>
<div class="level2">

<p>
Avant tout, installons le daemon du serveur ldap (slapd) sur le serveur. Pour cela, il suffit d&#039;<a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installer les paquets</a> <strong> <a href="apt://slapd" class="interwiki iw_apt" title="apt://slapd">slapd</a></strong>.
</p>

<p>
On vous demandera votre mot de passe administrateur et votre nom de domaine. Renseignez-les. Parfois on ne vous demandera que le mot de passe et on ne vous demandera rien concernant le nom de domaine car l&#039;installeur récupère directement le nom de domaine de la machine. Si vous souhaitez renseigner ces champs faites :
</p>
<pre class="code">sudo dpkg-reconfigure slapd</pre>

<p>
Voici brièvement les réponses attendues pour une installation standard :
</p>
<pre class="code">1.Passer la configuration d&#039;OpenLDAP ? non
2.Nom de domaine ? example.com
3.Nom de votre société ? masociété 
4.Quelle base de donnée ? hdb 
5.Voulez-vous que la base de donnée soit effacée lorsque slapd est purgé ? oui 
6.Supprimer les anciennes bases de données ? oui
7.Mot de passe administrateur ? VotreMotDePasse
8.Confirmer ce mot de passe ? VotreMotDePasse
9.Authoriser le protocol LDAPv2 ? non</pre>

<p>
Mais seulement quelques changements seront effectués sur la configuration par défaut. Tout le reste va se jouer dans le fichier <strong>/etc/ldap/slapd.conf</strong>.
</p>

<p>
Nous allons commencer par enregistrer le mot de passe administrateur (de <abbr title="Lightweight Directory Access Protocol">LDAP</abbr>) dans le fichier de configuration en éditant ce fichier. Ce serait une folie de vouloir enregistrer votre mot de passe en clair donc nous allons générer votre mot de passe en chiffré avec la commande :
</p>
<pre class="code">sudo slappasswd</pre>

<p>
On obtient quelque chose dans ce genre :
</p>
<pre class="code">sudo slappasswd
New password:
Re-enter password:
{SSHA}d2BamRTgBuhC6SxC0vFGWol31ki8iq5m</pre>

<p>
Cet exemple montre la définition de votre mot de passe en utilisant le mot de passe &quot;secret&quot;. (D&#039;après l&#039;implémentation de SSHA, votre résultat peut varier) .
</p>

<p>
<a href="/tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">Éditez</a> le fichier <strong> 
/etc/ldap/ldap.conf</strong> avec les droits administrateurs.
</p>

<p>
S&#039;il n&#039;est pas déjà présent, <a href="/tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">créez</a> ce fichier avec les droits administrateurs.
On renseigne alors les informations suivantes :
</p>
<pre class="code">ldap_version 3
URI ldap://localhost:389
SIZELIMIT 0
TIMELIMIT 0
DEREF never
BASE dc=example, dc=com</pre>

<p>
Toutes les informations relatives à <strong>slapd.d</strong> (dossier remplaçant slapd.conf) sont maintenant inscrites au moment où on lance la commande <em>dpkg-reconfigure slapd</em>
</p>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/slapd"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1615193810" /><input type="hidden" name="summary" value="[Installation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1679-4115" /><button type="submit" title="Installation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit3 page-header" id="remplir_ldap">Remplir LDAP</h2>
<div class="level2">

<p>
L&#039; annuaire a été créé lors de l&#039;installation, il est maintenant temps de le remplir. Il sera rempli avec des entrées classiques qui seront compatibles avec la structure d&#039;un annuaire (pour un annuaire partagé), avec les comptes classiques (pour une authentification Web par exemple) et avec les comptes Unix (posix).
</p>

<p>
L&#039;annuaire <abbr title="Lightweight Directory Access Protocol">LDAP</abbr> peut être rempli par des fichiers ldif (ldif signifie ldap directory interchange format). Vous pouvez commencer en créant ce fichier d&#039;exemple (init.ldif) :
</p>
<pre class="file"># fichier de données : ~/init.ldif
dn: dc=example,dc=com
objectClass: dcObject
objectClass: organizationalUnit
dc: example
ou: Example Dot Com

dn: ou=people,dc=example,dc=com
objectClass: organizationalUnit
ou: people

dn: ou=groups,dc=example,dc=com
objectClass: organizationalUnit
ou: groups

dn: uid=lionel,ou=people,dc=example,dc=com
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
uid: lionel
sn: Porcheron
givenName: Lionel
cn: Lionel Porcheron
displayName: Lionel Porcheron
uidNumber: 1000
gidNumber: 10000
gecos: Lionel Porcheron
loginShell: /bin/bash
homeDirectory: /home/lionel
shadowExpire: -1
shadowFlag: 0
shadowWarning: 7
shadowMin: 8
shadowMax: 999999
shadowLastChange: 10877
mail: lionel.porcheron@example.com
postalCode: 31000
l: Toulouse
o: Example
mobile: +33 (0)6 xx xx xx xx
homePhone: +33 (0)5 xx xx xx xx
title: System Administrator
postalAddress: 
initials: LP

dn: cn=example,ou=groups,dc=example,dc=com
objectClass: posixGroup
cn: example
gidNumber: 10000
displayName: Example group</pre>

<p>
Dans l&#039;exemple ci-dessus, la structure de l&#039;annuaire, c&#039;est-à-dire un utilisateur et un groupe ont été créés. Dans d&#039;autres exemples vous auriez pu voir le paramètre &quot;objectClass: top&quot; ajouté dans plusieurs entrées, mais c&#039;est le comportement par défaut donc pas besoin de le mettre :)
</p>

<p>
Maintenant ajoutez vos entrées à <abbr title="Lightweight Directory Access Protocol">LDAP</abbr> :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Arrêtez le daemon : </div>
</li>
</ul>
<pre class="code">sudo /etc/init.d/slapd stop</pre>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Supprimer ce qui a été ajouté automatiquement à l&#039;installation :</div>
</li>
</ul>
<pre class="code">sudo rm -rf /var/lib/ldap/*</pre>

<p>
Ajouter les données :
</p>
<pre class="code">sudo slapadd -l ~/init.ldif</pre>
<div class="notetip">Si vous rencontrez le message type : 
<pre class="code">Entry (cn=example,ou=groups,dc=example,dc=com), attribute &#039;displayName&#039; not allowed
slapadd: dn=&quot;cn=example,ou=groups,dc=example,dc=com&quot; (line=46): (65) attribute &#039;displayName&#039; not allowed</pre>

<p>
Il faut commenter la ligne 46 comme ceci : 
</p>
<pre class="code">#displayName: Example group</pre>

<p>
Puis refaire :
</p>
<pre class="code">sudo rm -rf /var/lib/ldap/*</pre>

</div>
<p>
Donner les droits de lecture aux fichiers de la base de données
</p>
<pre class="code">sudo chown -R openldap:openldap /var/lib/ldap</pre>

<p>
N&#039;oublions pas de relancer ldap :
</p>
<pre class="code">sudo /etc/init.d/slapd start</pre>

<p>
Nous allons pouvoir vérifier que les données ont été correctement ajoutées avec les outils du paquet <code>ldap-utils</code>. Pour effectuer une recherche dans les annuaires <abbr title="Lightweight Directory Access Protocol">LDAP</abbr> il vous suffit de faire :
</p>
<pre class="code">ldapsearch -xLLL -b &quot;dc=example,dc=com&quot; uid=lionel sn givenName cn
dn: uid=lionel,ou=people,dc=example,dc=com
cn: Lionel Porcheron
sn: Porcheron
givenName: Lionel</pre>

<p>
Une rapide explication :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> -x désactive l&#039;authentification SASL</div>
</li>
<li class="level1"><div class="li"> -LLL empêche l&#039;affichage des informations LDIF </div>
</li>
<li class="level1"><div class="li"> -b indique la branche utilisée</div>
</li>
</ul>

<p>
NE PAS OUBLIER d&#039;ajouter le user qui doit administrer le service ldap au group openldap à créer lors de l&#039;installation du paquet ou bien de donner les bons droits sur les fichiers /etc/ldap/ldap.conf et /var/lib/ldap/*
</p>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/slapd"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1615193810" /><input type="hidden" name="summary" value="[Remplir LDAP] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="remplir_ldap" /><input type="hidden" name="codeblockOffset" value="5" /><input type="hidden" name="range" value="4116-7664" /><button type="submit" title="Remplir LDAP" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit4" id="convertir_un_csv_en_ldif">Convertir un csv en ldif</h3>
<div class="level3">

<p>
Ci dessous un script bash convertissant un csv en ldif. Il faut évidemment le personnaliser selon vos besoins.
Il lui manque de: supprimer les doublons, les valeurs nulles, les têtes de colonne ainsi que les espaces et caractères spéciaux dans l&#039;uid.
</p>
<pre class="code">#!/bin/bash

# Le script et le fichier source doivent être dans le home.
# Le script ne supprime ni les doublons, ni les valeurs nulles, ni les têtes de colonne.
# Il faudrait aussi supprimer les espaces et les caractères spéciaux dans les uid=$nom$prenom

source=source.csv                      # Le fichier source
cible=cible.ldif                       # Le fichier cible

&gt; $cible                               # Nettoyage du fichier cible.

while read line                        # On lit le fichier, et pour chaque ligne...
do 
nom=$(echo $line | cut -d &quot;;&quot; -f2)     # On entre dans la variable $nom la deuxième colonne (-f2).
prenom=$(echo $line | cut -d &quot;;&quot; -f3)  # Remarquez le séparateur qui est le &quot;;&quot;. On pourrait changer.
rue=$(echo $line | cut -d &quot;;&quot; -f4)
cp=$(echo $line | cut -d &quot;;&quot; -f5)
ville=$(echo $line | cut -d &quot;;&quot; -f6)
tel=$(echo $line | cut -d &quot;;&quot; -f7)
mobile=$(echo $line | cut -d &quot;;&quot; -f8)
courriel=$(echo $line | cut -d &quot;;&quot; -f9)
                                       # A partir de la ligne suivante exportation par un echo.
                                       # C&#039;est ici que vous pouvez modifier le contenu du ldif.
                                       # Il faudrait y ajouter une condition pour ne pas afficher les champs vides.
echo &quot;dn: uid=$nom$prenom,ou=fideles,dc=example,dc=com
objectClass: inetOrgPerson
objectClass: organizationalPerson
objectClass: posixAccount
objectClass: shadowAccount
objectClass: person
objectClass: top
cn: $nom $prenom
gidNumber: 100
givenName: $prenom
homeDirectory: hd
homePhone: $tel
mobile: $mobile
mail: $courriel
street: $rue
postalCode: $cp $ville
sn: $nom
uid: $nom$prenom
uidNumber: 100

&quot; &gt;&gt; $cible                        # Écriture dans le fichier cible.
done &lt; $source                     # Lecture de la source.
</pre>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/slapd"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1615193810" /><input type="hidden" name="summary" value="[Convertir un csv en ldif] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="convertir_un_csv_en_ldif" /><input type="hidden" name="codeblockOffset" value="15" /><input type="hidden" name="range" value="7665-9769" /><button type="submit" title="Convertir un csv en ldif" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit5 page-header" id="utiliser_votre_serveur_ldap">Utiliser votre serveur LDAP</h2>
<div class="level2">

<p>
Maintenant que votre serveur est prêt et démarré vous pouvez :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Authentifier vos utilisateurs dans l&#039;annuaire comme expliqué dans la documentation <a href="https://help.ubuntu.com/community/LDAPClientAuthentication" class="urlextern" title="https://help.ubuntu.com/community/LDAPClientAuthentication" rel="nofollow">LDAPClientAuthentication</a></div>
</li>
<li class="level1"><div class="li"> Authentifier vos utilisateurs via une applications web</div>
</li>
<li class="level1"><div class="li"> Utiliser l&#039;annuaire comme une base de données pour votre client mail</div>
</li>
<li class="level1"><div class="li"> Et bien plus encore !!!</div>
</li>
</ul>

<p>
De manière plus concrète, il existe des solutions simples à installer et qui vous permettent un excellent accès à votre annuaire, que ce soit en visualisation comme en création/édition.
</p>

</div>

<h4 id="phpldapadmin">phpLDAPadmin</h4>
<div class="level4">

</div>

<h5 id="pre-requis">Pré-requis</h5>
<div class="level5">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Avoir un serveur WEB installé, voir <a href="/lamp" class="wikilink1" title="lamp">LAMP</a>.</div>
</li>
<li class="level1"><div class="li"> La version 12.04 LTS d&#039;Ubuntu. (La 13.10 étant incompatible avec phpLDAPadmin : <a href="https://bugs.launchpad.net/ubuntu/+source/phpldapadmin/+bug/1246170" class="urlextern" title="https://bugs.launchpad.net/ubuntu/+source/phpldapadmin/+bug/1246170" rel="nofollow">https://bugs.launchpad.net/ubuntu/+source/phpldapadmin/+bug/1246170</a>)</div>
</li>
</ul>

</div>

<h5 id="installation1">Installation</h5>
<div class="level5">

<p>
Vous devez <a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installer les paquets</a> <strong><a href="apt://phpldapadmin" class="urlextern" title="apt://phpldapadmin" rel="nofollow">apt://phpldapadmin</a></strong>.
</p>

<p>
Et on y accède via <a href="http://votre_domaine.com/phpldapadmin/" class="urlextern" title="http://votre_domaine.com/phpldapadmin/" rel="nofollow">http://votre_domaine.com/phpldapadmin/</a>
</p>

<p>
Attention, le login est : &quot;cn=admin,dc=example,dc=com&quot;.
</p>

</div>

<h5 id="problemememory_limit_low">Problème : Memory Limit low</h5>
<div class="level5">

<p>
Si lorsque vous allez sur l&#039;interface web de phpldapadmin, vous avez cette erreur : 
</p>

<p>
Memory Limit low.
Your php memory limit is low - currently 16M
</p>

<p>
Éditer en admin le fichiers php.ini :
</p>
<pre class="code"> cd /etc/php5/apache2/
 sudo nano php.ini</pre>

<p>
trouvez la section suivante et changez la valeur memory_limit = 16M en mettant 50M :
</p>
<pre class="code"> ;;;;;;;;;;;;;;;;;;;
 ; Resource Limits ;
 ;;;;;;;;;;;;;;;;;;;

 max_execution_time = 30     ; Maximum execution time of each script, in seconds
 max_input_time = 60 ; Maximum amount of time each script may spend parsing   request data
 ;max_input_nesting_level = 64 ; Maximum input variable nesting level
 memory_limit = 50M      ; Maximum amount of memory a script may consume (16MB)</pre>

<p>
Il suffit ensuite de recharger la configuration de apache pour que la modification soit prise en compte :
</p>
<pre class="code">sudo /etc/init.d/apache2 reload</pre>

<p>
puis relancer votre serveur ldap :
</p>
<pre class="code">sudo /etc/init.d/slapd restart</pre>

<p>
<a href="http://www.developpez.net/forums/d489029/hardware-systemes-logiciels/linux/reseau/phpldapadmin-memory-limit-low/" class="urlextern" title="http://www.developpez.net/forums/d489029/hardware-systemes-logiciels/linux/reseau/phpldapadmin-memory-limit-low/" rel="nofollow">source forum Developpez.com</a>
</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/slapd"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1615193810" /><input type="hidden" name="summary" value="[Utiliser votre serveur LDAP] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="utiliser_votre_serveur_ldap" /><input type="hidden" name="codeblockOffset" value="16" /><input type="hidden" name="range" value="9770-12042" /><button type="submit" title="Utiliser votre serveur LDAP" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit6 page-header" id="replication_des_donnees_ldap">Réplication des données LDAP</h2>
<div class="level2">

<p>
Le service <abbr title="Lightweight Directory Access Protocol">LDAP</abbr> peut vite devenir un service hautement critique dans votre système d&#039;information : tout dépend (ou peut dépendre) de <abbr title="Lightweight Directory Access Protocol">LDAP</abbr> :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Authentification</div>
</li>
<li class="level1"><div class="li"> Autorisation</div>
</li>
<li class="level1"><div class="li"> Mail</div>
</li>
<li class="level1"><div class="li"> …</div>
</li>
</ul>

<p>
Ce serait donc une bonne idée de créer un système redondant. Le mini HOWTO ci-dessous vous permettra de le faire.
</p>

</div>

<h4 id="introduction">Introduction</h4>
<div class="level4">

<p>
Avec OpenLDAP 2.2 (sur Breezy et Dapper), la réplication est basée sur une communication maître-esclave.
</p>

<p>
<em class="u"><strong>ATTENTION </strong></em>
</p>

<p>
Vous devez vous rappeler que les modifications devraient toujours être faites sur le maître ! Si vous modifiez un esclave, les modifications seront perdues dès la synchronisation suivante :/
</p>

</div>

<h4 id="le_maitre">Le maître</h4>
<div class="level4">

<p>
Sur le maître, vous devez modifier la section &quot;base de donnée&quot; du fichier de configuration <code>/etc/ldap/slapd.conf</code> pour ajouter une instruction de réplication.
L&#039;exemple suivant montre une réplication sur le serveur <code>ldap-2.example.com</code> avec le Manager <em>user</em> et le mot de passe <em>secret</em>.
Le fichier de log est l&#039;emplacement où les données seront stockées avant d’être envoyées sur le(s) serveur(s) esclave(s).
</p>
<div class="noteimportant">Note d&#039;un internaute : Comment faire pour les versions ou le fichier slapd.conf n&#039;existe plus, comme c&#039;est dit plus haut??
</div><pre class="code">replica uri=ldap://ldap-2.example.com:389 binddn=&quot;cn=Manager,dc=example,dc=com&quot; bindmethod=simple 
credentials=secret

replogfile      /var/lib/ldap/replog</pre>

<p>
Il ne reste plus qu&#039;a redémarrer votre serveur <abbr title="Lightweight Directory Access Protocol">LDAP</abbr> :)
</p>

</div>

<h4 id="le_s_esclave_s">Le(s) Esclave(s)</h4>
<div class="level4">

<p>
Sur le(s) serveur(s) esclave(s) , il vous suffit d&#039;autoriser votre serveur maître à mettre à jour la base de donnée <abbr title="Lightweight Directory Access Protocol">LDAP</abbr>. Pour cela ajoutez les lignes suivantes dans votre <code>/etc/ldap/slapd.conf</code> à la section base de données :
</p>
<pre class="code">updatedn        cn=Manager,dc=example,dc=com
updateref       ldap://ldap-1.example.com</pre>

<p>
Redémarrez votre serveur <abbr title="Lightweight Directory Access Protocol">LDAP</abbr> (l&#039;esclave).
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/slapd"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1615193810" /><input type="hidden" name="summary" value="[Réplication des données LDAP] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="replication_des_donnees_ldap" /><input type="hidden" name="codeblockOffset" value="20" /><input type="hidden" name="range" value="12043-13988" /><button type="submit" title="Réplication des données LDAP" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit7 page-header" id="liens">Liens</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <a href="https://wiki.ubuntu.com/OpenLDAPServer" class="urlextern" title="https://wiki.ubuntu.com/OpenLDAPServer" rel="nofollow">La version Anglaise</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://help.ubuntu.com/8.10/serverguide/C/openldap-server.html" class="urlextern" title="https://help.ubuntu.com/8.10/serverguide/C/openldap-server.html" rel="nofollow">La version Anglaise mis a jour pour 8.10</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.openldap.org/" class="urlextern" title="http://www.openldap.org/" rel="nofollow">OpenLDAP.org</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.tldp.org/HOWTO/html_single/LDAP-HOWTO/" class="urlextern" title="http://www.tldp.org/HOWTO/html_single/LDAP-HOWTO/" rel="nofollow">LDAP HOWTO</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://luma.sourceforge.net/" class="urlextern" title="http://luma.sourceforge.net/" rel="nofollow">Un GUI pour LDAP</a> (Disponible dans les dépots)</div>
</li>
<li class="level1"><div class="li"> <a href="http://ralf.schaeftlein.de/2009/02/04/howto-setup-a-openldap-server-for-ubuntu-810/" class="urlextern" title="http://ralf.schaeftlein.de/2009/02/04/howto-setup-a-openldap-server-for-ubuntu-810/" rel="nofollow">OpenLDAP Ubuntu 8.10 HOWTO</a></div>
</li>
</ul>
<hr />

<p>
Contributeurs : <a href="/utilisateurs/sp4rky" class="wikilink1" title="utilisateurs:sp4rky">Sp4rKy</a> puis remis (un peu) en page et déplacé par <a href="/utilisateurs/bastnic" class="wikilink1" title="utilisateurs:bastnic">bastnic</a>, <a href="/utilisateurs/kenny432" class="wikilink1" title="utilisateurs:kenny432">Kenny432</a>.
</p>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/slapd"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1615193810" /><input type="hidden" name="summary" value="[Liens] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="liens" /><input type="hidden" name="codeblockOffset" value="22" /><input type="hidden" name="range" value="13989-" /><button type="submit" title="Liens" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="slapd.txt">slapd.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 08/03/2021, 09:56">Le 08/03/2021, 09:56</span></li><li class="text-muted">par 109.190.93.124</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=slapd&amp;1635563738" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
