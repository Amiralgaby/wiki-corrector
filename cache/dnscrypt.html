<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>dnscrypt [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="xenial,reseau,internet,securite"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/dnscrypt?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/dnscrypt?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/dnscrypt"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/dnscrypt"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/dnscrypt"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"dnscrypt","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="dnscrypt">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/dnscrypt?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/dnscrypt?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/dnscrypt?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/dnscrypt?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/dnscrypt?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/dnscrypt?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/dnscrypt?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">dnscrypt</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/dnscrypt?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/dnscrypt?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/dnscrypt?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#pre-requis","title":"Pr\u00e9-requis","level":1},{"link":"#installation","title":"Installation","level":1},{"link":"#configuration","title":"Configuration","level":1},{"link":"#selectionner_le_resolveur","title":"S\u00e9lectionner le r\u00e9solveur","level":2},{"link":"#modifier_le_resolveur_du_systeme","title":"Modifier le r\u00e9solveur du syst\u00e8me","level":2},{"link":"#demarrer_le_service_systemd","title":"D\u00e9marrer le service systemd","level":2},{"link":"#verification","title":"V\u00e9rification","level":1},{"link":"#utilisation_avec_un_dns_local","title":"Utilisation avec un DNS local","level":1},{"link":"#local_dns_cache_configuration","title":"Local DNS cache configuration","level":2},{"link":"#changer_le_port","title":"Changer le port","level":2},{"link":"#exemple_de_configurations_local_dns_cache","title":"Exemple de configurations local DNS cache","level":1},{"link":"#unbound","title":"Unbound","level":2},{"link":"#dnsmasq","title":"dnsmasq","level":2},{"link":"#activer_edns0","title":"Activer EDNS0","level":2},{"link":"#problemes","title":"Probl\u00e8mes","level":1},{"link":"#dnscrypt_fonctionne_avec_les_privileges_root","title":"Dnscrypt fonctionne avec les privil\u00e8ges root","level":2},{"link":"#divers_processus_ecrasent_resolvconf","title":"Divers processus \u00e9crasent resolv.conf","level":2},{"link":"#desinstallation","title":"D\u00e9sinstallation","level":1},{"link":"#voir_aussi","title":"Voir aussi","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#pre-requis">Pré-requis</a></li>
<li class="level1"><a href="#installation">Installation</a></li>
<li class="level1"><a href="#configuration">Configuration</a>
<ul class="nav toc">
<li class="level2"><a href="#selectionner_le_resolveur">Sélectionner le résolveur</a></li>
<li class="level2"><a href="#modifier_le_resolveur_du_systeme">Modifier le résolveur du système</a></li>
<li class="level2"><a href="#demarrer_le_service_systemd">Démarrer le service systemd</a></li>
</ul>
</li>
<li class="level1"><a href="#verification">Vérification</a></li>
<li class="level1"><a href="#utilisation_avec_un_dns_local">Utilisation avec un DNS local</a>
<ul class="nav toc">
<li class="level2"><a href="#local_dns_cache_configuration">Local DNS cache configuration</a></li>
<li class="level2"><a href="#changer_le_port">Changer le port</a></li>
</ul>
</li>
<li class="level1"><a href="#exemple_de_configurations_local_dns_cache">Exemple de configurations local DNS cache</a>
<ul class="nav toc">
<li class="level2"><a href="#unbound">Unbound</a></li>
<li class="level2"><a href="#dnsmasq">dnsmasq</a></li>
<li class="level2"><a href="#activer_edns0">Activer EDNS0</a></li>
</ul>
</li>
<li class="level1"><a href="#problemes">Problèmes</a>
<ul class="nav toc">
<li class="level2"><a href="#dnscrypt_fonctionne_avec_les_privileges_root">Dnscrypt fonctionne avec les privilèges root</a></li>
<li class="level2"><a href="#divers_processus_ecrasent_resolvconf">Divers processus écrasent resolv.conf</a></li>
</ul>
</li>
<li class="level1"><a href="#desinstallation">Désinstallation</a></li>
<li class="level1"><a href="#voir_aussi">Voir aussi</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/xenial" class="wikilink1" title="xenial" rel="tag">Xenial</a>,
	<a href="/reseau" class="wikilink1" title="reseau" rel="tag">réseau</a>,
	<a href="/internet" class="wikilink1" title="internet" rel="tag">internet</a>,
	<a href="/securite" class="wikilink1" title="securite" rel="tag">sécurité</a>
</span></div>
<hr />

<p>
<img src="/_media/dnscrypt.png?w=200&amp;tok=6e8edd" class="mediaright img-responsive" alt="" width="200" />
</p>

<h1 class="sectionedit1 page-header" id="dnscrypt">DNSCrypt</h1>
<div class="level1">

<p>
 DNSCrypt est un protocole qui authentifie les communications entre un client <abbr title="Domain Name System">DNS</abbr> et un résolveur <a href="https://fr.wikipedia.org/wiki/DNS" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/DNS">DNS</a>. Cela empêche la falsification de <abbr title="Domain Name System">DNS</abbr>. Il utilise des signatures cryptographiques pour vérifier que les réponses proviennent du résolveur <abbr title="Domain Name System">DNS</abbr> choisi et n&#039;ont pas été falsifiées.
</p>

<p>
C&#039;est une spécification ouverte, avec des implémentations de référence gratuites et opensource, et elle n&#039;est affiliée à aucune entreprise ni organisation.
</p>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[DNSCrypt] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="dnscrypt" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="80-564" /><button type="submit" title="DNSCrypt" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="pre-requis">Pré-requis</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Disposer des <a href="/sudo" class="wikilink1" title="sudo">droits d&#039;administration</a>.</div>
</li>
<li class="level1"><div class="li"> Disposer d&#039;une connexion à Internet configurée et activée.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Pré-requis] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="pre-requis" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="565-712" /><button type="submit" title="Pré-requis" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit3 page-header" id="installation">Installation</h2>
<div class="level2">

<p>
<a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">Installez le paquet</a> <a href="apt://dnscrypt-proxy" class="interwiki iw_apt" title="apt://dnscrypt-proxy">dnscrypt-proxy</a>
</p>
<div class="noteclassic">Optionnellement <a href="apt://dnscrypt-proxy-plugins" class="interwiki iw_apt" title="apt://dnscrypt-proxy-plugins">dnscrypt-proxy-plugins</a>, donne beaucoup de contrôle sur le trafic <abbr title="Domain Name System">DNS</abbr> local:<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Passer en revue le trafic <abbr title="Domain Name System">DNS</abbr> provenant de votre réseau en temps réel et détecter les hôtes et applications compromises.</div>
</li>
<li class="level1"><div class="li"> Bloque localement les publicités, les trackers, les logiciels malveillants, les spams et tout site Web dont les noms de domaine ou les adresses IP correspondent à un ensemble de règles que vous définissez.</div>
</li>
<li class="level1"><div class="li"> Empêcher que les requêtes concernant les zones locales soient divulguées.</div>
</li>
<li class="level1"><div class="li"> Réduire la latence en cas de mise en cache des réponses et éviter de demander des adresses IPv6 sur les réseaux IPv4 uniquement.</div>
</li>
<li class="level1"><div class="li"> Forcer le trafic à utiliser <abbr title="Transmission Control Protocol">TCP</abbr>, pour l&#039;acheminer via des tunnels <abbr title="Transmission Control Protocol">TCP</abbr> uniquement ou Tor. <img src="/lib/images/smileys/icon_cool.gif" class="icon" alt="8-)" /></div>
</li>
</ul>

</div>
</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Installation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="713-1601" /><button type="submit" title="Installation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit4 page-header" id="configuration">Configuration</h2>
<div class="level2">

<p>
Pour configurer dnscrypt-proxy, procédez comme suit:
</p>
<div class="noteimportant">Un fichier de conf bien plus complet est <a href="https://raw.githubusercontent.com/jedisct1/dnscrypt-proxy/master/dnscrypt-proxy.conf" class="urlextern" title="https://raw.githubusercontent.com/jedisct1/dnscrypt-proxy/master/dnscrypt-proxy.conf" rel="nofollow">disponible sur github</a><br/>

<img src="/lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" /> Cependant prenez bien garde de bien corriger les différents chemin d&#039;accès. En effet, ceux-ci non prévus pour Debian/Ubuntu (et dérivés) sont sous la forme <strong>/etc/dnscrypt-proxy.conf</strong> alors que ce devrait être <strong>/etc/dnscrypt-proxy/dnscrypt-proxy.conf</strong> ou encore <strong>/usr/local/share/dnscrypt-proxy/dnscrypt-resolvers.csv</strong> a la place de <strong>/usr/share/dnscrypt-proxy/dnscrypt-resolvers.csv</strong><br/>

<img src="/lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" /> Notez que sytemd outrepasse l&#039;option <code><strong>LocalAddress</strong></code>  par un fichier socket et doit donc être commentée dans le fichier de conf
</div>
</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Configuration] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1602-2405" /><button type="submit" title="Configuration" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit5" id="selectionner_le_resolveur">Sélectionner le résolveur</h3>
<div class="level3">

<p>
Sélectionnez un résolveur à partir de <code>/usr/share/dnscrypt-proxy/dnscrypt-resolvers.csv</code> et <a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">modifiez</a> <strong>dnscrypt-proxy.conf</strong> avec les <a href="/sudo" class="wikilink1" title="sudo">droits d&#039;administration</a>, en utilisant un nom abrégé de la première colonne du fichier csv. Par exemple, pour sélectionner <code>dnscrypt.eu-nl</code> comme résolveur:
</p>
<dl class="file">
<dt><a href="/_export/code/dnscrypt?codeblock=0" title="Télécharger cet extrait" class="mediafile mf_conf">/etc/dnscrypt-proxy/dnscrypt-proxy.conf</a></dt>
<dd><pre class="file">ResolverName dnscrypt.eu-nl
ResolversList /usr/share/dnscrypt-proxy/dnscrypt-resolvers.csv
# BlackList domains:&quot;/etc/dnscrypt-proxy/dnscrypt-blacklist-domains.txt&quot;
EDNSPayloadSize 1252
Daemonize no
# LocalCache on</pre>
</dd></dl>
<div class="notetip"><ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Alternativement, &quot;random&quot; (sans guillemets) choisit un résolveur aléatoire, accessible sur IPv4, qui ne &quot;log&quot; pas et prend en charge DNSSEC.  Pour cela veillez a bien renseigner <code>ResolversList</code> avec <code>/usr/share/dnscrypt-proxy/dnscrypt-resolvers.csv</code> dans <strong>/etc/dnscrypt-proxy/dnscrypt-proxy.conf</strong></div>
</li>
<li class="level1"><div class="li"> Une liste potentiellement plus à jour est disponible directement sur <a href="https://github.com/jedisct1/dnscrypt-proxy/blob/master/dnscrypt-resolvers.csv" class="urlextern" title="https://github.com/jedisct1/dnscrypt-proxy/blob/master/dnscrypt-resolvers.csv" rel="nofollow">la page Github du projet</a></div>
</li>
<li class="level1"><div class="li"> <del>À ce stade, vous pouvez également ajouter un utilisateur non privilégié pour exécuter dnscrypt</del>. Voir <a href="#dnscrypt_fonctionne_avec_les_privileges_root" title="dnscrypt ↵" class="wikilink1">Dépannage</a></div>
</li>
</ul>

</div>
</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Sélectionner le résolveur] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="selectionner_le_resolveur" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="2406-3763" /><button type="submit" title="Sélectionner le résolveur" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit6" id="modifier_le_resolveur_du_systeme">Modifier le résolveur du système</h3>
<div class="level3">

<p>
Vous devez maintenant indiquer au système sur quelle adresse contacter le résolveur de noms de domaine.<br/>
Pour cela faites un clic droit sur votre applet Network-Manager et cliquez sur éditer la connection. Choisissez votre type de connection, filaire ou sans fil, puis dans l&#039;onglet IPv4 via le menu déroulant selectionnez <em><abbr title="Dynamic Host Configuration Protocol">DHCP</abbr></em> <em class="u">adresse only</em>.<br/>

 Enfin dans le champ pour indiquer les serveur <abbr title="Domain Name System">DNS</abbr> entrez <code><strong>127.0.2.1</strong></code> puis cliquez sur appliquer.<br/>

Le fichier <strong>/etc/resolv.conf</strong> doit maintenant afficher:
</p>
<pre class="file">nameserver 127.0.2.1</pre>

<p>
Pour les utilisateurs du bureau gnome le menu  déroulant ne contient pas <em><abbr title="Dynamic Host Configuration Protocol">DHCP</abbr></em> <em class="u">adresse only</em> selectionnez donc <abbr title="Dynamic Host Configuration Protocol">DHCP</abbr> (automatique) et prenez soin de mettre <abbr title="Domain Name System">DNS</abbr> sur Off avant d&#039;entrer <code><strong>127.0.2.1</strong></code> et d&#039;appliquer<br/>

</p>

<p>
<strong><img src="/lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" /> Attention</strong>, d&#039;autres programmes peuvent remplacer ce paramètre! <a href="#divers_processus_ecrasent_resolvconf" title="dnscrypt ↵" class="wikilink1">Voir 7.2</a><br/>

</p>

</div>

<h4 id="ajout_de_filtres">Ajout de filtres</h4>
<div class="level4">

<p>
Afin de profiter pleinement de Dnscrypt et dépolluer votre navigation sur le web, je vous propose d&#039;utiliser la liste polyvalente <a href="https://download.dnscrypt.info/blacklists/domains/mybase.txt" class="urlextern" title="https://download.dnscrypt.info/blacklists/domains/mybase.txt" rel="nofollow">MyBase</a> qui est mise à jour quotidiennement à partir de sources publiques, afin de bloquer les logiciels malveillants, les publicités et les traceurs courants. <img src="/lib/images/smileys/icon_cool.gif" class="icon" alt="8-)" /><br/>

Pour cela il vous faut décommenter le paramètre <code><strong>BlackList domains:/etc/dnscrypt-proxy/dnscrypt-blacklist-domains.txt</strong></code> (enlever le # en début de ligne)<br/>

Ensuite télèchargez puis déplacez la liste au bon endroit avec la commande suivante:
</p>
<pre class="code">wget https://download.dnscrypt.info/blacklists/domains/mybase.txt &amp;&amp; sudo mv mybase.txt /etc/dnscrypt-proxy/dnscrypt-blacklist-domains.txt</pre>

<p>
Exécutez a nouveau la commande pour mettre a jour la liste !
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Modifier le résolveur du système] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="modifier_le_resolveur_du_systeme" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="3764-5571" /><button type="submit" title="Modifier le résolveur du système" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit7" id="demarrer_le_service_systemd">Démarrer le service systemd</h3>
<div class="level3">

<p>
 Enfin, démarrez puis activez le service <code>dnscrypt-proxy.service</code> au démarrage de votre machine via <a href="/systemd" class="wikilink1" title="systemd">systemd</a>:
</p>
<pre class="code">sudo systemctl start dnscrypt-proxy.service</pre>
<pre class="code">sudo systemctl enable dnscrypt-proxy.service</pre>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Démarrer le service systemd] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="demarrer_le_service_systemd" /><input type="hidden" name="codeblockOffset" value="3" /><input type="hidden" name="range" value="5572-5844" /><button type="submit" title="Démarrer le service systemd" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit8 page-header" id="verification">Vérification</h2>
<div class="level2">

<p>
Pour effectuer une vérification de l&#039;installation, exécutez
</p>
<pre class="code">sudo lsof -i -n</pre>

<p>
Et assurez-vous que le processus est en train d&#039;écouter l&#039;adresse et le port souhaités.
Si c&#039;est bon, et que le proxy s&#039;exécute, envoyez votre première requête au proxy pour vérifier que la chaîne entière fonctionne comme prévu. <code>dnscrypt-proxy</code> inclut la commande <code>hostip</code>. Un petit utilitaire qui peut être utilisé pour envoyer des requêtes <abbr title="Domain Name System">DNS</abbr> à des résolveurs arbitraires.
</p>
<pre class="code">hostip -r 127.0.2.1 example.com</pre>

<p>
Cela devrait renvoyer les adresses IP de l&#039;hôte example.com.
Félicitations, vous avez envoyé votre première requête cryptée et authentifiée en utilisant le protocole DNSCrypt!
Pour confirmer que la réponse provient du résolveur que vous avez choisi et non de votre <abbr title="Fournisseur d&#039;Accès à Internet">FAI</abbr>:
</p>
<pre class="code">hostip -r 127.0.2.1 resolver.dnscrypt.info</pre>

<p>
Cette requête spéciale (<code>resolver.dnscrypt.info</code>) renvoie l&#039;adresse IP du résolveur que vous utiliserez probablement (et cela fonctionne avec ou sans DNSCrypt). Il devrait correspondre à l&#039;adresse IP du résolveur que vous avez choisi.
</p>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Vérification] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="verification" /><input type="hidden" name="codeblockOffset" value="5" /><input type="hidden" name="range" value="5845-6979" /><button type="submit" title="Vérification" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit9 page-header" id="utilisation_avec_un_dns_local">Utilisation avec un DNS local</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Utilisation avec un DNS local] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="utilisation_avec_un_dns_local" /><input type="hidden" name="codeblockOffset" value="8" /><input type="hidden" name="range" value="6980-7021" /><button type="submit" title="Utilisation avec un DNS local" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit10" id="local_dns_cache_configuration">Local DNS cache configuration</h3>
<div class="level3">
<div class="noteclassic">Dnscrypt peut mettre en cache les entrées sans compter sur un autre programme. Assurez-vous que <strong><code>LocalCache on</code></strong> est décommenté dans votre fichier de configuration dnscrypt pour activer cette fonctionnalité.
</div>
<p>
Si vous n&#039;utilisez pas la fonctionnalité de cache de dnscrypt il est recommandé d&#039;éxécuter DNSCrypt en tant que redirecteur pour un cache <abbr title="Domain Name System">DNS</abbr> local ; sinon, chaque requête fera un aller-retour vers le résolveur en amont. Tout programme de mise en cache <abbr title="Domain Name System">DNS</abbr> local devrait fonctionner. En plus de configurer dnscrypt-proxy, vous devez configurer votre programme de cache <abbr title="Domain Name System">DNS</abbr> local.
</p>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Local DNS cache configuration] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="local_dns_cache_configuration" /><input type="hidden" name="codeblockOffset" value="8" /><input type="hidden" name="range" value="7022-7678" /><button type="submit" title="Local DNS cache configuration" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit11" id="changer_le_port">Changer le port</h3>
<div class="level3">
<div class="noteimportant">Partie a vérifier - ne fonctionne pas apres test en VM sur ubuntu-Gnome 17.04
</div><div class="noteclassic">La modification de l&#039;adresse IP ou du port dans <code>/etc/dnscrypt-proxy/dnscrypt-proxy.conf</code> ne fonctionne pas avec systemd et doit être modifiée dans le socket systemd fourni de la manière suivante.
</div>
<p>
Afin de transférer vers un cache <abbr title="Domain Name System">DNS</abbr> local, dnscrypt-proxy doit écouter sur un port différent du port 53 pardéfaut, car le cache <abbr title="Domain Name System">DNS</abbr> lui-même doit écouter sur le port 53 et interroger dnscrypt-proxy sur un autre port. Le numéro de port <code>5353</code> est utilisé à titre d&#039;exemple dans cette section. Dans cet exemple, le numéro de port est supérieur à 1024, de sorte que <code>dnscrypt-proxy</code> n&#039;est pas a être exécuté par root. Modifiez <strong>dnscrypt-proxy.socket</strong> avec le contenu suivant:
</p>
<dl class="file">
<dt><a href="/_export/code/dnscrypt?codeblock=8" title="Télécharger cet extrait" class="mediafile mf_socket">/lib/systemd/system/dnscrypt-proxy.socket</a></dt>
<dd><pre class="file">[Socket]
ListenStream=
ListenDatagram=
ListenStream=127.0.2.1:5353
ListenDatagram=127.0.2.1:5353</pre>
</dd></dl>
<div class="noteimportant">Le port UDP 5353 est utilisé par Avahi (si installé et en cours d&#039;exécution) et peut provoquer des avertissements dans le journal. Dans ce cas, utilisez le port 5354 par example.
</div>
</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Changer le port] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="changer_le_port" /><input type="hidden" name="codeblockOffset" value="8" /><input type="hidden" name="range" value="7679-8876" /><button type="submit" title="Changer le port" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit12 page-header" id="exemple_de_configurations_local_dns_cache">Exemple de configurations local DNS cache</h2>
<div class="level2">

<p>
Les configurations suivantes devraient fonctionner avec dnscrypt-proxy et assume qu&#039;il écoute sur le port <code>5353</code>.
</p>

</div>
<div class='secedit editbutton_section editbutton_12'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Exemple de configurations local DNS cache] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="exemple_de_configurations_local_dns_cache" /><input type="hidden" name="codeblockOffset" value="9" /><input type="hidden" name="range" value="8877-9047" /><button type="submit" title="Exemple de configurations local DNS cache" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit13" id="unbound">Unbound</h3>
<div class="level3">

<p>
Configurez <a href="/unbound" class="wikilink1" title="unbound">Unbound</a> à votre convenance et ajoutez les lignes suivantes à la fin de la section <code>server</code>:
</p>
<dl class="file">
<dt><a href="/_export/code/dnscrypt?codeblock=9" title="Télécharger cet extrait" class="mediafile mf_conf">/etc/unbound/unbound.conf</a></dt>
<dd><pre class="file">do-not-query-localhost: no
forward-zone:
  name: &quot;.&quot;
  forward-addr: 127.0.2.1@5353</pre>
</dd></dl>
<div class="notetip">Si vous configurez un serveur, ajoutez l&#039;interface: <code>interface: 0.0.0.0@53</code> et <code>access-control: your-network/subnet-mask allow</code> dans la section <code>server:</code> section afin que les autres ordinateurs puissent se connecter au serveur. Un client doit être configuré avec <code>nameserver address-of-your-server</code> dans <strong>/etc/resolv.conf</strong>.
</div>
<p>
 Ensuite redémarrez unbound.service pour appliquer les modifications:
</p>
<pre class="code">sudo systemctl restart unbound.service</pre>

</div>
<div class='secedit editbutton_section editbutton_13'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Unbound] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="unbound" /><input type="hidden" name="codeblockOffset" value="9" /><input type="hidden" name="range" value="9048-9786" /><button type="submit" title="Unbound" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit14" id="dnsmasq">dnsmasq</h3>
<div class="level3">

<p>
Configurez dnsmasq en tant que <a href="#configuration_du_cache_dns" title="dnscrypt ↵" class="wikilink1">cache DNS local</a>. La configuration de base pour fonctionner avec DNSCrypt:
</p>
<dl class="file">
<dt><a href="/_export/code/dnscrypt?codeblock=11" title="Télécharger cet extrait" class="mediafile mf_conf">/etc/dnsmasq.conf</a></dt>
<dd><pre class="file">no-resolv
server=127.0.2.1#5353
listen-address=127.0.0.1</pre>
</dd></dl>

<p>
Si vous avez configuré DNSCrypt pour utiliser un résolveur avec la validation DNSSEC activée, assurez-vous de l&#039;activer également dans <strong>/etc/dnsmasq.conf</strong>:
</p>
<pre class="file">proxy-dnssec</pre>

<p>
Redémarrez dnsmasq.service pour appliquer les modifications:
</p>
<pre class="code">sudo systemctl restart dnsmasq.service</pre>

</div>
<div class='secedit editbutton_section editbutton_14'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[dnsmasq] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="dnsmasq" /><input type="hidden" name="codeblockOffset" value="11" /><input type="hidden" name="range" value="9787-10334" /><button type="submit" title="dnsmasq" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit15" id="activer_edns0">Activer EDNS0</h3>
<div class="level3">

<p>
<a href="https://fr.wikipedia.org/wiki/EDNS" class="interwiki iw_wpfr" title="https://fr.wikipedia.org/wiki/EDNS">EDNS</a> qui, entre autres, permettent à un client de préciser la taille d&#039;une réponse via UDP.
Ajoutez la ligne suivante à votre <strong>/etc/resolv.conf</strong>:
</p>
<pre class="file">options edns0</pre>

<p>
Vous pouvez également ajouter ce qui suit à <strong>/etc/dnscrypt-proxy/dnscrypt-proxy.conf</strong>:
</p>
<pre class="file">EDNSPayloadSize &lt;bytes&gt;</pre>

<p>
Ou &lt;bytes&gt; est un nombre, la taille par défaut étant 1252, avec des valeurs allant jusqu&#039;à 4096 octets, étant présumée sûre. Une valeur inférieure ou égale à 512 octets désactivera ce mécanisme, sauf si un client envoie un paquet avec une section OPT fournissant une taille.
</p>

</div>

<h4 id="tester_edns0">Tester EDNS0</h4>
<div class="level4">

<p>
Utilisez le <a href="https://www.dns-oarc.net/oarc/services/replysizetest" class="urlextern" title="https://www.dns-oarc.net/oarc/services/replysizetest" rel="nofollow">serveur de test de taille de réponse DNS</a>, utilisez l&#039;outil de ligne de commande <code>drill</code> pour émettre une requête TXT pour le nom <code>rs.dns-oarc.net</code>:
</p>
<pre class="code">$ drill rs.dns-oarc.net TXT</pre>

<p>
Avec EDNS0 pris en charge, la &quot;answer section&quot; de la sortie devrait ressembler à ceci:
</p>
<pre class="code">rst.x3827.rs.dns-oarc.net.
rst.x4049.x3827.rs.dns-oarc.net.
rst.x4055.x4049.x3827.rs.dns-oarc.net.
&quot;2a00:d880:3:1::a6c1:2e89 DNS reply size limit is at least 4055 bytes&quot;
&quot;2a00:d880:3:1::a6c1:2e89 sent EDNS buffer size 4096&quot;</pre>

</div>
<div class='secedit editbutton_section editbutton_15'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Activer EDNS0] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="activer_edns0" /><input type="hidden" name="codeblockOffset" value="14" /><input type="hidden" name="range" value="10335-11572" /><button type="submit" title="Activer EDNS0" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit16 page-header" id="problemes">Problèmes</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_16'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Problèmes] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="problemes" /><input type="hidden" name="codeblockOffset" value="18" /><input type="hidden" name="range" value="11573-11595" /><button type="submit" title="Problèmes" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit17" id="dnscrypt_fonctionne_avec_les_privileges_root">Dnscrypt fonctionne avec les privilèges root</h3>
<div class="level3">

<p>
Pour contourner cela, créez manuellement un utilisateur sans privilège:
</p>
<pre class="code">sudo useradd -r -d /var/dnscrypt -m -s /sbin/nologin dnscrypt</pre>

<p>
 <img src="/lib/images/smileys/fixme.gif" class="icon" alt="FIXME" /> commande a vérifier !
</p>

<p>
Deux solutions possibles <a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">modifiez</a>  <strong>/etc/dnscrypt-proxy/dnscrypt-proxy.conf</strong> avec les <a href="/sudo" class="wikilink1" title="sudo">droits d&#039;administration</a>, en ajoutant le nouvel utilisateur:
</p>
<pre class="file">User dnscrypt</pre>

<p>
Sinon, vous devez utiliser User = dans la section [Service] <code>dnscrypt-proxy.service</code> de <a href="/systemd" class="wikilink1" title="systemd">systemd</a>: <img src="/lib/images/smileys/fixme.gif" class="icon" alt="FIXME" /> Formulation a revoir !
</p>
<dl class="file">
<dt><a href="/_export/code/dnscrypt?codeblock=20" title="Télécharger cet extrait" class="mediafile mf_service">/lib/systemd/system/dnscrypt-proxy.service</a></dt>
<dd><pre class="file">[Service]
User=dnscrypt
CapabilityBoundingSet=CAP_NET_BIND_SERVICE</pre>
</dd></dl>

<p>
Cette deuxième option est utile lors de l&#039;utilisation d&#039;un serveur de mise en cache comme Unbound et est préférable, puisque l&#039;unité n&#039;est pas exécutée en tant que root en premier lieu. Si vous avez changé le port vers un non-privilégié (par exemple 5353), <code>CapabilityBoundingSet = CAP_NET_BIND_SERVICE</code> n&#039;est pas nécessaire.
</p>

</div>
<div class='secedit editbutton_section editbutton_17'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Dnscrypt fonctionne avec les privilèges root] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="dnscrypt_fonctionne_avec_les_privileges_root" /><input type="hidden" name="codeblockOffset" value="18" /><input type="hidden" name="range" value="11596-12654" /><button type="submit" title="Dnscrypt fonctionne avec les privilèges root" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit18" id="divers_processus_ecrasent_resolvconf">Divers processus écrasent resolv.conf</h3>
<div class="level3">

<p>
Il s&#039;agit généralement d&#039;un comportement souhaitable, mais parfois, les paramètres <abbr title="Domain Name System">DNS</abbr> doivent être définis manuellement (par exemple lors de l&#039;utilisation d&#039;une adresse IP statique). Il existe plusieurs façons d&#039;y parvenir.
</p>

</div>

<h4 id="avec_network_manager">Avec Network Manager</h4>
<div class="level4">

<p>
NetworkManager enregistre ses paramètres dans <strong>/etc/NetworkManager/system-connections/nom-de-la-connection</strong>.
Example pour une connection filaire: 
</p>
<dl class="file">
<dt><a href="/_export/code/dnscrypt?codeblock=21" title="Télécharger cet extrait" class="mediafile mf_">/etc/NetworkManager/system-connections/Wired connection 1</a></dt>
<dd><pre class="file">[802-3-ethernet]
duplex=full
mac-address=XX:XX:XX:XX:XX:XX

[connection]
id=Wired connection 1
uuid=xxx-xxxxxx-xxxxxx-xxxxxx-xxx
type=802-3-ethernet
timestamp=1385213042

[ipv6]
method=auto

[ipv4]
method=auto
dns=127.0.2.1;
ignore-auto-dns=true</pre>
</dd></dl>

<p>
Cette 1ère solution est a privilégier.
</p>

<p>
Alternativement, pour empêcher NetworkManager de modifier <strong>/etc/resolv.conf</strong>, <a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Modifiez</a> <strong>/etc/NetworkManager/NetworkManager.conf</strong> et ajoutez ce qui suit dans la section [main]:
</p>
<pre class="file">dns=none</pre>

<p>
<code>/etc/resolv.conf</code> peut être un lien symbolique brisé que vous devrez supprimer après avoir fait cela. Ensuite, créez simplement un nouveau fichier <code>/etc/resolv.conf</code>.
</p>

</div>

<h4 id="avec_resolvconf">Avec Resolvconf</h4>
<div class="level4">

<p>
Si le programme resolvconf est installé, vous ne devez pas modifier le fichier de configuration resolv.conf manuellement car il sera modifié dynamiquement par les programmes du système. Pour définir manuellement les serveurs de noms (comme avec une interface statique), ajoutez une ligne comme suit dans le fichier de configuration d&#039;interfaces dans <strong>/etc/network/interfaces</strong>:
</p>
<pre class="file">dns-nameservers 127.0.2.1</pre>

</div>

<h4 id="avec_dhcp_client">Avec DHCP Client</h4>
<div class="level4">

<p>
Exemple: dhclient3 utilise <strong>/etc/dhcp/dhclient.conf</strong>. Le réglage que vous voulez est
</p>
<pre class="file">supersede domain-name-servers 127.0.2.1;</pre>

<p>
ou peut-être
</p>
<pre class="file">prepend domain-name-servers 127.0.2.1;</pre>

<p>
Prenez garde de bien fermer la ligne avec un ;
Voir la page de manuel dhclient.conf (5) pour plus de détails.
</p>

</div>

<h4 id="protection_contre_l_ecriture">Protection contre l&#039;écriture</h4>
<div class="level4">

<p>
Une autre façon (radicale!) de protéger votre /etc/resolv.conf d&#039;être modifié par quoi que ce soit est de  mettre en place la protection en écriture:
</p>
<pre class="code">sudo chattr +i /etc/resolv.conf</pre>

<p>
 pour dévérouiller la protection, éxécutez:
</p>
<pre class="code">sudo chattr -i /etc/resolv.conf</pre>

<p>
<img src="/lib/images/smileys/fixme.gif" class="icon" alt="FIXME" /> : Trouver une solution plus élegante qui ne contrarie pas le comportement d&#039;autres services
</p>

</div>
<div class='secedit editbutton_section editbutton_18'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Divers processus écrasent resolv.conf] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="divers_processus_ecrasent_resolvconf" /><input type="hidden" name="codeblockOffset" value="21" /><input type="hidden" name="range" value="12655-15117" /><button type="submit" title="Divers processus écrasent resolv.conf" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit19 page-header" id="desinstallation">Désinstallation</h2>
<div class="level2">

<p>
Pour supprimer cette application, il suffit de <a href="/tutoriel/comment_supprimer_un_paquet" class="wikilink1" title="tutoriel:comment_supprimer_un_paquet">Supprimez les paquets</a> <code><strong>dnscrypt-proxy</strong></code> et <code><strong>dnscrypt-proxy-plugins</strong></code>. Selon la méthode choisie, la configuration globale de l&#039;application est conservée ou supprimée. Les journaux du système, et les fichiers de préférence des utilisateurs dans leurs dossiers personnels sont toujours conservés.
</p>

</div>
<div class='secedit editbutton_section editbutton_19'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Désinstallation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="desinstallation" /><input type="hidden" name="codeblockOffset" value="28" /><input type="hidden" name="range" value="15118-15550" /><button type="submit" title="Désinstallation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit20 page-header" id="voir_aussi">Voir aussi</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="https://dnscrypt.info" class="urlextern" title="https://dnscrypt.info" rel="nofollow">Site officiel de DNSCrypt</a></div>
</li>
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="https://github.com/DNSCrypt" class="urlextern" title="https://github.com/DNSCrypt" rel="nofollow">La page Github du projet</a></div>
</li>
<li class="level1"><div class="li"> <strong>(fr)</strong>   <a href="https://forum.ubuntu-fr.org/viewtopic.php?id=2012964" class="urlextern" title="https://forum.ubuntu-fr.org/viewtopic.php?id=2012964" rel="nofollow">Sujet sur le forum Ubuntu-fr</a></div>
</li>
</ul>
<hr />

<p>
<em>Contributeurs principaux : <a href="/utilisateurs/deobs" class="wikilink1" title="utilisateurs:deobs">deobs</a>.</em>
</p>

<p>
<em>Basé sur <a href="https://wiki.archlinux.org/index.php/DNSCrypt" class="urlextern" title="https://wiki.archlinux.org/index.php/DNSCrypt" rel="nofollow">ArchWiki</a> et <a href="https://github.com/DNSCrypt/dnscrypt-proxy/wiki" class="urlextern" title="https://github.com/DNSCrypt/dnscrypt-proxy/wiki" rel="nofollow">A protocol to improve DNS security</a> par <a href="https://github.com/jedisct1" class="urlextern" title="https://github.com/jedisct1" rel="nofollow">https://github.com/jedisct1</a> mainteneur actuel.</em>
</p>

</div>
<div class='secedit editbutton_section editbutton_20'><form class="button btn_secedit form-inline" method="post" action="/dnscrypt"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1597245124" /><input type="hidden" name="summary" value="[Voir aussi] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="voir_aussi" /><input type="hidden" name="codeblockOffset" value="28" /><input type="hidden" name="range" value="15551-" /><button type="submit" title="Voir aussi" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="dnscrypt.txt">dnscrypt.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 12/08/2020, 17:12">Le 12/08/2020, 17:12</span></li><li class="text-muted">par spnux</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=dnscrypt&amp;1635548804" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
