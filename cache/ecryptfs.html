<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>ecryptfs [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="xenial,fichier,chiffrement,securite"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/ecryptfs?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/ecryptfs?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/ecryptfs"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/ecryptfs"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/ecryptfs"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"ecryptfs","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="ecryptfs">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/ecryptfs?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/ecryptfs?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/ecryptfs?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/ecryptfs?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/ecryptfs?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/ecryptfs?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/ecryptfs?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">ecryptfs</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/ecryptfs?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/ecryptfs?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/ecryptfs?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#installation","title":"Installation","level":1},{"link":"#controle_prealable","title":"Contr\u00f4le pr\u00e9alable.","level":2},{"link":"#acquisition_du_logiciel","title":"Acquisition du logiciel.","level":2},{"link":"#configuration","title":"Configuration","level":1},{"link":"#utilisation","title":"Utilisation","level":1},{"link":"#correctif_pour_version_anterieure_a_la_version_1710","title":"correctif pour version ant\u00e9rieure \u00e0 la version 17.10","level":2},{"link":"#monter_le_repertoire","title":"Monter le r\u00e9pertoire","level":2},{"link":"#utilisation_du_repertoire","title":"Utilisation du r\u00e9pertoire","level":2},{"link":"#demonter_le_repertoire","title":"D\u00e9monter le r\u00e9pertoire","level":2},{"link":"#chiffrer_sonhome","title":"Chiffrer son \/home","level":1},{"link":"#prealable_pour_pouvoir_se_relogger_facilement_avec_le_gestionnaire_de_connexion_et_l_authentification_pam","title":"Pr\u00e9alable pour pouvoir se relogger facilement avec le gestionnaire de connexion et l'authentification PAM :","level":1},{"link":"#creation_d_un_nouvel_utilisateur_securise","title":"Cr\u00e9ation d'un nouvel utilisateur s\u00e9curis\u00e9 :","level":1},{"link":"#desinstallation","title":"D\u00e9sinstallation","level":1},{"link":"#recuperation_du_contenu_d_un_repertoirehome_chiffre","title":"R\u00e9cup\u00e9ration du contenu d'un r\u00e9pertoire \"\/home\" chiffr\u00e9","level":1},{"link":"#methode_automatique","title":"Methode automatique","level":2},{"link":"#methode_manuelle","title":"M\u00e9thode manuelle","level":2},{"link":"#demonter_le_repertoire1","title":"D\u00e9monter le r\u00e9pertoire","level":2},{"link":"#problemes","title":"Probl\u00e8mes","level":1},{"link":"#mot_de_passe_modifie","title":"Mot de passe modifi\u00e9","level":2},{"link":"#fil_de_discussion_associe","title":"Fil de discussion associ\u00e9","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#installation">Installation</a>
<ul class="nav toc">
<li class="level2"><a href="#controle_prealable">Contrôle préalable.</a></li>
<li class="level2"><a href="#acquisition_du_logiciel">Acquisition du logiciel.</a></li>
</ul>
</li>
<li class="level1"><a href="#configuration">Configuration</a></li>
<li class="level1"><a href="#utilisation">Utilisation</a>
<ul class="nav toc">
<li class="level2"><a href="#correctif_pour_version_anterieure_a_la_version_1710">correctif pour version antérieure à la version 17.10</a></li>
<li class="level2"><a href="#monter_le_repertoire">Monter le répertoire</a></li>
<li class="level2"><a href="#utilisation_du_repertoire">Utilisation du répertoire</a></li>
<li class="level2"><a href="#demonter_le_repertoire">Démonter le répertoire</a></li>
</ul>
</li>
<li class="level1"><a href="#chiffrer_sonhome">Chiffrer son /home</a></li>
<li class="level1"><a href="#prealable_pour_pouvoir_se_relogger_facilement_avec_le_gestionnaire_de_connexion_et_l_authentification_pam">Préalable pour pouvoir se relogger facilement avec le gestionnaire de connexion et l&#039;authentification PAM :</a></li>
<li class="level1"><a href="#creation_d_un_nouvel_utilisateur_securise">Création d&#039;un nouvel utilisateur sécurisé :</a></li>
<li class="level1"><a href="#desinstallation">Désinstallation</a></li>
<li class="level1"><a href="#recuperation_du_contenu_d_un_repertoirehome_chiffre">Récupération du contenu d&#039;un répertoire &quot;/home&quot; chiffré</a>
<ul class="nav toc">
<li class="level2"><a href="#methode_automatique">Methode automatique</a></li>
<li class="level2"><a href="#methode_manuelle">Méthode manuelle</a></li>
<li class="level2"><a href="#demonter_le_repertoire1">Démonter le répertoire</a></li>
</ul>
</li>
<li class="level1"><a href="#problemes">Problèmes</a>
<ul class="nav toc">
<li class="level2"><a href="#mot_de_passe_modifie">Mot de passe modifié</a></li>
</ul>
</li>
<li class="level1"><a href="#fil_de_discussion_associe">Fil de discussion associé</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/xenial" class="wikilink1" title="xenial" rel="tag">Xenial</a>,
	<a href="/fichier?do=showtag&amp;tag=fichier" class="wikilink1" title="fichier" rel="tag">fichier</a>,
	<a href="/chiffrement?do=showtag&amp;tag=chiffrement" class="wikilink1" title="chiffrement" rel="tag">chiffrement</a>,
	<a href="/securite" class="wikilink1" title="securite" rel="tag">sécurité</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="ecryptfschiffrer_sonhome_ou_creer_un_dossier_prive_chiffre">Ecryptfs : Chiffrer son /home ou créer un dossier privé chiffré</h1>
<div class="level1">

<p>
<strong>Ecryptfs </strong> est un outil pour créer un dossier privé (<strong>~/Private</strong>), <em class="u">chiffré et inaccessible aux autres utilisateurs</em>, il est destiné à contenir tous les fichiers &quot;sensibles&quot; que vous pourriez avoir : vos fichiers contenant des mots de passe, les données confidentielles relatives à vos comptes bancaires, vos emails…
</p>
<div class="noteclassic">Cette nouvelle caractéristique de sécurité est disponible depuis <a href="/intrepid" class="wikilink1" title="intrepid">Ubuntu Intrepid Ibex</a>
</div><div class="notewarning"> Cette <a href="https://wiki.ubuntu.com/BionicBeaver/ReleaseNotes" class="urlextern" title="https://wiki.ubuntu.com/BionicBeaver/ReleaseNotes" rel="nofollow">fonctionnalité </a>
n&#039;est pas disponible lors de l&#039;installation de la version <a href="https://bugs.launchpad.net/ubuntu/+source/ecryptfs-utils/+bug/1756840" class="urlextern" title="https://bugs.launchpad.net/ubuntu/+source/ecryptfs-utils/+bug/1756840" rel="nofollow">18.04.0</a>
</div>
</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Ecryptfs : Chiffrer son /home ou créer un dossier privé chiffré] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="ecryptfschiffrer_sonhome_ou_creer_un_dossier_prive_chiffre" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="53-824" /><button type="submit" title="Ecryptfs : Chiffrer son /home ou créer un dossier privé chiffré" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="installation">Installation</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Installation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="825-849" /><button type="submit" title="Installation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit3" id="controle_prealable">Contrôle préalable.</h3>
<div class="level3">

<p>
Ecryptfs assure une sécurité des données basée sur le mot de passe. Il est donc nécessaire que le mot de passe ne soit pas très aisément récupérable.
S&#039;il est récupérable en dix secondes, il semble inutile de chiffrer les données.
</p>
<pre class="code">sudo apt install john
sudo john --show  /etc/passwd /etc/shadow</pre>

<p>
S&#039;il est déchiffrable  en moins de 24 heures. le risque reste important.
</p>
<pre class="code">sudo john --incremental  /etc/passwd /etc/shadow</pre>

<p>
S&#039;il est nécessaire de  passer plus de temps, il est probable que les particuliers seront découragés mais pas les professionnels quitte à utiliser un réseau de 1000 machines afin de diminuer la durée de décryptage, mais ils décrypteront le mot de passe.
</p>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Contrôle préalable.] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="controle_prealable" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="850-1601" /><button type="submit" title="Contrôle préalable." class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit4" id="acquisition_du_logiciel">Acquisition du logiciel.</h3>
<div class="level3">

<p>
Il suffit <a href="/tutoriel/comment_installer_un_paquet#paquet_present_dans_les_depots" class="wikilink1" title="tutoriel:comment_installer_un_paquet">d&#039;installer le paquet</a> <strong><a href="apt://ecryptfs-utils" class="interwiki iw_apt" title="apt://ecryptfs-utils">ecryptfs-utils</a></strong>.
</p>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Acquisition du logiciel.] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="acquisition_du_logiciel" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="1602-1772" /><button type="submit" title="Acquisition du logiciel." class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit5 page-header" id="configuration">Configuration</h2>
<div class="level2">
<pre class="code">ecryptfs-setup-private </pre>

<p>
A l&#039;invite
</p>
<pre class="code">Enter your login passphrase:</pre>

<p>
Entrez le mot de passe que vous utilisez pour vous connecter.
</p>
<pre class="code">Enter your mount passphrase [leave blank to generate one]:</pre>

<p>
Choisissez une phrase secrète ou laissez vide pour en générer une.
</p>
<pre class="code">Enter your mount passphrase (again): </pre>

<p>
Reconfirmez votre phrase secrète.
</p>

<p>
Enregistrez votre phrase secrète dans un lieu sûr, elle sera requise pour récupérer vos données ultérieurement.
</p>

<p>
Puis, avant d&#039;utiliser, il faut absolument suivre cette directive, sinon ce que vous allez écrire sera perdu
</p>

<p>
<strong>Logout, and log back in to begin using your encrypted directory.</strong>
</p>
<div class="noteimportant">Ne perdez pas votre passphrase ! Soyez sûr de la retenir ou bien notez-la.
</div><div class="noteclassic">Vous allez avoir une fenêtre qui va s&#039;ouvrir avec comme message :
<pre class="code">Record your encryption passphrase

To encrypt your home directory or &quot;Private&quot; folder, a strong passphrase has been autogenerated. Usually your directory is unlocked with your user password, but if you ever need to manually recover this directory, you will need this passphrase. Please print or write it down and store it in a safe location.
You can run the &quot;ecryptfs-unwrap-passphrase&quot; command now to do this. Enter your user password at the &quot;Passphrase&quot; prompt.</pre>

<p>
La commande ecryptfs-unwrap-passphrase citée permet de retrouver la passphrase de montage (à condition de connaître le mot de passe d&#039;ouverture de session). Voir le paragraphe 5.2 pour plus de détails.
</p>

</div>
</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Configuration] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="1773-3312" /><button type="submit" title="Configuration" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit6 page-header" id="utilisation">Utilisation</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Utilisation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="utilisation" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="3313-3336" /><button type="submit" title="Utilisation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit7" id="correctif_pour_version_anterieure_a_la_version_1710">correctif pour version antérieure à la version 17.10</h3>
<div class="level3">

<p>
Une fois l&#039;installation faite, vous devrez vous rendre dans le dossier &quot;~/.Private&quot;    dans lequel vous trouverez un lanceur &quot;Access-Your-Private-Data&quot; afin de monter votre espace privé. Vous pouvez le copier/coller sur votre Bureau pour plus de facilité.<br/>

Malheureusement, pour le moment, ce lanceur n&#039;a pas l&#039;attribut exécutable et refuse de se lancer. Il faut pallier ce souci en lançant :
</p>
<pre class="code">sudo chmod +x /usr/share/ecryptfs-utils/ecryptfs-mount-private.desktop</pre>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[correctif pour version antérieure à la version 17.10] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="correctif_pour_version_anterieure_a_la_version_1710" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="3337-3886" /><button type="submit" title="correctif pour version antérieure à la version 17.10" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit8" id="monter_le_repertoire">Monter le répertoire</h3>
<div class="level3">
<pre class="code"> ecryptfs-mount-private</pre>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Monter le répertoire] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="monter_le_repertoire" /><input type="hidden" name="codeblockOffset" value="3" /><input type="hidden" name="range" value="3887-3965" /><button type="submit" title="Monter le répertoire" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit9" id="utilisation_du_repertoire">Utilisation du répertoire</h3>
<div class="level3">
<pre class="code"> cd /home/$USER/Private
 echo &quot;écrire dans fichier&quot;&gt;Fic
 mkdir Toto
 echo &quot;écrire dans sous-répertoire&quot;&gt;Toto/Fic
 cd
     </pre>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Utilisation du répertoire] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="utilisation_du_repertoire" /><input type="hidden" name="codeblockOffset" value="4" /><input type="hidden" name="range" value="3966-4142" /><button type="submit" title="Utilisation du répertoire" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit10" id="demonter_le_repertoire">Démonter le répertoire</h3>
<div class="level3">
<pre class="code"> ecryptfs-umount-private</pre>

<p>
La réponse sous ubuntu1710 est
</p>
<pre class="code"> Sessions still open, not unmounting</pre>

<p>
Il suffit de faire une seconde fois
</p>
<pre class="code"> ecryptfs-umount-private </pre>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Démonter le répertoire] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="demonter_le_repertoire" /><input type="hidden" name="codeblockOffset" value="4" /><input type="hidden" name="range" value="4143-4378" /><button type="submit" title="Démonter le répertoire" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit11 page-header" id="chiffrer_sonhome">Chiffrer son /home</h2>
<div class="level2">

<p>
Si vous n&#039;avez pas chiffré votre dossier personnel &quot;/home&quot; lors de l&#039;installation d&#039;Ubuntu et si vous n&#039;avez pas déjà créé un répertoire chiffré, il est encore possible de le faire. Pour cela, il faut utiliser la commande 
</p>
<pre class="code">sudo ecryptfs-migrate-home -u &quot;user&quot;</pre>

<p>
en remplaçant &quot;user&quot; par le login du compte à chiffrer.
</p>
<div class="noteimportant">Il n&#039;est pas possible d&#039;utiliser cette commande depuis le compte user du dossier /home à chiffrer. Il faut donc créer un utilisateur temporaire sur votre système, lui donner les droits sudo en l&#039;associant au groupe &quot;admin&quot; puis se logger sur une console avec cet utilisateur temporaire pour exécuter la commande ci-dessus.
</div><div class="notewarning">Avant de lancer le processus, il est recommandé de faire une sauvegarde de son répertoire /home en utilisant par exemple <a href="/clonezilla" class="wikilink1" title="clonezilla">Clonezilla</a>
</div><div class="noteclassic">Cette migration emporte aussi les données de l&#039;utilisateur  montées dans d&#039;autres partitions  et reliées par un lien logique aux dossiers Documents, Images, téléchargements, musique et Vidéos et nécessite 2,5 fois la taille de cet ensemble
</div>
<p>
Pour créer un nouvel utilisateur &quot;temporaire&quot; en lui donnant les droits d&#039;admin, tapez :
</p>
<pre class="code">sudo adduser --ingroup adm temporaire
sudo adduser temporaire sudo</pre>

<p>
Faite ensuite un clone de votre partition avec <a href="/clonezilla" class="wikilink1" title="clonezilla">Clonezilla</a> ou une copie de sauvegarde de votre dossier /home, si possible vers une autre partition:
</p>
<pre class="code">sudo rsync -a /home/user /backup/user.old</pre>

<p>
Faite ensuite du ménage dans votre dossier /home : la migration vers un /home chiffré nécessite que la partition sur laquelle est votre /home ait un espace disque libre de 2,5x la taille du /home à chiffrer ! <br/>

</p>

<p>
Passez ensuite en mode console avec CTRL+ALT+F1 en ayant fermé votre session graphique (il faut s&#039;assurer que le /home de l&#039;utilisateur à chiffrer n&#039;aura pas d&#039;accès en écriture pendant l’opération) et loggez vous avec votre nouvel utilisateur.<br/>
Vous pouvez vérifier si il y a encore des processus qui tournent sous votre user à chiffrer avec la commande 
</p>
<pre class="code">top</pre>

<p>
Vous pouvez alors lancer la migration du dossier /home de votre utilisateur &quot;user&quot;
</p>
<pre class="code">sudo ecryptfs-migrate-home -u &quot;user&quot;</pre>

<p>
Si il y a assez de place sur le disque, le programme vous demandera le password de l&#039;utilisateur &quot;user&quot; et la migration commencera. Après quelques minutes, vous devriez voir un message indiquant que tout s&#039;est bien passé et il faudra suivre les indications données pour finaliser la migration :
</p>
<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>Avant de rebooter</strong>, loguez vous avec l&#039;utilisateur qui vient d&#039;être migré <pre class="code">su &quot;user&quot;</pre>

<p>
 et naviguez dans votre dossier /home. Si vous retrouvez vos fichiers et pouvez les lire, c&#039;est que tout c&#039;est bien passé.
</p>
</div>
</li>
<li class="level1"><div class="li"> La migration a crée un dossier /home/user.XXXXXXXX. Si tout s&#039;est bien passé, vous pouvez le supprimer (à faire après quelque jours d&#039;utilisation, une fois que l&#039;on est vraiment sur que tout s&#039;est bien passé.) Si non, utilisez le pour restaurer votre /home</div>
</li>
<li class="level1"><div class="li"> Utilisez la commande <pre class="code">ecryptfs-unwrap-passphrase</pre>

<p>
 pour connaître votre clé de chiffrement. Notez-la et gardez-la précieusement, cela pourra vous être utile pour déchiffrer votre home en cas de problème.
</p>
</div>
</li>
<li class="level1"><div class="li"> Chiffrez votre swap avec la commande <pre class="code">ecryptfs-setup-swap</pre>
</div>
</li>
</ol>

<p>
Vous pourrez enfin supprimer votre utilisateur temporaire avec la commande
</p>
<pre class="code">sudo deluser --remove-all-files temporaire</pre>

</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Chiffrer son /home] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="chiffrer_sonhome" /><input type="hidden" name="codeblockOffset" value="7" /><input type="hidden" name="range" value="4379-7883" /><button type="submit" title="Chiffrer son /home" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit12 page-header" id="prealable_pour_pouvoir_se_relogger_facilement_avec_le_gestionnaire_de_connexion_et_l_authentification_pam">Préalable pour pouvoir se relogger facilement avec le gestionnaire de connexion et l&#039;authentification PAM :</h2>
<div class="level2">

<p>
Le montage est automatique en version 16.04, 
Le paquet peut aussi s&#039;appeler libpam-mount et les deux autres paquets peuvent déjà être installés.
</p>

<p>
L&#039;idée étant évidement que le répertoire personnel soit monté en clair dès le login. Pour cela nous allons utiliser pam_mount, il faudra d&#039;abord installer le paquet en question &quot;libpam_mount&quot; et &quot;rsync&quot; et &quot;lsof&quot; :
</p>
<pre class="code">sudo apt-get install libpam_mount rsync lsof</pre>

<p>
Éditer le fichier etc/pam.d/system-auth, après la ligne contenant &#039;auth required pam_unix.so&#039; ajouter :
</p>
<pre class="code">auth    required    pam_ecryptfs.so unwrap</pre>

<p>
Ensuite, avant la ligne contenant &#039;password required pam_unix.so&#039; insérer :
</p>
<pre class="code">password    optional    pam_ecryptfs.so</pre>

<p>
Et finalement, après la ligne contenant &#039;session required pam_unix.so&#039; ajouter :
</p>
<pre class="code">session    optional    pam_ecryptfs.so unwrap</pre>

<p>
Attention à bien utiliser la même passphrase pour chiffrer votre repertoire personnel, que le mot de passe de connexion.
</p>

</div>
<div class='secedit editbutton_section editbutton_12'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Préalable pour pouvoir se relogger facilement avec le gestionnaire de connexion et l&#039;authentification PAM :] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="prealable_pour_pouvoir_se_relogger_facilement_avec_le_gestionnaire_de_connexion_et_l_authentification_pam" /><input type="hidden" name="codeblockOffset" value="16" /><input type="hidden" name="range" value="7884-8997" /><button type="submit" title="Préalable pour pouvoir se relogger facilement avec le gestionnaire de connexion et l&#039;authentification PAM :" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit13 page-header" id="creation_d_un_nouvel_utilisateur_securise">Création d&#039;un nouvel utilisateur sécurisé :</h2>
<div class="level2">

<p>
(Réalisation en version 16.04)
</p>

<p>
L&#039;installation standard ne génère le répertoire /home/$USER que d&#039;un seul utilisateur pouvant être chiffré ou pas. il peut être  nécessaire de créer d&#039;autres utilisateurs.
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li">  Créer l&#039;utilisateur nouveau grâce à la commande <strong>sudo adduser NouveauNom</strong></div>
</li>
<li class="level1"><div class="li">  Initialiser immédiatement le chiffrage de cet utilisateur grâce à la commande. <strong>sudo ecryptfs-migrate-home -u NouveauNom</strong></div>
</li>
<li class="level1"><div class="li">  Demander à <strong>NouveauNom</strong> de se connecter afin qu&#039;il fabrique la phrase de sécurité de montage de son répertoire</div>
</li>
<li class="level1"><div class="li">  Patienter quelque minutes le temps que la grille proposant d&#039;enregistrer ce choix soit affichée.</div>
</li>
<li class="level1"><div class="li">  Valider la grille afin d&#039;automatiser</div>
</li>
<li class="level1"><div class="li"> Se déconnecter et se reconnecter immédiatement avant l&#039;arrêt de l&#039;ordinateur.</div>
</li>
</ul>

<p>
Constat;
 Le répertoire de cet utilisateur est bien monté automatiquement. il accède à ses propres données qui sont protégées des autres  sessions <strong>lorsque l&#039;utilisateur n&#039;est pas connecté</strong>..
</p>
<pre class="code">root@u16041:/mnt/home/cryptage# ls -las
total 8
4 dr-x------ 2 1002 1002 4096 déc.  29 11:47 .
4 drwxr-xr-x 7 root root 4096 déc.  29 11:47 ..
0 lrwxrwxrwx 1 1002 1002   56 déc.  29 11:47 Access-Your-Private-Data.desktop -&gt; /usr/share/ecryptfs-utils/ecryptfs-mount-private.desktop
0 lrwxrwxrwx 1 1002 1002   34 déc.  29 11:47 .ecryptfs -&gt; /home/.ecryptfs/cryptage/.ecryptfs
0 lrwxrwxrwx 1 1002 1002   33 déc.  29 11:47 .Private -&gt; /home/.ecryptfs/cryptage/.Private
0 lrwxrwxrwx 1 1002 1002   52 déc.  29 11:47 README.txt -&gt; /usr/share/ecryptfs-utils/ecryptfs-mount-private.txt
root@u16041:/mnt/home/cryptage</pre>
<pre class="code">root@u16042:/home/cryptage#  ls -ls
total 0
0 lrwxrwxrwx 1 cryptage cryptage 56 déc.  29 11:47 Access-Your-Private-Data.desktop -&gt; /usr/share/ecryptfs-utils/ecryptfs-mount-private.desktop
0 lrwxrwxrwx 1 cryptage cryptage 52 déc.  29 11:47 README.txt -&gt; /usr/share/ecryptfs-utils/ecryptfs-mount-private.txt
root@u16042:/home/cryptage# </pre>

<p>
.
</p>

</div>
<div class='secedit editbutton_section editbutton_13'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Création d&#039;un nouvel utilisateur sécurisé :] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="creation_d_un_nouvel_utilisateur_securise" /><input type="hidden" name="codeblockOffset" value="20" /><input type="hidden" name="range" value="8998-11022" /><button type="submit" title="Création d&#039;un nouvel utilisateur sécurisé :" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit14 page-header" id="desinstallation">Désinstallation</h2>
<div class="level2">

<p>
Pour supprimer cette application, il suffit de <a href="/tutoriel/comment_supprimer_un_paquet" class="wikilink1" title="tutoriel:comment_supprimer_un_paquet">supprimer son paquet</a>. La configuration de l&#039;application sera conservée ou supprimée selon la méthode de désinstallation que vous choisirez.
</p>
<div class="notewarning">ATTENTION : supprimer le paquet et sa configuration et/ou le dossier .ecryptf/ aurait pour résultat de rendre toutes vos données illisibles, et ce à jamais !
</div>
<p>
Assurez-vous d&#039;avoir déplacé <strong>toutes vos données</strong> ailleurs que dans le dossier ~/Private
</p>

<p>
1. Démonter le répertoire crypté : 
</p>
<pre class="code">   ecryptfs-umount-private  </pre>

<p>
2. Rendre ~/Private accessible en écriture :
</p>
<pre class="code">   chmod 700 ~/Private  </pre>

<p>
3. Effacer ~/Private, ~/.Private, ~/.ecryptfs <strong>(Note: EFFACEMENT DÉFINITIF)</strong> :
</p>
<pre class="code">   rm -rf ~/Private ~/.Private ~/.ecryptfs  </pre>

<p>
4. Désinstaller les paquets :
</p>
<pre class="code">   sudo apt-get remove ecryptfs-utils libecryptfs0
   ou
   sudo apt purge ecryptfs-utils libecryptfs1</pre>

<p>
Si vous n&#039;arrivez pas à désinstaller normalement :
(source : <a href="https://help.ubuntu.com/community/EncryptedPrivateDirectory#How_to_Remove_an_Encrypted_Private_Directory_Setup" class="urlextern" title="https://help.ubuntu.com/community/EncryptedPrivateDirectory#How_to_Remove_an_Encrypted_Private_Directory_Setup" rel="nofollow">https://help.ubuntu.com/community/EncryptedPrivateDirectory#How_to_Remove_an_Encrypted_Private_Directory_Setup</a>)
</p>

</div>
<div class='secedit editbutton_section editbutton_14'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Désinstallation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="desinstallation" /><input type="hidden" name="codeblockOffset" value="22" /><input type="hidden" name="range" value="11023-12156" /><button type="submit" title="Désinstallation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit15 page-header" id="recuperation_du_contenu_d_un_repertoirehome_chiffre">Récupération du contenu d&#039;un répertoire &quot;/home&quot; chiffré</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_15'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Récupération du contenu d&#039;un répertoire &quot;/home&quot; chiffré] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="recuperation_du_contenu_d_un_repertoirehome_chiffre" /><input type="hidden" name="codeblockOffset" value="22" /><input type="hidden" name="range" value="12157-12229" /><button type="submit" title="Récupération du contenu d&#039;un répertoire &quot;/home&quot; chiffré" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit16" id="methode_automatique">Methode automatique</h3>
<div class="level3">

</div>

<h4 id="si_tout_se_passe_bien">Si tout se passe bien</h4>
<div class="level4">

<p>
Pour récupérer très simplement <strong>vos données personnelles</strong>, il est possible d&#039;utiliser l&#039;outil <strong>ecryptfs-recover-private</strong>
</p>
<pre class="code">sudo ecryptfs-recover-private</pre>

<p>
Il va scanner vos disques à la recherche des dossiers chiffrés <em>.Private</em>. Comme indiqué, cette opération peut prendre du temps. Une fois la recherche terminée, il vous proposera de monter votre(vos) dossier(s) .Private comme par exemple :
</p>
<pre class="code">INFO: Found [/media/&lt;UUID&gt;/home/.ecryptfs/&lt;username&gt;/.Private]
Try to recover this directory? [Y/n]:</pre>

<p>
Répondez alors <strong>Y</strong> et il vous montera votre dossier automatiquement. Vous n&#039;aurez plus qu&#039;à parcourir le point de montage avec nautilus par exemple.
</p>
<pre class="code">sudo nautilus &amp;</pre>
<div class="noteclassic">Vous pouvez indiquer en paramètre de ecryptfs-recover-private le répertoire à déchiffrer, ce qui vous évitera l&#039;attente parfois longue (It may take a while !) de recherche du répertoire chiffré<pre class="code">sudo ecryptfs-recover-private /home/.ecryptfs/toto/.Private/</pre>

</div><div class="noteclassic">L&#039;option –rw ouvre les droits en écriture à l&#039;intérieur de la partition chiffrée<pre class="code">sudo ecryptfs-recover-private --rw /home/.ecryptfs/toto/.Private/</pre>

</div>
</div>

<h4 id="si_vous_obtenez_l_erreur_echec_de_l_appel_systeme_mount_2">Si vous obtenez l&#039;erreur « échec de l’appel système mount(2) »</h4>
<div class="level4">

<p>
Il peut arriver que la méthode automatique échoue sans qu&#039;il soit nécessaire de passer par la méthode manuelle, voire que la méthode manuelle échoue elle aussi avec une erreur « échec de l’appel système mount(2) : Aucun fichier ou dossier de ce type.» (mount: mount(2) failed: No such file or directory)
</p>
<pre class="code">usr@pc:~$ sudo ecryptfs-recover-private --rw /home/.ecryptfs/usr/.Private
[sudo] Mot de passe de usr : 
INFO: Found [/home/.ecryptfs/usr/.Private].
Try to recover this directory? [Y/n]: 
INFO: Found your wrapped-passphrase
Do you know your LOGIN passphrase? [Y/n] 
INFO: Enter your LOGIN passphrase...
Passphrase: 
Inserted auth tok with sig [a425d547696d4f7b] into the user session keyring
mount: /tmp/ecryptfs.a2GHrSDE: échec de l’appel système mount(2) : Aucun fichier ou dossier de ce type.
ERROR: Failed to mount private data at [/tmp/ecryptfs.a2GHrSDE].</pre>

<p>
Dans ce cas, il peut être nécessaire d&#039;initialiser les clés ecryptfs de la manière suivante :
</p>
<pre class="code">usr@pc:~$ sudo keyctl link @u @s</pre>

<p>
puis, tout simplement :
</p>
<pre class="code">usr@pc:~$ sudo ecryptfs-recover-private --rw /home/.ecryptfs/usr/.Private
INFO: Found [/home/.ecryptfs/usr/.Private].
Try to recover this directory? [Y/n]: 
INFO: Found your wrapped-passphrase
Do you know your LOGIN passphrase? [Y/n] 
INFO: Enter your LOGIN passphrase...
Passphrase: 
Inserted auth tok with sig [a425d547696d4f7b] into the user session keyring
INFO: Success!  Private data mounted at [/tmp/ecryptfs.sD45Yfu58].
</pre>

</div>
<div class='secedit editbutton_section editbutton_16'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Methode automatique] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="methode_automatique" /><input type="hidden" name="codeblockOffset" value="22" /><input type="hidden" name="range" value="12230-15066" /><button type="submit" title="Methode automatique" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit17" id="methode_manuelle">Méthode manuelle</h3>
<div class="level3">

<p>
Si par exemple, pour une raison quelconque votre Ubuntu ne démarre plus ou que vous souhaitez récupérer les données d&#039;un ordinateur tombé en panne, il va falloir déchiffrer le répertoire /home de l&#039;utilisateur qui a un problème.
Il est difficile de trouver de la documentation sur la façon de faire, alors après avoir galéré plusieurs heures, et jonglé avec différentes clés, je vous donne la solution.
</p>

</div>

<h4 id="etape_1obtenir_la_passphrase">Etape 1 : obtenir la passphrase</h4>
<div class="level4">

<p>
Tout d&#039;abord, il faut monter la partition /home dont on veut s&#039;approprier le contenu planté pour qu&#039;il soit accessible dans &quot;/media&quot;. Puis
</p>
<pre class="code">usr@pc:~$ sudo ecryptfs-unwrap-passphrase   /media/$USER/PointDeMontage/home/NomDeCeluiDontOnRécupèreLesDonnées/.ecryptfs/wrapped-passphrase</pre>

<p>
(le mot de passe demandé est celui de la personne dont on souhaite récupérer les données. Il peut être nécessaire de négocier pour obtenir ce mot de passe!)
</p>

<p>
(&quot; /media/$USER/pointDeMontage/home/NomDeCeluiDontOnRécupèrerLesDonnées/&quot; est le répertoire &quot;/home&quot; de l&#039;utilisateur qu&#039;on traite).
</p>

<p>
Vérifier bien que cette passphrase n&#039;est pas celle du système actuellement démarré, la passphrase doit être différente de celle-ci:
</p>
<pre class="code">sudo ecryptfs-unwrap-passphrase</pre>

</div>

<h4 id="etape_2obtenir_les_2_cles_fnek">Etape 2 : obtenir les 2 clés &quot;fnek&quot;</h4>
<div class="level4">
<pre class="code">usr@pc:~$  sudo ecryptfs-add-passphrase --fnek</pre>

<p>
(lorsque l&#039;on vous demande la passphrase, il ne faut pas confondre avec votre mot de passe session, mettez la passphrase obtenue ci-dessus)
On vous donne 2 clés, il faut  les copier dans la commande suivante avant de la lancer.
</p>

</div>

<h4 id="etape_3effectuer_le_montage_du_repertoire">Etape 3 : effectuer le montage du répertoire</h4>
<div class="level4">
<pre class="code">usr@pc:~$ sudo mount -i -t ecryptfs -o rw,ecryptfs_sig=premier_keyring,ecryptfs_fnek_sig=deuxième_keyring,ecryptfs_cipher=aes,ecryptfs_key_bytes=16  /media/$USER/PointDeMontage/home/NomDeCeluiDontOnRécupèreLesDonnées/.Private     /media</pre>

<p>
Vérifier alors que les noms des fichiers sont bien lisibles!
Si ce n&#039;est pas le cas et que leur taille est indiquée avec les ??????, vous vous êtes trompés dans les jetons. Notez qu&#039;aussitôt qu&#039;une commande de montage a été réalisée (avec succès ou pas) les jetons sont éliminés. Il est donc nécessaire de rejouer ce trio de commandes.
</p>

<p>
Ne pas oublier que la commande <strong>ecrypt2fs-recover-private,</strong> fait cette action mais en imposant le point de montage dans un répertoire aléatoire de /tmp…
</p>

</div>
<div class='secedit editbutton_section editbutton_17'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Méthode manuelle] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="methode_manuelle" /><input type="hidden" name="codeblockOffset" value="25" /><input type="hidden" name="range" value="15067-17485" /><button type="submit" title="Méthode manuelle" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit18" id="demonter_le_repertoire1">Démonter le répertoire</h3>
<div class="level3">

<p>
Après avoir monté le répertoire, récupéré ou modifié vos données, vous pouvez souhaiter démonter le répertoire chiffré. Le moyen le plus simple est de quitter la session ou d&#039;éteindre la machine mais vous pouvez souhaiter maintenir la session active.
Dans cette hypothèse, vous pouvez recourir à la commande <strong> umount.ecryptfs</strong> suivie du chemin complet vers le répertoire temporaire de montage de la partition chiffrée.
</p>
<pre class="code">usr@pc:~$  sudo umount.ecryptfs /tmp/ecryptfs.aQhg2lM4/
Could not unlink the key(s) from your keying. Please use `keyctl unlink` if you wish to remove the key(s). Proceeding with umount.
</pre>

</div>
<div class='secedit editbutton_section editbutton_18'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Démonter le répertoire] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="demonter_le_repertoire1" /><input type="hidden" name="codeblockOffset" value="28" /><input type="hidden" name="range" value="17486-18163" /><button type="submit" title="Démonter le répertoire" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit19 page-header" id="problemes">Problèmes</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_19'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Problèmes] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="problemes" /><input type="hidden" name="codeblockOffset" value="29" /><input type="hidden" name="range" value="18164-18187" /><button type="submit" title="Problèmes" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit20" id="mot_de_passe_modifie">Mot de passe modifié</h3>
<div class="level3">

<p>
Si vous avez modifié votre mot de passe depuis la ligne de commande à l&#039;aide &quot;passwd&quot;, le système ecryptfs ne vous autorisera plus à accéder aux données chiffrées.
Votre dossier chiffré est devenu illisible et non-déchiffrable parce que le montage du dossier ecryptfs est basé sur votre ancien mot de passe.<br/>

Vous pouvez vous en tirer si vous connaissez la passphrase mais vous n&#039;avez aucune solution dans le cas contraire.
</p>

</div>

<h4 id="solution_1acceder_temporairement_aux_donnees">Solution 1 : accéder temporairement aux données</h4>
<div class="level4">

<p>
Pour accéder à vos données, il vous suffira de monter le dossier chiffré vous-même manuellement et le tour sera joué :
</p>
<pre class="code">sudo mount -t ecryptfs ~/.Private ~/Private -o key=passphrase,ecryptfs_cipher=aes,ecryptfs_key_bytes=16,ecryptfs_passthrough=n</pre>

<p>
La passphrase vous sera demandée et le dossier Private sera monté correctement.
</p>

</div>

<h4 id="solution_2retablir_un_fonctionnement_normal">Solution 2 : rétablir un fonctionnement normal</h4>
<div class="level4">

<p>
Si vous avez modifié votre mot de passe depuis la ligne de commande, vous remarquerez que la passphrase utilisée pour monter votre dossier personnel chiffré n&#039;est PAS mise à jour. Ceci évite qu&#039;un super utilisateur (ex. : root) puisse accéder à vos données simplement en modifiant votre mot de passe d&#039;utilisateur et en se connectant avec votre identifiant.
</p>

<p>
Afin de modifier votre passphrase Ecryptfs (pour qu&#039;elle coïncide avec votre nouveau mot de passe), utilisez cette commande :
</p>
<pre class="code">ecryptfs-rewrap-passphrase ~/.ecryptfs/wrapped-passphrase</pre>

<p>
Vous devrez saisir votre ancienne passphrase, puis la nouvelle.
</p>

<p>
Vous pourrez alors utiliser votre répertoire crypté normalement.<br/>

<em>NB: Solution proposée sur ce tutoriel <a href="http://bodhizazen.net/Tutorials/Ecryptfs/" class="urlextern" title="http://bodhizazen.net/Tutorials/Ecryptfs/" rel="nofollow">Ecryptfs</a>, dans le chapitre «Change your passphrase to mount your encrypted private directory or home»</em>
</p>

</div>
<div class='secedit editbutton_section editbutton_20'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Mot de passe modifié] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="mot_de_passe_modifie" /><input type="hidden" name="codeblockOffset" value="29" /><input type="hidden" name="range" value="18188-19993" /><button type="submit" title="Mot de passe modifié" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit21 page-header" id="fil_de_discussion_associe">Fil de discussion associé</h2>
<div class="level2">

<p>
<a href="http://forum.ubuntu-fr.org/viewtopic.php?id=619641" class="urlextern" title="http://forum.ubuntu-fr.org/viewtopic.php?id=619641" rel="nofollow">http://forum.ubuntu-fr.org/viewtopic.php?id=619641</a>
</p>
<hr />
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="https://help.ubuntu.com/community/EncryptedPrivateDirectory" class="urlextern" title="https://help.ubuntu.com/community/EncryptedPrivateDirectory" rel="nofollow">https://help.ubuntu.com/community/EncryptedPrivateDirectory</a></div>
</li>
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="https://wiki.ubuntu.com/EncryptedPrivateDirectory" class="urlextern" title="https://wiki.ubuntu.com/EncryptedPrivateDirectory" rel="nofollow">https://wiki.ubuntu.com/EncryptedPrivateDirectory</a></div>
</li>
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="http://bodhizazen.net/Tutorials/Ecryptfs/" class="urlextern" title="http://bodhizazen.net/Tutorials/Ecryptfs/" rel="nofollow">http://bodhizazen.net/Tutorials/Ecryptfs/</a></div>
</li>
<li class="level1"><div class="li"> <strong>(fr)</strong> <a href="http://blog.rom1v.com/2010/05/chiffrer-son-dossier-personnel-home-sous-ubuntu/" class="urlextern" title="http://blog.rom1v.com/2010/05/chiffrer-son-dossier-personnel-home-sous-ubuntu/" rel="nofollow">Chiffrer son dossier personnel (/home) sous Ubuntu (®om&#039;s blog)</a></div>
</li>
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="https://bugs.launchpad.net/ecryptfs" class="urlextern" title="https://bugs.launchpad.net/ecryptfs" rel="nofollow">Anomalies connues</a></div>
</li>
<li class="level1"><div class="li"> <strong>(fr)</strong> <a href="https://kb-fr.sandisk.com/app/answers/detail/a_id/8251/~/page-dinformations-et-de-t%C3%A9l%C3%A9chargement-de-secureaccess-3.0" class="urlextern" title="https://kb-fr.sandisk.com/app/answers/detail/a_id/8251/~/page-dinformations-et-de-t%C3%A9l%C3%A9chargement-de-secureaccess-3.0" rel="nofollow">Ubuntu encore oublié par un grand fabriquant de matériel </a></div>
</li>
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="https://askubuntu.com/questions/659242/problem-with-ecryptfs-recover-private-mount2-failed~" class="urlextern" title="https://askubuntu.com/questions/659242/problem-with-ecryptfs-recover-private-mount2-failed~" rel="nofollow">Erreur mount avec ecryptfs-recover-private</a></div>
</li>
<li class="level1"><div class="li"> <strong>(en)</strong> <a href="https://bugs.launchpad.net/ubuntu/+source/ecryptfs-utils/+bug/1718658" class="urlextern" title="https://bugs.launchpad.net/ubuntu/+source/ecryptfs-utils/+bug/1718658" rel="nofollow">La commande ecryptfs-mount-private échoue à initialiser les clés ecryptfs</a></div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_21'><form class="button btn_secedit form-inline" method="post" action="/ecryptfs"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1623521247" /><input type="hidden" name="summary" value="[Fil de discussion associé] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="fil_de_discussion_associe" /><input type="hidden" name="codeblockOffset" value="29" /><input type="hidden" name="range" value="19994-" /><button type="submit" title="Fil de discussion associé" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="ecryptfs.txt">ecryptfs.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 12/06/2021, 20:07">Le 12/06/2021, 20:07</span></li><li class="text-muted">par zococo</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=ecryptfs&amp;1635549416" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
