<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>utilisateurs:ubuntu18a:partition_de_donnees [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="disque dur,partitions"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/utilisateurs/ubuntu18a/partition_de_donnees?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns=utilisateurs:ubuntu18a"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/utilisateurs/ubuntu18a/partition_de_donnees"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/utilisateurs/ubuntu18a/partition_de_donnees"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/utilisateurs/ubuntu18a/partition_de_donnees"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='utilisateurs:ubuntu18a';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"utilisateurs:ubuntu18a:partition_de_donnees","namespace":"utilisateurs:ubuntu18a","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="utilisateurs:ubuntu18a:partition_de_donnees">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=media&amp;ns=utilisateurs%3Aubuntu18a"  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Afficher le texte source [V]">Modifier cette page</a></li><li><a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">utilisateurs:ubuntu18a:partition_de_donnees</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=edit"  class="action text-muted source" accesskey="v" rel="nofollow" title="Afficher le texte source [V]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/utilisateurs/ubuntu18a/partition_de_donnees?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#creation_des_partitions","title":"Cr\u00e9ation des partitions","level":1},{"link":"#monter_la_partition_automatiquement_au_demarrage_d_ubuntu","title":"Monter la partition automatiquement au d\u00e9marrage d'Ubuntu","level":1},{"link":"#soit_montage_a_partir_du_label_de_la_partition","title":"Soit montage \u00e0 partir du label de la partition.","level":2},{"link":"#soit_montage_a_partir_du_nom_de_la_partition","title":"Soit montage \u00e0 partir du nom de la  partition.","level":2},{"link":"#creer_les_repertoires_pour_les_utilisateurs_de_ubuntu","title":"Cr\u00e9er les r\u00e9pertoires pour les utilisateurs de ubuntu","level":1},{"link":"#raccourci_vers_les_dossiers_du_dossier_personnel","title":"Raccourci vers les dossiers du Dossier Personnel","level":1},{"link":"#installation_de_liens_par_l_afficheur_du_bureau","title":"Installation de liens par  l'afficheur du bureau","level":2},{"link":"#installation_de_liens_chez_l_utilisateur","title":"Installation de liens chez l'utilisateur","level":2},{"link":"#installation_de_liens_dans_l_os_de_base","title":"Installation de liens dans l'O.S. de base","level":2}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#creation_des_partitions">Création des partitions</a></li>
<li class="level1"><a href="#monter_la_partition_automatiquement_au_demarrage_d_ubuntu">Monter la partition automatiquement au démarrage d&#039;Ubuntu</a>
<ul class="nav toc">
<li class="level2"><a href="#soit_montage_a_partir_du_label_de_la_partition">Soit montage à partir du label de la partition.</a></li>
<li class="level2"><a href="#soit_montage_a_partir_du_nom_de_la_partition">Soit montage à partir du nom de la  partition.</a></li>
</ul>
</li>
<li class="level1"><a href="#creer_les_repertoires_pour_les_utilisateurs_de_ubuntu">Créer les répertoires pour les utilisateurs de ubuntu</a></li>
<li class="level1"><a href="#raccourci_vers_les_dossiers_du_dossier_personnel">Raccourci vers les dossiers du Dossier Personnel</a>
<ul class="nav toc">
<li class="level2"><a href="#installation_de_liens_par_l_afficheur_du_bureau">Installation de liens par  l&#039;afficheur du bureau</a></li>
<li class="level2"><a href="#installation_de_liens_chez_l_utilisateur">Installation de liens chez l&#039;utilisateur</a></li>
<li class="level2"><a href="#installation_de_liens_dans_l_os_de_base">Installation de liens dans l&#039;O.S. de base</a></li>
</ul></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content">
<p>
Début de création d&#039;une page de documentation
</p>
<div class="noteimportant">D&#039;abord sachez que je n&#039;ai rien compris à la logique expliquée pour créer une page dans la documentation.
Mon astuce: Dans une application de l&#039;ordinateur, j&#039;écris intégralement le nom  que je colle dans google…
Par exemple 
<strong><a href="https://doc.ubuntu-fr.org/utilisateurs/ubuntu18a/partition_de_donn" class="urlextern" title="https://doc.ubuntu-fr.org/utilisateurs/ubuntu18a/partition_de_donn" rel="nofollow">https://doc.ubuntu-fr.org/utilisateurs/ubuntu18a/partition_de_donn</a>ées</strong>. 
Cela ouvre une grille de saisie.
<p>
A priori, il faut alors cliquer sur l&#039;enveloppe qui est en haut à droite .
cela semble marcher…
</p>

</div><div class="notewarning">J&#039;attend une semaine avant de mettre des données au cas où la page serait éphémère et disparaitrait sans préavis â la fin du mois.
</div><div class="notetip">J&#039;espère que vous pourrez accéder à ce document pour contribuer à son élaboration puis â sa maintenance.
</div>
<p>
<em class="u"></em><em class="u"></em><em class="u"></em><em class="u"></em>__
</p>
<div class="tags"><span>
	<a href="/disque_dur" class="wikilink1" title="disque_dur" rel="tag">disque dur</a>,
	<a href="/partitions" class="wikilink1" title="partitions" rel="tag">partitions</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="creation_d_une_partition_de_donnees_personnelles_sous_ubuntu">Création d&#039;une partition de données personnelles sous  Ubuntu</h1>
<div class="level1">

<p>
Souvent les ordinateurs portables sont équipés d&#039;un SSD de petite taille et d&#039;un disque dur de taille conséquente. Une des difficultés que l&#039;on rencontre est l&#039;obligation de mettre  /home sur le disque dur.  Cela oblige à faire une installation non automatique et à avoir une perte de performance pour l&#039;accès aux fichiers de paramétrage et de cache des diverses applications.
Il semble plus simple de laisser faire une installation totalement standard sur le SSD puis de fabriquer le plus rapidement possible une partition dédiée aux données personnelles sur le disque dur.
</p>

<p>
Ce tutoriel décrit la marche à suivre pour mettre ses données personnelles sur le disque dur.
</p>

<p>
Pour simplifier notre approche, nous décrirons le processus pour un seul utilisateur. S&#039;il y a plusieurs utilisateurs sur le système, il suffit  de rejouer le scénario  à chaque ajout d&#039;utilisateur.
</p>

</div>

<h2 class="sectionedit2 page-header" id="creation_des_partitions">Création des partitions</h2>
<div class="level2">

<p>
Il faut donc créer une partition <strong>sur le disque dur</strong>, que nous appellerons <strong>Commun1</strong>, par convention. Pour cela il suffit d&#039;utiliser <a href="/gparted" class="wikilink1" title="gparted">gparted</a>, De créer au besoin une table de partition puis  une partition (par exemple au format ext4)  et lui donner l&#039;étiquette <strong>Commun1</strong>.<br/>

</p>

</div>

<h2 class="sectionedit3 page-header" id="monter_la_partition_automatiquement_au_demarrage_d_ubuntu">Monter la partition automatiquement au démarrage d&#039;Ubuntu</h2>
<div class="level2">

<p>
La partition doit être montée automatiquement au démarrage. Le fichier <strong>/etc/fstab</strong> doit  être modifié. Il est possible de le faire en ligne de commandes. Ces commandes ne sont plus à refaire. La partition sera automatiquement montée au prochain boot. 
</p>

</div>

<h3 class="sectionedit4" id="soit_montage_a_partir_du_label_de_la_partition">Soit montage à partir du label de la partition.</h3>
<div class="level3">

<p>
Il est possible de monter une partition des disques internes en utilisant le label comme référence. Il y a une unicité garantie puisque ubuntu refuse de mettre en route lorsque  deux partitions  sur des disques internes  ont un label identique.
</p>
<pre class="code">##  Cette séquence fabrique le point de montage, met à jour le fichier /etc/fstab et monte la partition.
##  Il est nécessaire de définir les deux paramètres suivants:
LABEL=Commun1         ##### Il  faut renseigner la valeur LABEL par le label qui a été mis lors du formatage.
MOUNTPOINT=/$LABEL    #### Le point de montage est à définir.   Le mettre directement dans la partition racine est possible. Pour ceux qui souhaitent le mettre ailleurs, il faut alors préciser le point de montage.
   
sudo mkdir $MOUNTPOINT
echo &quot;LABEL=$LABEL   $MOUNTPOINT ext4 defaults  0   2 &quot; | sudo tee -a /etc/fstab
sudo mount -L $LABEL
tail -2 /etc/fstab  
 </pre>

</div>

<h3 class="sectionedit5" id="soit_montage_a_partir_du_nom_de_la_partition">Soit montage à partir du nom de la  partition.</h3>
<div class="level3">

<p>
Il n&#039;est pas possible de monter une partition des disques internes en utilisant le nom  comme référence. Bien qu&#039;il soit unique, le numéro final est fluctuant et peut changer lors de renumérotation ( <strong>sgdisk -s</strong>) . Il est donc nécessaire d&#039;utiliser le UUID qui est unique. 
</p>
<pre class="code">##  Cette séquence fabrique le point de montage, met à jour le fichier /etc/fstab et monte la partition.
##  Il est nécessaire de définir les deux paramètres suivants:
DISK=sdXN   ##### Il  faut renseigner la valeur DISK par le nom de la partition qui a été créée lors du formatage.
MOUNTPOINT=$(echo /$DISK | tr &#039;[:lower:]&#039; &#039;[:upper:]&#039;)    ###Le point de montage est à définir.   Le mettre directement dans la partition racine est possible. Pour ceux qui souhaitent le mettre ailleurs, il faut alors préciser le point de montage. 
   
sudo mkdir $MOUNTPOINT
echo &quot;UUID=$(lsblk -n -o uuid /dev/$DISK)     $MOUNTPOINT  ext4  defaults,errors=remount-ro  0 2&quot; | sudo tee -a  /etc/fstab
sudo mount -v /dev/$DISK
tail -2 /etc/fstab </pre>

</div>

<h2 class="sectionedit6 page-header" id="creer_les_repertoires_pour_les_utilisateurs_de_ubuntu">Créer les répertoires pour les utilisateurs de ubuntu</h2>
<div class="level2">

<p>
Lorsqu&#039;il a plusieurs utilisateurs, il peuvent avoir chacun leur propre partition. Ils peuvent aussi stocker leur données dans une partition commune. Chacun ayant un sous-répertoire personnel. Quelque que soit  la méthode retenue pour la fabrication des liens, il est nécessaire de fabriquer un point d&#039;entrée par utilisateur. Cette fabrication nécessite d&#039;avoir des droits administrateur.
Or, tous les utilisateurs ne sont pas obligatoirement administrateur.  La séquence de fabrication du point d&#039;entrée est isolée du déplacement des données. 
La séquence de création d&#039;un utilisateur est décrite en ligne de commande :
</p>
<pre class="code">## Création des répertoires des utilisateurs.  Il peut y avoir plusieurs utilisateurs dans une même partition.
##   Pré-requis. Ce script considère que tous les utilisateurs ont déjà été créés. Cependant il est possible d&#039;en créer d&#039;autres ultérieurement.
##  Création de l&#039;utilisateur principal
LABEL=Commun1  ##   OU   LABEL=SDXN   par exemple SDB1
MOUNTPOINT=/$LABEL
## Les deux commandes sont regroupées pour se prémunir d&#039;une erreur de frappe dans le mot de passe
sudo mkdir $MOUNTPOINT/$USER &amp;&amp; sudo chown $USER:$USER $MOUNTPOINT/$USER
##
## Création des autres utilisateurs:    Commande à faire autant de fois qu&#039;il y a d&#039;utilisateurs actuellement connus.
##                                      Commande à faire à chaque fois qu&#039;un nouvel utilisateur est créé.
sudo mkdir $MOUNTPOINT/Nom-D&#039;un-Utilisateur &amp;&amp; sudo chown Nom-D&#039;un-Utilisateur:Nom-D&#039;un-Utilisateur $MOUNTPOINT/Nom-D&#039;un-Utilisateur</pre>

</div>

<h2 class="sectionedit7 page-header" id="raccourci_vers_les_dossiers_du_dossier_personnel">Raccourci vers les dossiers du Dossier Personnel</h2>
<div class="level2">

<p>
Trois méthodes sont connues.   Elles seront toutes les trois décrites.
La première est à favoriser. Elle ne nécessite pas un reboot à chaque création d&#039;un nouvel utilisateur.
La seconde est basée sur des liens symboliques, Tout se passe chez l&#039;utilisateur. Mais les liens symboliques semblent ne pas très bien fonctionner avec les nouvelles applications.    La poubelle semble aussi ne pas très bien fonctionner.
La troisième est au niveau supérieur. Mais chaque ajout d&#039;utilisateur nécessite un reboot de l&#039;ordinateur pour prise en compte des modifications.
</p>

</div>

<h3 class="sectionedit8" id="installation_de_liens_par_l_afficheur_du_bureau">Installation de liens par  l&#039;afficheur du bureau</h3>
<div class="level3">

<p>
<strong>Chaque utilisateur est capable de réaliser le transfert de ses propres données.</strong>. Aucune commande en mode administratif n&#039;est nécessaire. Voici les commandes à faire 
</p>
<pre class="code">##Prérequis à l&#039;exécution du déplacement des données
##     Avoir créé  et monté une partition ext4 avec une étiquette Commun1
##     Avoir créé le point d&#039;entrée de l&#039;utilisateur
##     Avoir fermé ses applications afin que les fichiers puissent être déplacés.
##
LABEL=Commun1        
MOUNTPOINT=/$LABEL  
##
## Cette séquence transfère automatiquement les données de l&#039;utilisateur.
##
for i  in  Bureau  Téléchargements Modèles Public  Documents  Musique  Images  Vidéos          
do
    echo &quot; &quot; &amp;&amp; echo &quot; Début de déplacement des données existantes de  $i&quot; &amp;&amp;    sleep 5  
    mv -iuv  /home/$USER/$i $MOUNTPOINT/$USER  
done
## liste  pour vérifier
   ls  -ls /home/$USER
   ls  -ls $MOUNTPOINT/$USER
   </pre>

<p>
Ces commandes ne traitent pas les erreurs du style manque de place disque, répertoires ou fichiers déjà existants.
</p>

<p>
Il faut traiter ces situations manuellement.
</p>

<p>
Il faut s&#039;assurer que les répertoires entrées ont bien été supprimés avant de passer à la suite.
</p>

<p>
En pratique, il n&#039;y a pas d&#039;erreur lorsque l&#039;installation est récente. Cependant, cela peut arriver.  Donc la suite n&#039;est  pas enchaînée automatiquement afin de permettre à l&#039;utilisateur de finir le travail.
</p>

<p>
Lorsque les huit répertoires  sont enfin vides et supprimés, il faut prévenir l&#039;affichage du bureau pour prise en compte.
</p>

<p>
Cela se fera encore en ligne de commandes.
</p>
<pre class="code"> ## Mise à jour du fichier de directives de l&#039;utilisateur
if [ -f &quot;/home/$USER/.config/user-dirs.dirs.SAVE&quot; ]
   then
        echo &quot;sécurité déjà faite&quot;
   else
        cp -v /home/$USER/user-dirs.dirs  /home/$USER/user-dirs.dirs.SAVE
fi
##sed &#039;/^XDG_/d&#039; /home/$USER/.config/user-dirs.dirs &gt;   fichier.tmp  &amp;&amp; mv -f fichier.tmp /home/$USER/.config/user-dirs.dirs
xdg-user-dirs-update --set DESKTOP     $MOUNTPOINT/$USER/Bureau
xdg-user-dirs-update --set DOCUMENTS   $MOUNTPOINT/$USER/Documents
xdg-user-dirs-update --set PICTURES    $MOUNTPOINT/$USER/Images
xdg-user-dirs-update --set TEMPLATES   $MOUNTPOINT/$USER/Modèles
xdg-user-dirs-update --set MUSIC       $MOUNTPOINT/$USER/Musique
xdg-user-dirs-update --set PUBLICSHARE $MOUNTPOINT/$USER/Public
xdg-user-dirs-update --set DOWNLOAD    $MOUNTPOINT/$USER/Téléchargements
xdg-user-dirs-update --set VIDEOS      $MOUNTPOINT/$USER/Vidéos
xdg-user-dirs-gtk-update
cat /home/$USER/.config/user-dirs.dirs</pre>

<p>
Il ne reste plus qu&#039;à changer d&#039;utilisateur pour prise en charge. Il faut fermer la session et en ouvrir une nouvelle.    Il est aussi possible de faire cette commande  <strong>sudo skill -KILL -u $USER </strong>  pour une exécution immédiate.
</p>

</div>

<h3 class="sectionedit9" id="installation_de_liens_chez_l_utilisateur">Installation de liens chez l&#039;utilisateur</h3>
<div class="level3">

<p>
La technique décrite précédemment est parfaite. Elle traite huit dossiers classiques.   Elle supprime les dossiers du répertoire <strong>home</strong>. Cela peut se révéler déstabilisant pour la référence officielle qui a acté que c&#039;était toujours présent dans <strong>/home</strong>. Cependant elle permet d&#039;accéder directement aux données sans avoir besoin de consulter la partition /home . C&#039;est donc plus performant.
</p>

<p>
Elle ne traite pas d&#039;autres dossiers que certaines applications  installent discrètement en standard  dans le répertoire /home.
</p>

<p>
Dans l&#039;ensemble, ces applications ont souvent une séquence d&#039;initialisation qui aurait pu demander le lieu de stockage des données. 
</p>

<p>
La résolution du problème passe par la création de  <a href="https://doc.ubuntu-fr.org/lien_physique_et_symbolique" class="urlextern" title="https://doc.ubuntu-fr.org/lien_physique_et_symbolique" rel="nofollow">liens symboliques</a>
Cette technique est aussi valable pour les huit répertoires traités plus haut. Elle semble simple. Cependant les liens logiques peuvent dysfonctionner pour certaines applications.
Les applications thunderbird et mozilla sont susceptibles d&#039;être candidates à ce style de déplacement.
</p>

<p>
<strong>Chaque utilisateur pourra déplacer ses propres données.</strong>
</p>

<p>
Ce déplacement se fera en ligne de commandes. A titre d&#039;exemple:
</p>
<pre class="code">LABEL=Commun1
MOUNTPOINT=/$LABEL
## Recopie des données de l&#039;utilisateur.
for i   in    .thunderbird   .mozilla    #######  Bureau  Téléchargements    Modèles  Public  Documents  Musique  Images  Vidéos    
do
   #Vérifions la présence d&#039;un lien symbolique identique à celui qu&#039;on veut créer
    ls -ls /home/$USER/$i &gt;$HOME/FIC.tmp  
    if grep -q &quot;&gt; $MOUNTPOINT/$USER/$1&quot; $HOME/FIC.tmp 
       then
           echo &quot;Le traitement  est déjà fait pour $i&quot;    
       else   
           echo &quot; &quot; &amp;&amp; echo &quot; Début de déplacement des données existantes de  $i&quot; &amp;&amp;    sleep 5  
           mv -iu  /home/$USER/$i $MOUNTPOINT/$USER  
           sudo ln -s $MOUNTPOINT/$USER/$i  /home/$USER     
    fi
done
## liste  pour vérifier
ls -als /home/$USER | grep lrwx
ls -als $MOUNTPOINT/$USER</pre>

<p>
Les risques d&#039;erreurs et les rectifications sont identiques au contexte précédant. 
</p>

<p>
<strong>Un utilisateur pourra demander à un administrateur de déplacer  ses  données.</strong>
</p>

<p>
Ce déplacement se fera en ligne de commandes. A titre d&#039;exemple:
</p>
<pre class="code">LABEL=Commun1
MOUNTPOINT=/$LABEL
UTILISATEUR=NomDeL&#039;Utiliseur
## Recopie des données de l&#039;utilisateur.
for i  in   .thunderbird   .mozilla ##### Bureau  Téléchargements    Modèles  Public  Documents  Musique  Images  Vidéos    
do
    #Vérifions la présence d&#039;un lien symbolique identique à celui qu&#039;on veut créer
    ls -ls /home/$UTILISATEUR/$i &gt;$HOME/FIC.tmp  
    if grep -q &quot;&gt; $MOUNTPOINT/$UTILISATEUR/$1&quot; $HOME/FIC.tmp 
       then
              echo &quot;Le traitement  est déjà fait pour $i&quot;    
        else   
              echo &quot; &quot; &amp;&amp; echo &quot; Début de déplacement des données existantes de  $i&quot; &amp;&amp;    sleep 5  
              sudo mv -iu  /home/$UTILISATEUR/$i $MOUNTPOINT/$UTILISATEUR  
              sudo chown $UTILISATEUR:$UTILISATEUR -Rv $MOUNTPOINT/$UTILISATEUR/$i 
              sudo ln -s $MOUNTPOINT/$UTILISATEUR/$i  /home/$UTILISATEUR     
     fi
done
## liste  pour vérifier
ls -als /home/$UTILISATEUR | grep lrwx
ls -als $MOUNTPOINT/$UTILISATEUR </pre>

<p>
Les risques d&#039;erreurs et les rectifications sont identiques au contexte précédant.
</p>

</div>

<h3 class="sectionedit10" id="installation_de_liens_dans_l_os_de_base">Installation de liens dans l&#039;O.S. de base</h3>
<div class="level3">

<p>
Ce traitement ne peut se faire qu&#039;en mode administration. L&#039;ordinateur doit être relancé pour prise en compte des modifications effectuées dans le fichier /etc/fstab. L&#039;administrateur peut aussi se définir dans la liste de déplacement.
</p>

<p>
Voici les commandes à faire:
</p>
<pre class="code">##Prérequis à l&#039;exécution du déplacement des données.
##     Avoir créé  et monté une partition ext4 avec une étiquette Commun1.
##     Avoir créé le point d&#039;entrée de l&#039;utilisateur.
##     Avoir fermé ses applications afin que les fichiers puissent être déplacés.
##
# Chemin du Disque de Données, qu&#039;on a fait en point de montage dans /etc/fstab
PARTNAME=Commun1          # C&#039;est le label du disque
MOUNTPOINT=/$PARTNAME     # C&#039;est le point de montage de la partition. Il peut être modifié si ce choix ne convient pas.
#
# Liste des Utilisateurs à qui créer les Liens. Remplacer les nom_de_XX_utilisateur par les bons noms d&#039;utilisateurs.
#             Faire autant de lignes que d&#039;utilisateurs requis (ils doivent déjà être créés et exister dans /home !!)
UTILISATEUR[0]=&#039;nom_de_premier_utilisateur&#039;
UTILISATEUR[1]=&#039;nom_de_deuxieme_utilisateur&#039;
UTILISATEUR[2]=&#039;nom_de_troisieme_utilisateur&#039;
UTILISATEUR[3]=&#039;nom_de_quatrieme_utilisateur&#039;
#
# Liste des Liens à Créer
tabFolder[0]=&#039;Bureau&#039;
tabFolder[1]=&#039;Documents&#039;
tabFolder[2]=&#039;Images&#039;
tabFolder[3]=&#039;Modèles&#039;
tabFolder[4]=&#039;Musique&#039;
tabFolder[5]=&#039;Public&#039;
tabFolder[6]=&#039;Téléchargements&#039;
tabFolder[7]=&#039;Vidéos&#039;
tabFolder[8]=&#039;.mozilla&#039;       ##### C&#039;est selon le choix. Il faut aussi que cette application ait fonctionné chez les utilisateurs.
tabFolder[9]=&#039;.thunderbird&#039;   ##### C&#039;est selon le choix. Il faut aussi que cette application ait fonctionné chez les utilisateurs.

# Boucle pour passer dans chaque UTILISATEUR.
for i in ${!UTILISATEUR[@]}
do 
    # se mettre dans le dossier personnel de l&#039;utilisateur.
    echo &quot;Début de traitement pour ${UTILISATEUR[i]}&quot;    
    # boucle pour  faire tous les liens de cet utilisateur.
    for j in ${!tabFolder[@]}
    do
        #Vérifions la présence d&#039;un lien symbolique identique à celui qu&#039;on veut créer. 
        if grep -q &quot;$MOUNTPOINT/${UTILISATEUR[i]}/${tabFolder[j]}&quot; /etc/fstab
            then     echo &quot;Le traitement  est déjà fait pour ${tabFolder[j]}&quot;    
        else   
            echo &quot; &quot; &amp;&amp; echo &quot;Début de déplacement des données existantes de  ${tabFolder[j]}&quot; &amp;&amp;    sleep 5 
            sudo mkdir -v $MOUNTPOINT/${UTILISATEUR[i]}/${tabFolder[j]} 
            if [ -d &quot;$MOUNTPOINT/${UTILISATEUR[i]}/${tabFolder[j]}&quot; ]
            then      
                 sudo mv -iuv  /home/${UTILISATEUR[i]}/${tabFolder[j]} $MOUNTPOINT/${UTILISATEUR[i]} 
                 sudo mkdir -v /home/${UTILISATEUR[i]}/${tabFolder[j]}
                 if [ -d &quot;/home/${UTILISATEUR[i]}/${tabFolder[j]}&quot; ]
                 then  
                       sudo chown ${UTILISATEUR[i]}:${UTILISATEUR[i]}  $MOUNTPOINT/${UTILISATEUR[i]}/${tabFolder[j]}
                       echo &quot;$MOUNTPOINT/${UTILISATEUR[i]}/${tabFolder[j]}   /home/${UTILISATEUR[i]}/${tabFolder[j]} none bind &quot; | sudo tee -a /etc/fstab
                 else
                       echo &quot;Probablement encore des fichiers dans le répertoire /home/${UTILISATEUR[i]}/${tabFolder[j]}&quot;
                 fi
            else
                echo &quot;Erreur de création du répertoire $MOUNTPOINT/${UTILISATEUR[i]}/${tabFolder[j]}&quot;
            fi
         fi
    done
done
## listons la référence.
cat /etc/fstab</pre>

<p>
 Ces commandes tentent de faire certains contrôles afin de permettre de relancer après correction.
</p>

<p>
<strong>Il est nécessaire de rebooter afin de prendre en compte cette liaison au niveau O.S.</strong>
 Cela va permettre de faire fonctionner immédiatement la corbeille. Cependant, plein de points de montage seront affichés.
</p>

</div>

</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="utilisateurs/ubuntu18a/partition_de_donnees.txt">utilisateurs/ubuntu18a/partition_de_donnees.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 28/09/2019, 14:30">Le 28/09/2019, 14:30</span></li><li class="text-muted">par Theon</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=utilisateurs%3Aubuntu18a%3Apartition_de_donnees&amp;1635535797" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
