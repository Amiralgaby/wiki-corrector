====== Conversion en série avec Avidemux ======
<note>Conversion en série dénommée aussi "batch" dans les systèmes basés sur MS-DOS/MS-WINDOWS, ou dite scriptée, en console, pour les systèmes basés sur UNIX/LINUX</note>

Cette méthode vous permettra de traiter toutes sortes de travaux animées, surtout des feuilletons pour laquelle elle a été développée, une fois la commande lancée, vous ne vous en occupez plus !

===== Prérequis =====
  * Comprendre un peu l'anglais technique des vidéastes (bitrate & cie)
  * Avoir installé et compris comment utiliser [[:avidemux|Avidemux]]
  * [[:tutoriel:comment_modifier_un_fichier|Savoir comment éditer et/ou créer des fichiers scripts]]
  * Avoir une bonne idée de l'[[:arborescence|arborescence de votre Dossier Personnel]]
  * ??

===== Créer un fichier projet Avidemux =====
<note important>La méthode utilise Avidemux Appimage 2.8.1</note>

  * Créer un lien symbolique avidemux appimage vers le dossier des videos à traiter, ou dans un dossier facilement accessible (en général dans /home/nom_utilisateur/application…)
  * Lancer avidemux par ce lien symbolique ou par son raccourci bureau
  * Charger la première video à traiter (numéroter les de 1 à … 100 … ou davantage)
  * Faîtes tous les réglages nécessaires de conversion pour cette video que vous voulez voir appliquer à toute la série
  * Enregistrer ces réglages dans un projet, donner un nom facile à utiliser, garder absolument l'extension .py du fichier projet qui sera une partie de votre fichier script
  * Éditer ce fichier projet script .py pour désactiver les lignes suivantes avec un # (les "…" sont des données anonymisées) :
<code>
#if not adm.loadVideo("…"):
#    raise("Cannot load …")
#adm.clearSegments()
#adm.addSegment(0, 80000, 2665252000)
#adm.markerA = 0
#adm.markerB = 2665252000
</code>

===== Commande script qui lance la série de conversion =====
<note>La méthode utilise une boucle "For var in {debut%…fin%}; do …; done" et appelle l'interface Avidemux automatiquement avec les bons réglages de conversion. L'écart numérique "debut%…fin%" peut être aussi longue que nécessaire, ou contenir seulement certains éléments séparés par une virgule.</note>
<note important>Il est impératif d'utiliser uniquement des chemins absolus, et non relatifs, losque avidemux se lance il considère tous les appels de fichiers relatifs à sa localisation d'exécution et non à son raccourci de bureau ou à un lien symbolique.</note>

<code>for i in {debut%..fin%}; do /home/nom_utilisateur/avidemux/avidemux --video-codec "label du codec video dans Avidemux" --audio-codec "label du codec audio dans Avidemux" --force-alt-h264 --load "/emplacement/dossier_videos/"$i.format_conteneur --run /emplacement/dossier_script/nom_projet_script.py --save "/emplacement/dossier_videos/"$i.nouveau_format_conteneur --quit; done</code>

  * **format_conteneur** et **nouveau_format_conteneur** sont en général ce que vous avez et ce vous allez obtenir : par exemple de **videos .avi** vers **.mp4**, ou de **.mkv** vers **.mp4** (le conteneur **.mp4/x264** est pour le moment le meilleur rapport compression/qualité)
  * les labels des codecs video et audio sont ceux qui s'affichent dans les réglages d'Avidemux
  * l'option --run permet de lancer avidemux avec les réglages de conversion désirés
  * --load et --save indique les emplacements des videos à traiter et à enregistrer
  * --quit (re)ferme Avidemux à la fin de chaque traitement de chaque fichier video (c'est une boucle de traitement)
  * --force-alt-h264 , à utiliser absolument avec les contenus h264/x264, hvec/x265 (avi, mp4, mkv)

===== Exemples … =====
==== Simple conversion de mkv à mp4 ====
Le mkv n'est pas de facto le format accepté des appareils connectés, le mp4 l'est (merci mr Pomme) ...

Cette simple conversion ne fonctionne correctement que sous les conditions suivantes :
  * la piste vidéo est déja encodée en h264/x264 ou en x265
  * la piste audio est en aac
  * les deux pistes sont correctemeent entrelacées avec l'index qui va bien

<note tip>Pour le savoir, foin d'un utilitaire spécial, regardez la vidéo mkv avec [[:totem|Totem]] : si vous n'avez que le son et aucune image correct, ou ni son ni image, vous devrez ré-encoder le flux vidéo, lisez le second exemple pour cela.</note>

Puisque tout est ok, poursuivez …

  * Lancez Avidemux
  * Chargez la première vidéo de votre série
  * Réglez les sorties vidéo et audio en mode **Copy**
  * Choisissez le type de mélangeur MP4, **MP4 Muxer** ou **MP4v2 Muxer**
  * Ne modifiez aucun des réglages des mélangeurs pour le moment
  * Enregistrez les réglages dans un fichier **Projet** → 

==== Conversion avec re-encodage du flux video ====

à suivre…