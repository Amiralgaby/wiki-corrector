<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>utilisateurs:aldian:programme_formatage_portail_lignes_commandes [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="utilisateurs,aldian,programme formatage portail lignes commandes"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns=utilisateurs:aldian"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/utilisateurs/aldian/programme_formatage_portail_lignes_commandes"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/utilisateurs/aldian/programme_formatage_portail_lignes_commandes"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/utilisateurs/aldian/programme_formatage_portail_lignes_commandes"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='utilisateurs:aldian';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"utilisateurs:aldian:programme_formatage_portail_lignes_commandes","namespace":"utilisateurs:aldian","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="utilisateurs:aldian:programme_formatage_portail_lignes_commandes">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=media&amp;ns=utilisateurs%3Aaldian"  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Afficher le texte source [V]">Modifier cette page</a></li><li><a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">utilisateurs:aldian:programme_formatage_portail_lignes_commandes</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=edit"  class="action text-muted source" accesskey="v" rel="nofollow" title="Afficher le texte source [V]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/utilisateurs/aldian/programme_formatage_portail_lignes_commandes?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"></div><!-- CONTENT --><div class="dw-content">
<h1 class="sectionedit1 page-header" id="programme_de_formatage_de_la_page_portail_sur_les_lignes_de_commandes">Programme de formatage de la page portail sur les lignes de commandes</h1>
<div class="level1">

<p>
En relation avec la rédaction en cours de la page <a href="/portail_lignes_commandes" class="wikilink1" title="portail_lignes_commandes">portail lignes de commande</a> qui est en projet, et avec la page <a href="/utilisateurs/aldian/participer_portail_lignes_commandes" class="wikilink1" title="utilisateurs:aldian:participer_portail_lignes_commandes">participer au portail sur les lignes de commandes</a> qui vient en appoint pour décharger les contributeurs de la lourde tache du formatage, un programme java a été créé pour générer automatiquement le formatage. Le programme est particulièrement long (400 lignes), mais il a été conçu dans l&#039;optique de la fiabilité et de l&#039;ergonomie. Et plus un programme est ergonomique, plus il est long ;).
</p>

</div>

<h2 class="sectionedit2 page-header" id="utilisation">Utilisation</h2>
<div class="level2">

<p>
Copiez-collez le code source dans un fichier texte que vous nommerez &quot;CommandArray.java&quot;. Vous avez besoin d&#039;avoir installé le paquet <a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">gcj</a> pour pouvoir compiler du java en ligne de commande.
</p>

<p>
Compilez le programme avec la commande suivante:
</p>
<pre class="code">javac CommandArray.java</pre>

<p>
Ensuite en admettant que vous ayez copié collé tous les modèles renseignés de la page <a href="/utilisateurs/aldian/participer_portail_lignes_commandes" class="wikilink1" title="utilisateurs:aldian:participer_portail_lignes_commandes">participer au portail sur les lignes de commandes</a> dans un fichier nommé commandes.txt, exécutez la commande: 
</p>
<pre class="code">java CommandArray commandes.txt</pre>

<p>
 Le résultat s&#039;affiche à l&#039;écran et est stocké dans le fichier commandes.txt_format.txt
</p>

</div>

<h2 class="sectionedit3 page-header" id="le_code_source">Le code source</h2>
<div class="level2">

<p>
Ce code source est en version 0.1.1. Il n&#039;a pas encore été beaucoup testé et pourra être sujet à modifications.
</p>
<pre class="code">/*   CommandArray: This program create the formating for the page 
 *   portail_lignes_de_commande of site http://doc.ubuntu-fr.org/
 *  
 *   Copyright (C) 2009  Aldian (Administrator of Ubuntu French Documentation)
 *
 *   This program is free software: you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation, either version 3 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 * 
 */

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.LinkedList;


/**
 * @author Aldian (Administrator of Ubuntu French Documentation)
 * 
 * génère le formatage correspondant à l&#039;ensemble des commandes fournies dans le  
 * fichier passé en paramètre: 
 *  
 * paramètre obligatoire: nom du fichier 
 * le résultat est stocké dans le fichier NOM_FICHIER_format.txt 
 * le fichier source doit contenir au moins une fois le motif suivant: 
 *  
 * NOM: 
 * DESCRIPTION: 
 * LIEN_SYNOPSIS: 
 * LIEN: 
 * LIEN_MANPAGE: 
 * LIEN_FORUM: 
 *  
 * Le nombre de LIEN est indifférent. Une entrée valide doit contenir au moins 
 * une DESCRIPTION et un NOM. Si vous ne disposez pas par exemple du LIEN_MANPAGE, 
 * vous pouvez indifféremment mettre la ligne vide ou pas. 
 *
 */
public class CommandArray {
	protected static boolean DEBUG = true;
	String nom = null;
	String description = null;
	String lien_synopsys = null;
	LinkedList&lt;String&gt; liens = new LinkedList&lt;String&gt;();
	String lien_manpage = null;
	String lien_forum = null;
	
	public CommandArray(String nom, String description){
		this(nom);
		this.description= description;
	}
	private CommandArray(String nom){
		this.nom=nom;
	}

	/**
	 * Cette méthode ouvre les fichiers et s&#039;assure de l&#039;absence d&#039;erreurs à l&#039;ouverture.
	 * Le travail réel de gestion du formatage est sous traité à la fonction performFormat
	 * 
	 * @param args le nom du fichier à traiter
	 */
	public static void main(String[] args) {
		printLicense();
		BufferedReader in;
		BufferedWriter out;
		
		// check nombre arguments
		if(args.length!=1){
			printUsage();
			return;
		}
		
		// check help
		if(args[0].equals(&quot;-h&quot;) || args[0].equals(&quot;-help&quot;) || args[0].equals(&quot;-u&quot;) || args[0].equals(&quot;-usage&quot;)){
			printUsage();
			return;
		}
		
		// check ouverture fichier input
		try {
			in = new BufferedReader(new FileReader(args[0]));
		} catch (FileNotFoundException e) {
			println(&quot;erreur: nom de fichier incorrect: &quot;+args[0]);
			if(DEBUG)
				e.printStackTrace();
			return;
		}
		
		// check ouverture fichier output
		String outputFileName = args[0]+&quot;_format.txt&quot;;
		try {
			out = new BufferedWriter(new FileWriter(outputFileName));
		} catch (IOException e) {
			println(&quot;erreur: impossible de créer le fichier d&#039;output: &quot;+outputFileName);
			if(DEBUG)
				e.printStackTrace();
			return;
		}
		
		//exécution formatage
		println(&quot;formating content file: &quot;+args[0]+&quot; to file &quot;+outputFileName+&quot;...&quot;);
		try {
			performFormat(in, out);
		} catch (Exception e1) {
			println(&quot;Une erreur est survenue durant l&#039;exécution&quot;);
			if(DEBUG)
				e1.printStackTrace();
		}
		finally {
			// fermeture des flux
			try {
				in.close();
				out.close();
			} catch (IOException e) {
				println(&quot;Warning: une erreur est survenue pendant la fermeture des fichiers&quot;);
				if(DEBUG)
					e.printStackTrace();
			}
		}
		println(&quot;Le programme s&#039;est terminé sans erreurs&quot;);
	}
	
	/**
	 * Lit le fichier source, génère la liste des commandes, effectue le formatage, écrit le fichier de destination
	 * 
	 * @param in le buffer vers le fichier d&#039;entrée
	 * @param out le buffer vers le fichier de sortie
	 * @throws IOException
	 * @throws ParseException
	 */
	public static void performFormat(BufferedReader in,BufferedWriter out) throws IOException, ParseException{
		LinkedList&lt;CommandArray&gt; commandListe = readFile(in);
		
		
		//vérifications d&#039;intégrité
		if(!checkCommandListValidity(commandListe))
			return;
		
		/**
		 * A partir de maintenant on dispose d&#039;une liste d&#039;objets ayant au moins un nom et une description probablement valides.
		 * Les urls sont forcément correctement constituées.
		 */
		String formatedLine = null;
		for(int i=0;i&lt;commandListe.size();i++){
			formatedLine = makeFormattedLine(commandListe.get(i));
			out.write(formatedLine+&quot;\n&quot;);
			println(formatedLine);
		}
			
		
			
	}
	/************************************************
	 *           FONCTIONS DE FORMATAGE             *
	 ************************************************/
	
	/**
	 * Cette fonction crée le formatage pour une commande donnée
	 * 
	 * @param commandArray :  La commande à formatter
	 * @return ligne contenant le code formatée pour la commande donnée.
	 */
	public static String makeFormattedLine(CommandArray commandArray){
		StringBuilder result = new StringBuilder();
		int i;
		//String link = null;
		result.append(&quot;| &quot;);
		result.append(commandArray.description);
		result.append(&quot; | &quot;);
		result.append(makeDocLinkString(commandArray.lien_synopsys,commandArray.nom));
		result.append(&quot; | &quot;);
		if(commandArray.liens!=null){
			for(i=0;i&lt;commandArray.liens.size()-1;i++)
				result.append(makeUndiferrentiateLinkString(commandArray.liens.get(i),null)+&quot;, &quot;);
			result.append(makeUndiferrentiateLinkString(commandArray.liens.get(i),null));
		}
		result.append(&quot; | &quot;);
		result.append(makeExternLink(commandArray.lien_manpage,&quot;manpage&quot;));
		result.append(&quot; | &quot;);
		result.append(makeExternLink(commandArray.lien_forum,&quot;forum&quot;));
		result.append(&quot; |&quot;);

		return result.toString();
	}
	
	/**
	 * Appelle la méthode corespondante selon que le lien est interne ou externe à la documentation.
	 * 
	 * @param link lien à formatter
	 * @param nom du lien à formatter
	 * @return code correspondant au lien
	 */
	public static String makeUndiferrentiateLinkString(String link, String nom){
		if(link.indexOf(&quot;http://doc.ubuntu-fr.org&quot;)==-1)
			return makeExternLink(link,nom);
		else
			return makeDocLinkString(link,nom);
	}
	
	
	/**
	 * Crée le formattage pour un lien interne à la documentation. 
	 * Si le nom n&#039;est pas spécifié, un nom par défaut est généré.
	 * 
	 * @param link lien à formatter
	 * @param nom du lien à formatter
	 * @return code correspondant au lien
	 */
	public static String makeDocLinkString(String link, String nom){
		String result = null;
		URL url = null;
		String name = null;
		
		//si le champ correspondant n&#039;a pas été renseigné
		if(link==null)
			return &quot;&quot;;
		
		// devrait pas y avoir de problème
		try {url = new URL(link);} catch (MalformedURLException e) {return null;}
		
		//gestion du nom (si le nom donné est invalide, construit un nom par défaut
		if(nom!=null)
			if(checkValidity(nom))
				name=nom;
		if(name==null){
			name=url.getPath();
			int slash = name.lastIndexOf(&quot;/&quot;);
			if(slash!=-1){
				name=name.substring(slash+1);
			}
		}
		
		//gestion du chemin
		String path = url.getPath();
		char [] pathChar = path.toCharArray();
		for(int i=0;i&lt;pathChar.length;i++)
			if(pathChar[i]==&#039;/&#039;)
				pathChar[i]=&#039;:&#039;;
		path = new String(pathChar);
		
		//gestion de l&#039;ancre
		String ancre = url.getRef();
		if(ancre==null)
			ancre=&quot;&quot;;
		if(ancre.indexOf(&#039;?&#039;)!=-1){
			ancre=ancre.substring(0, ancre.indexOf(&#039;?&#039;)-1);
		}
		
		//construction de la représentation de la doc:
		result = &quot;[[&quot;+path;
		if(!ancre.equals(&quot;&quot;))
			result+=&quot;#&quot;+ancre;
		result+=&quot;|&quot;+name+&quot;]]&quot;;
		
		return result;
	}
	
	/**
	 * Crée le formattage pour un lien externe à la documentation.
	 * Si le nom est omis, un nom par défaut est généré.
	 * 
	 * @param link lien à formatter
	 * @param nom du lien à formatter
	 * @return code correspondant au lien
	 */
	public static String makeExternLink(String link,String nom){
		URL url = null;
		String name = null;
		
		//gestion du nom (si le nom donné est invalide, construit un nom par défaut
		if(nom!=null)
			if(checkValidity(nom))
				name=nom;
		if(name==null){
			try {url = new URL(link);} catch (MalformedURLException e) {return &quot;&quot;;}
			name=url.getPath();
			
			//élimine le chemin d&#039;accès
			int slash = name.lastIndexOf(&quot;/&quot;);
			if(slash!=-1){
				name=name.substring(slash+1);
			}
			
			//élimine l&#039;extension
			int dot = name.lastIndexOf(&quot;.&quot;);
			if(dot&gt;1){
				name=name.substring(0,dot);
			}
		}
		
		
		//si le champ correspondant n&#039;a pas été renseigné
		if(link==null)
			return &quot;&quot;;
		else
			return &quot;[[&quot;+link+&quot;|&quot;+name+&quot;]]&quot;;
	}
	
	
	/************************************************
	 *    FONCTIONS DE VERIFICATION DE VALIDITE     *
	 ************************************************/
	
	/**
	 * Vérifie l&#039;ensemble d&#039;une liste de commandes pour voir si elles sont acceptables et s&#039;il n&#039;y a pas d&#039;erreurs.
	 * En fait cette fonction fait plus qu&#039;un test, en effet les objets invalides sont retirés de la liste.
	 * 
	 * @param commandListe
	 * @return vrai si à l&#039;issue du test la liste contient au moins une commande valide, non sinon
	 */
	public static boolean checkCommandListValidity(LinkedList&lt;CommandArray&gt; commandListe){
		boolean  validity =  true;
		CommandArray commandArray=null;
		
		//taille
		if(commandListe.size()==0){
			println(&quot;erreur, pas d&#039;objet valide trouvé.&quot;);
			return false;
		}
		
		//validité objets
		for(int i=0;i&lt;commandListe.size();i++){
			commandArray=commandListe.get(i);
			if(!checkCommandValidity(commandArray)){
				debug(&quot;performFormat&quot;,&quot;warning, lien_forum {&quot;+commandArray.lien_forum+&quot;} incorrect &gt;&gt; Réinitialisé&quot;);
				commandListe.remove(commandArray);
			}
		}
		
		//taille
		if(commandListe.size()==0){
			println(&quot;erreur, pas d&#039;objet valide trouvé après check de validité.&quot;);
			return false;
		}
		
		return validity;
	}
	
	/**
	 * Vérifie la validité d&#039;une commande simple. La présence d&#039;un nom et d&#039;une description valide sont obligatoires pour avoir un résultat true.
	 * Les autres champs sont testés aussi, et en cas de problèmes, réinitialisés.
	 * 
	 * @param commandArray
	 * @return
	 */
	public static boolean checkCommandValidity(CommandArray commandArray){
		boolean result = true;
		String lien = null;
		if(!checkValidity(commandArray.nom)){
			result = false;
			debug(&quot;checkCommandValidity&quot;,&quot;erreur, nom {&quot;+commandArray.nom+&quot;} incorrect&quot;);
		}
		if(!checkValidity(commandArray.description)){
			result = false;
			debug(&quot;checkCommandValidity&quot;,&quot;erreur, description {&quot;+commandArray.description+&quot;} incorrect&quot;);
		}
		if(!checkLinkValidity(commandArray.lien_synopsys)){
			commandArray.lien_synopsys=null;
			debug(&quot;checkCommandValidity&quot;,&quot;warning, lien_synopsys {&quot;+commandArray.lien_synopsys+&quot;} incorrect &gt;&gt; Réinitialisé&quot;);
		}
		if(!checkLinkValidity(commandArray.lien_manpage)){
			commandArray.lien_manpage=null;
			debug(&quot;checkCommandValidity&quot;,&quot;warning, lien_manpage {&quot;+commandArray.lien_manpage+&quot;} incorrect &gt;&gt; Réinitialisé&quot;);
		}
		if(!checkLinkValidity(commandArray.lien_forum)){
			commandArray.lien_forum=null;
			debug(&quot;checkCommandValidity&quot;,&quot;warning, lien_forum {&quot;+commandArray.lien_forum+&quot;} incorrect &gt;&gt; Réinitialisé&quot;);
		}
		if(commandArray.liens.size()==0)
			commandArray.liens = null;
		else {
			for(int i=0;i&lt;commandArray.liens.size();i++){
				lien = commandArray.liens.get(i);
				if(!checkLinkValidity(lien)){
					debug(&quot;checkCommandValidity&quot;,&quot;warning, lien {&quot;+lien+&quot;} incorrect &gt;&gt; Réinitialisé&quot;);
					commandArray.liens.remove(lien);
				}
			}
			if(commandArray.liens.size()==0)
				commandArray.liens = null;
		}
		return result;
	}
	
	/**
	 * Teste la validité d&#039;une String suivant les critèrs suivants:
	 * Ne doit pas être nulle, ne doit pas être vide, mono caractère ou constituée seulement d&#039;espaces.
	 * A noter qu&#039;on ne s&#039;est pas donner la peine de tester proprement les espaces, 
	 * si vous voulez faire planter le programme mettez en un grand nombre.
	 * 
	 * @param arg la chaine à tester
	 * @return un booléen qui indique si la chaine est correcte ou non.
	 */
	public static boolean checkValidity(String arg){
		if(arg==null)
			return false;
		//pas envie de me prendre la tête à faire &quot;si ya que des espaces&quot; ;)
		if(arg.equals(&quot;&quot;) || arg.equals(&quot; &quot;) || arg.equals(&quot;  &quot;) || arg.equals(&quot;   &quot;))
			return false;
		if(arg.length()&lt;2)
			return false;
		return true;
	}
	
	/**
	 * Teste la validité d&#039;un lien de la manière suivante:
	 * Construit un objet URL basé sur ce lien. S&#039;il n&#039;y a pas de MalformedURLException, c&#039;est bon.
	 * 
	 * @param arg le lien à tester 
	 * @return un booléen qui indique si le lien est correct ou non.
	 */
	public static boolean checkLinkValidity(String arg){
		@SuppressWarnings(&quot;unused&quot;)
		URL url = null;
		try {
			url = new URL(arg);
		} catch (MalformedURLException e) {
			return false;
		}
		return true;
	}
	
	/************************************************
	 *    FONCTIONS DE LECTURE DU FICHIER SOURCE    *
	 ************************************************/
	

	/**
	 * Crée la liste des commandes à formater à partir du fichie source
	 * @param in
	 * @return LinkedList&lt;CommandArray&gt;
	 * @throws IOException
	 * @throws ParseException
	 */
	public static LinkedList&lt;CommandArray&gt; readFile(BufferedReader in) throws IOException, ParseException{
		LinkedList&lt;CommandArray&gt; commandListe = new LinkedList&lt;CommandArray&gt;();
		
		
		/****
		 * Initialisation. Pour l&#039;initialisation on fait tous les tests de validité possibles, on sera moins strict par la suite.
		 */
		String [] firstValidLine = searchForValidLine(in);
		if(firstValidLine==null)
			throw new CommandArray.ParseException(&quot;Erreur, aucune ligne valide trouvée dans le fichier.&quot;);
		if(!firstValidLine[0].equals(&quot;NOM&quot;))
			throw new CommandArray.ParseException(&quot;Erreur, le NOM doit venir en premier &quot; +
					&quot;(vérifiez si vous n&#039;avez pas une ligne comportant un &#039;:&#039; précédent &quot; +
					&quot;votre première ligne commençant par NOM&quot;);
		String [] secondValidLine = searchForValidLine(in);
		if(!secondValidLine[0].equals(&quot;DESCRIPTION&quot;))
			throw new CommandArray.ParseException(&quot;Erreur, la DESCRIPTION doit venir juste&quot; +
					&quot; après le NOM&quot;);
		
		if(!checkValidity(firstValidLine[1]))
			throw new CommandArray.ParseException(&quot;Erreur, nom invalide: {&quot;+firstValidLine[1]+&quot;}&quot;);
		if(!checkValidity(secondValidLine[1]))
			throw new CommandArray.ParseException(&quot;Erreur, description invalide: {&quot;+firstValidLine[1]+&quot;}&quot;);
		
		CommandArray commandArray = new CommandArray(firstValidLine[1],secondValidLine[1]);
		
		/*******
		 * Boucle. On ne se soucie pas trop des éventuels problèmes d&#039;objet mal rempli, ce sera checké en aval
		 */
		String [] line = null;
		String arg = null, key = null;
		while((line=searchForValidLine(in))!=null){
			key = line[0];
			arg = line[1];
			if(key.equals(&quot;NOM&quot;)){
				commandListe.add(commandArray);
				commandArray=new CommandArray(arg);
			}
			if(key.equals(&quot;DESCRIPTION&quot;))
				commandArray.description=arg;
			if(key.equals(&quot;LIEN_SYNOPSIS&quot;))
				commandArray.lien_synopsys=arg;
			if(key.equals(&quot;LIEN&quot;))
				commandArray.liens.add(arg);
			if(key.equals(&quot;LIEN_MANPAGE&quot;))
				commandArray.lien_manpage=arg;
			if(key.equals(&quot;LIEN_FORUM&quot;))
				commandArray.lien_forum=arg;
			
		}
		commandListe.add(commandArray);
		
		
		return commandListe;
	}
	
	/**
	 * Retrouve la ligne valide suivante dans le fichier source.
	 * Une ligne est considérée comme valide si elle comporte un &#039;:&#039; 
	 * @param in
	 * @return ligne valide
	 * @throws IOException
	 */
	public static String [] searchForValidLine(BufferedReader in) throws IOException{
		String line = null;
		//String key = null;
		String [] splitedLine = new String[2];
		int doubledotindex=-1;
		while((line=in.readLine())!=null){
			doubledotindex=line.indexOf(&#039;:&#039;);
			if(doubledotindex!=-1)
			{
				splitedLine[0]=line.substring(0, doubledotindex);
				if(doubledotindex&lt;line.length())
					splitedLine[1]=line.substring(doubledotindex+1);
				else
					splitedLine[1]=&quot;&quot;;
				/*splitedLine =  line.split(&quot;:&quot;);
				if(splitedLine.length==2)
					return splitedLine;
				else {
					key = splitedLine[0];
					splitedLine=new String[2];
					splitedLine[0]=key;
					splitedLine[1]=&quot;&quot;;
					return splitedLine;
				}*/
				return splitedLine;
			}
		}
		return null;
	}
	

	/*******************************
	 *    println &amp; debug stuff    *
	 *******************************/
    public static void println(String s){
    	System.out.println(s);
    }
    public static void println(String [] s){
    	for(int i=0;i&lt;s.length;i++)
    		System.out.println(s[i]);
    }
    
    public static void debug(String origin,String s){
    	if (DEBUG) {
			System.out.println(&quot;DEBUG(FormatArray.&quot;+origin+&quot;): &quot;+s);
		}
    }
    public static void debug(String origin,String [] s){
    	if (DEBUG) {
			for (int i = 0; i &lt; s.length; i++)
				System.out.println(&quot;DEBUG(FormatArray.&quot;+origin+&quot;): &quot;+s[i]);
		}
    }
    public static void printUsage(){
    	println(&quot;***************************************************************************&quot;);
    	println(&quot;*                           FormatArray                                   *&quot;);
    	println(&quot;***************************************************************************&quot;);
    	println(&quot;&quot;);
    	println(&quot;génère le formatage correspondant à l&#039;ensemble des commandes fournies dans le &quot;);
    	println(&quot;fichier passé en paramètre:&quot;);
    	println(&quot;&quot;);
    	println(&quot;paramètre obligatoire: nom du fichier&quot;);
    	println(&quot;le résultat est stocké dans le fichier NOM_FICHIER_format.txt&quot;);
    	println(&quot;le fichier source doit contenir au moins une fois le motif suivant:&quot;);
    	println(&quot;&quot;);
    	println(&quot;NOM:&quot;);
    	println(&quot;DESCRIPTION:&quot;);
    	println(&quot;LIEN_SYNOPSIS:&quot;);
    	println(&quot;LIEN:&quot;);
    	println(&quot;LIEN_MANPAGE:&quot;);
    	println(&quot;LIEN_FORUM:&quot;);
    	println(&quot;&quot;);
    	println(&quot;Le nombre de LIEN est indifférent. Une entrée valide doit contenir au moins&quot;);
    	println(&quot;une DESCRIPTION et un NOM. Si vous ne disposez pas par exemple du LIEN_MANPAGE,&quot;);
    	println(&quot;vous pouvez indifféremment mettre la ligne vide ou pas.&quot;);
    }
    
    public static void printLicense(){
    	println(&quot;FormatArray  Copyright (C) 2009 Aldian (Administrator of Ubuntu French Documentation)&quot;);
    	println(&quot;This program comes with ABSOLUTELY NO WARRANTY; for details visit site http://www.gnu.org/licenses/gpl.html.&quot;);
    	println(&quot;This is free software, and you are welcome to redistribute it&quot;);
    	println(&quot;under certain conditions; visit site http://www.gnu.org/licenses/gpl.html for details.&quot;);
    	println(&quot;&quot;);
    }
    
    /**
     * @author aldian
     * Exception dédiée aux problèmes survenus dans l&#039;interprétation du contenu du fichier source.
     */
    static class ParseException extends Exception {
		private static final long serialVersionUID = -1172968771252448754L;

		public ParseException(String erreur){
    		super (erreur);
    	}
    }

}</pre>

</div>

</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="utilisateurs/aldian/programme_formatage_portail_lignes_commandes.txt">utilisateurs/aldian/programme_formatage_portail_lignes_commandes.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 28/04/2011, 22:55">Le 28/04/2011, 22:55</span></li><li>(modification externe)</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=utilisateurs%3Aaldian%3Aprogramme_formatage_portail_lignes_commandes&amp;1635533284" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
