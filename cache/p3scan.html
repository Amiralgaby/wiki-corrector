<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>p3scan [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="xenial,antivirus"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/p3scan?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/p3scan?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/p3scan"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/p3scan"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/p3scan"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"p3scan","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="p3scan">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/p3scan?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/p3scan?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/p3scan?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/p3scan?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/p3scan?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/p3scan?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/p3scan?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">p3scan</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/p3scan?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/p3scan?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/p3scan?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#interet","title":"Int\u00e9r\u00eat ?","level":1},{"link":"#fonctionnement","title":"Fonctionnement","level":1},{"link":"#pre-requis","title":"Pr\u00e9-requis","level":1},{"link":"#installation","title":"Installation","level":1},{"link":"#configuration","title":"Configuration","level":1},{"link":"#configuration_commune","title":"Configuration commune","level":2},{"link":"#exemple_avec_clamav","title":"Exemple avec Clamav","level":2},{"link":"#exemple_avec_clamav-daemon","title":"Exemple avec Clamav-daemon","level":2},{"link":"#exemple_pour_f-prot_antivirus","title":"Exemple pour F-Prot Antivirus :","level":2},{"link":"#exemple_de_filtrage_de_spam","title":"Exemple de filtrage de spam","level":2},{"link":"#configuration_du_pare-feu","title":"Configuration du pare-feu","level":2},{"link":"#test_de_fonctionnement","title":"Test de fonctionnement","level":2},{"link":"#ressources_externes","title":"Ressources externes","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#interet">Intérêt ?</a></li>
<li class="level1"><a href="#fonctionnement">Fonctionnement</a></li>
<li class="level1"><a href="#pre-requis">Pré-requis</a></li>
<li class="level1"><a href="#installation">Installation</a></li>
<li class="level1"><a href="#configuration">Configuration</a>
<ul class="nav toc">
<li class="level2"><a href="#configuration_commune">Configuration commune</a></li>
<li class="level2"><a href="#exemple_avec_clamav">Exemple avec Clamav</a></li>
<li class="level2"><a href="#exemple_avec_clamav-daemon">Exemple avec Clamav-daemon</a></li>
<li class="level2"><a href="#exemple_pour_f-prot_antivirus">Exemple pour F-Prot Antivirus :</a></li>
<li class="level2"><a href="#exemple_de_filtrage_de_spam">Exemple de filtrage de spam</a></li>
<li class="level2"><a href="#configuration_du_pare-feu">Configuration du pare-feu</a></li>
<li class="level2"><a href="#test_de_fonctionnement">Test de fonctionnement</a></li>
</ul>
</li>
<li class="level1"><a href="#ressources_externes">Ressources externes</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/xenial" class="wikilink1" title="xenial" rel="tag">Xenial</a>,
	<a href="/antivirus" class="wikilink1" title="antivirus" rel="tag">antivirus</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="p3scan">P3scan</h1>
<div class="level1">

<p>
P3scan permet de scanner a l&#039;aide d&#039;un antivirus les messages entrants 
d&#039;un client email. Il est en outre possible de l&#039;utiliser avec un client antispam <em>(tel spamassassin)</em>.
</p>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[P3scan] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="p3scan" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="33-233" /><button type="submit" title="P3scan" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="interet">Intérêt ?</h2>
<div class="level2">

<p>
Si vous utilisez conjointement <a href="/thunderbird" class="wikilink1" title="thunderbird">Thunderbird</a> sous Ubuntu et Windows, que vous ne voulez pas infecter d&#039;autres ordinateurs en renvoyant des messages reçus, ou tout simplement si vous êtes parano. De plus cela ne touche en rien votre configuration de client email et est valable pour tous les utilisateurs du système sans qu&#039;ils ne le sachent. C&#039;est pourquoi il peut être très utile pour un réseau domestique.
</p>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Intérêt ?] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="interet" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="234-676" /><button type="submit" title="Intérêt ?" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit3 page-header" id="fonctionnement">Fonctionnement</h2>
<div class="level2">

<p>
P3scan va s&#039;intercaler entre le client (<em>par exemple <a href="/thunderbird" class="wikilink1" title="thunderbird">Thunderbird</a></em>) et le serveur (<em>par exemple pop.free.fr</em>). Il se fait passer du coté client pour le serveur et du coté serveur pour le client. Ainsi il peut traiter les mails  de manière transparente pour le serveur et le client (aucun des deux ne se rend compte qu&#039;il y a P3scan entre les deux). 
Explication simple :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Le client demande au serveur les mails</div>
</li>
<li class="level1"><div class="li"> Grace au pare-feu, on renvoie tout ce qui rentre du port pop3 vers le port où attend p3scan.</div>
</li>
<li class="level1"><div class="li"> P3scan se fait alors passer d&#039;un coté pour le serveur et de l&#039;autre pour le client.</div>
</li>
<li class="level1"><div class="li"> Il sauvegarde dans un dossier sur votre disque les messages pour les traiter avec l&#039;antivirus.</div>
</li>
<li class="level1"><div class="li"> Si aucun message n&#039;est infecté alors il renvoie les messages au travers du port pop3 vers votre client.</div>
</li>
<li class="level1"><div class="li"> Si un message est infecté, il remplace le corps du message par un message d&#039;information et le renvoie.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Fonctionnement] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="fonctionnement" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="677-1633" /><button type="submit" title="Fonctionnement" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit4 page-header" id="pre-requis">Pré-requis</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> Disposer des <a href="/sudo" class="wikilink1" title="sudo">droits d&#039;administration</a> ;</div>
</li>
<li class="level1"><div class="li"> Disposer d&#039;une connexion à Internet configurée et activée.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Pré-requis] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="pre-requis" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1634-1777" /><button type="submit" title="Pré-requis" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit5 page-header" id="installation">Installation</h2>
<div class="level2">

<p>
Commencez par installer une antivirus, par exemple <a href="/clamav" class="wikilink1" title="clamav">Clamav</a>. Mais d&#039;autres antivirus sont supportés par P3scan.
</p>

<p>
Puis <a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">Installez le paquet</a> <strong><a href="apt://p3scan" class="interwiki iw_apt" title="apt://p3scan">p3scan</a></strong>. <br/>

</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Installation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1778-2008" /><button type="submit" title="Installation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit6 page-header" id="configuration">Configuration</h2>
<div class="level2">

<p>
<a href="/tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">éditer le fichier</a> /etc/p3scan/p3scan.conf.
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Configuration] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="2009-2120" /><button type="submit" title="Configuration" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit7" id="configuration_commune">Configuration commune</h3>
<div class="level3">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>Explication simple du fichier de configuration :</strong></div>
</li>
</ul>
<div class="table-responsive"><table class="inline table table-striped table-condensed">
	<thead>
	<tr class="row0">
		<th class="col0 centeralign" colspan="2">    Pour la configuration du réseau                                         </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 centeralign">  pidfile       </td><td class="col1 centeralign">  Endroit où inscrire le fichier indiquant le fonctionnement du programme      </td>
	</tr>
	<tr class="row2">
		<td class="col0 centeralign">  maxchilds     </td><td class="col1 centeralign">  Connexion maximum du programme (10 scans à la fois)               </td>
	</tr>
	<tr class="row3">
		<td class="col0 centeralign">  ip            </td><td class="col1 centeralign">  Adresse réseau sur laquelle attendre le mail                                  </td>
	</tr>
	<tr class="row4">
		<td class="col0 centeralign">  port          </td><td class="col1 centeralign">  Port où le mail doit arriver au programme                           </td>
	</tr>
	<tr class="row5">
		<th class="col0 centeralign" colspan="2">    Pour la configuration du  système                                           </th>
	</tr>
	<tr class="row6">
		<td class="col0 centeralign">  user        </td><td class="col1 centeralign">  Nom que le démon utilise pour travailler   (utile pour les   permissions)                            </td>
	</tr>
	<tr class="row7">
		<td class="col0 centeralign">  notifydir   </td><td class="col1 centeralign">  Répertoire où le programme inscrit les notifications et repertoire temporaire de travail                       </td>
	</tr>
	<tr class="row8">
		<td class="col0 centeralign">  virusdir    </td><td class="col1 centeralign">  Répertoire de sauvegarde des fichiers infectés         </td>
	</tr>
	<tr class="row9">
		<td class="col0 centeralign">  justdelete  </td><td class="col1 centeralign">  Effacement du fichier infecté sans sauvegarde          </td>
	</tr>
	<tr class="row10">
		<th class="col0 centeralign" colspan="2">    Pour la configuration de l&#039;antivirus                                      </th>
	</tr>
	<tr class="row11">
		<td class="col0 rightalign">  scannertype </td><td class="col1 centeralign">  Type de programme antivirus                            </td>
	</tr>
	<tr class="row12">
		<td class="col0 centeralign">  scanner     </td><td class="col1 centeralign">  Endroit où se situe l&#039;exécutable de l&#039;antivirus                              </td>
	</tr>
	<tr class="row13">
		<td class="col0 centeralign">  viruscode   </td><td class="col1 centeralign">  Expression du résultat du scan                                       </td>
	</tr>
	<tr class="row14">
		<td class="col0 rightalign">  virusregexp </td><td class="col1 centeralign">  Nom du virus à inclure dans la notification                                         </td>
	</tr>
	<tr class="row15">
		<td class="col0 centeralign">  demime      </td><td class="col1 centeralign">  Scanner en fonction du type de fichier (zip,jpg,…) et pas tel que recu par le client  </td>
	</tr>
	<tr class="row16">
		<th class="col0 centeralign" colspan="2">    Pour la configuration de l&#039;antispam                                        </th>
	</tr>
	<tr class="row17">
		<td class="col0 centeralign">  checkspam   </td><td class="col1 centeralign">  Vérifier le spam                                     </td>
	</tr>
	<tr class="row18">
		<td class="col0 centeralign">  spamcheck   </td><td class="col1 centeralign">  Endroit où se situe l&#039;exécutable de l&#039;antipsam                               </td>
	</tr>
	<tr class="row19">
		<th class="col0 centeralign" colspan="2">    Pour la configuration des notifications dans le mail                                  </th>
	</tr>
	<tr class="row20">
		<td class="col0 centeralign">  template    </td><td class="col1 centeralign">  Fichier à renvoyer à la place du fichier infecté       </td>
	</tr>
	<tr class="row21">
		<td class="col0 centeralign">  subject     </td><td class="col1 centeralign">  Sujet du message à la place du fichier infecté         </td>
	</tr>
	<tr class="row22">
		<td class="col0 centeralign">  notify      </td><td class="col1 centeralign">  Notification dans le message avec l&#039;option justdelete  </td>
	</tr>
</table></div>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <strong>Exemple concret :</strong></div>
</li>
</ul>
<pre class="file">pidfile = /var/run/p3scan.pid
maxchilds = 10
ip = 0.0.0.0
port = 8110
user = p3scan
notifydir = /var/spool/p3scan/notify
virusdir = /var/spool/p3scan
justdelete
template = /etc/p3scan/p3scan-fr.mail
subject = [virus] dans un message pour vous:
notify = Pour information, le message a été détruit.</pre>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Configuration commune] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_commune" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="2121-4775" /><button type="submit" title="Configuration commune" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit9" id="exemple_avec_clamav">Exemple avec Clamav</h3>
<div class="level3">
<pre class="file">scannertype = basic
scanner = /usr/bin/clamscan --no-summary -i
virusregexp = .*: (.*) FOUND</pre>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Exemple avec Clamav] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="exemple_avec_clamav" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="4776-4915" /><button type="submit" title="Exemple avec Clamav" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit10" id="exemple_avec_clamav-daemon">Exemple avec Clamav-daemon</h3>
<div class="level3">

<p>
<a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">Installez le paquet</a> <strong>clamav-daemon</strong>. <br/>

</p>
<pre class="file">scannertype = basic
scanner = /usr/bin/clamdscan --no-summary -i
virusregexp = .*: (.*) FOUND</pre>

<p>
Vous devez ajouter clamav au groupe p3scan pour pouvoir lire dans les fichiers temporaires de P3scan :
</p>
<pre class="code">sudo adduser clamav p3scan</pre>

<p>
<a href="/_detail/icons/iconnote.png?id=p3scan" class="media" title="icons:iconnote.png"><img src="/_media/icons/iconnote.png" class="medialeft img-responsive" alt="" /></a>
</p>
<blockquote><div class="no">
Avec cette méthode, le scan des mails est légèrement plus rapide.</div></blockquote>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Exemple avec Clamav-daemon] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="exemple_avec_clamav-daemon" /><input type="hidden" name="codeblockOffset" value="2" /><input type="hidden" name="range" value="4916-5388" /><button type="submit" title="Exemple avec Clamav-daemon" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit11" id="exemple_pour_f-prot_antivirus">Exemple pour F-Prot Antivirus :</h3>
<div class="level3">
<pre class="file">scannertype = basic
scanner = /usr/bin/f-prot -archive -ai
viruscode = 3,8
virusregexp = (?=Infection\:)[[:space:]]*(.*)$
demime</pre>

</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Exemple pour F-Prot Antivirus :] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="exemple_pour_f-prot_antivirus" /><input type="hidden" name="codeblockOffset" value="4" /><input type="hidden" name="range" value="5389-5577" /><button type="submit" title="Exemple pour F-Prot Antivirus :" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit12" id="exemple_de_filtrage_de_spam">Exemple de filtrage de spam</h3>
<div class="level3">
<pre class="file">checkspam
spamcheck = /usr/bin/spamc     ## avec le démon spamassassin</pre>

<p>
<a href="/_detail/icons/iconnote.png?id=p3scan" class="media" title="icons:iconnote.png"><img src="/_media/icons/iconnote.png" class="medialeft img-responsive" alt="" /></a>
</p>
<blockquote><div class="no">
<strong>Le fichier de configuration est bien détaillé, d&#039;autres exemples sont indiqués</strong>.</div></blockquote>

</div>
<div class='secedit editbutton_section editbutton_12'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Exemple de filtrage de spam] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="exemple_de_filtrage_de_spam" /><input type="hidden" name="codeblockOffset" value="5" /><input type="hidden" name="range" value="5578-5820" /><button type="submit" title="Exemple de filtrage de spam" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit13" id="configuration_du_pare-feu">Configuration du pare-feu</h3>
<div class="level3">

<p>
<em>Pour de plus amples informations sur le pare feu par défaut, je vous renvoie sur la page <a href="/iptables" class="wikilink1" title="iptables">iptables</a></em>
</p>
<blockquote><div class="no">
<strong>Pour que p3scan puisse fonctionner, il faut rediriger les mails entrants sur le port 110 <em>(port par défaut)</em> vers le port ou p3scan attend.</strong></div></blockquote>

<p>
Ça c&#039;est très bien mais comment fait-on ? Ma messagerie ne fonctionne plus maintenant!!!!!!!!!!!
</p>

</div>

<h4 id="avec_iptables">Avec Iptables</h4>
<div class="level4">
<pre class="code">sudo iptables -t nat -A OUTPUT  -p tcp --dport pop3 -m owner --uid-owner &lt;UID&gt; -j ACCEPT
sudo iptables -t nat -A OUTPUT  -p tcp --dport pop3 -j REDIRECT --to 8110</pre>

<p>
En mettant l&#039;UID que votre système a attribué à P3scan, pour l&#039;obtenir :
</p>
<pre class="code">sudo id p3scan</pre>

<p>
<br/>

Pour ceux qui utiliseraient encore <em>Firestarter</em>, pour la persistance des règles, il suffit de copier les 2 règles iptables dans le fichier user-pre de <em>Firestarter</em>. Faites au préalable les tests à l&#039;aide de <em>telnet</em> décrit plus bas. 
</p>
<pre class="code">sudo vi /etc/firestarter/user-pre</pre>

<p>
Pour obtenir le contenu suivant :<br/>

iptables -t nat -A OUTPUT  -p tcp –dport pop3 -m owner –uid-owner &lt;UID&gt; -j ACCEPT<br/>

iptables -t nat -A OUTPUT  -p tcp –dport pop3 -j REDIRECT –to 8110
</p>

</div>

<h4 id="avec_shorewall">Avec Shorewall</h4>
<div class="level4">

<p>
<em><a href="/shorewall" class="wikilink1" title="shorewall">Shorewall</a> est un pare-feu basé sur <a href="/iptables" class="wikilink1" title="iptables">iptables</a> , seul la manière de le paramétrer diffère.</em>  <br/>

</p>

<p>
<a href="/tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">Éditer le fichier</a> /etc/shorewall/rules :
</p>
<pre class="code">REDIRECT fw 8110 tcp pop3 - - - !p3scan</pre>

</div>
<div class='secedit editbutton_section editbutton_13'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Configuration du pare-feu] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_du_pare-feu" /><input type="hidden" name="codeblockOffset" value="6" /><input type="hidden" name="range" value="5821-7291" /><button type="submit" title="Configuration du pare-feu" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit14" id="test_de_fonctionnement">Test de fonctionnement</h3>
<div class="level3">

<p>
<em>Pour cela on va utiliser une <a href="/console" class="wikilink1" title="console">console</a> telnet qui est un protocole de communication entre internet et son ordinateur dépourvu d&#039;interface graphique.</em>
</p>
<ol class=" fix-media-list-overlap">
<li class="level1"><div class="li"> On demande une connexion telnet au serveur de messagerie sur le port 110 </div>
</li>
<li class="level1"><div class="li"> On indique son login et son mot de passe.</div>
</li>
<li class="level1"><div class="li"> On recherche ses message.</div>
</li>
<li class="level1"><div class="li"> On télécharge le premier message.</div>
</li>
</ol>
<pre class="code">telnet pop.votrefournisseur.fr 110
user votrelogindemessagerie
pass votremotdepassedemessagerie
list
retr 1</pre>

<p>
Si tous se passe bien vous devriez avoir en réponse quelque chose comme :
</p>
<pre class="code">retr 1
+OK P3Scan&#039;ing...</pre>

<p>
pour quitter : 
</p>
<pre class="code">quit</pre>

</div>
<div class='secedit editbutton_section editbutton_14'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Test de fonctionnement] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="test_de_fonctionnement" /><input type="hidden" name="codeblockOffset" value="10" /><input type="hidden" name="range" value="7292-7952" /><button type="submit" title="Test de fonctionnement" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit15 page-header" id="ressources_externes">Ressources externes</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <a href="http://p3scan.sourceforge.net/" class="urlextern" title="http://p3scan.sourceforge.net/" rel="nofollow">Site officiel de P3scan</a>.</div>
</li>
</ul>
<hr />

<p>
<em>Contributeurs : <a href="/utilisateurs/coolaman" class="wikilink2" title="utilisateurs:coolaman" rel="nofollow">coolaman</a></em>
</p>

</div>
<div class='secedit editbutton_section editbutton_15'><form class="button btn_secedit form-inline" method="post" action="/p3scan"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1487003865" /><input type="hidden" name="summary" value="[Ressources externes] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="ressources_externes" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="7953-" /><button type="submit" title="Ressources externes" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="p3scan.txt">p3scan.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 13/02/2017, 17:37">Le 13/02/2017, 17:37</span></li><li class="text-muted">par L&#039;Africain</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=p3scan&amp;1635559932" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
