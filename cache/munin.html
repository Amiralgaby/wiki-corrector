<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>munin [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="administration,serveur,systeme,supervision"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/munin?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/munin?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/munin"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/munin"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/munin"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"munin","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="munin">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/munin?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/munin?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/munin?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/munin?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/munin?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/munin?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/munin?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">munin</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/munin?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/munin?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/munin?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#munin_le_grapheur","title":"Munin (le grapheur)","level":1},{"link":"#installation","title":"Installation","level":2},{"link":"#configuration","title":"Configuration","level":2},{"link":"#voir_les_graphes","title":"Voir les graphes","level":2},{"link":"#mise_a_jour_des_indicateurs_des_n\u0153uds","title":"Mise \u00e0 jour des indicateurs des n\u0153uds","level":2},{"link":"#munin-node_le_demon_sur_les_n\u0153uds","title":"Munin-node (le d\u00e9mon sur les n\u0153uds)","level":1},{"link":"#installation1","title":"Installation","level":2},{"link":"#configuration1","title":"Configuration","level":2},{"link":"#plugins_apache","title":"plugins Apache","level":2},{"link":"#plugins_mysql","title":"plugins Mysql","level":2},{"link":"#plugins_proftpd","title":"Plugins Proftpd","level":2},{"link":"#plugin_df","title":"Plugin df","level":2},{"link":"#plugin_sensors","title":"Plugin sensors_","level":2},{"link":"#resolution_des_problemes_courants","title":"R\u00e9solution des probl\u00e8mes courants","level":2},{"link":"#regles_iptables_firewall","title":"R\u00e8gles Iptables (Firewall)","level":1},{"link":"#liens","title":"Liens","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#munin_le_grapheur">Munin (le grapheur)</a>
<ul class="nav toc">
<li class="level2"><a href="#installation">Installation</a></li>
<li class="level2"><a href="#configuration">Configuration</a></li>
<li class="level2"><a href="#voir_les_graphes">Voir les graphes</a></li>
<li class="level2"><a href="#mise_a_jour_des_indicateurs_des_nœuds">Mise à jour des indicateurs des nœuds</a></li>
</ul>
</li>
<li class="level1"><a href="#munin-node_le_demon_sur_les_nœuds">Munin-node (le démon sur les nœuds)</a>
<ul class="nav toc">
<li class="level2"><a href="#installation1">Installation</a></li>
<li class="level2"><a href="#configuration1">Configuration</a></li>
<li class="level2"><a href="#plugins_apache">plugins Apache</a></li>
<li class="level2"><a href="#plugins_mysql">plugins Mysql</a></li>
<li class="level2"><a href="#plugins_proftpd">Plugins Proftpd</a></li>
<li class="level2"><a href="#plugin_df">Plugin df</a></li>
<li class="level2"><a href="#plugin_sensors">Plugin sensors_</a></li>
<li class="level2"><a href="#resolution_des_problemes_courants">Résolution des problèmes courants</a></li>
</ul>
</li>
<li class="level1"><a href="#regles_iptables_firewall">Règles Iptables (Firewall)</a></li>
<li class="level1"><a href="#liens">Liens</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/administration" class="wikilink1" title="administration" rel="tag">administration</a>,
	<a href="/serveur" class="wikilink1" title="serveur" rel="tag">serveur</a>,
	<a href="/systeme" class="wikilink1" title="systeme" rel="tag">système</a>,
	<a href="/supervision" class="wikilink1" title="supervision" rel="tag">supervision</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="muninle_grapheur_pour_surveiller_les_machines_d_un_parc">Munin : le grapheur pour surveiller les machines d&#039;un parc</h1>
<div class="level1">

<p>
<a href="http://munin-monitoring.org/" class="urlextern" title="http://munin-monitoring.org/" rel="nofollow">Munin</a> est un système complet de monitoring (ou métrologie) de machine. Il permet de générer une série de graphes à partir des informations envoyées par les autres machines : utilisation de la mémoire vive, « load average », utilisation du processeur, réseau,… Il permet même d&#039;envoyer des alertes par courriel ou vers <a href="/nagios" class="wikilink1" title="nagios">Nagios</a> en fonction de seuils d&#039;alerte prédéfinis.
</p>

<p>
Munin fonctionne sur le modèle client-serveur. Un petit démon tourne sur chacune des machines devant être surveillée : <em>munin-node</em>. Ce démon fournit les informations brutes concernant la machine dès que le grapheur <em>munin</em> les lui demande.
</p>

<p>
Pour surveiller un parc informatique, vous devez donc installer :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> le grapheur <em>munin</em> sur une machine qui va se charger de la surveillance.</div>
</li>
<li class="level1"><div class="li"> le démon <em>munin-node</em> sur chaque machine à surveiller.</div>
</li>
</ul>

<p>
Dans la mythologie nordique, Hugin et Munin sont les deux corbeaux messagers d&#039;Odin. Tous les jours, ils parcourent le monde et reviennent ensuite rapporter au dieu tout ce qu&#039;ils ont vu et entendu. Hugin représente la pensée, tandis que son comparse Munin représente la mémoire.
</p>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Munin : le grapheur pour surveiller les machines d&#039;un parc] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="muninle_grapheur_pour_surveiller_les_machines_d_un_parc" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="60-1302" /><button type="submit" title="Munin : le grapheur pour surveiller les machines d&#039;un parc" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="munin_le_grapheur">Munin (le grapheur)</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Munin (le grapheur)] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="munin_le_grapheur" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1303-1335" /><button type="submit" title="Munin (le grapheur)" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit3" id="installation">Installation</h3>
<div class="level3">

<p>
Munin  est une application écrite en <a href="/perl" class="wikilink2" title="perl" rel="nofollow">Perl</a> qui génère des graphes grâce à <a href="/rrdtool" class="wikilink1" title="rrdtool">rrdtool</a>. Pour visualiser ces graphes munin génère des pages <abbr title="HyperText Markup Language">HTML</abbr>. Comme pour toutes application web il faut donc avoir un serveur web déjà installé et fonctionnel. Le paquet munin fournit une configuration de base pour le serveur Apache mais cela peut généralement fonctionner avec <a href="/nginx" class="wikilink1" title="nginx">Nginx</a> ou <a href="/lighttpd" class="wikilink1" title="lighttpd">Lighttpd</a>.
Cette documentation concerne une installation avec le serveur web Apache2.
</p>

<p>
Installation des paquets sur le grapheur :
</p>
<pre class="code">sudo apt install munin munin-node munin-plugins-extra libcgi-fast-perl libapache2-mod-fcgid</pre>

<p>
Les modules Apache <em>fast-perl</em> et <em>fcgid</em> sont nécessaires pour la génération des graphes. Les paquets munin-node et munin-plugins-extra ne sont nécessaires que pour surveiller le serveur lui-me (ce qui est généralement le cas).
</p>

<p>
Il faut activer le module fcgid pour Apache :
</p>
<pre class="code">sudo a2enmod fcgid</pre>
<pre class="code">sudo systemctl restart apache2</pre>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Installation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1336-2376" /><button type="submit" title="Installation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit4" id="configuration">Configuration</h3>
<div class="level3">

</div>

<h4 id="serveur_web_ici_apache">Serveur web (ici apache)</h4>
<div class="level4">

<p>
Lors de son installation munin active automatiquement sa configuration Apache en créant les liens symboliques sous /etc/apache2/conf-available/munin.conf qui pointent vers <strong>/etc/munin/apache24.conf.</strong> Dans cette configuration les graphes sont accessibles que depuis l&#039;hôte local. Pour les rendre accessible depuis d&#039;autres machines il faut modifier le fichier <strong>/etc/munin/apache24.conf</strong> ainsi :
</p>
<pre class="file">Alias /munin /var/cache/munin/www
&lt;Directory /var/cache/munin/www&gt;
	&lt;RequireAny&gt;
	    Require local
	    Require ip a.b.c.d w.x.y.z
	&lt;/RequireAny&gt;
        Options None
&lt;/Directory&gt;

ScriptAlias /munin-cgi/munin-cgi-graph /usr/lib/munin/cgi/munin-cgi-graph
&lt;Location /munin-cgi/munin-cgi-graph&gt;
        &lt;RequireAny&gt;
	    Require local
	    Require ip a.b.c.d w.x.y.z
	&lt;/RequireAny&gt;
	&lt;IfModule mod_fcgid.c&gt;
	    SetHandler fcgid-script
	&lt;/IfModule&gt;
        &lt;IfModule !mod_fcgid.c&gt;
            SetHandler cgi-script
        &lt;/IfModule&gt;
&lt;/Location&gt;</pre>

<p>
où a.b.c.d et w.x.y.z sont les adresses IP des machine autorisées à consulter les graphes munin qui seront accessibles par <a href="http://nom_de_domaine_du_serveur/munin" class="urlextern" title="http://nom_de_domaine_du_serveur/munin" rel="nofollow">http://nom_de_domaine_du_serveur/munin</a>.
Pour plus d&#039;informations sur la configuration et les restrictions d&#039;accès, consultez la documentation d&#039;<a href="/apache2" class="wikilink1" title="apache2">Apache2</a>.
</p>

</div>

<h4 id="serveur_munin_central">Serveur Munin central</h4>
<div class="level4">

<p>
Il faut indiquer à Munin quels hôtes il doit surveiller. Dans le fichier <strong>/etc/munin/munin.conf</strong>. Vous devriez avoir une configuration par défaut qui ressemble à ceci :
</p>
<pre class="file">[localhost.localdomain]
    address 127.0.0.1
    use_node_name yes</pre>

<p>
Vous pouvez remplacer <em>localhost.localdomain</em> par le nom de domaine associé au serveur.
</p>

<p>
Pour chacune des machines à surveiller, vous devez indiquer son <code>nom d&#039;hôte</code>, son <code>domaine</code> et son <code>adresse ip</code>.
</p>

<p>
Par exemple, pour la machine <code>www.example.com</code> qui est sur l&#039;IP <code>192.168.0.1</code>, on ajoute l&#039;entrée suivante dans le fichier <strong>/etc/munin/munin.conf</strong> :
</p>
<pre class="file">[www.ubuntu-fr.org]
    address 192.168.0.1
    use_node_name yes</pre>
<div class="notetip">Le paramètre <strong>use_node_name yes</strong> permet de prendre en compte la machine même si le nom entre crochets ne correspond pas au nom de la machine. Dans munin la machine sera toujours affichée avec le nom entre crochets. <br/>

S&#039;il n&#039;est pas précisé, il est nécessaire de mettre la même chose que le retour de la commande <em>hostname -f</em> sur la machine en question, sinon la machine n&#039;apparaîtra tout simplement pas dans la partie Web car munin demandera à la machine distante si cette dernière connaît un nœud correspondant au nom entre crochet, ce qui ne sera pas le cas.
</div>
<p>
Les informations récupérées par munin pour chaque machine dépendent de la configuration de munin-node que les machine distantes (plugins activés).
</p>

<p>
Pour  être averti par courriel en cas de dépassement d&#039;un seuil d&#039;alerte (par ex:disque plein), ajoutez ceci :
</p>
<pre class="file">contacts toto
contact.toto.command mail -s &quot;Munin notif ${var:host}&quot; toto@example.com
contact.toto.always_send warning critical</pre>

<p>
(en remplaçant bien sûr <em>toto</em> <em>et toto@example.com</em> par les valeurs qui conviennent).
</p>

<p>
ou encore envoyer une alerte vers Nagios :
</p>
<pre class="file">contact.nagios.command /usr/sbin/send_nsca -H nagios.host.com -c /etc/send_nsca.cfg</pre>

<p>
La périodicité des mises à jour des graphes est déterminée par le programme <code>munin-cron</code> qui par défaut se lance toutes les 5 minutes.
</p>

<p>
À l&#039;installation, le fichier <strong>/etc/cron.d/munin</strong> a été créé. En modifiant ce dernier, vous pourrez changer la périodicité des mises à jour des graphes.
</p>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Configuration] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration" /><input type="hidden" name="codeblockOffset" value="3" /><input type="hidden" name="range" value="2377-5979" /><button type="submit" title="Configuration" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit5" id="voir_les_graphes">Voir les graphes</h3>
<div class="level3">

<p>
Il vous suffit d&#039;aller sur la page web suivante : <a href="http://localhost/munin" class="urlextern" title="http://localhost/munin" rel="nofollow">http://localhost/munin</a> si vous avez installé Munin sur votre machine en local. Sinon, remplacez localhost par l&#039;ip de la machine où se trouve le grapheur.
</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Voir les graphes] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="voir_les_graphes" /><input type="hidden" name="codeblockOffset" value="8" /><input type="hidden" name="range" value="5980-6215" /><button type="submit" title="Voir les graphes" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit6" id="mise_a_jour_des_indicateurs_des_nœuds">Mise à jour des indicateurs des nœuds</h3>
<div class="level3">

<p>
La mise à jour (télé-relevé) se fait par défaut toutes les 5 minutes, grâce à la cron <code>/etc/cron.d/munin</code>.
Pour déclencher une mise-à-jour manuelle supplémentaire : 
</p>
<pre class="code">sudo -u munin /usr/bin/munin-cron</pre>

<p>
Et pour suivre ce qui se passe, le fichier journal est <code>/var/log/munin/munin-update.log</code>
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Mise à jour des indicateurs des nœuds] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="mise_a_jour_des_indicateurs_des_nœuds" /><input type="hidden" name="codeblockOffset" value="8" /><input type="hidden" name="range" value="6216-6582" /><button type="submit" title="Mise à jour des indicateurs des nœuds" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit7 page-header" id="munin-node_le_demon_sur_les_nœuds">Munin-node (le démon sur les nœuds)</h2>
<div class="level2">

<p>
Sur chaque machine que vous désirez surveiller, il vous faut installer le démon qui va répondre aux requêtes du grapheur.
</p>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Munin-node (le démon sur les nœuds)] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="munin-node_le_demon_sur_les_nœuds" /><input type="hidden" name="codeblockOffset" value="9" /><input type="hidden" name="range" value="6583-6760" /><button type="submit" title="Munin-node (le démon sur les nœuds)" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit8" id="installation1">Installation</h3>
<div class="level3">

<p>
Installez les paquets suivants :
</p>
<pre class="code">sudo apt install munin-node munin-plugins-extra</pre>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Installation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation1" /><input type="hidden" name="codeblockOffset" value="9" /><input type="hidden" name="range" value="6761-6877" /><button type="submit" title="Installation" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit9" id="configuration1">Configuration</h3>
<div class="level3">

</div>

<h4 id="acces_au_nœud">Accès au nœud</h4>
<div class="level4">

<p>
Pour que le grapheur accède aux informations du nœud, il faut autoriser explicitement le grapheur à se connecter au nœud.
</p>

<p>
Cette information est indiquée dans le fichier de configuration <strong>/etc/munin/munin-node.conf</strong>. À la fin du fichier de configuration, vous trouverez une ligne de ce style :
</p>
<pre class="file">allow ^127\.0\.0\.1$</pre>

<p>
Pour autoriser votre grapheur à se connecter, vous ajouter une ligne du même type. Par exemple, si votre grapheur possède l&#039;IP 192.168.0.253, vous ajoutez la ligne :
</p>
<pre class="file">allow ^192\.168\.0\.253$</pre>

</div>

<h4 id="configuration_des_plugins">Configuration des plugins</h4>
<div class="level4">

<p>
Chaque information affichée dans les graphes est traitée par un plugin. Les plugins actifs sont en réalité des liens symboliques qui se trouvent dans le répertoire <strong>/etc/munin/plugins</strong>. La plupart des plugins Munin sont installés par défaut dans le répertoire <strong>/usr/share/munin/plugins/</strong>
</p>

<p>
À l&#039;installation du paquet, les plugins détectés sont automatiquement ajoutés.
</p>

<p>
Le fichier de configuration des plugins est <strong>/etc/munin/plugin-conf.d/munin-node</strong>
</p>

<p>
Normalement, on ne règle que les utilisateurs et les groupes sous lesquels tournent les plugins (rapport aux droits d&#039;exécution, de lecture et d&#039;écriture… si vous ne savez pas de quoi il est question, lisez donc la documentation sur les <a href="/permissions" class="wikilink1" title="permissions">permissions</a>.
</p>

<p>
Pour visualiser facilement les plugins installés, vous pouvez utiliser la commande :
</p>
<pre class="code">munin-node-configure</pre>

<p>
Cette commande vous permet également d&#039;obtenir une suggestion des pluggins à rajouter :
</p>
<pre class="code">munin-node-configure --suggest</pre>

<p>
vous obtiendrez les commandes de création des liens pour l&#039;activation des plugins avec la commande :
</p>
<pre class="code">munin-node-configure --suggest --shell</pre>

</div>

<h4 id="test_des_plugins">Test des plugins</h4>
<div class="level4">

<p>
Si vous créez vos plugins ou si vous désirez seulement tester la bonne configuration de vos plugins, vous ne devez pas lancer le plugin comme si vous lanciez un script shell. Vous devez utiliser la commande <strong>munin-run</strong>, par exemple :
</p>
<pre class="code">munin-run postgres_bgwriter</pre>

<p>
le plugin sera alors lancé avec les variables nécessaires (nom utilisateur,nom BDD …)
</p>

</div>

<h4 id="prise_en_compte_d_une_configuration_du_nœud_modifiee">Prise en compte d&#039;une configuration du nœud modifiée</h4>
<div class="level4">

<p>
Une fois les modifications effectuées, il faut redémarrer le nœud munin pour les prendre en compte à la prochaine interrogation depuis le serveur munin : 
</p>
<pre class="code">sudo systemctl restart munin-node</pre>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Configuration] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration1" /><input type="hidden" name="codeblockOffset" value="10" /><input type="hidden" name="range" value="6878-9269" /><button type="submit" title="Configuration" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit10" id="plugins_apache">plugins Apache</h3>
<div class="level3">

<p>
Les plugins Apache ont besoin de la bibliothèque <strong><a href="apt://libwww-perl" class="interwiki iw_apt" title="apt://libwww-perl">libwww-perl</a></strong>.
</p>

<p>
Afin de récupérer les données statistique d&#039;apache le module <strong>status</strong> doit être activé :
</p>
<pre class="code">sudo a2enmod status</pre>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[plugins Apache] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="plugins_apache" /><input type="hidden" name="codeblockOffset" value="13" /><input type="hidden" name="range" value="9270-9501" /><button type="submit" title="plugins Apache" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit11" id="plugins_mysql">plugins Mysql</h3>
<div class="level3">

<p>
Normalement les plugins mysql sont directement activés à l&#039;installation. 
</p>

<p>
Si ce n&#039;est pas le cas, vous pouvez taper:  
</p>
<pre class="code">munin-node-configure</pre>

<p>
Cela vous donnera une liste des plugins en précisant s&#039;ils sont installés et s&#039;ils peuvent fonctionner. 
</p>

<p>
Si vous avez une erreur pour les plugins mysql, vous devrez corriger les erreurs et réactiver manuellement les plugins mysql. 
</p>

</div>

<h5 id="erreur_missing_dependency_cachecache">Erreur Missing dependency Cache::Cache</h5>
<div class="level5">

<p>
Vous pouvez résoudre cette erreur en installant le paquet: <strong><a href="apt://libcache-cache-perl" class="interwiki iw_apt" title="apt://libcache-cache-perl">libcache-cache-perl</a></strong>
</p>

<p>
Une fois installé, vérifier que votre problème est bien corrigé avec munin-node-configure. 
Vous pouvez ensuite réactiver les plugins mysql: 
</p>
<pre class="code">ln -s /usr/share/munin/plugins/mysql_* /etc/munin/plugins/</pre>

<p>
Pour finir, rechargez la configuration de munin pour que ce soit pris en compte: reload munin-node
</p>

</div>

<h5 id="installer_davantage_de_plugins_mysql">Installer davantage de plugins MySQL</h5>
<div class="level5">
<div class="noteclassic">Munin est un outil de surveillance qui consomme peu de ressources, mais l&#039;activation des plugins MySQL peut augmenter significativement les ressources utilisées.
</div>
<p>
Vous pouvez installer plusieurs autres plugins mysql pour suivre par exemple la valeur de max_connection, le débit réseau, le type de requête etc …
Pour avoir une liste des plugins que vous pouvez ajouter allez dans le dossier: 
</p>
<pre class="code">cd /usr/share/munin/plugins</pre>

<p>
et faites:
</p>
<pre class="code">./mysql_ suggest</pre>

<p>
Vous obtiendrez donc la liste des graphs que peut faire mysql_. 
Exemple:
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> bin_relay_log</div>
</li>
<li class="level1"><div class="li"> commands</div>
</li>
<li class="level1"><div class="li"> connections</div>
</li>
<li class="level1"><div class="li"> files_tables</div>
</li>
<li class="level1"><div class="li"> innodb_bpool</div>
</li>
<li class="level1"><div class="li"> innodb_bpool_act</div>
</li>
<li class="level1"><div class="li"> innodb_insert_buf</div>
</li>
<li class="level1"><div class="li"> innodb_io</div>
</li>
<li class="level1"><div class="li"> innodb_io_pend</div>
</li>
<li class="level1"><div class="li"> innodb_log</div>
</li>
<li class="level1"><div class="li"> innodb_rows</div>
</li>
<li class="level1"><div class="li"> innodb_semaphores</div>
</li>
<li class="level1"><div class="li"> innodb_tnx</div>
</li>
<li class="level1"><div class="li"> myisam_indexes</div>
</li>
<li class="level1"><div class="li"> network_traffic</div>
</li>
<li class="level1"><div class="li"> qcache</div>
</li>
<li class="level1"><div class="li"> qcache_mem</div>
</li>
<li class="level1"><div class="li"> replication</div>
</li>
<li class="level1"><div class="li"> select_types</div>
</li>
<li class="level1"><div class="li"> slow</div>
</li>
<li class="level1"><div class="li"> sorts</div>
</li>
<li class="level1"><div class="li"> table_locks</div>
</li>
<li class="level1"><div class="li"> tmp_tables</div>
</li>
</ul>

<p>
Si vous voulez ajouter qcache par exemple, faites un lien de la sorte:
</p>
<pre class="code"> ln -s /usr/share/munin/plugin/mysql_ /etc/munin/plugins/mysql_qcache</pre>

<p>
C&#039;est donc sous la forme: ln -ls /usr/share/munin/plugin/mysql_ /etc/munin/plugins/mysql_NomDuPlugin
</p>

</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[plugins Mysql] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="plugins_mysql" /><input type="hidden" name="codeblockOffset" value="14" /><input type="hidden" name="range" value="9502-11612" /><button type="submit" title="plugins Mysql" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit12" id="plugins_proftpd">Plugins Proftpd</h3>
<div class="level3">

<p>
Les plugins Proftpd ont besoin de <strong><a href="apt://logtail" class="interwiki iw_apt" title="apt://logtail">logtail</a></strong>. D&#039;autre part, il faut que vous puissiez lire le contenu du log de transfert de proftpd. Ce dernier est normalement situé à <strong>/var/log/proftpd/xferlog</strong> , mais une vérification s&#039;impose : lisez le fichier de configuration de proftpd, normalement <strong>/etc/proftpd/proftpd.conf</strong> :
</p>
<pre class="code">less /etc/proftpd/proftpd.conf</pre>

<p>
et repérez la balise TransferLog, elle indique l&#039;emplacement du fichier de log qui nous intéresse.
</p>

<p>
Regardez les permissions et propriétaires du fichier. Si le propriétaire est root et son groupe, root, peut être vaut-il mieux modifier son groupe. Je l&#039;ai mis à adm. Et j&#039;ai autorisé la lecture et l&#039;écriture. (l&#039;écriture, je ne sais pas si c&#039;est nécessaire, mais la lecture, oui, assurément !)
</p>
<pre class="code">chown root:adm xferlog
chmod ug+rw xferlog</pre>

<p>
Ensuite, assurez vous que les plugins proftpd tournent bien dans le bon groupe. Pour ce faire, éditez le fichier /etc/munin/plugin-conf.d/munin-node, et repérez (ou ajoutez) la balise [proftpd*] ou [proftpd_*], ajoutez en dessous, le groupe ou l&#039;utilisateur que vous avez réglé sur xferlog, pour moi, cela donne :
</p>
<pre class="code">[proftpd*]
group adm</pre>
<div class="noteclassic">L&#039;auteur tient à signaler que les options de configuration pour les plugins Proftpd peuvent changer (groupe et propriétaire…), c&#039;est à vous de décider suivant ce qui vous parait le mieux.
</div>
</div>
<div class='secedit editbutton_section editbutton_12'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Plugins Proftpd] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="plugins_proftpd" /><input type="hidden" name="codeblockOffset" value="19" /><input type="hidden" name="range" value="11613-13047" /><button type="submit" title="Plugins Proftpd" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit13" id="plugin_df">Plugin df</h3>
<div class="level3">

<p>
Le plugin df, comme tous les plugins qui affichent l&#039;utilisation des disques, risquent de ne pas afficher certaines partitions. La première chose à faire, est de les faire tourner en root en éditant le fichier /etc/munin/plugin-conf.d/munin-node afin de rajouter dans la section df user root : 
</p>
<pre class="code">[df*]
user root</pre>

<p>
Puis relancer le service : 
</p>
<pre class="code">sudo service munin-node restart</pre>

<p>
Vous devriez alors voir toutes vos partitions sauf /home, c&#039;est une nouveauté avec systemd.
</p>

<p>
Il vous faudra alors créer un fichier /etc/systemd/system/munin-node.service.d/override.conf contenant : 
</p>
<pre class="code">[Service]
ProtectHome=read-only</pre>

<p>
Puis relancer systemctl : 
</p>
<pre class="code">sudo systemctl daemon-reload</pre>

<p>
Puis relancer munin : 
</p>
<pre class="code">sudo service munin-node restart</pre>

<p>
Vous devriez maintenant voir toutes vos partitions.
</p>

<p>
S&#039;il en manque, vous pouvez les forcer en éditant de nouveau /etc/munin/plugin-conf.d/munin-node et dans la section [df*], mettre une ligne comme : 
</p>
<pre class="code">     env.include_re /dev/sdc2 /dev/sdd2 /dev/md3</pre>

<p>
S&#039;il y en a en trop, ça va ressembler à : 
</p>
<pre class="code">     env.exclude_re /run /dev/shm /run/lock /sys/fs/cgroup /run/user/1000</pre>

<p>
Ce qui chez moi donne : 
</p>
<pre class="code">[df*]
user root
env.warning 92
env.critical 98
#env.exclude_re ^/run/user
     env.include_re /dev/sdc2 /dev/sdd2 /dev/md3 
     env.exclude_re /run /dev/shm /run/lock /sys/fs/cgroup /run/user/1000</pre>

<p>
Une fois ces modifications effectuées, il faut de nouveau relancer munin : 
</p>
<pre class="code">sudo service munin-node restart</pre>

</div>
<div class='secedit editbutton_section editbutton_13'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Plugin df] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="plugin_df" /><input type="hidden" name="codeblockOffset" value="22" /><input type="hidden" name="range" value="13048-14642" /><button type="submit" title="Plugin df" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit14" id="plugin_sensors">Plugin sensors_</h3>
<div class="level3">

<p>
Ce plugin permet d&#039;afficher la température, la tension et la vitesse des ventilateurs. Il utilise <a href="/lm-sensors" class="wikilink1" title="lm-sensors">lm-sensors</a> pour cela. 
</p>

<p>
Théoriquement, on peut dire à Munin de ne pas grapher tel ou tel capteur (température incohérente, ventilateur affichant systématiquement une vitesse de rotation à 0…) en éditant /etc/munin/plugin-conf.d/sensors.conf et en rajoutant : 
</p>
<pre class="code">[sensors_*]
  env.ignore_temp3
  env.ignore_temp4
  env.ignore_temp5
  env.ignore_fan5</pre>

<p>
Mais ça ne fonctionne pas.
</p>

<p>
Le work-around, c&#039;est de créer un fichier /etc/sensors.d/ignore.conf qui indiquera directement à lm-sensors quels capteurs ignorer.
</p>

<p>
Par exemple, si
</p>
<pre class="code">sensors</pre>

<p>
vous retourne : 
</p>
<pre class="code">it8620-isa-0a40
Adapter: ISA adapter
in0:         408.00 mV (min =  +0.00 V, max =  +3.06 V)
in1:           2.51 V  (min =  +0.00 V, max =  +3.06 V)
in2:           2.03 V  (min =  +0.00 V, max =  +3.06 V)
in3:           2.02 V  (min =  +0.00 V, max =  +3.06 V)
in4:           1.06 V  (min =  +0.00 V, max =  +3.06 V)
in5:         948.00 mV (min =  +0.00 V, max =  +3.06 V)
in6:           2.50 V  (min =  +0.00 V, max =  +3.06 V)
3VSB:          3.38 V  (min =  +0.00 V, max =  +6.12 V)
Vbat:          3.14 V
fan1:           0 RPM  (min =    0 RPM)
fan2:           0 RPM  (min =    0 RPM)
fan3:           0 RPM  (min =    0 RPM)
fan4:           0 RPM  (min =    0 RPM)
fan5:           0 RPM  (min =    0 RPM)
temp1:        +33.0°C  (low  = +127.0°C, high = +127.0°C)  sensor = thermistor
temp2:        +36.0°C  (low  = +127.0°C, high = +127.0°C)  sensor = thermistor
temp3:        -55.0°C  (low  = +127.0°C, high = +127.0°C)  sensor = thermistor
temp4:        +41.0°C
temp5:        +46.0°C
temp6:        +46.0°C</pre>

<p>
Le nom du chip est it8620-isa-0a40 et grapher les fan et temp3 ne sert à rien. On va donc éditer le fichier /etc/sensors.d/ignore.conf
</p>
<pre class="code">sudo vim /etc/sensors.d/ignore.conf</pre>

<p>
afin qu&#039;il ressemble à ça : 
</p>
<pre class="code">chip &quot;it8620-isa-0a40&quot;
ignore temp3
ignore fan1
ignore fan2
ignore fan3
ignore fan4
ignore fan5</pre>

<p>
Ainsi ces 6 capteurs ne seront plus graphés dans Munin et n’apparaitront plus lorsque vous lancerez la commande sensors. 
</p>

</div>
<div class='secedit editbutton_section editbutton_14'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Plugin sensors_] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="plugin_sensors" /><input type="hidden" name="codeblockOffset" value="31" /><input type="hidden" name="range" value="14643-16866" /><button type="submit" title="Plugin sensors_" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit15" id="resolution_des_problemes_courants">Résolution des problèmes courants</h3>
<div class="level3">

<p>
Si au niveau de votre grapheur, une sonde ne génère <em>aucun</em> graphe, vérifiez que les access-list configurées dans /etc/munin/munin-node.conf sont correctes et que le pare-feu de la sonde autorise les connexions sur le port associé à la sonde munin (4949 par défaut).
</p>

<p>
Si certains graphes sont générés mais pas tous, vous avez probablement un plugin qui n&#039;est pas fonctionnel. Connectez vous sur une machine pouvant accéder à la sonde (par exemple le grapheur). Sur cette machine, <a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installez le paquet</a> <strong><a href="apt://telnet" class="interwiki iw_apt" title="apt://telnet">telnet</a></strong>. Supposons que la sonde défectueuse ait pour IP x.x.x.x et écoute sur le port 4949. Lancez la commande suivante :
</p>
<pre class="code">telnet x.x.x.x 4949</pre>

<p>
Vous pouvez alors afficher l&#039;aide en appuyant sur entrée afin de voir quelle commande sont disponibles. On retiendra principalement les trois directives suivantes :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li">  <em>list :</em> liste les plugins munin activés,</div>
</li>
<li class="level1"><div class="li"> <em>fetch <em class="u">nom_du_plugin</em> :</em> déclenche une collecte de point avec ce plugin,</div>
</li>
<li class="level1"><div class="li"> <em>quit :</em> quitte la sonde.</div>
</li>
</ul>

<p>
<em>Exemple :</em> dans ce qui suit, on liste les plugins (list), on déclenche une collecte de point pour le plugin apache_accesses (fetch apache_accesses) et on quitte (quit)
</p>
<pre class="code">Trying 127.0.0.1...
Connected to localhost.localdomain.
Escape character is &#039;^]&#039;.
# munin node at nom_de_la_machine_sonde
list
apache_accesses apache_processes apache_volume cpu cpuspeed df df_inode entropy exim_mailqueue exim_mailstats forks fw_conntrack fw_forwarded_local http_loadtime if_eth0 interrupts iostat iostat_ios irqstats load memory mysql_queries mysql_slowqueries mysql_threads open_files open_inodes proc_pri processes smart_sda smart_sdb swap threads uptime users vmstat
fetch apache_accesses
accesses80.value 11705
.
quit
Connection closed by foreign host.</pre>

<p>
Dans cet exemple, la commande s&#039;est bien déroulée, donc le plugin est fonctionnel. En cas de message d&#039;erreur, vérifiez dans la section dédiée au plugin mis en cause que vous n&#039;avez pas oublié d&#039;installer un paquet sur la machine sonde (par exemple libwww-perl si vous utilisez un plugin munin concernant apache).
</p>

</div>
<div class='secedit editbutton_section editbutton_15'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Résolution des problèmes courants] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="resolution_des_problemes_courants" /><input type="hidden" name="codeblockOffset" value="36" /><input type="hidden" name="range" value="16867-19057" /><button type="submit" title="Résolution des problèmes courants" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit16 page-header" id="regles_iptables_firewall">Règles Iptables (Firewall)</h2>
<div class="level2">
<pre class="code"> iptables -A OUTPUT -p tcp --sport 4949 -j ACCEPT
 iptables -A INPUT -p tcp --dport 4949 -j ACCEPT</pre>

<p>
Vous pouvez également autoriser la &quot;récolte&quot; d&#039;informations depuis un seul serveur en spécifiant la source autorisée dans la deuxième règle.
</p>

<p>
Par exemple, chez moi, seul le pc de la maison est autorisé à récupérer les informations du serveur dédié. En supposant que mon ip à la maison soit 82.xxx.xxx.xxx Les commandes iptables à lancer sur le serveur ressembleraient donc à ceci:
</p>
<pre class="code"> iptables -A OUTPUT -p tcp --sport 4949 -j ACCEPT
 iptables -A INPUT -p tcp --dport 4949 -s 82.xxx.xxx.xxx -j ACCEPT</pre>

<p>
ps: ces règles s&#039;appliquent uniquement avec une police par défaut &quot;DROP&quot;
</p>

</div>
<div class='secedit editbutton_section editbutton_16'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Règles Iptables (Firewall)] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="regles_iptables_firewall" /><input type="hidden" name="codeblockOffset" value="38" /><input type="hidden" name="range" value="19058-19797" /><button type="submit" title="Règles Iptables (Firewall)" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit17 page-header" id="liens">Liens</h2>
<div class="level2">
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <a href="http://munin-monitoring.org//" class="urlextern" title="http://munin-monitoring.org//" rel="nofollow">Site officiel de Munin (EN)</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://muninexchange.projects.linpro.no/" class="urlextern" title="http://muninexchange.projects.linpro.no/" rel="nofollow">Autres plugins Munin (EN)</a></div>
</li>
<li class="level1"><div class="li"> Exemple de Munin en action : <a href="http://munin.ping.uio.no/" class="urlextern" title="http://munin.ping.uio.no/" rel="nofollow">http://munin.ping.uio.no/</a>, <a href="http://demo.munin-monitoring.org" class="urlextern" title="http://demo.munin-monitoring.org" rel="nofollow"> Démo sur le site officiel</a></div>
</li>
</ul>
<hr />

<p>
<em>Contributeurs : <a href="/utilisateurs/ostaquet" class="wikilink2" title="utilisateurs:ostaquet" rel="nofollow">ostaquet</a>, <a href="/utilisateurs/stephaneguedon" class="wikilink1" title="utilisateurs:stephaneguedon">stephaneguedon</a>, <a href="/utilisateurs/elemmire" class="wikilink1" title="utilisateurs:elemmire">elemmire</a>, <a href="/utilisateurs/rapidos" class="wikilink2" title="utilisateurs:rapidos" rel="nofollow">rapidos</a>, <a href="/utilisateurs/mamiemando" class="wikilink1" title="utilisateurs:mamiemando">MaMieMando</a>, <a href="http://karchnu.fr" class="urlextern" title="http://karchnu.fr" rel="nofollow">Karchnu</a> </em>
</p>

</div>
<div class='secedit editbutton_section editbutton_17'><form class="button btn_secedit form-inline" method="post" action="/munin"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1612707707" /><input type="hidden" name="summary" value="[Liens] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="liens" /><input type="hidden" name="codeblockOffset" value="38" /><input type="hidden" name="range" value="19798-" /><button type="submit" title="Liens" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="munin.txt">munin.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 07/02/2021, 15:21">Le 07/02/2021, 15:21</span></li><li class="text-muted">par FAWTS</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=munin&amp;1635558344" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
