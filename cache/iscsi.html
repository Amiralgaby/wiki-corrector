<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"
  lang="fr" dir="ltr" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>iscsi [Wiki ubuntu-fr]</title>
  <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="shortcut icon" href="/_media/favicon.ico" />
<link rel="apple-touch-icon" href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" />
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="materiel,reseau"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/fonts/united.fonts.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css"/>
<link type="text/css" rel="stylesheet" href="/lib/tpl/bootstrap3/assets/bootstrap/united/bootstrap.min.css"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="Wiki ubuntu-fr"/>
<link rel="start" href="/"/>
<link rel="contents" href="/iscsi?do=index" title="Plan du site"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Catégorie courante" href="/feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="/iscsi?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="/_export/xhtml/iscsi"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="/_export/raw/iscsi"/>
<link rel="canonical" href="http://doc.ubuntu-fr.org/iscsi"/>
<link rel="stylesheet" type="text/css" href="/lib/exe/css.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"bootstrap3":{"mode":"show","toc":[],"config":{"collapsibleSections":0,"fixedTopNavbar":1,"showSemanticPopup":0,"sidebarOnNavbar":0,"tagsOnTop":1,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"tocLayout":"default","useAnchorJS":1}},"id":"iscsi","namespace":"","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f"></script>
<script type="text/javascript" charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=b4a19b95bb4d08daf02b6dd52d7e6abc"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js"></script>
<script type="text/javascript" src="/lib/tpl/bootstrap3/assets/typeahead/bootstrap3-typeahead.min.js"></script>
<!--<![endif]-->
<style type="text/css">@media screen { body { margin-top: 70px; }  #dw__toc.affix { top: 60px; position: fixed !important; }  #dw__toc .nav .nav .nav { display: none; } }</style>
    <!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="united dokuwiki mode_show tpl_bootstrap3 dw-page-on-panel" data-page-id="iscsi">

  <header id="dokuwiki__header" class="dokuwiki container">
    <nav id="dw__navbar" class="navbar navbar-fixed-top navbar-default" role="navigation">

  <div class="container">

    <div class="navbar-header">

      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/accueil"  accesskey="h" title="[H]" class="navbar-brand"><span class="uf uf-cof" id="dw__accueil" style="font-size: 35px;" ></span> <span id="dw__title" style="margin-top:-5px">Wiki ubuntu-fr<span id="dw__tagline">La Documentation francophone</span></span></a>
    </div>

    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav">
        <li>
          <a href="//ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-home"></i><span> Accueil</span></a>        </li>
        <li>
          <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-comments"></i><span> Forum</span></a>        </li>
        <li>
          <a href="//planet.ubuntu-fr.org/" ><i class="fa fa-2x fa-fw fa-globe"></i><span> Planet</span></a>        </li>
      </ul>

            
      
      <div class="navbar-right" id="dw__navbar_items">

        <form action="//forum.ubuntu-fr.org/search_ubuntufr.php" accept-charset="utf-8" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><input id="qsearch" autocomplete="off" type="search" placeholder="Rechercher" accesskey="f" name="q" class="form-control" title="[F]" /><button type="submit" title="Rechercher"><i class="fa fa-fw fa-search"></i></button><input type="hidden" name="do" value="search" /><input type="hidden" name="tsearch" value="wiki" /></div></form>
        
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">


  <li class="dropdown">

    <a href="" class="dropdown-toggle" data-target="#" data-toggle="dropdown" title="" role="button" aria-haspopup="true" aria-expanded="false">
      <i class="fa fa-2x fa-fw fa-wrench"></i> <span class="hidden-lg hidden-md hidden-sm">Outils</span> <span class="caret"></span>
    </a>

    <ul class="dropdown-menu tools" role="menu">
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-cubes"></i> Outils du site      </li>
      <li><a href="/iscsi?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li><li><a href="/iscsi?do=media&amp;ns="  class="action media" rel="nofollow" title="Gestionnaire Multimédia">Gestionnaire Multimédia</a></li><li><a href="/iscsi?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
            <li class="divider" role="separator"></li>
      
    
      <li class="dropdown-header">
        <i class="fa fa-fw fa-file"></i> Outils de la page      </li>
      <li><a href="/iscsi?do=edit"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li><li><a href="/iscsi?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li><li><a href="/iscsi?do=backlink"  class="action backlink" rel="nofollow" title="Liens de retour">Liens de retour</a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Haut de page [T]">Haut de page</a></li>
      
        </ul>
  </li>


</ul>


        <ul class="nav navbar-nav">

          
          
                    <li>
            <span class="dw__actions dw-action-icon">
              <a href="/iscsi?do=login&amp;sectok="  class="action btn btn-default navbar-btn login" rel="nofollow" title="S&#039;identifier"><span class="">S'identifier</span></a>            </span>
          </li>
          
        </ul>

        
        

      </div>

    </div>
  </div>
</nav>
  </header>

  <div id="dokuwiki__top" class="dokuwiki container">

    <div id="dokuwiki__pageheader">

      
      
      <p class="pageId text-right small">
        <span class="label label-primary">iscsi</span>      </p>

      <div id="dw__msgarea" class="small">
              </div>

    </div>

    <main class="main row" role="main">

      
      <article id="dokuwiki__content" class="container" itemscope itemtype="http://schema.org/Article" itemref="dw__license">

        
<nav id="dw__pagetools" class="hidden-print">
  <div class="tools panel panel-default pull-right ">
    <ul class="nav nav-stacked nav-pills">
      <li><a href="/iscsi?do=edit"  class="action text-muted edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]"><i class="fa fa-fw fa-pencil-square-o"></i><span class="sr-only"> Modifier cette page</span></a></li><li><a href="/iscsi?do=revisions"  class="action text-muted revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]"><i class="fa fa-fw fa-clock-o"></i><span class="sr-only"> </span></a></li><li><a href="/iscsi?do=backlink"  class="action text-muted backlink" rel="nofollow" title="Liens de retour"><i class="fa fa-fw fa-link"></i><span class="sr-only"> Liens de retour</span></a></li>    </ul>
  </div>
</nav>

        <div class="panel panel-default" itemprop="articleBody">
          <div class="page panel-body">

            <div class="dw-content-page "><div class="dw-toc hidden-print"><script>JSINFO.bootstrap3.toc = [{"link":"#configuration_du_serveur_et_de_ses_disques","title":"Configuration du serveur et de ses disques","level":1},{"link":"#installation_du_service","title":"Installation du service","level":2},{"link":"#cas_d_un_disque_emule","title":"Cas d'un disque \u00e9mul\u00e9","level":2},{"link":"#cas_pour_un_disque_dur_ou_une_partition_en_dur","title":"Cas pour un disque dur ou une partition en dur","level":2},{"link":"#configuration_finale","title":"Configuration finale","level":2},{"link":"#configuration_du_poste_client_gnulinux","title":"Configuration du poste client GNU\/Linux","level":1},{"link":"#installation_manuelle","title":"Installation manuelle","level":2},{"link":"#montage_automatique_au_demarrage","title":"Montage automatique au d\u00e9marrage","level":2},{"link":"#script_automatique_pour_pc_diskless_pxe_boot_en_live","title":"Script automatique pour PC diskless (PXE boot en Live)","level":2},{"link":"#poste_client_windows","title":"Poste client Windows","level":1}];</script>
<!-- TOC START -->
<nav id="dw__toc" role="navigation" class="toc-panel panel panel-default small">
<h6 data-toggle="collapse" data-target="#dw__toc .toc-body" title="Table des matières" class="panel-heading toc-title"><i class="fa fa-fw fa-th-list"></i> <span>Table des matières</span> <i class="caret"></i></h6>
<div class="panel-body  toc-body collapse in">

<ul class="nav toc">
<li class="level1"><a href="#configuration_du_serveur_et_de_ses_disques">Configuration du serveur et de ses disques</a>
<ul class="nav toc">
<li class="level2"><a href="#installation_du_service">Installation du service</a></li>
<li class="level2"><a href="#cas_d_un_disque_emule">Cas d&#039;un disque émulé</a></li>
<li class="level2"><a href="#cas_pour_un_disque_dur_ou_une_partition_en_dur">Cas pour un disque dur ou une partition en dur</a></li>
<li class="level2"><a href="#configuration_finale">Configuration finale</a></li>
</ul>
</li>
<li class="level1"><a href="#configuration_du_poste_client_gnulinux">Configuration du poste client GNU/Linux</a>
<ul class="nav toc">
<li class="level2"><a href="#installation_manuelle">Installation manuelle</a></li>
<li class="level2"><a href="#montage_automatique_au_demarrage">Montage automatique au démarrage</a></li>
<li class="level2"><a href="#script_automatique_pour_pc_diskless_pxe_boot_en_live">Script automatique pour PC diskless (PXE boot en Live)</a></li>
</ul>
</li>
<li class="level1"><a href="#poste_client_windows">Poste client Windows</a></li>
</ul>

</div>
</nav>
<!-- TOC END -->
</div><!-- CONTENT --><div class="dw-content"><div class="tags"><span>
	<a href="/materiel" class="wikilink1" title="materiel" rel="tag">matériel</a>,
	<a href="/reseau" class="wikilink1" title="reseau" rel="tag">réseau</a>
</span></div>
<hr />

<h1 class="sectionedit1 page-header" id="iscsi">ISCSI</h1>
<div class="level1">
<div class="noteimportant">Cette configuration a été effectuée sous un serveur local disposant d&#039;<a href="/precise" class="wikilink1" title="precise">ubuntu 12.04.1 LTS</a>, il se peut qu&#039;elle diffère pour des versions antérieures
</div>
<p>
Un SAN, qu&#039;est ce que c&#039;est ? <img src="/lib/images/smileys/icon_razz.gif" class="icon" alt=":-P" />
</p>

<p>
Un SAN, tout comme un NAS usant des protocoles <abbr title="Network File System">NFS</abbr> ou SAMBA, vous permet de partager de l&#039;espace disque via une image disque simulant un disque dur ou d&#039;un disque complet, via le protocole ISCSI.<br/>

La nette différence résulte dans le fait que c&#039;est le système client qui prend en charge le formatage et le système de fichiers de ce dernier, sans compter que les performances seront généralement meilleures que sous les deux autres protocoles, notamment sur de multiples petits fichiers. <img src="/lib/images/smileys/icon_wink.gif" class="icon" alt=";-)" />
</p>

<p>
Selon <a href="http://blog.gaetan-grigis.eu/systeme/administration/mise-en-place-discsi-pour-le-partage-de-donnees/" class="urlextern" title="http://blog.gaetan-grigis.eu/systeme/administration/mise-en-place-discsi-pour-le-partage-de-donnees/" rel="nofollow">cet article</a>, l&#039;accès en écriture serait amélioré de 20% par rapport en <abbr title="Network File System">NFS</abbr>, et de 400% (théorique, dépend de votre configuration réseau) en lecture. <img src="/lib/images/smileys/icon_fun.gif" class="icon" alt="^_^" />
</p>

<p>
Autres points importants, cette technique vous permet de soulager votre serveur en terme de ressources demandées (au détriment du poste client toutefois), mais surtout de mapper en dur cet espace disque comme s&#039;il faisait partie intégrante de la machine client.<br/>

Ainsi certains logiciels comme le client <a href="/steam" class="wikilink1" title="steam">Steam</a> sous Windows, développé pour empêcher l&#039;utilisateur de faire fonctionner ce client logiciel de jeux, sous un disque réseau (<img src="/lib/images/smileys/facepalm.gif" class="icon" alt="m(" />), n&#039;y verra plus que du feu. <img src="/lib/images/smileys/icon_lol.gif" class="icon" alt="LOL" /><br/>

Cette technique est aussi valable pour d&#039;autres logiciels n&#039;autorisant leur utilisation que sur des disques locaux.  <img src="/lib/images/smileys/icon_wink.gif" class="icon" alt=";-)" />
</p>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[ISCSI] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="iscsi" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="33-1655" /><button type="submit" title="ISCSI" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit2 page-header" id="configuration_du_serveur_et_de_ses_disques">Configuration du serveur et de ses disques</h2>
<div class="level2">

<p>
La configuration est également assez simple une fois le concept saisi, deux choix s&#039;offrent à vous, dédier un disque complet à l&#039;utilisation de ISCSI pour un partage réseau en dur, ou bien dédier un espace choisi via la création d&#039;un fichier image d&#039;un disque dur.
</p>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Configuration du serveur et de ses disques] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_du_serveur_et_de_ses_disques" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1656-1984" /><button type="submit" title="Configuration du serveur et de ses disques" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit3" id="installation_du_service">Installation du service</h3>
<div class="level3">

<p>
L&#039;installation est très simple, et se résume par l&#039;<a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installation des paquets</a> <strong><a href="apt://iscsitarget,iscsitarget-source,iscsitarget-dkms" class="interwiki iw_apt" title="apt://iscsitarget,iscsitarget-source,iscsitarget-dkms">iscsitarget iscsitarget-source iscsitarget-dkms</a></strong>.<br/>

Ce qui peut se résumer avec l&#039;outil <a href="/apt-get" class="wikilink1" title="apt-get">apt-get</a> dans un <a href="/terminal" class="wikilink1" title="terminal">terminal</a> par la <a href="/commande_shell" class="wikilink1" title="commande_shell">commande</a> :
</p>
<pre class="code">sudo apt-get install iscsitarget iscsitarget-source iscsitarget-dkms</pre>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Installation du service] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation_du_service" /><input type="hidden" name="codeblockOffset" value="0" /><input type="hidden" name="range" value="1985-2444" /><button type="submit" title="Installation du service" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit4" id="cas_d_un_disque_emule">Cas d&#039;un disque émulé</h3>
<div class="level3">

<p>
Voici la commande nécessaire à la création d&#039;un disque virtuel de 40Go, vous devrez modifier fs.iscsi.disk par le chemin et le nom du fichier que vous aurez choisi, et la valeur 40000 correspondra à la taille du disque choisie.
</p>
<pre class="code">dd if=/dev/zero of=fs.iscsi.disk bs=1M count=40000</pre>

<p>
<a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Éditer avec les droits d&#039;administration</a> le fichier de configuration <strong>/etc/iet/ietd.conf</strong> pour y ajouter:
</p>
<pre class="file">Target nom-libre:fs.iscsi.disk
Lun 0 Path=/chemin/du/disque/virtuel/fs.iscsi.disk,Type=fileio</pre>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Cas d&#039;un disque émulé] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="cas_d_un_disque_emule" /><input type="hidden" name="codeblockOffset" value="1" /><input type="hidden" name="range" value="2445-3037" /><button type="submit" title="Cas d&#039;un disque émulé" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit5" id="cas_pour_un_disque_dur_ou_une_partition_en_dur">Cas pour un disque dur ou une partition en dur</h3>
<div class="level3">

<p>
<a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Éditer avec les droits d&#039;administration</a> le fichier de configuration <strong>/etc/iet/ietd.conf</strong> pour y ajouter:
</p>
<pre class="file">Target nom-libre:sdb2
Lun 0 Path=/dev/sdb2,Type=fileio</pre>

<p>
En adaptant la partition <em>/dev/sdb2</em> à votre cas.
</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Cas pour un disque dur ou une partition en dur] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="cas_pour_un_disque_dur_ou_une_partition_en_dur" /><input type="hidden" name="codeblockOffset" value="3" /><input type="hidden" name="range" value="3038-3368" /><button type="submit" title="Cas pour un disque dur ou une partition en dur" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit6" id="configuration_finale">Configuration finale</h3>
<div class="level3">

<p>
Enfin, <a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">éditer avec les droits d&#039;administration</a> le fichier de configuration <strong>/etc/default/iscsitarget</strong> et remplacez la valeur &quot;false&quot; par &quot;true&quot; :
</p>
<pre class="file"> ISCSITARGET_ENABLE=false </pre>

<p>
deviendra ainsi
</p>
<pre class="file">ISCSITARGET_ENABLE=true </pre>

<p>
Il ne reste plus qu&#039;à redémarrer le <a href="/services" class="wikilink1" title="services">service</a> pour prendre en compte les modifications :
</p>
<pre class="code">sudo service iscsitarget restart</pre>

<p>
Devra vous indiquer :
</p>
<pre class="code"> * Removing iSCSI enterprise target devices:              [ OK ]
 * Starting iSCSI enterprise target service                   [ OK ]
                                                                                   [ OK ]</pre>

<p>
Enfin, vous pouvez vérifier que votre disque a bien été pris en compte via cette commande :
</p>
<pre class="code">cat /proc/net/iet/volume</pre>
<div class="noteimportant">Si votre serveur est protégé par un <a href="/pare-feu" class="wikilink1" title="pare-feu">pare-feu</a>, ouvrez le port 3260 vers votre réseau local<br/>

Par exemple : <pre class="code">sudo ufw allow to any port 3260 from 192.168.1.0/24</pre>

</div>
</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Configuration finale] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_finale" /><input type="hidden" name="codeblockOffset" value="4" /><input type="hidden" name="range" value="3369-4438" /><button type="submit" title="Configuration finale" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit7 page-header" id="configuration_du_poste_client_gnulinux">Configuration du poste client GNU/Linux</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Configuration du poste client GNU/Linux] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="configuration_du_poste_client_gnulinux" /><input type="hidden" name="codeblockOffset" value="10" /><input type="hidden" name="range" value="4439-4490" /><button type="submit" title="Configuration du poste client GNU/Linux" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit8" id="installation_manuelle">Installation manuelle</h3>
<div class="level3">

<p>
Sur le poste client, <a href="/tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installez le paquet</a> <strong><a href="apt://open-iscsi" class="interwiki iw_apt" title="apt://open-iscsi">open-iscsi</a></strong>, puis lancez une détection (192.168.0.1 étant à remplacer par l&#039;<a href="/tutoriel/connaitre_son_adresse_ip" class="wikilink1" title="tutoriel:connaitre_son_adresse_ip">ip du serveur</a>):
</p>
<pre class="code">sudo iscsiadm --mode discovery --type sendtargets --portal 192.168.0.1</pre>

<p>
Par exemple, sur un disque virtuel étant dédié à <a href="/steam" class="wikilink1" title="steam">Steam</a>, cela peut donner le résultat :
</p>
<pre class="code">192.168.0.1:3260,1 steam:fs.iscsi.steam</pre>

<p>
Ensuite pour lier le disque virtuel au couple machine/client (en adaptant selon vos valeurs) :
</p>
<pre class="code">sudo iscsiadm --mode node --targetname steam:fs.iscsi.steam \ --portal 192.168.0.1 --login</pre>

<p>
Si l&#039;opération s&#039;est bien déroulée, toujours avec l&#039;exemple du disque virtuel dédié à Steam,  s&#039;affiche alors quelque chose comme : 
</p>
<pre class="code">Logging in to [iface: default, target: steam:fs.iscsi.steam, portal: 192.168.0.1,3260] (multiple)</pre>

<p>
Remarquez le jeu de mot… (Steam/Valve/Portal ! <img src="/lib/images/smileys/facepalm.gif" class="icon" alt="m(" /> )
</p>

<p>
Voilà, votre disque virtuel distant SCSI est disponible en tant que périphérique (dans /dev) sur votre machine cliente Linux !
</p>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Installation manuelle] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="installation_manuelle" /><input type="hidden" name="codeblockOffset" value="10" /><input type="hidden" name="range" value="4491-5623" /><button type="submit" title="Installation manuelle" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit9" id="montage_automatique_au_demarrage">Montage automatique au démarrage</h3>
<div class="level3">

<p>
Si vous voulez que les disques distants soient automatiquement montés au démarrage de votre système, il faut <a href="/tutoriel/comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">éditer avec les droits d&#039;administration</a> le fichier <strong>/etc/iscsi/iscsid.conf</strong> et dé-commenter <sup><a href="#fn__1" id="fnt__1" class="fn_top">1)</a></sup>
</p>
<pre class="file">node.startup = automatic</pre>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Montage automatique au démarrage] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="montage_automatique_au_demarrage" /><input type="hidden" name="codeblockOffset" value="14" /><input type="hidden" name="range" value="5624-5982" /><button type="submit" title="Montage automatique au démarrage" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h3 class="sectionedit10" id="script_automatique_pour_pc_diskless_pxe_boot_en_live">Script automatique pour PC diskless (PXE boot en Live)</h3>
<div class="level3">

<p>
Lors d&#039;un démarrage en mode <a href="/netboot_live" class="wikilink1" title="netboot_live">Netboot Live</a>, votre PC client est totalement dénudé.<br/>

Ce script va vous permettre de réaliser l&#039;installation de &#039;open-iscsi&#039;, d&#039;interroger le serveur et de pouvoir choisir le disque à connecter.
Il permet aussi de déconnecter un disque.
</p>

</div>

<h4 id="version_terminal">Version terminal</h4>
<div class="level4">
<pre class="code">#! /bin/sh
# gestion automatique iSCSI

if [ x$1 = x ];
then
  echo &quot;You have to give the server (IP or URL) or -u to disconnect disks&quot;
  exit
fi

installed=`dpkg -l &quot;open-iscsi*&quot; | grep ii | cut -d &#039; &#039; -f 1`
if [ &quot;x$installed&quot; = &quot;x&quot; ];
then
   apt-get install -y open-iscsi open-iscsi-utils
fi

if [ &quot;$1&quot; != &quot;-u&quot; ];
then
  info=`iscsiadm --mode discovery --type sendtargets --portal $1`
  pos=2
  while [ 1 ];
  do
    volume=`echo $info | cut -d &#039; &#039; -f $pos`
    if [ &quot;$volume&quot; = &quot;&quot; ]; then break;fi
    echo &quot;`expr $pos / 2` - $volume&quot;
    pos=`expr $pos + 2`
  done
  echo -n &quot;\nChoose the disk number : &quot;; read n
  bon=`echo &quot;123456789&quot; | grep $n`
  if [ &quot;$bon&quot; = &quot;&quot; ]; then echo &quot;Error, you do type a number&quot;; exit;fi
  n=`expr $n + $n`
  if [ $n -ge $pos ]; then echo &quot;Error, bad disks number&quot;; exit;fi
  disk=`echo $info | cut -d &#039; &#039; -f $n`
  session=`iscsiadm -m session | grep $disk`
  if [ &quot;$session&quot; != &quot;&quot; ]; then echo &quot;Error, iSCSI disk already connected&quot;; exit;fi

  iscsiadm --mode node --targetname $disk \ --portal $1 --login
  iscsiadm -m session
else
  sion=`iscsiadm -m session`
  if [ &quot;$sion&quot; = &quot;&quot; ]; then exit;fi
  sion=`iscsiadm -m session | cut -d &#039; &#039; -f 4`
  pos=1
  for i in $sion;
  do 
     echo &quot;$pos - $i&quot;
     pos=`expr $pos + 1`
  done
  echo -n &quot;\nChoose the disk number : &quot;; read n
  bon=`echo &quot;123456789&quot; | grep $n`
  if [ &quot;$bon&quot; = &quot;&quot; ]; then echo &quot;Error, you do type a number&quot;; exit;fi
  if [ $n -ge $pos ]; then echo &quot;Error, bad disks number&quot;; exit;fi

  name=`echo $sion | cut -d &#039; &#039; -f $n`
  iscsiadm -m node -u -T $name
fi</pre>

<p>
Copier tout ce code dans un fichier, la syntaxe de lancement est très simple :
</p>
<ul class=" fix-media-list-overlap">
<li class="level1"><div class="li"> <pre class="code">sudo sh &lt;SCRIPT&gt; &lt;IP_DU_SERVEUR&gt;</pre>

<p>
 pour connecter un disque
</p>
</div>
</li>
<li class="level1"><div class="li"> <pre class="code">sudo sh &lt;SCRIPT&gt; -u </pre>

<p>
pour déconnecter un disque
</p>
</div>
</li>
</ul>

</div>

<h4 id="version_avec_interface_graphique">version avec interface graphique</h4>
<div class="level4">
<pre class="code">#! /bin/sh
# gestion automatique iSCSI

installed=`dpkg -l &quot;open-iscsi*&quot; | grep ii | cut -d &#039; &#039; -f 1`

if [ &quot;x$installed&quot; = &quot;x&quot; ];
then
  zenity --question --title &quot;Manager not here&quot; --text=&quot;open-iscsi is not installed\nWould you proceed to this now ?&quot;
  if [ $? = 0 ]
  then
    apt-get install -y open-iscsi open-iscsi-utils
  else
    echo &quot;Operation aborted&quot;
  fi
  exit
fi

if [ x$1 = x ];
then
  zenity --error --title &quot;Syntax&quot; --text=&quot;You have to give the server (IP or URL)\n or -u to disconnect disks&quot;
  exit
fi

if [ &quot;$1&quot; != &quot;-u&quot; ];
then
  info=`iscsiadm --mode discovery --type sendtargets --portal $1`
  pos=2
  liste=&quot;&quot;
  while [ 1 ];
  do
    volume=`echo $info | cut -d &#039; &#039; -f $pos`
    if [ &quot;$volume&quot; = &quot;&quot; ]; then break;fi
    list=`echo &quot;$list $volume&quot;`
    pos=`expr $pos + 2`
  done
  
  disk=`zenity --list --title &quot;Choose an iSCSI disk&quot; --column=&quot;Target&quot; $list`
  if [ $? != 0 ]; then exit; fi

  session=`iscsiadm -m session | grep $disk`
  if [ &quot;$session&quot; != &quot;&quot; ]; then zenity --error --title &quot;Error&quot; --text=&quot;iSCSI disk already connected&quot;; exit;fi

  iscsiadm --mode node --targetname $disk \ --portal $1 --login
  iscsiadm -m session
else
  sion=`iscsiadm -m session`
  if [ &quot;$sion&quot; = &quot;&quot; ]; then zenity --error --title &quot;Error&quot; --text=&quot;No connected disk&quot;;exit;fi
  sion=`iscsiadm -m session | cut -d &#039; &#039; -f 4`

  name=`zenity --list --title &quot;Choose an iSCSI disk&quot; --column=&quot;Target&quot; $sion`
  if [ $? != 0 ]; then exit; fi

  iscsiadm -m node -u -T $name
fi</pre>

<p>
Sauvegardez ce scripte dans un fichier par exemple &quot;iscsi-ctrl&quot;, rendez le exécutable et lancez le via &#039;sudo&#039;
</p>
<pre class="code">chmod +x iscsi-ctrl
sudo ./iscsi-ctrl</pre>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Script automatique pour PC diskless (PXE boot en Live)] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="script_automatique_pour_pc_diskless_pxe_boot_en_live" /><input type="hidden" name="codeblockOffset" value="15" /><input type="hidden" name="range" value="5983-9861" /><button type="submit" title="Script automatique pour PC diskless (PXE boot en Live)" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div>
<h2 class="sectionedit11 page-header" id="poste_client_windows">Poste client Windows</h2>
<div class="level2">

<p>
Concernant les machines sous Windows, ça n&#039;a pas lieu d&#039;être traité ici, même si il semblerait que sous Windows 8 Entreprise, il n&#039;y ai pas de souci particulier pour connecter un disque via ISCSI et le formater en NTFS en quelques clics; <a href="http://technet.microsoft.com/fr-fr/library/ee338480%28v=ws.10%29.aspx" class="urlextern" title="http://technet.microsoft.com/fr-fr/library/ee338480%28v=ws.10%29.aspx" rel="nofollow">rendez vous sur la page ISCSI du support technique de Microsoft</a> pour obtenir des informations à ce sujet.
</p>

<p>
À noter qu&#039;il y a eu des régressions entre Windows 7 et Windows 8, par exemple sous Windows 7 pro, il était possible de configurer sans problème le partage de fichiers via <abbr title="Network File System">NFS</abbr>, ce qui est absent de Windows 8 pro, et présent uniquement dans la version Entreprise.
</p>

<p>
<del>Il est nécessaire d&#039;avoir au minimum la version Business (ou Enterprise) pour Windows 7 également.</del>
</p>

<p>
C&#039;est totalement faux, on peut bien effectuer la manip sans soucis sur Windows 7 pro, dans les composants logiciels !
</p>
<hr />

<p>
<em>Contributeurs:billou</em>
<em>Contributeurs:Maisondouf</em>
</p>

</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit form-inline" method="post" action="/iscsi"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1483699217" /><input type="hidden" name="summary" value="[Poste client Windows] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="hid" value="poste_client_windows" /><input type="hidden" name="codeblockOffset" value="20" /><input type="hidden" name="range" value="9862-" /><button type="submit" title="Poste client Windows" class=" btn btn-default btn btn-xs btn-default">Modifier</button></div></form></div><hr/><div class="footnotes">
<div class="fn"><sup><a href="#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
<div class="content">enlever le dièse &quot;#&quot;</div></div>
</div>

</div><!-- /CONTENT --></div>
          </div>
        </div>

        <div class="small text-right">

                    <span class="docInfo">
            <ul class="list-inline"><li><i class="fa fa-fw fa-file-text-o text-muted"></i> <span title="iscsi.txt">iscsi.txt</span></li><li><i class="fa fa-fw fa-calendar text-muted"></i> Dernière modification: <span title="Le 06/01/2017, 11:40">Le 06/01/2017, 11:40</span></li><li class="text-muted">par 193.52.40.65</li></ul>          </span>
          
          
        </div>

      </article>

      
    </main>

    <footer id="dw__footer" class="navbar navbar-default">
  <div class="container">

    <div class="small navbar-text">

            <div class="footer-dw-title row">
        <div class="media col-sm-4">
          <!--<div class="media-left">
            <img src="/_media/logo.png" alt="Wiki ubuntu-fr" class="media-object" style="width:32px" />
          </div> -->
          <div class="media-body">
            <h4 class="media-heading">Documentation ubuntu-fr</h4>
            <p>
              Les pages de cette documentation sont rédigées par les utilisateurs
              pour les utilisateurs. Apportez-nous votre aide pour améliorer
              le contenu de cette documentation.
            </p>
          </div>
        </div>
        <div class="col-sm-4">
          <h4>Liens utiles</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/debutant" ><i class="fa fa-fw fa-child" style="font-size: 1.3em;"></i> Débuter sur Ubuntu</a>            </li>
            <li>
              <a href="/wiki/participer_wiki" ><i class="fa fa-fw fa-edit" style="font-size: 1.3em;"></i> Participer à la documentation</a>            </li>
            <li>
              <a href="/documentation_hors_ligne" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Documentation hors ligne</a>            </li>
            <li>
              <a href="//www.ubuntu-fr.org/telechargement" ><i class="fa fa-fw fa-arrow-circle-down" style="font-size: 1.3em;"></i> Télécharger Ubuntu</a>            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h4>Obtenir de l'aide</h4>
          <ul class="list-group list-unstyled">
            <li>
              <a href="/tutoriel/comment_obtenir_une_reponse_satisfaisante" ><i class="fa fa-fw fa-info-circle" style="font-size: 1.3em;"></i> Chercher de l'aide</a>            </li>
            <li>
              <a href="//doc.ubuntu-fr.org/" ><i class="fa fa-fw fa-book" style="font-size: 1.3em;"></i> Consulter la documentation</a>            </li>
            <li>
              <a href="//forum.ubuntu-fr.org/" ><i class="fa fa-fw fa-comments" style="font-size: 1.3em;"></i> Consulter le Forum</a>            </li>
            <li>
              <a href="//guide.ubuntu-fr.org/" ><i class="fa fa-fw fa-question-circle" style="font-size: 1.3em;"></i> Lisez le guide</a>            </li>
          </ul>
        </div>
        <p>&nbsp;</p>
      </div>
      
      
      <div class="footer-license row">

        <div class="col-sm-6">
                    <p>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license"><img src="/lib/tpl/bootstrap3/images/license/cc.png" width="24" height="24" alt="cc" /> <img src="/lib/tpl/bootstrap3/images/license/by.png" width="24" height="24" alt="by" /> <img src="/lib/tpl/bootstrap3/images/license/sa.png" width="24" height="24" alt="sa" /> </a>          </p>
          <p class="small">
            Sauf mention contraire, le contenu de ce wiki est placé sous les termes de la licence suivante :<br/><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" title="CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported" target="" itemscope itemtype="http://schema.org/CreativeWork" itemprop="license" rel="license" class="license">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a>          </p>
                  </div>

        <div class="col-sm-6">
                    <ul id="dw__badges" class="list-inline text-right hidden-print">

  <li>
    <a href="https://www.dokuwiki.org/template:bootstrap3" title="Bootstrap template for DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/bootstrap.png" width="20" alt="Bootstrap template for DokuWiki" />
    </a>
  </li>

  <li>
    <a href="https://www.php.net" title="Powered by PHP" target="">
      <img src="/lib/tpl/bootstrap3/images/php.png" width="20" alt="Powered by PHP" />
    </a>
  </li>

  <li>
    <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="">
      <img src="/lib/tpl/bootstrap3/images/html5.png" width="20" alt="Valid HTML5" />
    </a>
  </li>

  <li>
    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="">
      <img src="/lib/tpl/bootstrap3/images/css3.png" width="20" alt="Valid CSS" />
    </a>
  </li>

  <li>
    <a href="https://www.dokuwiki.org/" title="Driven by DokuWiki" target="">
      <img src="/lib/tpl/bootstrap3/images/logo.png" width="20" alt="Driven by DokuWiki" />
    </a>
  </li>

</ul>
                  </div>

      </div>

    </div>

  </div>
</footer>
<img src="/lib/exe/indexer.php?id=iscsi&amp;1635554398" width="2" height="1" alt="" />
    <a href="#dokuwiki__top" class="back-to-top hidden-print btn btn-default btn-sm" title="Aller au contenu" accesskey="t"><i class="fa fa-chevron-up"></i></a>

    <div id="screen__mode">      <span class="visible-xs-block"></span>
      <span class="visible-sm-block"></span>
      <span class="visible-md-block"></span>
      <span class="visible-lg-block"></span>
    </div>

  </div>

    <!-- Piwik -->
		<script type="text/javascript">
		  var _paq = _paq || [];
		  _paq.push(["setDomains", ["*.doc.ubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.xubuntu-fr.org","*.doc.edubuntu-fr.org","*.doc.lubuntu-fr.org","*.doc.ubuntu-fr.org","*.doc.xubuntu-fr.org"]]);
		  _paq.push(['trackPageView']);
		  _paq.push(['enableLinkTracking']);
		  (function() {
		    var u="//piwik.ubuntu-fr.org/";
		    _paq.push(['setTrackerUrl', u+'piwik.php']);
		    _paq.push(['setSiteId', 3]);
		    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
		    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		  })();
		</script>
		<noscript><p><img src="//piwik.ubuntu-fr.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
		<!-- End Piwik Code -->

</body>
</html>
